-- name: test_mv_refresh_label
create database db_${uuid0};
-- result:
-- !result
use db_${uuid0};
-- result:
-- !result
CREATE TABLE t_base (k1 int) DUPLICATE KEY(k1) DISTRIBUTED BY HASH(k1) BUCKETS 1 PROPERTIES("replication_num" = "1");
-- result:
-- !result
insert into t_base values (1), (2);
-- result:
-- !result
CREATE MATERIALIZED VIEW mv_label
REFRESH MANUAL
AS SELECT k1 FROM t_base;
-- result:
-- !result
refresh materialized view mv_label with sync mode;
-- result:
-- !result
[UC]label=select label from information_schema.loads where db_name='db_${uuid0}';
-- result:
[REGEX]mv_.+
-- !result
select case when substr('${label}', 1, 3) = 'mv_' then 1 else 0 end;
-- result:
1
-- !result

drop materialized view mv_label;
-- result:
-- !result
drop table t_base;
-- result:
-- !result
drop database db_${uuid0};
-- result:
-- !result
