-- name: test_drop_recover_range_partition
CREATE TABLE t0(k1 DATE, v1 INT)
DUPLICATE KEY(k1)
PARTITION BY RANGE(k1) (
  PARTITION p1 VALUES LESS THAN('2024-01-01'),
  PARTITION p2 VALUES LESS THAN('2024-02-01'),
  PARTITION p3 VALUES LESS THAN('2024-03-01'),
  PARTITION p4 VALUES LESS THAN('2024-04-01')
)
DISTRIBUTED BY HASH(k1) BUCKETS 1 PROPERTIES('replication_num'='1');
INSERT INTO t0 VALUES('2023-12-31', 0),('2024-01-01', 1),('2024-01-31', 2),('2024-02-02', 3),('2024-03-03', 4);
ALTER TABLE t0 DROP PARTITION p1;
SELECT * FROM t0 ORDER BY k1;
RECOVER PARTITION p1 FROM t0;
SELECT * FROM t0 ORDER BY k1;
INSERT INTO t0 VALUES('2023-12-01', 10);
SELECT * FROM t0 ORDER BY k1;
ALTER TABLE t0 DROP PARTITION p2 FORCE;
SELECT * FROM t0 ORDER BY k1;
RECOVER PARTITION p2 FROM t0;
SELECT * FROM t0 ORDER BY k1;
ALTER TABLE t0 DROP PARTITION pxxxx;
RECOVER PARTITION pyyyy FROM t0;

-- name: test_drop_recover_list_partition
CREATE TABLE t1(k1 VARCHAR(100) NOT NULL, v1 INT)
DUPLICATE KEY(k1)
PARTITION BY LIST(k1) (
  PARTITION p1 VALUES IN ('beijing', 'shanghai'),
  PARTITION p2 VALUES IN ('guangzhou'),
  PARTITION p3 VALUES IN ('shenzhen'),
  PARTITION p4 VALUES IN ('jinan','hefei')
)
DISTRIBUTED BY HASH(k1) BUCKETS 1 PROPERTIES('replication_num'='1');
INSERT INTO t1 VALUES('beijing', 1),('shanghai', 2),('shanghai', 3),('guangzhou', 4),('shenzhen', 5),('jinan', 6),('hefei', 7);
ALTER TABLE t1 DROP PARTITION p1;
SELECT * FROM t1 ORDER BY k1;
RECOVER PARTITION p1 FROM t1;
ALTER TABLE t1 DROP PARTITION p2 FORCE;
SELECT * FROM t1 ORDER BY k1;
RECOVER PARTITION p2 FROM t1;
