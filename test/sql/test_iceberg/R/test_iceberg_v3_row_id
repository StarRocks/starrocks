-- name: test_iceberg_v3_row_id
create external catalog iceberg_sql_test_${uuid0} PROPERTIES ("type"="iceberg", "iceberg.catalog.type"="hive", "iceberg.catalog.hive.metastore.uris"="${iceberg_catalog_hive_metastore_uris}","enable_iceberg_metadata_cache"="true","aws.s3.access_key" = "${oss_ak}","aws.s3.secret_key" = "${oss_sk}","aws.s3.endpoint" = "${oss_endpoint}");
-- result:
-- !result
select min(_row_id),max(_row_id) from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3;
-- result:
0	9999
-- !result
select count(_row_id) from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3;
-- result:
10000
-- !result
select _row_id,* from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3 order by _row_id limit 10;
-- result:
0	1	11	101	1
1	2	12	102	2
2	3	13	103	3
3	4	14	104	4
4	5	15	105	5
5	6	16	106	6
6	7	17	107	7
7	8	18	108	8
8	9	19	109	9
9	10	20	110	10
-- !result
select _row_id,* from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3 where c0=20 order by _row_id limit 10;
-- result:
9	10	20	110	10
-- !result
select _row_id,* from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3 where c0>100 order by _row_id limit 10;
-- result:
90	91	101	191	91
91	92	102	192	92
92	93	103	193	93
93	94	104	194	94
94	95	105	195	95
95	96	106	196	96
96	97	107	197	97
97	98	108	198	98
98	99	109	199	99
99	100	110	None	100
-- !result
select _row_id,* from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3 where _row_id=9 order by _row_id limit 10;
-- result:
9	10	20	110	10
-- !result
select _row_id,* from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3 where _row_id >=10 and _row_id <= 20 order by _row_id limit 10;
-- result:
10	11	21	111	11
11	12	22	112	12
12	13	23	113	13
13	14	24	114	14
14	15	25	115	15
15	16	26	116	16
16	17	27	117	17
17	18	28	118	18
18	19	29	119	19
19	20	30	120	20
-- !result
select _row_id,* from iceberg_sql_test_${uuid0}.iceberg_oss_db.test_v3 where _row_id in (10,11,12) order by _row_id limit 10;
-- result:
10	11	21	111	11
11	12	22	112	12
12	13	23	113	13
-- !result
drop catalog iceberg_sql_test_${uuid0};
-- result:
-- !result