-- name: testIcebergColocateJoin
create external catalog iceberg_sql_test_${uuid0} PROPERTIES ("type"="iceberg", "iceberg.catalog.type"="hive", "iceberg.catalog.hive.metastore.uris"="${iceberg_catalog_hive_metastore_uris}");
-- result:
-- !result
select * from iceberg_sql_test_${uuid0}.iceberg_oss_db.lineitem_two_bucket join iceberg_sql_test_${uuid0}.iceberg_oss_db.partsupp_two_bucket on ps_suppkey = l_suppkey and ps_partkey = l_partkey order by l_orderkey limit 3;
-- result:
545153	1	2	1995-10-04	1	2	3
545153	1	2	1995-10-04	1	2	3
545153	1	2	1995-10-04	1	2	3
-- !result
select * from iceberg_sql_test_${uuid0}.iceberg_oss_db.lineitem_two_bucket join iceberg_sql_test_${uuid0}.iceberg_oss_db.partsupp_no_bucket on ps_suppkey = l_suppkey and ps_partkey = l_partkey order by l_orderkey limit 3;
-- result:
545153	1	2	1995-10-04	1	2	3
545153	1	2	1995-10-04	1	2	3
545153	1	2	1995-10-04	1	2	3
-- !result
drop catalog iceberg_sql_test_${uuid0}
-- result:
-- !result