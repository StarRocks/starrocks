-- name: test_bucket_aware_incremental_scan_range
create external catalog iceberg_${uuid0} PROPERTIES ("type"="iceberg",
    "iceberg.catalog.type"="hive", 
    "iceberg.catalog.hive.metastore.uris"="${iceberg_catalog_hive_metastore_uris}",
    "aws.s3.access_key" = "${oss_ak}",
    "aws.s3.secret_key" = "${oss_sk}",
    "aws.s3.endpoint" = "${oss_endpoint}"
);
-- result:
-- !result
select distinct entity_type_id from iceberg_${uuid0}.iceberg_oss_db.entity order by entity_type_id;
-- result:
a
b
c
d
e
f
g
type_a
type_b
type_c
-- !result
SELECT
  owner_id,
  COUNT(*) AS count
FROM iceberg_${uuid0}.iceberg_oss_db.entity
GROUP BY owner_id
ORDER BY count DESC, owner_id ASC
LIMIT 10;
-- result:
owner_0	1000
owner_1	1000
owner_10	1000
owner_100	1000
owner_101	1000
owner_102	1000
owner_103	1000
owner_104	1000
owner_105	1000
owner_106	1000
-- !result
drop catalog iceberg_${uuid0};
-- result:
-- !result