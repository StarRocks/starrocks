-- name: test_expr_predicate_pushdown
create table t0 (
    c0 string
) DUPLICATE KEY(c0) DISTRIBUTED BY HASH(c0) BUCKETS 1 PROPERTIES('replication_num' = '1');
-- result:
-- !result
insert into t0 SELECT concat("s_", generate_series) FROM TABLE(generate_series(0,  80000));
-- result:
-- !result
insert into t0 SELECT * FROM t0;
-- result:
-- !result
insert into t0 SELECT * FROM t0;
-- result:
-- !result
insert into t0 SELECT * FROM t0;
-- result:
-- !result
insert into t0 SELECT * FROM t0;
-- result:
-- !result
insert into t0 SELECT * FROM t0;
-- result:
-- !result
create table t1 like t0;
-- result:
-- !result
insert into t1 select * from t0 order by c0;
-- result:
-- !result
select count(*) from t1;
-- result:
2560032
-- !result
select count(*) from t1 where c0 like 's_%';
-- result:
2560032
-- !result
-- name: test_push_down_cast_expr
CREATE TABLE `test003` (
  `data_date` date NOT NULL COMMENT "",
  `user_id` varchar(128) NULL COMMENT ""
) ENGINE=OLAP 
PRIMARY KEY(`data_date`)
COMMENT "OLAP"
DISTRIBUTED BY HASH(`data_date`)
PROPERTIES (
"replication_num" = "1"
);
-- result:
-- !result
insert into test003 values("2025-08-12", NULL);
-- result:
-- !result
set sql_mode = 'ALLOW_THROW_EXCEPTION';
-- result:
-- !result
select * from test003 where CAST(user_id AS INT) ;
-- result:
-- !result
