-- name: test_empty_input @mac

CREATE TABLE `t0` (
  `v1` bigint(20) COMMENT "",
  `v2` bigint(20) COMMENT "",
  `v3` bigint(20) COMMENT "",
  `v4` varchar COMMENT ""
) ENGINE=OLAP
DUPLICATE KEY(`v1`, `v2`, `v3`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 3
PROPERTIES (
"replication_num" = "1",
"enable_persistent_index" = "true",
"replicated_storage" = "true",
"compression" = "LZ4"
);

select percentile_disc(v1,0.5) from t0;
select percentile_cont(v1,0.5) from t0;
select percentile_disc_lc(v1,0.5) from t0;
select max(v1),min(v1) from t0;
select max(v1),count(*) from t0;
select count(v1) from t0;
select count(*) from t0;
select count(distinct v1) from t0;

-- name: test_empty_input_not_null_string
CREATE TABLE `tt0` (
  `c0` int(11) NULL COMMENT "",
  `c1` varchar(20) not NULL COMMENT "",
  `c2` varchar(200) not NULL COMMENT "",
  `c3` int(11) NULL COMMENT ""
) ENGINE=OLAP
DUPLICATE KEY(`c0`, `c1`)
COMMENT "OLAP"
DISTRIBUTED BY HASH(`c0`, `c1`) BUCKETS 4
PROPERTIES (
"compression" = "LZ4",
"fast_schema_evolution" = "true",
"replicated_storage" = "true",
"replication_num" = "1"
);
insert into tt0 values (1,"test","test",1);
select max(c2) from tt0 where 1=0;
select min(c2) from tt0 where 1=0;

