-- name: test_nested_type_in_predict
CREATE TABLE `sc2` (
  `v1` bigint(20) NULL COMMENT "",
  `s2` string NULL,
  `array1` ARRAY<INT> NULL,
  `array2` ARRAY<MAP<INT, INT>> NULL,
  `array3` ARRAY<STRUCT<a INT, b INT>> NULL,
  `map1` MAP<INT, INT> NULL,
  `map2` MAP<INT, ARRAY<INT>> NULL,
  `map3` MAP<INT, STRUCT<c INT, b INT>> NULL,
  `st1` STRUCT<s1 int, s2 ARRAY<INT>, s3 MAP<INT, INT>, s4 Struct<e INT, f INT>>
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
COMMENT "OLAP"
DISTRIBUTED BY HASH(`v1`) BUCKETS 3
PROPERTIES (
"replication_num" = "1",
"in_memory" = "false",
"enable_persistent_index" = "false",
"replicated_storage" = "true",
"compression" = "LZ4"
);


insert into sc2 values (0, "abc", null, null, null, null, null, null, null);
insert into sc2 values (2, "abc", [1,3,2], [map{null:null}], [row(1, 2)], map{2:null}, map{2:[2,3,4], 1:[1,2,3]}, map{2:row(2,4), 1:row(1,2)}, row(1, [2,1,3], map{2:2, 1:1}, null));
insert into sc2 values (3, "abc", [1,2,3], [],               [row(1, 2)], map{2:20, 1:null, 3:30}, map{2:[3,2,4], 1:[1,2,3]}, map{2:row(2,4), 1:row(1,2)}, row(1, [2,1,3], map{1:1, 2:2}, row(3, 2)));
insert into sc2 values (4, "abc", [1,2,3], [map{2:20, null:10}],       [row(1, 3)], map{}, map{2:[3,2,4], 1:[1,2,3]}, map{2:row(2,4), 1:row(1,null)}, row(1, null, map{1:1, 2:2}, row(1, 2)));
insert into sc2 values (5, "abd", [1,2,3], [null],       [row(1, 2)], map{1:10, 2:20, null:30}, map{1:[1,2,3], 2:[2,3,4]}, map{}, row(1, [], map{1:1, 2:null}, row(null, 2)));
insert into sc2 values (6, "abd", [1,3,2], [map{}],       [row(1, 2)], map{1:10, 2:20, 4:40}, map{1:[2,1,3], 2:[2,3,4]}, map{1:row(2,3), 2:row(2,3)}, row(1, [null], map{}, row(1, 2)));
insert into sc2 values (7, "abd", [2,1,3], [map{1:10, 3:30, 2:20}], [], map{}, map{1:[2,1,3], 2:[2,4,3]}, map{1:row(2,3), 2:row(2,4)}, row(1, [1,2,3], map{2:null}, row(1, 2)));
insert into sc2 values (8, "abd", [2,1,3], [map{1:10, 3:30, 2:20}], [null], map{2:20, 1:10, 3:30}, map{1:[1,2,3], null:[2,4,3]}, map{null:row(2,4)}, row(1, null, map{2:2, 3:3, 1:1}, row(1, 2)));
insert into sc2 values (9, "abd", [],      [map{1:10, 3:30, 2:20}], [row(1, 2),null], map{1:10, 2:20, 3:30}, map{1:[1,2,3], 2:[2,4,3]}, map{1:row(1,3), 2:row(2,4)}, row(1, [1,2,3], map{2:2, 3:3, 1:1}, null));
insert into sc2 values (10, "abc", [1,2,null], [map{2:20, 1:10, null:30}], [row(1, 2)], map{1:10, 4:40}, map{2:[2,null,4], 1:[1,2,null]}, map{null:null}, row(1, [2,1,null], map{2:2, 1:1}, row(null, 2)));
insert into sc2 values (11, "abc", [2,1,null], [map{2:20, 1:10, null:30}], [row(1, null)], map{}, map{2:[2,null,4], 1:[1,2,null]}, map{2:row(2,4), 1:row(1,2)}, row(1, [2,1,null], null, row(null, 2)));
insert into sc2 values (12, "abc", [1,2],  [map{2:20, 1:10, null:30}], [row(1, 2)], map{2:20, 1:10, null:30}, map{2:[2,null,4], 1:[1,2,null]}, map{2:row(2,4), 1:row(1,2)}, row(1, [null], map{null:2, 1:1}, row(null, 2)));
insert into sc2 values (13, "abc", [],     [map{2:20, 1:10}],       [row(1, 2)], map{2:20, 1:10, null:30}, map{2:[null,2,4], 1:[1,2,null]}, map{2:row(2,4), 1:row(1,2)}, row(1, [2,1,null], map{1:1, 2:2}, row(null, 2)));
insert into sc2 values (14, "abc", [null], [map{}],       [row(1, null)], map{2:20, 1:10, null:30}, map{2:[null,2,4], 1:[1,2,null]}, map{2:row(2,4), 1:row(1,2)}, row(1, [2,1,null], map{1:1, 2:2}, row(1, 2)));
insert into sc2 values (15, "abd", [1,2,null], [map{1:10, 2:20}],       [row(1, 2),row(1,3)], map{1:10, 2:20, null:30}, map{1:[1,2,null], 2:[2,null,4]}, map{1:row(1,null), 2:row(2,null)}, row(1, [2,1,null], map{1:1, 2:2}, row(null, 2)));
insert into sc2 values (16, "abd", [1,null,2], [map{1:10, 2:20}],       [row(1, 2),null], map{1:10, 2:20, 4:40}, map{1:[2,1,null], 2:[2,null,4]}, map{1:row(2,null), 2:row(2,null)}, row(1, [1,2,null], map{2:2, 1:1, null:null}, row(1, 2)));
insert into sc2 values (17, "abd", null, [map{1:10, null:30, 2:20}], [row(2, 1)], map{1:10, 2:20, 4:40}, map{1:[2,1,null], 2:[2,4,null]}, map{1:row(2,null), 2:row(2,4)}, row(1, [1,2,null], map{2:2, 1:1, null:null}, row(1, 2)));
insert into sc2 values (18, "abd", [null,null], [map{1:10, null:30, 2:20}], [row(2, 1)], map{2:20, 1:10, null:30}, map{1:[1,2,null], 2:[2,4,null]}, map{1:row(2,null), 2:row(2,4)}, row(1, [1,2,null], map{2:2, null:null, 1:1}, row(1, 2)));
insert into sc2 values (19, "abd", [null], [map{1:10, null:30, 2:20}], [row(1, 2)], map{1:10, 2:20, null:30}, map{1:[1,2,null], 2:[2,4,null]}, map{1:row(1,null), 2:row(2,4)}, row(1, [1,2,null], map{2:2, null:null, 1:1}, row(1, 2)));

select array1 in ([]), array1 not in ([]), array1 in ([null]), array1 not in ([null]), array1 in ([1,null,2]), array1 not in ([1,null,2]) from sc2;
select [] in (array1), [] not in (array1), [null] in (array1), [null] not in (array1),[] in (array2), [] not in (array2), [null] in (array2), [null] not in (array2),[] in (array3), [] not in (array3), [null] in (array3), [null] not in (array3) from sc2;

select array2 in ([]), array2 not in ([]), array2 in ([null]), array2 not in ([null]),array2 in ([map{1:10, 3:30, 2:20}], [map{}]), array2 not in ([map{1:10, 3:30, 2:20}], [map{}]) from sc2;
select array3 in ([]), array3 not in ([]), array3 in ([null]), array3 not in ([null]), array3 in ([row(1, 2)], [null]), array3 not in ([row(1, 2)], [null]) from sc2;

select array1 in (null), array1 not in (null), array2 in (null), array2 not in (null), array3 in (null), array3 not in (null) from sc2;
select null in (array1), null not in (array1), null in (array2), null not in (array2), null in (array3), null not in (array3) from sc2;

select map1 in (map{}), map1 not in (map{}), map2 in (map{}), map2 not in (map{}), map3 in (map{}), map3 not in (map{}) from sc2;

select map1 not in (map{}) from sc2;