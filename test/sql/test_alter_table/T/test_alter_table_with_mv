-- name: test_alter_table_with_mv

CREATE TABLE t0(k0 BIGINT, k1 DATETIME, v0 INT, v1 VARCHAR(100))
 distributed by hash(k0)
 order by (v0)
 properties('replication_num'='1');

INSERT INTO t0 VALUES(0, '2024-01-01 00:00:00', 10, '100');

CREATE MATERIALIZED VIEW test_mv1 AS SELECT k0, v1 FROM t0 WHERE v0 > 10;
function: wait_table_rollup_finish()
CREATE MATERIALIZED VIEW test_mv2 AS SELECT k0, v1, k1, v0 FROM t0 WHERE v0 > 10 and k1 = '2024-01-01 00:00:00';
function: wait_table_rollup_finish()

ALTER TABLE t0 DROP COLUMN k1;

ALTER TABLE t0 DROP COLUMN v0;

ALTER TABLE t0 DROP COLUMN v1, DROP COLUMN v0;

ALTER TABLE t0 DROP COLUMN v1, DROP COLUMN v100;

DESC t0;

SELECT * from t0 order by k0;