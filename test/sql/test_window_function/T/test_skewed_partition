-- name: test_skewed_partition
CREATE TABLE `t0` (
    `v1` int(11) NULL,
    `v2` int(11) NULL,
    `v3` int(11) NOT NULL,
    `v4` int(11) NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
    "replication_num" = "1"
);

INSERT INTO `t0` (v1, v2, v3, v4) values
    (1, 1, 1, NULL),
    (1, 1, 2, NULL),
    (1, NULL, 3, NULL),
    (1, NULL, 4, NULL),
    (1, 2, 5, NULL),
    (1, 2, 6, NULL),
    (1, NULL, 7, NULL),
    (1, NULL, 8, NULL),
    (2, 3, 9, NULL),
    (2, 3, 10, NULL),
    (2, NULL, 11, NULL),
    (2, NULL, 12, NULL),
    (2, 4, 13, NULL),
    (2, 4, 14, NULL),
    (2, NULL, 15, NULL),
    (2, NULL, 16, NULL),
    (NULL, 3, 17, NULL),
    (NULL, 3, 18, NULL),
    (NULL, NULL, 19, NULL),
    (NULL, NULL, 20, NULL),
    (NULL, 4, 21, NULL),
    (NULL, 4, 22, NULL),
    (NULL, NULL, 23, NULL),
    (NULL, NULL, 24, NULL);

INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
INSERT INTO `t0` SELECT * FROM `t0`;
-- This point for v1, values `1`, `2`, `NULL` all have 32768 rows

INSERT INTO `t0` (v1, v2, v3, v4) values
    (1, 1111, 1111, NULL),
    (1, 1111, 2222, NULL),
    (1, NULL, 3333, NULL),
    (1, NULL, 4444, NULL),
    (1, 2222, 5555, NULL),
    (1, 2222, 6666, NULL),
    (1, NULL, 7777, NULL),
    (1, NULL, 8888, NULL),
    (101, 101, 101, NULL),
    (101, 101, 102, NULL),
    (101, NULL, 103, NULL),
    (101, NULL, 104, NULL),
    (101, 102, 105, NULL),
    (101, 102, 106, NULL),
    (101, NULL, 107, NULL),
    (101, NULL, 108, NULL),
    (102, 103, 109, NULL),
    (102, 103, 110, NULL),
    (102, NULL, 111, NULL),
    (102, NULL, 112, NULL),
    (102, 104, 113, NULL),
    (102, 104, 114, NULL),
    (102, NULL, 115, NULL),
    (102, NULL, 116, NULL),
    (NULL, 103, 117, NULL),
    (NULL, 103, 118, NULL),
    (NULL, NULL, 119, NULL),
    (NULL, NULL, 120, NULL),
    (NULL, 104, 121, NULL),
    (NULL, 104, 122, NULL),
    (NULL, NULL, 123, NULL),
    (NULL, NULL, 124, NULL);
-- This point for v1, value `1` and `NULL` are not an integer multiple of chunk_size

CREATE TABLE `t1` (
    `v1` decimal64(18,5) NULL,
    `v2` decimal64(18,5) NULL,
    `v3` decimal64(18,5) NOT NULL,
    `v4` decimal64(18,5) NULL,
    `v5` decimal64(18,5) NOT NULL,
    `v6` decimal64(18,5) NOT NULL,
    `v7` decimal64(18,5) NOT NULL,
    `v8` decimal64(18,5) NOT NULL,
    `v9` decimal64(18,5) NOT NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
    "replication_num" = "1"
);

INSERT INTO `t1` (v1, v2, v3, v4, v5, v6, v7, v8, v9)
SELECT v1, v2, v3, v4, v5, v6, 
mod(v5, 128) as v7,
mod(v6, 32) as v8,
1 as v9
FROM (
    SELECT v1, v2, v3, v4,
    row_number() OVER (ORDER BY v1, v2, v3, v4) as v5,
    row_number() OVER (PARTITION BY v1 ORDER BY v2, v3, v4) as v6
    FROM `t0`
) tmp;

-- SUM(HAS_NULL) with partition by v1
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v1) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v2
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v2) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v3
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v3) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v4
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v4) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v5
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v5) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v6
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v6) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v7
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v7) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v8
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v8) AS wv FROM t1) a;

-- SUM(HAS_NULL) with PARTITION BY v9
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v9) AS wv FROM t1) a;
