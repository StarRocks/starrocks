-- name: test_removable_cumulative_process
CREATE TABLE IF NOT EXISTS `t1` (
    `v1` int(11) NULL,
    `v2` int(11) NULL,
    `v3` int(11) NOT NULL,
    `v4` int(11) NULL
)
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
    "replication_num" = "1"
);

INSERT INTO `t1` values (1, 1, 1, NULL), (1, 1, 2, NULL), (1, NULL, 3, NULL), (1, NULL, 4, NULL),
(1, 2, 5, NULL), (1, 2, 6, NULL), (1, NULL, 7, NULL), (1, NULL, 8, NULL), (2, 3, 9, NULL),
(2, 3, 10, NULL), (2, NULL, 11, NULL), (2, NULL, 12, NULL), (2, 4, 13, NULL), (2, 4, 14, NULL),
(2, NULL, 15, NULL), (2, NULL, 16, NULL), (NULL, 3, 17, NULL), (NULL, 3, 18, NULL),
(NULL, NULL, 19, NULL), (NULL, NULL, 20, NULL), (NULL, 4, 21, NULL), (NULL, 4, 22, NULL),
(NULL, NULL, 23, NULL), (NULL, NULL, 24, NULL);

-- >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> COUNT <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

-- COUNT(Nullable Column)
SELECT v3, v1, COUNT(v1) OVER(ORDER BY v3 ROWS BETWEEN 5 PRECEDING AND 2 PRECEDING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, COUNT(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, COUNT(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 FOLLOWING AND 5 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, COUNT(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, COUNT(v1) OVER(ORDER BY v3 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;

-- Count(Not Nullable Column)
SELECT v3, COUNT(v3) OVER(ORDER BY v3 ROWS BETWEEN 5 PRECEDING AND 2 PRECEDING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, COUNT(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, COUNT(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 FOLLOWING AND 5 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, COUNT(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS CNT FROM t1 ORDER BY v3;
SELECT v3, COUNT(v3) OVER(ORDER BY v3 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;

-- >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> SUM <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

-- SUM(Nullable Column)
SELECT v3, v1, SUM(v1) OVER(ORDER BY v3 ROWS BETWEEN 5 PRECEDING AND 2 PRECEDING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, SUM(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, SUM(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 FOLLOWING AND 5 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, SUM(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, SUM(v1) OVER(ORDER BY v3 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;

-- SUM(Not Nullable Column)
SELECT v3, SUM(v3) OVER(ORDER BY v3 ROWS BETWEEN 5 PRECEDING AND 2 PRECEDING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, SUM(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, SUM(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 FOLLOWING AND 5 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, SUM(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS CNT FROM t1 ORDER BY v3;
SELECT v3, SUM(v3) OVER(ORDER BY v3 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;

-- >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> AVG <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

-- AVG(Nullable Column)
SELECT v3, v1, AVG(v1) OVER(ORDER BY v3 ROWS BETWEEN 5 PRECEDING AND 2 PRECEDING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, AVG(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, AVG(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 FOLLOWING AND 5 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, AVG(v1) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS CNT FROM t1 ORDER BY v3;
SELECT v3, v1, AVG(v1) OVER(ORDER BY v3 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;

-- AVG(Not Nullable Column)
SELECT v3, AVG(v3) OVER(ORDER BY v3 ROWS BETWEEN 5 PRECEDING AND 2 PRECEDING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, AVG(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, AVG(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 FOLLOWING AND 5 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
SELECT v3, AVG(v3) OVER(ORDER BY v3 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS CNT FROM t1 ORDER BY v3;
SELECT v3, AVG(v3) OVER(ORDER BY v3 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS CNT FROM t1 ORDER BY v3;
