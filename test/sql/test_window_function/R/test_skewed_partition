-- name: test_skewed_partition
CREATE TABLE `t0` (
    `v1` int(11) NULL,
    `v2` int(11) NULL,
    `v3` int(11) NOT NULL,
    `v4` int(11) NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t0` (v1, v2, v3, v4) values
    (1, 1, 1, NULL),
    (1, 1, 2, NULL),
    (1, NULL, 3, NULL),
    (1, NULL, 4, NULL),
    (1, 2, 5, NULL),
    (1, 2, 6, NULL),
    (1, NULL, 7, NULL),
    (1, NULL, 8, NULL),
    (2, 3, 9, NULL),
    (2, 3, 10, NULL),
    (2, NULL, 11, NULL),
    (2, NULL, 12, NULL),
    (2, 4, 13, NULL),
    (2, 4, 14, NULL),
    (2, NULL, 15, NULL),
    (2, NULL, 16, NULL),
    (NULL, 3, 17, NULL),
    (NULL, 3, 18, NULL),
    (NULL, NULL, 19, NULL),
    (NULL, NULL, 20, NULL),
    (NULL, 4, 21, NULL),
    (NULL, 4, 22, NULL),
    (NULL, NULL, 23, NULL),
    (NULL, NULL, 24, NULL);
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` (v1, v2, v3, v4) values
    (1, 1111, 1111, NULL),
    (1, 1111, 2222, NULL),
    (1, NULL, 3333, NULL),
    (1, NULL, 4444, NULL),
    (1, 2222, 5555, NULL),
    (1, 2222, 6666, NULL),
    (1, NULL, 7777, NULL),
    (1, NULL, 8888, NULL),
    (101, 101, 101, NULL),
    (101, 101, 102, NULL),
    (101, NULL, 103, NULL),
    (101, NULL, 104, NULL),
    (101, 102, 105, NULL),
    (101, 102, 106, NULL),
    (101, NULL, 107, NULL),
    (101, NULL, 108, NULL),
    (102, 103, 109, NULL),
    (102, 103, 110, NULL),
    (102, NULL, 111, NULL),
    (102, NULL, 112, NULL),
    (102, 104, 113, NULL),
    (102, 104, 114, NULL),
    (102, NULL, 115, NULL),
    (102, NULL, 116, NULL),
    (NULL, 103, 117, NULL),
    (NULL, 103, 118, NULL),
    (NULL, NULL, 119, NULL),
    (NULL, NULL, 120, NULL),
    (NULL, 104, 121, NULL),
    (NULL, 104, 122, NULL),
    (NULL, NULL, 123, NULL),
    (NULL, NULL, 124, NULL);
-- result:
-- !result
CREATE TABLE `t1` (
    `v1` decimal64(18,5) NULL,
    `v2` decimal64(18,5) NULL,
    `v3` decimal64(18,5) NOT NULL,
    `v4` decimal64(18,5) NULL,
    `v5` decimal64(18,5) NOT NULL,
    `v6` decimal64(18,5) NOT NULL,
    `v7` decimal64(18,5) NOT NULL,
    `v8` decimal64(18,5) NOT NULL,
    `v9` decimal64(18,5) NOT NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t1` (v1, v2, v3, v4, v5, v6, v7, v8, v9)
SELECT v1, v2, v3, v4, v5, v6, 
mod(v5, 128) as v7,
mod(v6, 32) as v8,
1 as v9
FROM (
    SELECT v1, v2, v3, v4,
    row_number() OVER (ORDER BY v1, v2, v3, v4) as v5,
    row_number() OVER (PARTITION BY v1 ORDER BY v2, v3, v4) as v6
    FROM `t0`
) tmp;
-- result:
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
4796118752.00000	48772.76635209893	406.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1040602226.00000	21164.21709241783	1.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
1039192334.00000	21151.88955831468	1.00000	57320.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
1042070180.00000	21177.70556436207	1.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
835278.00000	16.99619493336	1.00000	24.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1588656.00000	32.29566384095	1.00000	6680.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
879298.00000	17.87881498953	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
853040.00000	17.34949560690	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
882780.00000	17.94596572544	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
462398344.00000	13536.25128805621	1.00000	33199.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
1303296264.00000	20308.15669409125	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
1463586344.00000	18488.96341586660	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
897878306.00000	18261.43642206313	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
1463591678.00000	18485.29450843690	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v4 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
4796118752.00000	48772.76635209893	406.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1040602226.00000	21164.21709241783	1.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v6 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1040602226.00000	21164.21709241783	1.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v7 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
2505580146.00000	25481.85812789846	101.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v8 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
2535730290.00000	25788.48639248230	101.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v9 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
4796118752.00000	48772.76635209893	406.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v1) AS wv FROM t1) a;
-- result:
4796118752.00000	48772.76635209893	406.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
41614390848.00000	423185.71884152294	836.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
20446266832.00000	207922.49869834038	3.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
20433692722.00000	207891.87833960728	3.00000	672098.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
20458968697.00000	208051.66670395379	33.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
7522446.00000	76.51682924596	3.00000	24458.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
13913093.00000	141.48524446795	11.00000	24498.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
7618383.00000	77.49268138865	6.00000	24458.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
7559366.00000	76.87282378783	3.00000	24458.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
7625223.00000	77.54253782948	6.00000	24458.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
8735743512.00000	104845.69745559289	3.00000	229098.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
11681602800.00000	118792.73917995444	836.00000	229098.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
9001765040.00000	108038.46663466155	14.00000	229098.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
10506403568.00000	106841.88464041653	3.00000	229098.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
10981699872.00000	111675.27530100879	14.00000	229098.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v4 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
41614390848.00000	423185.71884152294	836.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
20446266832.00000	207922.49869834038	3.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v6 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
20446266832.00000	207922.49869834038	3.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v7 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
21503001040.00000	218668.65684998373	103.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v8 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
21914277328.00000	222851.01415554832	103.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed] PARTITION BY v1 ORDER BY v9 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
41614390848.00000	423185.71884152294	836.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v3) OVER([skewed, hash] PARTITION BY v1) AS wv FROM t1) a;
-- result:
41614390848.00000	423185.71884152294	836.00000	672708.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v4 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v6 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v7 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v8 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed] PARTITION BY v1 ORDER BY v9 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v4) OVER([skewed, hash] PARTITION BY v1) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result