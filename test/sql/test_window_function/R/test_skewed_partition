-- name: test_skewed_partition
CREATE TABLE `t0` (
    `v1` int(11) NULL,
    `v2` int(11) NULL,
    `v3` int(11) NOT NULL,
    `v4` int(11) NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t0` (v1, v2, v3, v4) values
    (1, 1, 1, NULL),
    (1, 1, 2, NULL),
    (1, NULL, 3, NULL),
    (1, NULL, 4, NULL),
    (1, 2, 5, NULL),
    (1, 2, 6, NULL),
    (1, NULL, 7, NULL),
    (1, NULL, 8, NULL),
    (2, 3, 9, NULL),
    (2, 3, 10, NULL),
    (2, NULL, 11, NULL),
    (2, NULL, 12, NULL),
    (2, 4, 13, NULL),
    (2, 4, 14, NULL),
    (2, NULL, 15, NULL),
    (2, NULL, 16, NULL),
    (NULL, 3, 17, NULL),
    (NULL, 3, 18, NULL),
    (NULL, NULL, 19, NULL),
    (NULL, NULL, 20, NULL),
    (NULL, 4, 21, NULL),
    (NULL, 4, 22, NULL),
    (NULL, NULL, 23, NULL),
    (NULL, NULL, 24, NULL);
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` (v1, v2, v3, v4) values
    (1, 1111, 1111, NULL),
    (1, 1111, 2222, NULL),
    (1, NULL, 3333, NULL),
    (1, NULL, 4444, NULL),
    (1, 2222, 5555, NULL),
    (1, 2222, 6666, NULL),
    (1, NULL, 7777, NULL),
    (1, NULL, 8888, NULL),
    (101, 101, 101, NULL),
    (101, 101, 102, NULL),
    (101, NULL, 103, NULL),
    (101, NULL, 104, NULL),
    (101, 102, 105, NULL),
    (101, 102, 106, NULL),
    (101, NULL, 107, NULL),
    (101, NULL, 108, NULL),
    (102, 103, 109, NULL),
    (102, 103, 110, NULL),
    (102, NULL, 111, NULL),
    (102, NULL, 112, NULL),
    (102, 104, 113, NULL),
    (102, 104, 114, NULL),
    (102, NULL, 115, NULL),
    (102, NULL, 116, NULL),
    (NULL, 103, 117, NULL),
    (NULL, 103, 118, NULL),
    (NULL, NULL, 119, NULL),
    (NULL, NULL, 120, NULL),
    (NULL, 104, 121, NULL),
    (NULL, 104, 122, NULL),
    (NULL, NULL, 123, NULL),
    (NULL, NULL, 124, NULL);
-- result:
-- !result
CREATE TABLE `t1` (
    `v1` decimal64(18,5) NULL,
    `v2` decimal64(18,5) NULL,
    `v3` decimal64(18,5) NOT NULL,
    `v4` decimal64(18,5) NULL,
    `v5` decimal64(18,5) NOT NULL,
    `v6` decimal64(18,5) NOT NULL,
    `v7` decimal64(18,5) NOT NULL,
    `v8` decimal64(18,5) NOT NULL,
    `v9` decimal64(18,5) NOT NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t1` (v1, v2, v3, v4, v5, v6, v7, v8, v9)
SELECT v1, v2, v3, v4, v5, v6, 
mod(v5, 128) as v7,
mod(v6, 32) as v8,
1 as v9
FROM (
    SELECT v1, v2, v3, v4,
    row_number() OVER (ORDER BY v1, v2, v3, v4) as v5,
    row_number() OVER (PARTITION BY v1 ORDER BY v2, v3, v4) as v6
    FROM `t0`
) tmp;
-- result:
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
4796118752.00000	48772.76635209893	406.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1040602226.00000	21164.21709241783	1.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
1039192334.00000	21151.88955831468	1.00000	57320.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
1042070180.00000	21177.70556436207	1.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
835278.00000	16.99619493336	1.00000	24.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1588656.00000	32.29566384095	1.00000	6680.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
879298.00000	17.87881498953	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
853040.00000	17.34949560690	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
882780.00000	17.94596572544	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
462398344.00000	13536.25128805621	1.00000	33199.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
1303296264.00000	20308.15669409125	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
1463586344.00000	18488.96341586660	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
897878306.00000	18261.43642206313	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
1463591678.00000	18485.29450843690	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1040602226.00000	21164.21709241783	1.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v1) AS wv FROM t1) a;
-- result:
4796118752.00000	48772.76635209893	406.00000	57758.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
2080392240.00000	42311.91506671006	202.00000	65536.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1040269702.00000	21157.45407582167	1.00000	65536.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
1038864834.00000	21152.97348916762	1.00000	65496.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
1041666570.00000	21185.86417995444	11.00000	65536.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
835134.00000	16.99776113327	1.00000	24.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1549060.00000	31.50545069964	6.00000	4444.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
835134.00000	16.99776113327	1.00000	24.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
848112.00000	17.24926781647	1.00000	4444.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
848112.00000	17.24926781647	1.00000	4444.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
462212772.00000	15855.26797475302	1.00000	40004.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
1142746720.00000	23241.67588675561	202.00000	40004.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
462212772.00000	15855.26797475302	1.00000	40004.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
897647950.00000	18256.75134233648	1.00000	40004.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
897647950.00000	18256.75134233648	1.00000	40004.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v2 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1040269702.00000	21157.45407582167	1.00000	65536.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v2) AS wv FROM t1) a;
-- result:
2080392240.00000	42311.91506671006	202.00000	65536.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
570433244.00000	11601.71745850960	101.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
285290204.00000	5802.35527172144	1.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
283891194.00000	5789.91666666667	1.00000	16344.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
286680974.00000	5830.64135209893	11.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
834054.00000	16.98961134197	1.00000	24.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1538784.00000	31.29645297755	6.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
834054.00000	16.98961134197	1.00000	24.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
842974.00000	17.14476895542	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
842974.00000	17.14476895542	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
570433244.00000	11601.71745850960	101.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
285290204.00000	5802.35527172144	1.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
285290204.00000	5802.35527172144	1.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v3 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
285290204.00000	5802.35527172144	1.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v3) AS wv FROM t1) a;
-- result:
570433244.00000	11601.71745850960	101.00000	16384.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
14471519104.00000	147164.00000000000	147164.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
5852375186.00000	71415.71711329136	3.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
5850906755.00000	71406.51169176695	3.00000	146546.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
5853846826.00000	71424.95944264135	3.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
880194.00000	17.89703340721	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1617353.00000	32.87236031788	1.00000	6680.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.95011282552	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
881533.00000	17.92243727890	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.95011282552	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
1087255436.00000	16941.77630266766	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
1418001158.00000	19116.71103861087	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
1471787164.00000	18588.80423360614	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1265817686.00000	18298.50939632242	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
1471787164.00000	18588.80423360614	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v4 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
5852375186.00000	71415.71711329136	3.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v4) AS wv FROM t1) a;
-- result:
14471519104.00000	147164.00000000000	147164.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v5 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v5) AS wv FROM t1) a;
-- result:
147164.00000	2.99308493329	1.00000	2222.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
436028.00000	8.86451980158	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
287224.00000	5.84168564920	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
436028.00000	8.86451980158	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
436028.00000	8.86451980158	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
287224.00000	5.84168564920	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
295968.00000	6.01707733594	2.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
436028.00000	8.86451980158	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
287224.00000	5.84168564920	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
295968.00000	6.01707733594	2.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v6 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
287224.00000	5.84168564920	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v6) AS wv FROM t1) a;
-- result:
436028.00000	8.86451980158	3.00000	2326.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
113064668.00000	1149.77900260332	1088.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
45797596.00000	558.86166837507	3.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
44355800.00000	549.85620072395	3.00000	3270.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
47269236.00000	567.94871918104	3.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
855408.00000	17.17135057010	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1607344.00000	30.68855964564	1.00000	2242.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.28358910116	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
871524.00000	17.27295068971	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.28358910116	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
113064668.00000	1149.77900260332	1088.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
45797596.00000	558.86166837507	3.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
67414236.00000	685.60568708811	4.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v7 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
45797596.00000	558.86166837507	3.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v7) AS wv FROM t1) a;
-- result:
113064668.00000	1149.77900260332	1088.00000	3310.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
452258672.00000	4599.11601041328	4352.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
182972768.00000	2232.79113584224	3.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
181513318.00000	2223.66489439898	3.00000	6646.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
184444408.00000	2241.99455438324	3.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
872688.00000	17.68866547754	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1613478.00000	32.28505682728	1.00000	2242.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.78488559459	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
877658.00000	17.73189752707	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.78488559459	1.00000	2232.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
452258672.00000	4599.11601041328	4352.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
None	None	None	None
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
182972768.00000	2232.79113584224	3.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
269433068.00000	2740.14591977870	4.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v8 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
182972768.00000	2232.79113584224	3.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v8) AS wv FROM t1) a;
-- result:
452258672.00000	4599.11601041328	4352.00000	6884.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv FROM t1) a;
-- result:
14471519104.00000	147164.00000000000	147164.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
5852375186.00000	71415.71711329136	3.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv FROM t1) a;
-- result:
5850906755.00000	71406.51169176695	3.00000	146546.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
5853846826.00000	71424.95944264135	3.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv FROM t1) a;
-- result:
880194.00000	17.89703340721	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
1617353.00000	32.87236031788	1.00000	6680.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.95011282552	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
881533.00000	17.92243727890	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 5 FOLLOWING) AS wv FROM t1) a;
-- result:
882984.00000	17.95011282552	1.00000	6670.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 15000 PRECEDING AND 5000 PRECEDING) AS wv FROM t1) a;
-- result:
1087255436.00000	16941.77630266766	1.00000	38597.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5000 PRECEDING AND 5000 FOLLOWING) AS wv FROM t1) a;
-- result:
1418001158.00000	19116.71103861087	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 5000 FOLLOWING AND 15000 FOLLOWING) AS wv FROM t1) a;
-- result:
1471787164.00000	18588.80423360614	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN 10000 PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
1265817686.00000	18298.50939632242	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 ROWS BETWEEN CURRENT ROW AND 10000 FOLLOWING) AS wv FROM t1) a;
-- result:
1471787164.00000	18588.80423360614	1.00000	38967.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed] PARTITION BY v9 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv FROM t1) a;
-- result:
5852375186.00000	71415.71711329136	3.00000	147164.00000
-- !result
SELECT SUM(wv), AVG(wv), MIN(wv), MAX(wv) FROM (SELECT SUM(v2) OVER([skewed, hash] PARTITION BY v9) AS wv FROM t1) a;
-- result:
14471519104.00000	147164.00000000000	147164.00000	147164.00000
-- !result
