-- name: test_basic_multi_window_function
CREATE TABLE `t0` (
  `v1` int(11) NULL,
  `v2` int(11) NULL,
  `v3` int(11) NOT NULL,
  `v4` int(11) NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
 "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t0` (v1, v2, v3, v4) values
    (1, 1, 1, NULL),
    (1, 1, 2, NULL),
    (1, NULL, 3, NULL),
    (1, NULL, 4, NULL),
    (1, 2, 5, NULL),
    (1, 2, 6, NULL),
    (1, NULL, 7, NULL),
    (1, NULL, 8, NULL),
    (2, 3, 9, NULL),
    (2, 3, 10, NULL),
    (2, NULL, 11, NULL),
    (2, NULL, 12, NULL),
    (2, 4, 13, NULL),
    (2, 4, 14, NULL),
    (2, NULL, 15, NULL),
    (2, NULL, 16, NULL),
    (NULL, 3, 17, NULL),
    (NULL, 3, 18, NULL),
    (NULL, NULL, 19, NULL),
    (NULL, NULL, 20, NULL),
    (NULL, 4, 21, NULL),
    (NULL, 4, 22, NULL),
    (NULL, NULL, 23, NULL),
    (NULL, NULL, 24, NULL);
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
INSERT INTO `t0` (v1, v2, v3, v4) values
    (101, 101, 101, NULL),
    (101, 101, 102, NULL),
    (101, NULL, 103, NULL),
    (101, NULL, 104, NULL),
    (101, 102, 105, NULL),
    (101, 102, 106, NULL),
    (101, NULL, 107, NULL),
    (101, NULL, 108, NULL),
    (102, 103, 109, NULL),
    (102, 103, 110, NULL),
    (102, NULL, 111, NULL),
    (102, NULL, 112, NULL),
    (102, 104, 113, NULL),
    (102, 104, 114, NULL),
    (102, NULL, 115, NULL),
    (102, NULL, 116, NULL),
    (NULL, 103, 117, NULL),
    (NULL, 103, 118, NULL),
    (NULL, NULL, 119, NULL),
    (NULL, NULL, 120, NULL),
    (NULL, 104, 121, NULL),
    (NULL, 104, 122, NULL),
    (NULL, NULL, 123, NULL),
    (NULL, NULL, 124, NULL);
-- result:
-- !result
INSERT INTO `t0` SELECT * FROM `t0`;
-- result:
-- !result
CREATE TABLE `t1` (
  `v1` decimal64(18,5) NULL,
  `v2` decimal64(18,5) NULL,
  `v3` decimal64(18,5) NOT NULL,
  `v4` decimal64(18,5) NULL,
  `v5` decimal64(18,5) NOT NULL,
  `v6` decimal64(18,5) NOT NULL,
  `v7` decimal64(18,5) NOT NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
 "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t1` (v1, v2, v3, v4, v5, v6, v7) 
SELECT v1, v2, v3, v4,
row_number() OVER (ORDER BY v1, v2, v3, v4) as v5,
row_number() OVER (PARTITION BY v1 ORDER BY v2, v3, v4) as v6,
1 as v7
FROM `t0`;
-- result:
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
303170688	12312.0	12312	12312	918081216.00000	37284.00000000000	37284.00000	37284.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
126269736	5127.913255360624	0	12304	364718836.00000	17782.48834714773	3.00000	36456.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
126515932	5137.91146848603	0	12312	365459954.00000	17801.26419873356	3.00000	37284.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
73830	2.9982943469785575	0	6	219354.00000	17.79459722560	1.00000	622.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
135417	5.499390838206628	0	11	408565.00000	33.07415202785	1.00000	840.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
73872	3.0	0	6	223704.00000	18.13277133825	1.00000	622.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v2) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
126392812	5132.91146848603	0	12312	365087114.00000	17791.76968810916	3.00000	37284.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
126392812	5132.91146848603	0	12312	365087114.00000	17791.76968810916	3.00000	37284.00000	None	None	None	None	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
126392812	5132.91146848603	0	12312	365087114.00000	17791.76968810916	3.00000	37284.00000	61560.00000	3.00000000000	3.00000	3.00000	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
100794752	4093.3541260558804	8	4104	292264512.00000	11869.09161793372	812.00000	15164.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
25081947	1018.5975877192982	0	4094	64795922.00000	5282.56334583401	1.00000	14328.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
25327958	1028.5882878492528	0	4104	65527118.00000	5302.40475805146	1.00000	15164.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
73653	2.9911062378167643	0	6	210456.00000	17.12834703345	1.00000	321.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
135357	5.496954191033138	0	11	405387.00000	32.85944719138	1.00000	840.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
73866	2.999756335282651	0	6	223092.00000	18.08902943323	1.00000	622.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
25204844	1023.5885315139701	0	4104	65154890.00000	5291.98261858350	1.00000	15164.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
25204844	1023.5885315139701	0	4104	65154890.00000	5291.98261858350	1.00000	15164.00000	None	None	None	None	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
25204844	1023.5885315139701	0	4104	65154890.00000	5291.98261858350	1.00000	15164.00000	None	None	None	None	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
606341376	24624.0	24624	24624	7697462400.00000	312600.00000000000	312600.00000	312600.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
302936805	12302.501827485381	0	24614	4350068102.00000	176731.45778825059	19.00000	311476.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
303429185	12322.497766406757	11	24624	4356313999.00000	176913.33654158545	209.00000	312600.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
147699	5.998172514619883	0	6	1870555.00000	75.98013729234	6.00000	734.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
270834	10.998781676413255	6	11	3436614.00000	139.56359649123	11.00000	1240.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
147699	5.998172514619883	0	6	1874745.00000	76.15033104513	6.00000	734.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v3) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
303183000	12312.5	1	24624	4353189044.00000	176786.42966211826	19.00000	312600.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
303183000	12312.5	1	24624	4353189044.00000	176786.42966211826	19.00000	312600.00000	467856.00000	19.00000000000	19.00000	19.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
303183000	12312.5	1	24624	4353189044.00000	176786.42966211826	19.00000	312600.00000	467856.00000	19.00000000000	19.00000	19.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
201589504	8186.708252111761	16	8208	2535149952.00000	102954.43274853801	1672.00000	169864.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
100561049	4083.863263482781	0	8198	1255118504.00000	51075.05916822658	3.00000	168864.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
101053029	4103.842958089668	11	8208	1261340771.00000	51224.04040773229	33.00000	169864.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
147519	5.990862573099415	0	6	1859871.00000	75.60758567421	3.00000	734.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
270714	10.993908382066277	6	11	3429474.00000	139.27363547758	11.00000	1240.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
147519	5.990862573099415	0	6	1864315.00000	75.78824342453	6.00000	734.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
100807064	4093.8541260558804	1	8208	1258228532.00000	51097.64993502274	3.00000	169864.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
100807064	4093.8541260558804	1	8208	1258228532.00000	51097.64993502274	3.00000	169864.00000	274064.00000	11.12995451592	3.00000	111.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
100807064	4093.8541260558804	1	8208	1258228532.00000	51097.64993502274	3.00000	169864.00000	274064.00000	11.12995451592	3.00000	111.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v4) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        COUNT(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
0	0.0	0	0	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
74567.99999993904	3.028265107210	3.02826510721	3.02826510721	2560896.00000	104.00000000000	104.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
61954.44021987779	3.020694306186	2.59853658537	3.69493177388	1721388.00000	83.92920526572	3.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
62014.64563352777	3.020684151657	2.59853658537	3.69493177388	1723468.00000	83.94875791525	3.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
37564.96666666667	3.047372975312	1.00000000000	104.00000000000	37825.00000	3.06846759147	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
39084.69163059164	3.163983779697	1.00000000000	104.00000000000	39712.00000	3.21476564397	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
38601.46666666667	3.128918429656	1.00000000000	104.00000000000	38864.00000	3.15019858961	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v2) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
61984.36298245567	3.020680457235	2.59853658537	3.69493177388	1722428.00000	83.93898635478	3.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
61984.36298245567	3.020680457235	2.59853658537	3.69493177388	1722428.00000	83.93898635478	3.00000	104.00000	None	None	None	None	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
61984.36298245567	3.020680457235	2.59853658537	3.69493177388	1722428.00000	83.93898635478	3.00000	104.00000	61560.00000	3.00000000000	3.00000	3.00000	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
74568.00000000704	3.028265107213	1.50000000000	103.50000000000	906080.00000	36.79662118259	2.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
30501.06475653231	2.486634987488	1.00000000000	3.49975574011	34748.00000	2.83287135170	1.00000	4.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
33950.80249932811	2.747273223768	1.00000000000	103.50000000000	40036.00000	3.23968279657	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
35501.50000000000	2.889354602425	1.00000000000	103.00000000000	35707.00000	2.90607959632	1.00000	103.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
38335.09163059164	3.107326872870	1.00000000000	103.66666666667	38864.00000	3.15019858961	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
38193.46666666667	3.096851266250	1.00000000000	104.00000000000	38456.00000	3.11813832806	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
32221.85318158931	2.617109582650	1.00000000000	103.50000000000	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
32221.85318158931	2.617109582650	1.00000000000	103.50000000000	37284.00000	3.02826510721	1.00000	104.00000	None	None	None	None	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v2 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
32221.85318158931	2.617109582650	1.00000000000	103.50000000000	37284.00000	3.02826510721	1.00000	104.00000	None	None	None	None	37284.00000	3.02826510721	1.00000	104.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
312600.00000002112	12.694931773880	12.69493177388	12.69493177388	3053376.00000	124.00000000000	124.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
398323.44675157993	16.182800306800	12.48265394623	21.69493177388	2632276.00000	106.94222800033	19.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
398387.16313074369	16.178815916616	12.48265394623	21.69493177388	2634566.00000	106.99179662118	19.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
311806.66666666669	12.665285619508	1.00000000000	122.33333333333	313285.00000	12.72533409156	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
312598.09047619046	12.694854226616	1.00000000000	112.72727272727	315551.00000	12.81477420403	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
312741.96666666670	12.703276602082	1.00000000000	122.33333333333	314238.00000	12.76404403103	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v3) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
398450.21381300489	16.181376454394	12.48265394623	21.69493177388	2633516.00000	106.94915529565	19.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
398450.21381300489	16.181376454394	12.48265394623	21.69493177388	2633516.00000	106.94915529565	19.00000	124.00000	467856.00000	19.00000000000	19.00000	19.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
398450.21381300489	16.181376454394	12.48265394623	21.69493177388	2633516.00000	106.94915529565	19.00000	124.00000	467856.00000	19.00000000000	19.00000	19.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
312600.00000000704	12.694931773879	4.50000000000	112.50000000000	1217984.00000	49.46328784925	8.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
301658.06203020793	12.275496949223	3.00000000000	112.66666666667	773884.00000	31.49198339709	3.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
304259.90313733666	12.356233883095	3.00000000000	112.50000000000	778794.00000	31.62743664717	3.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
310597.06666666666	12.626410287681	1.00000000000	122.33333333333	311453.00000	12.66120574007	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
312594.17532467530	12.694695229235	1.00000000000	120.33333333333	314453.00000	12.77018356075	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
311622.56666666671	12.668098974213	1.00000000000	122.33333333333	312543.00000	12.70551648441	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
304206.83953388358	12.354078928439	3.00000000000	113.50000000000	777604.00000	31.57910981157	3.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
304206.83953388358	12.354078928439	3.00000000000	113.50000000000	777604.00000	31.57910981157	3.00000	124.00000	274064.00000	11.12995451592	3.00000	111.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v3 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v3 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
304206.83953388358	12.354078928439	3.00000000000	113.50000000000	777604.00000	31.57910981157	3.00000	124.00000	274064.00000	11.12995451592	3.00000	111.00000	312600.00000	12.69493177388	1.00000	124.00000
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v4) OVER(ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4 IGNORE NULLS) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 10 PRECEDING AND 5 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 PRECEDING AND 5 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN 5 FOLLOWING AND 10 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2),
    SUM(wv3), AVG(wv3), MIN(wv3), MAX(wv3),
    SUM(wv4), AVG(wv4), MIN(wv4), MAX(wv4)
FROM (
    SELECT
        AVG(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv1,
        MAX(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv2,
        FIRST_VALUE(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv3,
        LAST_VALUE(v4 IGNORE NULLS) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS wv4
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v2, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
37284.00000	3.02826510721	1.00000	104.00000	365198966.00000	17794.61901281489	3.00000	37284.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v2 IGNORE NULLS, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
67603.00000	2.74574550181	1.00000	104.00000	365198966.00000	17794.61901281489	3.00000	37284.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v2, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
36972.00000	3.00365586156	1.00000	104.00000	364975574.00000	17788.93473704733	3.00000	36972.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v2 IGNORE NULLS, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v2) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
471996.00000	23.00511770727	1.00000	104.00000	364975574.00000	17788.93473704733	3.00000	36972.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v2, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
37284.00000	3.02826510721	1.00000	104.00000	65266742.00000	5294.61685730510	1.00000	15164.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v2 IGNORE NULLS, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
66979.00000	2.72172782315	1.00000	104.00000	65266742.00000	5294.61685730510	1.00000	15164.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v2, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
36336.00000	2.95486704074	1.00000	104.00000	65043986.00000	5289.41904529560	1.00000	14852.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v2 IGNORE NULLS, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v2) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
36336.00000	2.95486704074	1.00000	104.00000	65043986.00000	5289.41904529560	1.00000	14852.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v3, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
312543.00000	12.69416351895	1.00000	124.00000	4354126730.00000	176824.50982781027	76.00000	312600.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v3 IGNORE NULLS, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
312543.00000	12.69416351895	1.00000	124.00000	4354126730.00000	176824.50982781027	76.00000	312600.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v3, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
312259.00000	12.68262865034	1.00000	124.00000	4352251586.00000	176769.89504894196	19.00000	312259.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v3 IGNORE NULLS, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v3) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
312259.00000	12.68262865034	1.00000	124.00000	4352251586.00000	176769.89504894196	19.00000	312259.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v3, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
311857.00000	12.67247754886	1.00000	124.00000	1259164848.00000	51135.67446393762	12.00000	169864.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v3 IGNORE NULLS, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
311857.00000	12.67247754886	1.00000	124.00000	1259164848.00000	51135.67446393762	12.00000	169864.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v3, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
311517.00000	12.65866146532	1.00000	124.00000	1257291818.00000	51090.73176480150	3.00000	169499.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v3 IGNORE NULLS, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v3) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
311517.00000	12.65866146532	1.00000	124.00000	1257291818.00000	51090.73176480150	3.00000	169499.00000
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v4, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v4 IGNORE NULLS, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v4, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v4 IGNORE NULLS, 3) OVER(ORDER BY v5) AS wv1,
        SUM(v4) OVER(ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v4, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LEAD(v4 IGNORE NULLS, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 FOLLOWING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v4, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result
SELECT 
    SUM(wv1), AVG(wv1), MIN(wv1), MAX(wv1),
    SUM(wv2), AVG(wv2), MIN(wv2), MAX(wv2)
FROM (
    SELECT
        LAG(v4 IGNORE NULLS, 3) OVER(PARTITION BY v1 ORDER BY v5) AS wv1,
        SUM(v4) OVER(PARTITION BY v1 ORDER BY v5 ROWS BETWEEN UNBOUNDED PRECEDING AND 3 PRECEDING) AS wv2
    FROM t1
) a;
-- result:
None	None	None	None	None	None	None	None
-- !result