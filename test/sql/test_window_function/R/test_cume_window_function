-- name: test_cume_window_function
DROP TABLE IF EXISTS `cume_test`;
-- result:
-- !result
CREATE TABLE IF NOT EXISTS `cume_test` (
  k1 INT,
  k2 INT,
  v1 INT SUM,
  v2 DOUBLE MAX,
  v3 DATE MIN,
  v4 VARCHAR(20) REPLACE
)
ENGINE = olap
AGGREGATE KEY(k1, k2)
DISTRIBUTED BY HASH(`k1`)
PROPERTIES(
  "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `cume_test` (k1, k2, v1, v2, v3, v4)
VALUES (1, 10, 15, 2.5, '2023-01-01', 'apple'),
       (1, 2, 15, 2.5, '2023-01-02', 'banana'),
       (1, 8, 15, 3.5, '2023-01-03', 'cherry'),
       (1, 7, 20, 3.5, '2023-01-04', 'date'),
       (2, 6, 20, 3.5, '2023-01-05', 'fig'),
       (2, 5, 20, 4.5, '2023-01-06', 'grape'),
       (2, 4, 20, 5.5, '2023-01-07', 'honeydew'),
       (3, 3, 20, 5.5, '2023-01-08', 'kiwi'),
       (3, 2, 20, 5.5, '2023-01-09', 'lemon'),
       (4, 2, 25, 5.5, '2023-01-10', 'mango'),
       (4, 10, 30, 5.5, '2023-01-11', 'nectarine'),
       (4, 9, 30, 5.5, '2023-01-12', 'orange'),
       (4, 8, 35, 6.5, '2023-01-13', 'papaya'),
       (4, 7, 35, 6.5, '2023-01-14', 'pineapple'),
       (4, 6, 35, 7.5, '2023-01-15', 'quince'),
       (4, 5, 35, 7.5, '2023-01-16', 'raspberry'),
       (5, 4, 35, 8.5, '2023-01-17', 'strawberry'),
       (5, 3, 40, 8.5, '2023-01-18', 'tangerine'),
       (5, 2, 40, 8.5, '2023-01-19', 'ugli fruit'),
       (5, 1, 40, 8.5, '2023-01-20', 'vanilla'),
       (5, 10, 45, 9.5, '2023-01-21', 'watermelon'),
       (6, 9, 45, 10.5, '2023-01-22', 'xigua'),
       (6, 8, 50, 11.5, '2023-01-23', 'yumberry'),
       (6, 7, 50, 12.5, '2023-01-24', 'zucchini'),
       (6, 6, 55, 13.5, '2023-01-25', 'acerola'),
       (6, 5, 60, 13.5, '2023-01-26', 'bilberry'),
       (7, 4, 60, 13.5, '2023-01-27', 'cloudberry'),
       (7, 3, 60, 14.5, '2023-01-28', 'dewberry'),
       (8, 2, null, 2.5, '2023-01-29', null),
       (8, 8, 15, 3.5, '2023-01-30', null),
       (8, 7, null, 3.5, '2023-01-31', 'date'),
       (8, 6, null, null, '2023-02-01', 'fig'),
       (9, 5, 20, 4.5, '2023-02-02', 'grape'),
       (9, 4, 20, 5.5, '2023-02-07', null),
       (10, 3, 20, null, null, 'kiwi'),
       (10, 2, 20, 5.5, '2023-02-09', 'lemon'),
       (10, 2, 25, 5.5, '2023-02-10', null),
       (11, 10, null, 5.5, null, null),
       (11, 9, 30, 5.5, '2023-02-12', 'orange'),
       (12, 8, 35, 6.5, '2023-02-13', null),
       (13, 7, 35, 6.5, '2023-02-14', 'pineapple'),
       (13, 6, null, 7.5, '2023-02-15', 'quince'),
       (13, 5, 35, 7.5, '2023-02-16', null),
       (13, 4, 35, 8.5, null, null),
       (13, 3, 40, 8.5, '2023-02-18', 'tangerine'),
       (14, 2, 40, null, '2023-02-19', 'ugli fruit'),
       (14, 1, 40, null, '2023-02-20', 'vanilla'),
       (14, 10, 45, 9.5, '2023-02-21', 'watermelon'),
       (15, 9, 45, 10.5, null, 'xigua'),
       (16, 8, 50, 11.5, null, null),
       (16, 7, 50, 12.5, '2023-02-24', null),
       (16, 6, 55, 13.5, '2023-02-25', 'acerola'),
       (16, 5, null, 13.5, '2023-02-26', 'bilberry'),
       (17, 4, 60, 13.5, null, 'cloudberry'),
       (17, 3, 60, 14.5, '2023-02-28', 'dewberry');
-- result:
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1 FROM cume_test;
-- result:
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111
13	6	None	7.5	2023-02-15	quince	0.1111111111111111
11	10	None	5.5	None	None	0.1111111111111111
8	7	None	3.5	2023-01-31	date	0.1111111111111111
8	6	None	None	2023-02-01	fig	0.1111111111111111
8	2	None	2.5	2023-01-29	None	0.1111111111111111
1	2	15	2.5	2023-01-02	banana	0.18518518518518517
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517
8	8	15	3.5	2023-01-30	None	0.18518518518518517
1	10	15	2.5	2023-01-01	apple	0.18518518518518517
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186
9	4	20	5.5	2023-02-07	None	0.35185185185185186
9	5	20	4.5	2023-02-02	grape	0.35185185185185186
10	3	20	None	None	kiwi	0.35185185185185186
2	5	20	4.5	2023-01-06	grape	0.35185185185185186
1	7	20	3.5	2023-01-04	date	0.35185185185185186
2	6	20	3.5	2023-01-05	fig	0.35185185185185186
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186
4	2	25	5.5	2023-01-10	mango	0.37037037037037035
11	9	30	5.5	2023-02-12	orange	0.42592592592592593
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593
4	9	30	5.5	2023-01-12	orange	0.42592592592592593
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926
12	8	35	6.5	2023-02-13	None	0.5925925925925926
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926
13	4	35	8.5	None	None	0.5925925925925926
13	5	35	7.5	2023-02-16	None	0.5925925925925926
4	6	35	7.5	2023-01-15	quince	0.5925925925925926
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037
14	1	40	None	2023-02-20	vanilla	0.7037037037037037
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963
10	2	45	5.5	2023-02-09	None	0.7962962962962963
15	9	45	10.5	None	xigua	0.7962962962962963
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703
16	7	50	12.5	2023-02-24	None	0.8703703703703703
16	8	50	11.5	None	None	0.8703703703703703
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074
6	5	60	13.5	2023-01-26	bilberry	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
17	4	60	13.5	None	cloudberry	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2 DESC) AS cume_dist_v2 FROM cume_test;
-- result:
17	3	60	14.5	2023-02-28	dewberry	0.037037037037037035
7	3	60	14.5	2023-01-28	dewberry	0.037037037037037035
6	5	60	13.5	2023-01-26	bilberry	0.14814814814814814
6	6	55	13.5	2023-01-25	acerola	0.14814814814814814
17	4	60	13.5	None	cloudberry	0.14814814814814814
16	5	None	13.5	2023-02-26	bilberry	0.14814814814814814
7	4	60	13.5	2023-01-27	cloudberry	0.14814814814814814
16	6	55	13.5	2023-02-25	acerola	0.14814814814814814
6	7	50	12.5	2023-01-24	zucchini	0.18518518518518517
16	7	50	12.5	2023-02-24	None	0.18518518518518517
6	8	50	11.5	2023-01-23	yumberry	0.2222222222222222
16	8	50	11.5	None	None	0.2222222222222222
6	9	45	10.5	2023-01-22	xigua	0.25925925925925924
15	9	45	10.5	None	xigua	0.25925925925925924
5	10	45	9.5	2023-01-21	watermelon	0.2962962962962963
14	10	45	9.5	2023-02-21	watermelon	0.2962962962962963
5	1	40	8.5	2023-01-20	vanilla	0.4074074074074074
5	2	40	8.5	2023-01-19	ugli fruit	0.4074074074074074
5	3	40	8.5	2023-01-18	tangerine	0.4074074074074074
5	4	35	8.5	2023-01-17	strawberry	0.4074074074074074
13	4	35	8.5	None	None	0.4074074074074074
13	3	40	8.5	2023-02-18	tangerine	0.4074074074074074
13	5	35	7.5	2023-02-16	None	0.48148148148148145
4	6	35	7.5	2023-01-15	quince	0.48148148148148145
4	5	35	7.5	2023-01-16	raspberry	0.48148148148148145
13	6	None	7.5	2023-02-15	quince	0.48148148148148145
12	8	35	6.5	2023-02-13	None	0.5555555555555556
4	7	35	6.5	2023-01-14	pineapple	0.5555555555555556
4	8	35	6.5	2023-01-13	papaya	0.5555555555555556
13	7	35	6.5	2023-02-14	pineapple	0.5555555555555556
3	2	20	5.5	2023-01-09	lemon	0.7407407407407407
3	3	20	5.5	2023-01-08	kiwi	0.7407407407407407
9	4	20	5.5	2023-02-07	None	0.7407407407407407
10	2	45	5.5	2023-02-09	None	0.7407407407407407
4	9	30	5.5	2023-01-12	orange	0.7407407407407407
4	10	30	5.5	2023-01-11	nectarine	0.7407407407407407
11	9	30	5.5	2023-02-12	orange	0.7407407407407407
11	10	None	5.5	None	None	0.7407407407407407
4	2	25	5.5	2023-01-10	mango	0.7407407407407407
2	4	20	5.5	2023-01-07	honeydew	0.7407407407407407
9	5	20	4.5	2023-02-02	grape	0.7777777777777778
2	5	20	4.5	2023-01-06	grape	0.7777777777777778
1	7	20	3.5	2023-01-04	date	0.8703703703703703
1	8	15	3.5	2023-01-03	cherry	0.8703703703703703
8	7	None	3.5	2023-01-31	date	0.8703703703703703
8	8	15	3.5	2023-01-30	None	0.8703703703703703
2	6	20	3.5	2023-01-05	fig	0.8703703703703703
1	2	15	2.5	2023-01-02	banana	0.9259259259259259
1	10	15	2.5	2023-01-01	apple	0.9259259259259259
8	2	None	2.5	2023-01-29	None	0.9259259259259259
10	3	20	None	None	kiwi	1.0
14	2	40	None	2023-02-19	ugli fruit	1.0
14	1	40	None	2023-02-20	vanilla	1.0
8	6	None	None	2023-02-01	fig	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3 FROM cume_test;
-- result:
16	8	50	11.5	None	None	0.1111111111111111
13	4	35	8.5	None	None	0.1111111111111111
11	10	None	5.5	None	None	0.1111111111111111
17	4	60	13.5	None	cloudberry	0.1111111111111111
15	9	45	10.5	None	xigua	0.1111111111111111
10	3	20	None	None	kiwi	0.1111111111111111
1	10	15	2.5	2023-01-01	apple	0.12962962962962962
1	2	15	2.5	2023-01-02	banana	0.14814814814814814
1	8	15	3.5	2023-01-03	cherry	0.16666666666666666
1	7	20	3.5	2023-01-04	date	0.18518518518518517
2	6	20	3.5	2023-01-05	fig	0.2037037037037037
2	5	20	4.5	2023-01-06	grape	0.2222222222222222
2	4	20	5.5	2023-01-07	honeydew	0.24074074074074073
3	3	20	5.5	2023-01-08	kiwi	0.25925925925925924
3	2	20	5.5	2023-01-09	lemon	0.2777777777777778
4	2	25	5.5	2023-01-10	mango	0.2962962962962963
4	10	30	5.5	2023-01-11	nectarine	0.3148148148148148
4	9	30	5.5	2023-01-12	orange	0.3333333333333333
4	8	35	6.5	2023-01-13	papaya	0.35185185185185186
4	7	35	6.5	2023-01-14	pineapple	0.37037037037037035
4	6	35	7.5	2023-01-15	quince	0.3888888888888889
4	5	35	7.5	2023-01-16	raspberry	0.4074074074074074
5	4	35	8.5	2023-01-17	strawberry	0.42592592592592593
5	3	40	8.5	2023-01-18	tangerine	0.4444444444444444
5	2	40	8.5	2023-01-19	ugli fruit	0.46296296296296297
5	1	40	8.5	2023-01-20	vanilla	0.48148148148148145
5	10	45	9.5	2023-01-21	watermelon	0.5
6	9	45	10.5	2023-01-22	xigua	0.5185185185185185
6	8	50	11.5	2023-01-23	yumberry	0.5370370370370371
6	7	50	12.5	2023-01-24	zucchini	0.5555555555555556
6	6	55	13.5	2023-01-25	acerola	0.5740740740740741
6	5	60	13.5	2023-01-26	bilberry	0.5925925925925926
7	4	60	13.5	2023-01-27	cloudberry	0.6111111111111112
7	3	60	14.5	2023-01-28	dewberry	0.6296296296296297
8	2	None	2.5	2023-01-29	None	0.6481481481481481
8	8	15	3.5	2023-01-30	None	0.6666666666666666
8	7	None	3.5	2023-01-31	date	0.6851851851851852
8	6	None	None	2023-02-01	fig	0.7037037037037037
9	5	20	4.5	2023-02-02	grape	0.7222222222222222
9	4	20	5.5	2023-02-07	None	0.7407407407407407
10	2	45	5.5	2023-02-09	None	0.7592592592592593
11	9	30	5.5	2023-02-12	orange	0.7777777777777778
12	8	35	6.5	2023-02-13	None	0.7962962962962963
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148
13	6	None	7.5	2023-02-15	quince	0.8333333333333334
13	5	35	7.5	2023-02-16	None	0.8518518518518519
13	3	40	8.5	2023-02-18	tangerine	0.8703703703703703
14	2	40	None	2023-02-19	ugli fruit	0.8888888888888888
14	1	40	None	2023-02-20	vanilla	0.9074074074074074
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259
16	7	50	12.5	2023-02-24	None	0.9444444444444444
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629
16	5	None	13.5	2023-02-26	bilberry	0.9814814814814815
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4 FROM cume_test;
-- result:
12	8	35	6.5	2023-02-13	None	0.18518518518518517
10	2	45	5.5	2023-02-09	None	0.18518518518518517
9	4	20	5.5	2023-02-07	None	0.18518518518518517
16	8	50	11.5	None	None	0.18518518518518517
16	7	50	12.5	2023-02-24	None	0.18518518518518517
13	5	35	7.5	2023-02-16	None	0.18518518518518517
13	4	35	8.5	None	None	0.18518518518518517
11	10	None	5.5	None	None	0.18518518518518517
8	8	15	3.5	2023-01-30	None	0.18518518518518517
8	2	None	2.5	2023-01-29	None	0.18518518518518517
6	6	55	13.5	2023-01-25	acerola	0.2222222222222222
16	6	55	13.5	2023-02-25	acerola	0.2222222222222222
1	10	15	2.5	2023-01-01	apple	0.24074074074074073
1	2	15	2.5	2023-01-02	banana	0.25925925925925924
6	5	60	13.5	2023-01-26	bilberry	0.2962962962962963
16	5	None	13.5	2023-02-26	bilberry	0.2962962962962963
1	8	15	3.5	2023-01-03	cherry	0.3148148148148148
17	4	60	13.5	None	cloudberry	0.35185185185185186
7	4	60	13.5	2023-01-27	cloudberry	0.35185185185185186
1	7	20	3.5	2023-01-04	date	0.3888888888888889
8	7	None	3.5	2023-01-31	date	0.3888888888888889
17	3	60	14.5	2023-02-28	dewberry	0.42592592592592593
7	3	60	14.5	2023-01-28	dewberry	0.42592592592592593
2	6	20	3.5	2023-01-05	fig	0.46296296296296297
8	6	None	None	2023-02-01	fig	0.46296296296296297
9	5	20	4.5	2023-02-02	grape	0.5
2	5	20	4.5	2023-01-06	grape	0.5
2	4	20	5.5	2023-01-07	honeydew	0.5185185185185185
3	3	20	5.5	2023-01-08	kiwi	0.5555555555555556
10	3	20	None	None	kiwi	0.5555555555555556
3	2	20	5.5	2023-01-09	lemon	0.5740740740740741
4	2	25	5.5	2023-01-10	mango	0.5925925925925926
4	10	30	5.5	2023-01-11	nectarine	0.6111111111111112
4	9	30	5.5	2023-01-12	orange	0.6481481481481481
11	9	30	5.5	2023-02-12	orange	0.6481481481481481
4	8	35	6.5	2023-01-13	papaya	0.6666666666666666
13	7	35	6.5	2023-02-14	pineapple	0.7037037037037037
4	7	35	6.5	2023-01-14	pineapple	0.7037037037037037
13	6	None	7.5	2023-02-15	quince	0.7407407407407407
4	6	35	7.5	2023-01-15	quince	0.7407407407407407
4	5	35	7.5	2023-01-16	raspberry	0.7592592592592593
5	4	35	8.5	2023-01-17	strawberry	0.7777777777777778
5	3	40	8.5	2023-01-18	tangerine	0.8148148148148148
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148
5	2	40	8.5	2023-01-19	ugli fruit	0.8518518518518519
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519
5	1	40	8.5	2023-01-20	vanilla	0.8888888888888888
14	1	40	None	2023-02-20	vanilla	0.8888888888888888
5	10	45	9.5	2023-01-21	watermelon	0.9259259259259259
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259
6	9	45	10.5	2023-01-22	xigua	0.9629629629629629
15	9	45	10.5	None	xigua	0.9629629629629629
6	8	50	11.5	2023-01-23	yumberry	0.9814814814814815
6	7	50	12.5	2023-01-24	zucchini	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v1) AS percent_rank_v1 FROM cume_test;
-- result:
16	5	None	13.5	2023-02-26	bilberry	0.0
13	6	None	7.5	2023-02-15	quince	0.0
11	10	None	5.5	None	None	0.0
8	7	None	3.5	2023-01-31	date	0.0
8	6	None	None	2023-02-01	fig	0.0
8	2	None	2.5	2023-01-29	None	0.0
1	2	15	2.5	2023-01-02	banana	0.11320754716981132
1	8	15	3.5	2023-01-03	cherry	0.11320754716981132
8	8	15	3.5	2023-01-30	None	0.11320754716981132
1	10	15	2.5	2023-01-01	apple	0.11320754716981132
3	2	20	5.5	2023-01-09	lemon	0.18867924528301888
3	3	20	5.5	2023-01-08	kiwi	0.18867924528301888
9	4	20	5.5	2023-02-07	None	0.18867924528301888
9	5	20	4.5	2023-02-02	grape	0.18867924528301888
10	3	20	None	None	kiwi	0.18867924528301888
2	5	20	4.5	2023-01-06	grape	0.18867924528301888
1	7	20	3.5	2023-01-04	date	0.18867924528301888
2	6	20	3.5	2023-01-05	fig	0.18867924528301888
2	4	20	5.5	2023-01-07	honeydew	0.18867924528301888
4	2	25	5.5	2023-01-10	mango	0.3584905660377358
11	9	30	5.5	2023-02-12	orange	0.37735849056603776
4	10	30	5.5	2023-01-11	nectarine	0.37735849056603776
4	9	30	5.5	2023-01-12	orange	0.37735849056603776
5	4	35	8.5	2023-01-17	strawberry	0.4339622641509434
12	8	35	6.5	2023-02-13	None	0.4339622641509434
4	8	35	6.5	2023-01-13	papaya	0.4339622641509434
4	7	35	6.5	2023-01-14	pineapple	0.4339622641509434
13	4	35	8.5	None	None	0.4339622641509434
13	5	35	7.5	2023-02-16	None	0.4339622641509434
4	6	35	7.5	2023-01-15	quince	0.4339622641509434
13	7	35	6.5	2023-02-14	pineapple	0.4339622641509434
4	5	35	7.5	2023-01-16	raspberry	0.4339622641509434
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604
14	1	40	None	2023-02-20	vanilla	0.6037735849056604
14	2	40	None	2023-02-19	ugli fruit	0.6037735849056604
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716
6	9	45	10.5	2023-01-22	xigua	0.7169811320754716
10	2	45	5.5	2023-02-09	None	0.7169811320754716
15	9	45	10.5	None	xigua	0.7169811320754716
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716
6	7	50	12.5	2023-01-24	zucchini	0.8113207547169812
6	8	50	11.5	2023-01-23	yumberry	0.8113207547169812
16	7	50	12.5	2023-02-24	None	0.8113207547169812
16	8	50	11.5	None	None	0.8113207547169812
6	6	55	13.5	2023-01-25	acerola	0.8867924528301887
16	6	55	13.5	2023-02-25	acerola	0.8867924528301887
6	5	60	13.5	2023-01-26	bilberry	0.9245283018867925
17	3	60	14.5	2023-02-28	dewberry	0.9245283018867925
17	4	60	13.5	None	cloudberry	0.9245283018867925
7	4	60	13.5	2023-01-27	cloudberry	0.9245283018867925
7	3	60	14.5	2023-01-28	dewberry	0.9245283018867925
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v2) AS percent_rank_v2 FROM cume_test;
-- result:
10	3	20	None	None	kiwi	0.0
14	2	40	None	2023-02-19	ugli fruit	0.0
14	1	40	None	2023-02-20	vanilla	0.0
8	6	None	None	2023-02-01	fig	0.0
8	2	None	2.5	2023-01-29	None	0.07547169811320754
1	2	15	2.5	2023-01-02	banana	0.07547169811320754
1	10	15	2.5	2023-01-01	apple	0.07547169811320754
8	7	None	3.5	2023-01-31	date	0.1320754716981132
2	6	20	3.5	2023-01-05	fig	0.1320754716981132
1	7	20	3.5	2023-01-04	date	0.1320754716981132
8	8	15	3.5	2023-01-30	None	0.1320754716981132
1	8	15	3.5	2023-01-03	cherry	0.1320754716981132
9	5	20	4.5	2023-02-02	grape	0.22641509433962265
2	5	20	4.5	2023-01-06	grape	0.22641509433962265
3	3	20	5.5	2023-01-08	kiwi	0.2641509433962264
9	4	20	5.5	2023-02-07	None	0.2641509433962264
10	2	45	5.5	2023-02-09	None	0.2641509433962264
3	2	20	5.5	2023-01-09	lemon	0.2641509433962264
4	2	25	5.5	2023-01-10	mango	0.2641509433962264
4	10	30	5.5	2023-01-11	nectarine	0.2641509433962264
4	9	30	5.5	2023-01-12	orange	0.2641509433962264
11	9	30	5.5	2023-02-12	orange	0.2641509433962264
11	10	None	5.5	None	None	0.2641509433962264
2	4	20	5.5	2023-01-07	honeydew	0.2641509433962264
12	8	35	6.5	2023-02-13	None	0.4528301886792453
4	8	35	6.5	2023-01-13	papaya	0.4528301886792453
4	7	35	6.5	2023-01-14	pineapple	0.4528301886792453
13	7	35	6.5	2023-02-14	pineapple	0.4528301886792453
4	6	35	7.5	2023-01-15	quince	0.5283018867924528
13	5	35	7.5	2023-02-16	None	0.5283018867924528
13	6	None	7.5	2023-02-15	quince	0.5283018867924528
4	5	35	7.5	2023-01-16	raspberry	0.5283018867924528
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604
5	4	35	8.5	2023-01-17	strawberry	0.6037735849056604
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604
13	4	35	8.5	None	None	0.6037735849056604
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716
6	9	45	10.5	2023-01-22	xigua	0.7547169811320755
15	9	45	10.5	None	xigua	0.7547169811320755
6	8	50	11.5	2023-01-23	yumberry	0.7924528301886793
16	8	50	11.5	None	None	0.7924528301886793
6	7	50	12.5	2023-01-24	zucchini	0.8301886792452831
16	7	50	12.5	2023-02-24	None	0.8301886792452831
6	5	60	13.5	2023-01-26	bilberry	0.8679245283018868
6	6	55	13.5	2023-01-25	acerola	0.8679245283018868
17	4	60	13.5	None	cloudberry	0.8679245283018868
7	4	60	13.5	2023-01-27	cloudberry	0.8679245283018868
16	5	None	13.5	2023-02-26	bilberry	0.8679245283018868
16	6	55	13.5	2023-02-25	acerola	0.8679245283018868
17	3	60	14.5	2023-02-28	dewberry	0.9811320754716981
7	3	60	14.5	2023-01-28	dewberry	0.9811320754716981
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v3 DESC) AS percent_rank_v3 FROM cume_test;
-- result:
17	3	60	14.5	2023-02-28	dewberry	0.0
16	5	None	13.5	2023-02-26	bilberry	0.018867924528301886
16	6	55	13.5	2023-02-25	acerola	0.03773584905660377
16	7	50	12.5	2023-02-24	None	0.05660377358490566
14	10	45	9.5	2023-02-21	watermelon	0.07547169811320754
14	1	40	None	2023-02-20	vanilla	0.09433962264150944
14	2	40	None	2023-02-19	ugli fruit	0.11320754716981132
13	3	40	8.5	2023-02-18	tangerine	0.1320754716981132
13	5	35	7.5	2023-02-16	None	0.1509433962264151
13	6	None	7.5	2023-02-15	quince	0.16981132075471697
13	7	35	6.5	2023-02-14	pineapple	0.18867924528301888
12	8	35	6.5	2023-02-13	None	0.20754716981132076
11	9	30	5.5	2023-02-12	orange	0.22641509433962265
10	2	45	5.5	2023-02-09	None	0.24528301886792453
9	4	20	5.5	2023-02-07	None	0.2641509433962264
9	5	20	4.5	2023-02-02	grape	0.2830188679245283
8	6	None	None	2023-02-01	fig	0.3018867924528302
8	7	None	3.5	2023-01-31	date	0.32075471698113206
8	8	15	3.5	2023-01-30	None	0.33962264150943394
8	2	None	2.5	2023-01-29	None	0.3584905660377358
7	3	60	14.5	2023-01-28	dewberry	0.37735849056603776
7	4	60	13.5	2023-01-27	cloudberry	0.39622641509433965
6	5	60	13.5	2023-01-26	bilberry	0.41509433962264153
6	6	55	13.5	2023-01-25	acerola	0.4339622641509434
6	7	50	12.5	2023-01-24	zucchini	0.4528301886792453
6	8	50	11.5	2023-01-23	yumberry	0.4716981132075472
6	9	45	10.5	2023-01-22	xigua	0.49056603773584906
5	10	45	9.5	2023-01-21	watermelon	0.5094339622641509
5	1	40	8.5	2023-01-20	vanilla	0.5283018867924528
5	2	40	8.5	2023-01-19	ugli fruit	0.5471698113207547
5	3	40	8.5	2023-01-18	tangerine	0.5660377358490566
5	4	35	8.5	2023-01-17	strawberry	0.5849056603773585
4	5	35	7.5	2023-01-16	raspberry	0.6037735849056604
4	6	35	7.5	2023-01-15	quince	0.6226415094339622
4	7	35	6.5	2023-01-14	pineapple	0.6415094339622641
4	8	35	6.5	2023-01-13	papaya	0.660377358490566
4	9	30	5.5	2023-01-12	orange	0.6792452830188679
4	10	30	5.5	2023-01-11	nectarine	0.6981132075471698
4	2	25	5.5	2023-01-10	mango	0.7169811320754716
3	2	20	5.5	2023-01-09	lemon	0.7358490566037735
3	3	20	5.5	2023-01-08	kiwi	0.7547169811320755
2	4	20	5.5	2023-01-07	honeydew	0.7735849056603774
2	5	20	4.5	2023-01-06	grape	0.7924528301886793
2	6	20	3.5	2023-01-05	fig	0.8113207547169812
1	7	20	3.5	2023-01-04	date	0.8301886792452831
1	8	15	3.5	2023-01-03	cherry	0.8490566037735849
1	2	15	2.5	2023-01-02	banana	0.8679245283018868
1	10	15	2.5	2023-01-01	apple	0.8867924528301887
13	4	35	8.5	None	None	0.9056603773584906
11	10	None	5.5	None	None	0.9056603773584906
16	8	50	11.5	None	None	0.9056603773584906
15	9	45	10.5	None	xigua	0.9056603773584906
10	3	20	None	None	kiwi	0.9056603773584906
17	4	60	13.5	None	cloudberry	0.9056603773584906
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v4) AS percent_rank_v4 FROM cume_test;
-- result:
12	8	35	6.5	2023-02-13	None	0.0
10	2	45	5.5	2023-02-09	None	0.0
9	4	20	5.5	2023-02-07	None	0.0
16	8	50	11.5	None	None	0.0
16	7	50	12.5	2023-02-24	None	0.0
13	5	35	7.5	2023-02-16	None	0.0
13	4	35	8.5	None	None	0.0
11	10	None	5.5	None	None	0.0
8	8	15	3.5	2023-01-30	None	0.0
8	2	None	2.5	2023-01-29	None	0.0
6	6	55	13.5	2023-01-25	acerola	0.18867924528301888
16	6	55	13.5	2023-02-25	acerola	0.18867924528301888
1	10	15	2.5	2023-01-01	apple	0.22641509433962265
1	2	15	2.5	2023-01-02	banana	0.24528301886792453
6	5	60	13.5	2023-01-26	bilberry	0.2641509433962264
16	5	None	13.5	2023-02-26	bilberry	0.2641509433962264
1	8	15	3.5	2023-01-03	cherry	0.3018867924528302
17	4	60	13.5	None	cloudberry	0.32075471698113206
7	4	60	13.5	2023-01-27	cloudberry	0.32075471698113206
1	7	20	3.5	2023-01-04	date	0.3584905660377358
8	7	None	3.5	2023-01-31	date	0.3584905660377358
17	3	60	14.5	2023-02-28	dewberry	0.39622641509433965
7	3	60	14.5	2023-01-28	dewberry	0.39622641509433965
2	6	20	3.5	2023-01-05	fig	0.4339622641509434
8	6	None	None	2023-02-01	fig	0.4339622641509434
9	5	20	4.5	2023-02-02	grape	0.4716981132075472
2	5	20	4.5	2023-01-06	grape	0.4716981132075472
2	4	20	5.5	2023-01-07	honeydew	0.5094339622641509
3	3	20	5.5	2023-01-08	kiwi	0.5283018867924528
10	3	20	None	None	kiwi	0.5283018867924528
3	2	20	5.5	2023-01-09	lemon	0.5660377358490566
4	2	25	5.5	2023-01-10	mango	0.5849056603773585
4	10	30	5.5	2023-01-11	nectarine	0.6037735849056604
4	9	30	5.5	2023-01-12	orange	0.6226415094339622
11	9	30	5.5	2023-02-12	orange	0.6226415094339622
4	8	35	6.5	2023-01-13	papaya	0.660377358490566
13	7	35	6.5	2023-02-14	pineapple	0.6792452830188679
4	7	35	6.5	2023-01-14	pineapple	0.6792452830188679
13	6	None	7.5	2023-02-15	quince	0.7169811320754716
4	6	35	7.5	2023-01-15	quince	0.7169811320754716
4	5	35	7.5	2023-01-16	raspberry	0.7547169811320755
5	4	35	8.5	2023-01-17	strawberry	0.7735849056603774
5	3	40	8.5	2023-01-18	tangerine	0.7924528301886793
13	3	40	8.5	2023-02-18	tangerine	0.7924528301886793
5	2	40	8.5	2023-01-19	ugli fruit	0.8301886792452831
14	2	40	None	2023-02-19	ugli fruit	0.8301886792452831
5	1	40	8.5	2023-01-20	vanilla	0.8679245283018868
14	1	40	None	2023-02-20	vanilla	0.8679245283018868
5	10	45	9.5	2023-01-21	watermelon	0.9056603773584906
14	10	45	9.5	2023-02-21	watermelon	0.9056603773584906
6	9	45	10.5	2023-01-22	xigua	0.9433962264150944
15	9	45	10.5	None	xigua	0.9433962264150944
6	8	50	11.5	2023-01-23	yumberry	0.9811320754716981
6	7	50	12.5	2023-01-24	zucchini	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1 DESC) AS cume_dist_v1 FROM cume_test WHERE v1 IS NOT NULL;
-- result:
6	5	60	13.5	2023-01-26	bilberry	0.10416666666666667
17	3	60	14.5	2023-02-28	dewberry	0.10416666666666667
17	4	60	13.5	None	cloudberry	0.10416666666666667
7	3	60	14.5	2023-01-28	dewberry	0.10416666666666667
7	4	60	13.5	2023-01-27	cloudberry	0.10416666666666667
6	6	55	13.5	2023-01-25	acerola	0.14583333333333334
16	6	55	13.5	2023-02-25	acerola	0.14583333333333334
6	7	50	12.5	2023-01-24	zucchini	0.22916666666666666
6	8	50	11.5	2023-01-23	yumberry	0.22916666666666666
16	8	50	11.5	None	None	0.22916666666666666
16	7	50	12.5	2023-02-24	None	0.22916666666666666
5	10	45	9.5	2023-01-21	watermelon	0.3333333333333333
6	9	45	10.5	2023-01-22	xigua	0.3333333333333333
10	2	45	5.5	2023-02-09	None	0.3333333333333333
15	9	45	10.5	None	xigua	0.3333333333333333
14	10	45	9.5	2023-02-21	watermelon	0.3333333333333333
5	1	40	8.5	2023-01-20	vanilla	0.4583333333333333
5	2	40	8.5	2023-01-19	ugli fruit	0.4583333333333333
5	3	40	8.5	2023-01-18	tangerine	0.4583333333333333
13	3	40	8.5	2023-02-18	tangerine	0.4583333333333333
14	1	40	None	2023-02-20	vanilla	0.4583333333333333
14	2	40	None	2023-02-19	ugli fruit	0.4583333333333333
5	4	35	8.5	2023-01-17	strawberry	0.6458333333333334
12	8	35	6.5	2023-02-13	None	0.6458333333333334
4	5	35	7.5	2023-01-16	raspberry	0.6458333333333334
4	6	35	7.5	2023-01-15	quince	0.6458333333333334
4	7	35	6.5	2023-01-14	pineapple	0.6458333333333334
4	8	35	6.5	2023-01-13	papaya	0.6458333333333334
13	4	35	8.5	None	None	0.6458333333333334
13	5	35	7.5	2023-02-16	None	0.6458333333333334
13	7	35	6.5	2023-02-14	pineapple	0.6458333333333334
4	9	30	5.5	2023-01-12	orange	0.7083333333333334
4	10	30	5.5	2023-01-11	nectarine	0.7083333333333334
11	9	30	5.5	2023-02-12	orange	0.7083333333333334
4	2	25	5.5	2023-01-10	mango	0.7291666666666666
3	2	20	5.5	2023-01-09	lemon	0.9166666666666666
3	3	20	5.5	2023-01-08	kiwi	0.9166666666666666
9	4	20	5.5	2023-02-07	None	0.9166666666666666
9	5	20	4.5	2023-02-02	grape	0.9166666666666666
10	3	20	None	None	kiwi	0.9166666666666666
2	5	20	4.5	2023-01-06	grape	0.9166666666666666
2	6	20	3.5	2023-01-05	fig	0.9166666666666666
1	7	20	3.5	2023-01-04	date	0.9166666666666666
2	4	20	5.5	2023-01-07	honeydew	0.9166666666666666
8	8	15	3.5	2023-01-30	None	1.0
1	8	15	3.5	2023-01-03	cherry	1.0
1	10	15	2.5	2023-01-01	apple	1.0
1	2	15	2.5	2023-01-02	banana	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2 FROM cume_test WHERE v2 IS NOT NULL;
-- result:
1	2	15	2.5	2023-01-02	banana	0.06
1	10	15	2.5	2023-01-01	apple	0.06
8	2	None	2.5	2023-01-29	None	0.06
1	7	20	3.5	2023-01-04	date	0.16
1	8	15	3.5	2023-01-03	cherry	0.16
2	6	20	3.5	2023-01-05	fig	0.16
8	8	15	3.5	2023-01-30	None	0.16
8	7	None	3.5	2023-01-31	date	0.16
9	5	20	4.5	2023-02-02	grape	0.2
2	5	20	4.5	2023-01-06	grape	0.2
3	2	20	5.5	2023-01-09	lemon	0.4
3	3	20	5.5	2023-01-08	kiwi	0.4
9	4	20	5.5	2023-02-07	None	0.4
10	2	45	5.5	2023-02-09	None	0.4
2	4	20	5.5	2023-01-07	honeydew	0.4
4	2	25	5.5	2023-01-10	mango	0.4
11	10	None	5.5	None	None	0.4
11	9	30	5.5	2023-02-12	orange	0.4
4	9	30	5.5	2023-01-12	orange	0.4
4	10	30	5.5	2023-01-11	nectarine	0.4
12	8	35	6.5	2023-02-13	None	0.48
13	7	35	6.5	2023-02-14	pineapple	0.48
4	8	35	6.5	2023-01-13	papaya	0.48
4	7	35	6.5	2023-01-14	pineapple	0.48
4	6	35	7.5	2023-01-15	quince	0.56
4	5	35	7.5	2023-01-16	raspberry	0.56
13	5	35	7.5	2023-02-16	None	0.56
13	6	None	7.5	2023-02-15	quince	0.56
5	1	40	8.5	2023-01-20	vanilla	0.68
5	2	40	8.5	2023-01-19	ugli fruit	0.68
5	3	40	8.5	2023-01-18	tangerine	0.68
5	4	35	8.5	2023-01-17	strawberry	0.68
13	3	40	8.5	2023-02-18	tangerine	0.68
13	4	35	8.5	None	None	0.68
5	10	45	9.5	2023-01-21	watermelon	0.72
14	10	45	9.5	2023-02-21	watermelon	0.72
6	9	45	10.5	2023-01-22	xigua	0.76
15	9	45	10.5	None	xigua	0.76
6	8	50	11.5	2023-01-23	yumberry	0.8
16	8	50	11.5	None	None	0.8
6	7	50	12.5	2023-01-24	zucchini	0.84
16	7	50	12.5	2023-02-24	None	0.84
6	5	60	13.5	2023-01-26	bilberry	0.96
6	6	55	13.5	2023-01-25	acerola	0.96
17	4	60	13.5	None	cloudberry	0.96
16	5	None	13.5	2023-02-26	bilberry	0.96
16	6	55	13.5	2023-02-25	acerola	0.96
7	4	60	13.5	2023-01-27	cloudberry	0.96
17	3	60	14.5	2023-02-28	dewberry	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3 FROM cume_test WHERE v3 IS NOT NULL;
-- result:
1	10	15	2.5	2023-01-01	apple	0.020833333333333332
1	2	15	2.5	2023-01-02	banana	0.041666666666666664
1	8	15	3.5	2023-01-03	cherry	0.0625
1	7	20	3.5	2023-01-04	date	0.08333333333333333
2	6	20	3.5	2023-01-05	fig	0.10416666666666667
2	5	20	4.5	2023-01-06	grape	0.125
2	4	20	5.5	2023-01-07	honeydew	0.14583333333333334
3	3	20	5.5	2023-01-08	kiwi	0.16666666666666666
3	2	20	5.5	2023-01-09	lemon	0.1875
4	2	25	5.5	2023-01-10	mango	0.20833333333333334
4	10	30	5.5	2023-01-11	nectarine	0.22916666666666666
4	9	30	5.5	2023-01-12	orange	0.25
4	8	35	6.5	2023-01-13	papaya	0.2708333333333333
4	7	35	6.5	2023-01-14	pineapple	0.2916666666666667
4	6	35	7.5	2023-01-15	quince	0.3125
4	5	35	7.5	2023-01-16	raspberry	0.3333333333333333
5	4	35	8.5	2023-01-17	strawberry	0.3541666666666667
5	3	40	8.5	2023-01-18	tangerine	0.375
5	2	40	8.5	2023-01-19	ugli fruit	0.3958333333333333
5	1	40	8.5	2023-01-20	vanilla	0.4166666666666667
5	10	45	9.5	2023-01-21	watermelon	0.4375
6	9	45	10.5	2023-01-22	xigua	0.4583333333333333
6	8	50	11.5	2023-01-23	yumberry	0.4791666666666667
6	7	50	12.5	2023-01-24	zucchini	0.5
6	6	55	13.5	2023-01-25	acerola	0.5208333333333334
6	5	60	13.5	2023-01-26	bilberry	0.5416666666666666
7	4	60	13.5	2023-01-27	cloudberry	0.5625
7	3	60	14.5	2023-01-28	dewberry	0.5833333333333334
8	2	None	2.5	2023-01-29	None	0.6041666666666666
8	8	15	3.5	2023-01-30	None	0.625
8	7	None	3.5	2023-01-31	date	0.6458333333333334
8	6	None	None	2023-02-01	fig	0.6666666666666666
9	5	20	4.5	2023-02-02	grape	0.6875
9	4	20	5.5	2023-02-07	None	0.7083333333333334
10	2	45	5.5	2023-02-09	None	0.7291666666666666
11	9	30	5.5	2023-02-12	orange	0.75
12	8	35	6.5	2023-02-13	None	0.7708333333333334
13	7	35	6.5	2023-02-14	pineapple	0.7916666666666666
13	6	None	7.5	2023-02-15	quince	0.8125
13	5	35	7.5	2023-02-16	None	0.8333333333333334
13	3	40	8.5	2023-02-18	tangerine	0.8541666666666666
14	2	40	None	2023-02-19	ugli fruit	0.875
14	1	40	None	2023-02-20	vanilla	0.8958333333333334
14	10	45	9.5	2023-02-21	watermelon	0.9166666666666666
16	7	50	12.5	2023-02-24	None	0.9375
16	6	55	13.5	2023-02-25	acerola	0.9583333333333334
16	5	None	13.5	2023-02-26	bilberry	0.9791666666666666
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4 FROM cume_test WHERE v4 IS NOT NULL;
-- result:
6	6	55	13.5	2023-01-25	acerola	0.045454545454545456
16	6	55	13.5	2023-02-25	acerola	0.045454545454545456
1	10	15	2.5	2023-01-01	apple	0.06818181818181818
1	2	15	2.5	2023-01-02	banana	0.09090909090909091
6	5	60	13.5	2023-01-26	bilberry	0.13636363636363635
16	5	None	13.5	2023-02-26	bilberry	0.13636363636363635
1	8	15	3.5	2023-01-03	cherry	0.1590909090909091
17	4	60	13.5	None	cloudberry	0.20454545454545456
7	4	60	13.5	2023-01-27	cloudberry	0.20454545454545456
1	7	20	3.5	2023-01-04	date	0.25
8	7	None	3.5	2023-01-31	date	0.25
17	3	60	14.5	2023-02-28	dewberry	0.29545454545454547
7	3	60	14.5	2023-01-28	dewberry	0.29545454545454547
2	6	20	3.5	2023-01-05	fig	0.3409090909090909
8	6	None	None	2023-02-01	fig	0.3409090909090909
9	5	20	4.5	2023-02-02	grape	0.38636363636363635
2	5	20	4.5	2023-01-06	grape	0.38636363636363635
2	4	20	5.5	2023-01-07	honeydew	0.4090909090909091
3	3	20	5.5	2023-01-08	kiwi	0.45454545454545453
10	3	20	None	None	kiwi	0.45454545454545453
3	2	20	5.5	2023-01-09	lemon	0.4772727272727273
4	2	25	5.5	2023-01-10	mango	0.5
4	10	30	5.5	2023-01-11	nectarine	0.5227272727272727
11	9	30	5.5	2023-02-12	orange	0.5681818181818182
4	9	30	5.5	2023-01-12	orange	0.5681818181818182
4	8	35	6.5	2023-01-13	papaya	0.5909090909090909
13	7	35	6.5	2023-02-14	pineapple	0.6363636363636364
4	7	35	6.5	2023-01-14	pineapple	0.6363636363636364
13	6	None	7.5	2023-02-15	quince	0.6818181818181818
4	6	35	7.5	2023-01-15	quince	0.6818181818181818
4	5	35	7.5	2023-01-16	raspberry	0.7045454545454546
5	4	35	8.5	2023-01-17	strawberry	0.7272727272727273
5	3	40	8.5	2023-01-18	tangerine	0.7727272727272727
13	3	40	8.5	2023-02-18	tangerine	0.7727272727272727
5	2	40	8.5	2023-01-19	ugli fruit	0.8181818181818182
14	2	40	None	2023-02-19	ugli fruit	0.8181818181818182
5	1	40	8.5	2023-01-20	vanilla	0.8636363636363636
14	1	40	None	2023-02-20	vanilla	0.8636363636363636
5	10	45	9.5	2023-01-21	watermelon	0.9090909090909091
14	10	45	9.5	2023-02-21	watermelon	0.9090909090909091
6	9	45	10.5	2023-01-22	xigua	0.9545454545454546
15	9	45	10.5	None	xigua	0.9545454545454546
6	8	50	11.5	2023-01-23	yumberry	0.9772727272727273
6	7	50	12.5	2023-01-24	zucchini	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v1) AS percent_rank_v1 FROM cume_test WHERE v1 IS NOT NULL;
-- result:
1	8	15	3.5	2023-01-03	cherry	0.0
1	10	15	2.5	2023-01-01	apple	0.0
1	2	15	2.5	2023-01-02	banana	0.0
8	8	15	3.5	2023-01-30	None	0.0
3	2	20	5.5	2023-01-09	lemon	0.0851063829787234
3	3	20	5.5	2023-01-08	kiwi	0.0851063829787234
9	4	20	5.5	2023-02-07	None	0.0851063829787234
9	5	20	4.5	2023-02-02	grape	0.0851063829787234
10	3	20	None	None	kiwi	0.0851063829787234
1	7	20	3.5	2023-01-04	date	0.0851063829787234
2	4	20	5.5	2023-01-07	honeydew	0.0851063829787234
2	5	20	4.5	2023-01-06	grape	0.0851063829787234
2	6	20	3.5	2023-01-05	fig	0.0851063829787234
4	2	25	5.5	2023-01-10	mango	0.2765957446808511
4	9	30	5.5	2023-01-12	orange	0.2978723404255319
4	10	30	5.5	2023-01-11	nectarine	0.2978723404255319
11	9	30	5.5	2023-02-12	orange	0.2978723404255319
5	4	35	8.5	2023-01-17	strawberry	0.3617021276595745
12	8	35	6.5	2023-02-13	None	0.3617021276595745
4	5	35	7.5	2023-01-16	raspberry	0.3617021276595745
4	6	35	7.5	2023-01-15	quince	0.3617021276595745
4	7	35	6.5	2023-01-14	pineapple	0.3617021276595745
4	8	35	6.5	2023-01-13	papaya	0.3617021276595745
13	4	35	8.5	None	None	0.3617021276595745
13	5	35	7.5	2023-02-16	None	0.3617021276595745
13	7	35	6.5	2023-02-14	pineapple	0.3617021276595745
5	1	40	8.5	2023-01-20	vanilla	0.5531914893617021
5	2	40	8.5	2023-01-19	ugli fruit	0.5531914893617021
5	3	40	8.5	2023-01-18	tangerine	0.5531914893617021
14	2	40	None	2023-02-19	ugli fruit	0.5531914893617021
13	3	40	8.5	2023-02-18	tangerine	0.5531914893617021
14	1	40	None	2023-02-20	vanilla	0.5531914893617021
5	10	45	9.5	2023-01-21	watermelon	0.6808510638297872
6	9	45	10.5	2023-01-22	xigua	0.6808510638297872
10	2	45	5.5	2023-02-09	None	0.6808510638297872
15	9	45	10.5	None	xigua	0.6808510638297872
14	10	45	9.5	2023-02-21	watermelon	0.6808510638297872
6	7	50	12.5	2023-01-24	zucchini	0.7872340425531915
6	8	50	11.5	2023-01-23	yumberry	0.7872340425531915
16	8	50	11.5	None	None	0.7872340425531915
16	7	50	12.5	2023-02-24	None	0.7872340425531915
6	6	55	13.5	2023-01-25	acerola	0.8723404255319149
16	6	55	13.5	2023-02-25	acerola	0.8723404255319149
6	5	60	13.5	2023-01-26	bilberry	0.9148936170212766
17	3	60	14.5	2023-02-28	dewberry	0.9148936170212766
17	4	60	13.5	None	cloudberry	0.9148936170212766
7	4	60	13.5	2023-01-27	cloudberry	0.9148936170212766
7	3	60	14.5	2023-01-28	dewberry	0.9148936170212766
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v2) AS percent_rank_v2 FROM cume_test WHERE v2 IS NOT NULL;
-- result:
1	2	15	2.5	2023-01-02	banana	0.0
1	10	15	2.5	2023-01-01	apple	0.0
8	2	None	2.5	2023-01-29	None	0.0
1	7	20	3.5	2023-01-04	date	0.061224489795918366
1	8	15	3.5	2023-01-03	cherry	0.061224489795918366
2	6	20	3.5	2023-01-05	fig	0.061224489795918366
8	8	15	3.5	2023-01-30	None	0.061224489795918366
8	7	None	3.5	2023-01-31	date	0.061224489795918366
9	5	20	4.5	2023-02-02	grape	0.16326530612244897
2	5	20	4.5	2023-01-06	grape	0.16326530612244897
3	2	20	5.5	2023-01-09	lemon	0.20408163265306123
3	3	20	5.5	2023-01-08	kiwi	0.20408163265306123
9	4	20	5.5	2023-02-07	None	0.20408163265306123
10	2	45	5.5	2023-02-09	None	0.20408163265306123
2	4	20	5.5	2023-01-07	honeydew	0.20408163265306123
4	2	25	5.5	2023-01-10	mango	0.20408163265306123
11	10	None	5.5	None	None	0.20408163265306123
11	9	30	5.5	2023-02-12	orange	0.20408163265306123
4	9	30	5.5	2023-01-12	orange	0.20408163265306123
4	10	30	5.5	2023-01-11	nectarine	0.20408163265306123
12	8	35	6.5	2023-02-13	None	0.40816326530612246
13	7	35	6.5	2023-02-14	pineapple	0.40816326530612246
4	8	35	6.5	2023-01-13	papaya	0.40816326530612246
4	7	35	6.5	2023-01-14	pineapple	0.40816326530612246
4	6	35	7.5	2023-01-15	quince	0.4897959183673469
4	5	35	7.5	2023-01-16	raspberry	0.4897959183673469
13	5	35	7.5	2023-02-16	None	0.4897959183673469
13	6	None	7.5	2023-02-15	quince	0.4897959183673469
5	1	40	8.5	2023-01-20	vanilla	0.5714285714285714
5	2	40	8.5	2023-01-19	ugli fruit	0.5714285714285714
5	3	40	8.5	2023-01-18	tangerine	0.5714285714285714
5	4	35	8.5	2023-01-17	strawberry	0.5714285714285714
13	3	40	8.5	2023-02-18	tangerine	0.5714285714285714
13	4	35	8.5	None	None	0.5714285714285714
5	10	45	9.5	2023-01-21	watermelon	0.6938775510204082
14	10	45	9.5	2023-02-21	watermelon	0.6938775510204082
6	9	45	10.5	2023-01-22	xigua	0.7346938775510204
15	9	45	10.5	None	xigua	0.7346938775510204
6	8	50	11.5	2023-01-23	yumberry	0.7755102040816326
16	8	50	11.5	None	None	0.7755102040816326
6	7	50	12.5	2023-01-24	zucchini	0.8163265306122449
16	7	50	12.5	2023-02-24	None	0.8163265306122449
6	5	60	13.5	2023-01-26	bilberry	0.8571428571428571
6	6	55	13.5	2023-01-25	acerola	0.8571428571428571
17	4	60	13.5	None	cloudberry	0.8571428571428571
16	5	None	13.5	2023-02-26	bilberry	0.8571428571428571
16	6	55	13.5	2023-02-25	acerola	0.8571428571428571
7	4	60	13.5	2023-01-27	cloudberry	0.8571428571428571
17	3	60	14.5	2023-02-28	dewberry	0.9795918367346939
7	3	60	14.5	2023-01-28	dewberry	0.9795918367346939
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v3) AS percent_rank_v3 FROM cume_test WHERE v3 IS NOT NULL;
-- result:
1	10	15	2.5	2023-01-01	apple	0.0
1	2	15	2.5	2023-01-02	banana	0.02127659574468085
1	8	15	3.5	2023-01-03	cherry	0.0425531914893617
1	7	20	3.5	2023-01-04	date	0.06382978723404255
2	6	20	3.5	2023-01-05	fig	0.0851063829787234
2	5	20	4.5	2023-01-06	grape	0.10638297872340426
2	4	20	5.5	2023-01-07	honeydew	0.1276595744680851
3	3	20	5.5	2023-01-08	kiwi	0.14893617021276595
3	2	20	5.5	2023-01-09	lemon	0.1702127659574468
4	2	25	5.5	2023-01-10	mango	0.19148936170212766
4	10	30	5.5	2023-01-11	nectarine	0.2127659574468085
4	9	30	5.5	2023-01-12	orange	0.23404255319148937
4	8	35	6.5	2023-01-13	papaya	0.2553191489361702
4	7	35	6.5	2023-01-14	pineapple	0.2765957446808511
4	6	35	7.5	2023-01-15	quince	0.2978723404255319
4	5	35	7.5	2023-01-16	raspberry	0.3191489361702128
5	4	35	8.5	2023-01-17	strawberry	0.3404255319148936
5	3	40	8.5	2023-01-18	tangerine	0.3617021276595745
5	2	40	8.5	2023-01-19	ugli fruit	0.3829787234042553
5	1	40	8.5	2023-01-20	vanilla	0.40425531914893614
5	10	45	9.5	2023-01-21	watermelon	0.425531914893617
6	9	45	10.5	2023-01-22	xigua	0.44680851063829785
6	8	50	11.5	2023-01-23	yumberry	0.46808510638297873
6	7	50	12.5	2023-01-24	zucchini	0.48936170212765956
6	6	55	13.5	2023-01-25	acerola	0.5106382978723404
6	5	60	13.5	2023-01-26	bilberry	0.5319148936170213
7	4	60	13.5	2023-01-27	cloudberry	0.5531914893617021
7	3	60	14.5	2023-01-28	dewberry	0.574468085106383
8	2	None	2.5	2023-01-29	None	0.5957446808510638
8	8	15	3.5	2023-01-30	None	0.6170212765957447
8	7	None	3.5	2023-01-31	date	0.6382978723404256
8	6	None	None	2023-02-01	fig	0.6595744680851063
9	5	20	4.5	2023-02-02	grape	0.6808510638297872
9	4	20	5.5	2023-02-07	None	0.7021276595744681
10	2	45	5.5	2023-02-09	None	0.723404255319149
11	9	30	5.5	2023-02-12	orange	0.7446808510638298
12	8	35	6.5	2023-02-13	None	0.7659574468085106
13	7	35	6.5	2023-02-14	pineapple	0.7872340425531915
13	6	None	7.5	2023-02-15	quince	0.8085106382978723
13	5	35	7.5	2023-02-16	None	0.8297872340425532
13	3	40	8.5	2023-02-18	tangerine	0.851063829787234
14	2	40	None	2023-02-19	ugli fruit	0.8723404255319149
14	1	40	None	2023-02-20	vanilla	0.8936170212765957
14	10	45	9.5	2023-02-21	watermelon	0.9148936170212766
16	7	50	12.5	2023-02-24	None	0.9361702127659575
16	6	55	13.5	2023-02-25	acerola	0.9574468085106383
16	5	None	13.5	2023-02-26	bilberry	0.9787234042553191
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v4 DESC) AS percent_rank_v4 FROM cume_test WHERE v4 IS NOT NULL;
-- result:
6	7	50	12.5	2023-01-24	zucchini	0.0
6	8	50	11.5	2023-01-23	yumberry	0.023255813953488372
6	9	45	10.5	2023-01-22	xigua	0.046511627906976744
15	9	45	10.5	None	xigua	0.046511627906976744
5	10	45	9.5	2023-01-21	watermelon	0.09302325581395349
14	10	45	9.5	2023-02-21	watermelon	0.09302325581395349
5	1	40	8.5	2023-01-20	vanilla	0.13953488372093023
14	1	40	None	2023-02-20	vanilla	0.13953488372093023
5	2	40	8.5	2023-01-19	ugli fruit	0.18604651162790697
14	2	40	None	2023-02-19	ugli fruit	0.18604651162790697
5	3	40	8.5	2023-01-18	tangerine	0.23255813953488372
13	3	40	8.5	2023-02-18	tangerine	0.23255813953488372
5	4	35	8.5	2023-01-17	strawberry	0.27906976744186046
4	5	35	7.5	2023-01-16	raspberry	0.3023255813953488
13	6	None	7.5	2023-02-15	quince	0.32558139534883723
4	6	35	7.5	2023-01-15	quince	0.32558139534883723
4	7	35	6.5	2023-01-14	pineapple	0.37209302325581395
13	7	35	6.5	2023-02-14	pineapple	0.37209302325581395
4	8	35	6.5	2023-01-13	papaya	0.4186046511627907
11	9	30	5.5	2023-02-12	orange	0.4418604651162791
4	9	30	5.5	2023-01-12	orange	0.4418604651162791
4	10	30	5.5	2023-01-11	nectarine	0.4883720930232558
4	2	25	5.5	2023-01-10	mango	0.5116279069767442
3	2	20	5.5	2023-01-09	lemon	0.5348837209302325
3	3	20	5.5	2023-01-08	kiwi	0.5581395348837209
10	3	20	None	None	kiwi	0.5581395348837209
2	4	20	5.5	2023-01-07	honeydew	0.6046511627906976
9	5	20	4.5	2023-02-02	grape	0.627906976744186
2	5	20	4.5	2023-01-06	grape	0.627906976744186
8	6	None	None	2023-02-01	fig	0.6744186046511628
2	6	20	3.5	2023-01-05	fig	0.6744186046511628
17	3	60	14.5	2023-02-28	dewberry	0.7209302325581395
7	3	60	14.5	2023-01-28	dewberry	0.7209302325581395
8	7	None	3.5	2023-01-31	date	0.7674418604651163
1	7	20	3.5	2023-01-04	date	0.7674418604651163
17	4	60	13.5	None	cloudberry	0.813953488372093
7	4	60	13.5	2023-01-27	cloudberry	0.813953488372093
1	8	15	3.5	2023-01-03	cherry	0.8604651162790697
6	5	60	13.5	2023-01-26	bilberry	0.8837209302325582
16	5	None	13.5	2023-02-26	bilberry	0.8837209302325582
1	2	15	2.5	2023-01-02	banana	0.9302325581395349
1	10	15	2.5	2023-01-01	apple	0.9534883720930233
6	6	55	13.5	2023-01-25	acerola	0.9767441860465116
16	6	55	13.5	2023-02-25	acerola	0.9767441860465116
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY k1, k2) AS cume_dist_k1_k2 FROM cume_test;
-- result:
1	2	15	2.5	2023-01-02	banana	0.018518518518518517
1	7	20	3.5	2023-01-04	date	0.037037037037037035
1	8	15	3.5	2023-01-03	cherry	0.05555555555555555
1	10	15	2.5	2023-01-01	apple	0.07407407407407407
2	4	20	5.5	2023-01-07	honeydew	0.09259259259259259
2	5	20	4.5	2023-01-06	grape	0.1111111111111111
2	6	20	3.5	2023-01-05	fig	0.12962962962962962
3	2	20	5.5	2023-01-09	lemon	0.14814814814814814
3	3	20	5.5	2023-01-08	kiwi	0.16666666666666666
4	2	25	5.5	2023-01-10	mango	0.18518518518518517
4	5	35	7.5	2023-01-16	raspberry	0.2037037037037037
4	6	35	7.5	2023-01-15	quince	0.2222222222222222
4	7	35	6.5	2023-01-14	pineapple	0.24074074074074073
4	8	35	6.5	2023-01-13	papaya	0.25925925925925924
4	9	30	5.5	2023-01-12	orange	0.2777777777777778
4	10	30	5.5	2023-01-11	nectarine	0.2962962962962963
5	1	40	8.5	2023-01-20	vanilla	0.3148148148148148
5	2	40	8.5	2023-01-19	ugli fruit	0.3333333333333333
5	3	40	8.5	2023-01-18	tangerine	0.35185185185185186
5	4	35	8.5	2023-01-17	strawberry	0.37037037037037035
5	10	45	9.5	2023-01-21	watermelon	0.3888888888888889
6	5	60	13.5	2023-01-26	bilberry	0.4074074074074074
6	6	55	13.5	2023-01-25	acerola	0.42592592592592593
6	7	50	12.5	2023-01-24	zucchini	0.4444444444444444
6	8	50	11.5	2023-01-23	yumberry	0.46296296296296297
6	9	45	10.5	2023-01-22	xigua	0.48148148148148145
7	3	60	14.5	2023-01-28	dewberry	0.5
7	4	60	13.5	2023-01-27	cloudberry	0.5185185185185185
8	2	None	2.5	2023-01-29	None	0.5370370370370371
8	6	None	None	2023-02-01	fig	0.5555555555555556
8	7	None	3.5	2023-01-31	date	0.5740740740740741
8	8	15	3.5	2023-01-30	None	0.5925925925925926
9	4	20	5.5	2023-02-07	None	0.6111111111111112
9	5	20	4.5	2023-02-02	grape	0.6296296296296297
10	2	45	5.5	2023-02-09	None	0.6481481481481481
10	3	20	None	None	kiwi	0.6666666666666666
11	9	30	5.5	2023-02-12	orange	0.6851851851851852
11	10	None	5.5	None	None	0.7037037037037037
12	8	35	6.5	2023-02-13	None	0.7222222222222222
13	3	40	8.5	2023-02-18	tangerine	0.7407407407407407
13	4	35	8.5	None	None	0.7592592592592593
13	5	35	7.5	2023-02-16	None	0.7777777777777778
13	6	None	7.5	2023-02-15	quince	0.7962962962962963
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148
14	1	40	None	2023-02-20	vanilla	0.8333333333333334
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519
14	10	45	9.5	2023-02-21	watermelon	0.8703703703703703
15	9	45	10.5	None	xigua	0.8888888888888888
16	5	None	13.5	2023-02-26	bilberry	0.9074074074074074
16	6	55	13.5	2023-02-25	acerola	0.9259259259259259
16	7	50	12.5	2023-02-24	None	0.9444444444444444
16	8	50	11.5	None	None	0.9629629629629629
17	3	60	14.5	2023-02-28	dewberry	0.9814814814814815
17	4	60	13.5	None	cloudberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY k1 ASC, k2 DESC) AS cume_dist_k1_asc_k2_desc FROM cume_test;
-- result:
1	10	15	2.5	2023-01-01	apple	0.018518518518518517
1	8	15	3.5	2023-01-03	cherry	0.037037037037037035
1	7	20	3.5	2023-01-04	date	0.05555555555555555
1	2	15	2.5	2023-01-02	banana	0.07407407407407407
2	6	20	3.5	2023-01-05	fig	0.09259259259259259
2	5	20	4.5	2023-01-06	grape	0.1111111111111111
2	4	20	5.5	2023-01-07	honeydew	0.12962962962962962
3	3	20	5.5	2023-01-08	kiwi	0.14814814814814814
3	2	20	5.5	2023-01-09	lemon	0.16666666666666666
4	10	30	5.5	2023-01-11	nectarine	0.18518518518518517
4	9	30	5.5	2023-01-12	orange	0.2037037037037037
4	8	35	6.5	2023-01-13	papaya	0.2222222222222222
4	7	35	6.5	2023-01-14	pineapple	0.24074074074074073
4	6	35	7.5	2023-01-15	quince	0.25925925925925924
4	5	35	7.5	2023-01-16	raspberry	0.2777777777777778
4	2	25	5.5	2023-01-10	mango	0.2962962962962963
5	10	45	9.5	2023-01-21	watermelon	0.3148148148148148
5	4	35	8.5	2023-01-17	strawberry	0.3333333333333333
5	3	40	8.5	2023-01-18	tangerine	0.35185185185185186
5	2	40	8.5	2023-01-19	ugli fruit	0.37037037037037035
5	1	40	8.5	2023-01-20	vanilla	0.3888888888888889
6	9	45	10.5	2023-01-22	xigua	0.4074074074074074
6	8	50	11.5	2023-01-23	yumberry	0.42592592592592593
6	7	50	12.5	2023-01-24	zucchini	0.4444444444444444
6	6	55	13.5	2023-01-25	acerola	0.46296296296296297
6	5	60	13.5	2023-01-26	bilberry	0.48148148148148145
7	4	60	13.5	2023-01-27	cloudberry	0.5
7	3	60	14.5	2023-01-28	dewberry	0.5185185185185185
8	8	15	3.5	2023-01-30	None	0.5370370370370371
8	7	None	3.5	2023-01-31	date	0.5555555555555556
8	6	None	None	2023-02-01	fig	0.5740740740740741
8	2	None	2.5	2023-01-29	None	0.5925925925925926
9	5	20	4.5	2023-02-02	grape	0.6111111111111112
9	4	20	5.5	2023-02-07	None	0.6296296296296297
10	3	20	None	None	kiwi	0.6481481481481481
10	2	45	5.5	2023-02-09	None	0.6666666666666666
11	10	None	5.5	None	None	0.6851851851851852
11	9	30	5.5	2023-02-12	orange	0.7037037037037037
12	8	35	6.5	2023-02-13	None	0.7222222222222222
13	7	35	6.5	2023-02-14	pineapple	0.7407407407407407
13	6	None	7.5	2023-02-15	quince	0.7592592592592593
13	5	35	7.5	2023-02-16	None	0.7777777777777778
13	4	35	8.5	None	None	0.7962962962962963
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148
14	10	45	9.5	2023-02-21	watermelon	0.8333333333333334
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519
14	1	40	None	2023-02-20	vanilla	0.8703703703703703
15	9	45	10.5	None	xigua	0.8888888888888888
16	8	50	11.5	None	None	0.9074074074074074
16	7	50	12.5	2023-02-24	None	0.9259259259259259
16	6	55	13.5	2023-02-25	acerola	0.9444444444444444
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629
17	4	60	13.5	None	cloudberry	0.9814814814814815
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY k1, k2) AS percent_rank_k1_k2 FROM cume_test;
-- result:
1	2	15	2.5	2023-01-02	banana	0.0
1	7	20	3.5	2023-01-04	date	0.018867924528301886
1	8	15	3.5	2023-01-03	cherry	0.03773584905660377
1	10	15	2.5	2023-01-01	apple	0.05660377358490566
2	4	20	5.5	2023-01-07	honeydew	0.07547169811320754
2	5	20	4.5	2023-01-06	grape	0.09433962264150944
2	6	20	3.5	2023-01-05	fig	0.11320754716981132
3	2	20	5.5	2023-01-09	lemon	0.1320754716981132
3	3	20	5.5	2023-01-08	kiwi	0.1509433962264151
4	2	25	5.5	2023-01-10	mango	0.16981132075471697
4	5	35	7.5	2023-01-16	raspberry	0.18867924528301888
4	6	35	7.5	2023-01-15	quince	0.20754716981132076
4	7	35	6.5	2023-01-14	pineapple	0.22641509433962265
4	8	35	6.5	2023-01-13	papaya	0.24528301886792453
4	9	30	5.5	2023-01-12	orange	0.2641509433962264
4	10	30	5.5	2023-01-11	nectarine	0.2830188679245283
5	1	40	8.5	2023-01-20	vanilla	0.3018867924528302
5	2	40	8.5	2023-01-19	ugli fruit	0.32075471698113206
5	3	40	8.5	2023-01-18	tangerine	0.33962264150943394
5	4	35	8.5	2023-01-17	strawberry	0.3584905660377358
5	10	45	9.5	2023-01-21	watermelon	0.37735849056603776
6	5	60	13.5	2023-01-26	bilberry	0.39622641509433965
6	6	55	13.5	2023-01-25	acerola	0.41509433962264153
6	7	50	12.5	2023-01-24	zucchini	0.4339622641509434
6	8	50	11.5	2023-01-23	yumberry	0.4528301886792453
6	9	45	10.5	2023-01-22	xigua	0.4716981132075472
7	3	60	14.5	2023-01-28	dewberry	0.49056603773584906
7	4	60	13.5	2023-01-27	cloudberry	0.5094339622641509
8	2	None	2.5	2023-01-29	None	0.5283018867924528
8	6	None	None	2023-02-01	fig	0.5471698113207547
8	7	None	3.5	2023-01-31	date	0.5660377358490566
8	8	15	3.5	2023-01-30	None	0.5849056603773585
9	4	20	5.5	2023-02-07	None	0.6037735849056604
9	5	20	4.5	2023-02-02	grape	0.6226415094339622
10	2	45	5.5	2023-02-09	None	0.6415094339622641
10	3	20	None	None	kiwi	0.660377358490566
11	9	30	5.5	2023-02-12	orange	0.6792452830188679
11	10	None	5.5	None	None	0.6981132075471698
12	8	35	6.5	2023-02-13	None	0.7169811320754716
13	3	40	8.5	2023-02-18	tangerine	0.7358490566037735
13	4	35	8.5	None	None	0.7547169811320755
13	5	35	7.5	2023-02-16	None	0.7735849056603774
13	6	None	7.5	2023-02-15	quince	0.7924528301886793
13	7	35	6.5	2023-02-14	pineapple	0.8113207547169812
14	1	40	None	2023-02-20	vanilla	0.8301886792452831
14	2	40	None	2023-02-19	ugli fruit	0.8490566037735849
14	10	45	9.5	2023-02-21	watermelon	0.8679245283018868
15	9	45	10.5	None	xigua	0.8867924528301887
16	5	None	13.5	2023-02-26	bilberry	0.9056603773584906
16	6	55	13.5	2023-02-25	acerola	0.9245283018867925
16	7	50	12.5	2023-02-24	None	0.9433962264150944
16	8	50	11.5	None	None	0.9622641509433962
17	3	60	14.5	2023-02-28	dewberry	0.9811320754716981
17	4	60	13.5	None	cloudberry	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY k1 DESC, k2 ASC) AS percent_rank_k1_desc_k2_asc FROM cume_test;
-- result:
17	3	60	14.5	2023-02-28	dewberry	0.0
17	4	60	13.5	None	cloudberry	0.018867924528301886
16	5	None	13.5	2023-02-26	bilberry	0.03773584905660377
16	6	55	13.5	2023-02-25	acerola	0.05660377358490566
16	7	50	12.5	2023-02-24	None	0.07547169811320754
16	8	50	11.5	None	None	0.09433962264150944
15	9	45	10.5	None	xigua	0.11320754716981132
14	1	40	None	2023-02-20	vanilla	0.1320754716981132
14	2	40	None	2023-02-19	ugli fruit	0.1509433962264151
14	10	45	9.5	2023-02-21	watermelon	0.16981132075471697
13	3	40	8.5	2023-02-18	tangerine	0.18867924528301888
13	4	35	8.5	None	None	0.20754716981132076
13	5	35	7.5	2023-02-16	None	0.22641509433962265
13	6	None	7.5	2023-02-15	quince	0.24528301886792453
13	7	35	6.5	2023-02-14	pineapple	0.2641509433962264
12	8	35	6.5	2023-02-13	None	0.2830188679245283
11	9	30	5.5	2023-02-12	orange	0.3018867924528302
11	10	None	5.5	None	None	0.32075471698113206
10	2	45	5.5	2023-02-09	None	0.33962264150943394
10	3	20	None	None	kiwi	0.3584905660377358
9	4	20	5.5	2023-02-07	None	0.37735849056603776
9	5	20	4.5	2023-02-02	grape	0.39622641509433965
8	2	None	2.5	2023-01-29	None	0.41509433962264153
8	6	None	None	2023-02-01	fig	0.4339622641509434
8	7	None	3.5	2023-01-31	date	0.4528301886792453
8	8	15	3.5	2023-01-30	None	0.4716981132075472
7	3	60	14.5	2023-01-28	dewberry	0.49056603773584906
7	4	60	13.5	2023-01-27	cloudberry	0.5094339622641509
6	5	60	13.5	2023-01-26	bilberry	0.5283018867924528
6	6	55	13.5	2023-01-25	acerola	0.5471698113207547
6	7	50	12.5	2023-01-24	zucchini	0.5660377358490566
6	8	50	11.5	2023-01-23	yumberry	0.5849056603773585
6	9	45	10.5	2023-01-22	xigua	0.6037735849056604
5	1	40	8.5	2023-01-20	vanilla	0.6226415094339622
5	2	40	8.5	2023-01-19	ugli fruit	0.6415094339622641
5	3	40	8.5	2023-01-18	tangerine	0.660377358490566
5	4	35	8.5	2023-01-17	strawberry	0.6792452830188679
5	10	45	9.5	2023-01-21	watermelon	0.6981132075471698
4	2	25	5.5	2023-01-10	mango	0.7169811320754716
4	5	35	7.5	2023-01-16	raspberry	0.7358490566037735
4	6	35	7.5	2023-01-15	quince	0.7547169811320755
4	7	35	6.5	2023-01-14	pineapple	0.7735849056603774
4	8	35	6.5	2023-01-13	papaya	0.7924528301886793
4	9	30	5.5	2023-01-12	orange	0.8113207547169812
4	10	30	5.5	2023-01-11	nectarine	0.8301886792452831
3	2	20	5.5	2023-01-09	lemon	0.8490566037735849
3	3	20	5.5	2023-01-08	kiwi	0.8679245283018868
2	4	20	5.5	2023-01-07	honeydew	0.8867924528301887
2	5	20	4.5	2023-01-06	grape	0.9056603773584906
2	6	20	3.5	2023-01-05	fig	0.9245283018867925
1	2	15	2.5	2023-01-02	banana	0.9433962264150944
1	7	20	3.5	2023-01-04	date	0.9622641509433962
1	8	15	3.5	2023-01-03	cherry	0.9811320754716981
1	10	15	2.5	2023-01-01	apple	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY v1 ORDER BY v2) AS cume_dist_v1_partition_v2 FROM cume_test;
-- result:
6	8	50	11.5	2023-01-23	yumberry	0.5
16	8	50	11.5	None	None	0.5
6	7	50	12.5	2023-01-24	zucchini	1.0
16	7	50	12.5	2023-02-24	None	1.0
6	6	55	13.5	2023-01-25	acerola	1.0
16	6	55	13.5	2023-02-25	acerola	1.0
1	2	15	2.5	2023-01-02	banana	0.5
1	10	15	2.5	2023-01-01	apple	0.5
1	8	15	3.5	2023-01-03	cherry	1.0
8	8	15	3.5	2023-01-30	None	1.0
14	2	40	None	2023-02-19	ugli fruit	0.3333333333333333
14	1	40	None	2023-02-20	vanilla	0.3333333333333333
5	3	40	8.5	2023-01-18	tangerine	1.0
13	3	40	8.5	2023-02-18	tangerine	1.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0
10	3	20	None	None	kiwi	0.1111111111111111
1	7	20	3.5	2023-01-04	date	0.3333333333333333
2	6	20	3.5	2023-01-05	fig	0.3333333333333333
9	5	20	4.5	2023-02-02	grape	0.5555555555555556
2	5	20	4.5	2023-01-06	grape	0.5555555555555556
3	3	20	5.5	2023-01-08	kiwi	1.0
9	4	20	5.5	2023-02-07	None	1.0
3	2	20	5.5	2023-01-09	lemon	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
4	2	25	5.5	2023-01-10	mango	1.0
4	9	30	5.5	2023-01-12	orange	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
11	9	30	5.5	2023-02-12	orange	1.0
6	5	60	13.5	2023-01-26	bilberry	0.6
17	4	60	13.5	None	cloudberry	0.6
7	4	60	13.5	2023-01-27	cloudberry	0.6
17	3	60	14.5	2023-02-28	dewberry	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
12	8	35	6.5	2023-02-13	None	0.4444444444444444
4	7	35	6.5	2023-01-14	pineapple	0.4444444444444444
4	8	35	6.5	2023-01-13	papaya	0.4444444444444444
13	7	35	6.5	2023-02-14	pineapple	0.4444444444444444
4	5	35	7.5	2023-01-16	raspberry	0.7777777777777778
4	6	35	7.5	2023-01-15	quince	0.7777777777777778
13	5	35	7.5	2023-02-16	None	0.7777777777777778
5	4	35	8.5	2023-01-17	strawberry	1.0
13	4	35	8.5	None	None	1.0
8	6	None	None	2023-02-01	fig	0.16666666666666666
8	2	None	2.5	2023-01-29	None	0.3333333333333333
8	7	None	3.5	2023-01-31	date	0.5
11	10	None	5.5	None	None	0.6666666666666666
13	6	None	7.5	2023-02-15	quince	0.8333333333333334
16	5	None	13.5	2023-02-26	bilberry	1.0
10	2	45	5.5	2023-02-09	None	0.2
14	10	45	9.5	2023-02-21	watermelon	0.6
5	10	45	9.5	2023-01-21	watermelon	0.6
15	9	45	10.5	None	xigua	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY v3 ORDER BY v4) AS cume_dist_v3_partition_v4 FROM cume_test;
-- result:
14	2	40	None	2023-02-19	ugli fruit	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
4	7	35	6.5	2023-01-14	pineapple	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
1	10	15	2.5	2023-01-01	apple	1.0
4	6	35	7.5	2023-01-15	quince	1.0
10	2	45	5.5	2023-02-09	None	1.0
12	8	35	6.5	2023-02-13	None	1.0
4	5	35	7.5	2023-01-16	raspberry	1.0
13	3	40	8.5	2023-02-18	tangerine	1.0
1	2	15	2.5	2023-01-02	banana	1.0
1	8	15	3.5	2023-01-03	cherry	1.0
8	8	15	3.5	2023-01-30	None	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
8	6	None	None	2023-02-01	fig	1.0
9	5	20	4.5	2023-02-02	grape	1.0
9	4	20	5.5	2023-02-07	None	1.0
2	5	20	4.5	2023-01-06	grape	1.0
16	6	55	13.5	2023-02-25	acerola	1.0
16	5	None	13.5	2023-02-26	bilberry	1.0
3	3	20	5.5	2023-01-08	kiwi	1.0
4	8	35	6.5	2023-01-13	papaya	1.0
5	3	40	8.5	2023-01-18	tangerine	1.0
6	8	50	11.5	2023-01-23	yumberry	1.0
13	6	None	7.5	2023-02-15	quince	1.0
4	9	30	5.5	2023-01-12	orange	1.0
4	2	25	5.5	2023-01-10	mango	1.0
2	6	20	3.5	2023-01-05	fig	1.0
8	7	None	3.5	2023-01-31	date	1.0
14	10	45	9.5	2023-02-21	watermelon	1.0
14	1	40	None	2023-02-20	vanilla	1.0
3	2	20	5.5	2023-01-09	lemon	1.0
5	10	45	9.5	2023-01-21	watermelon	1.0
11	9	30	5.5	2023-02-12	orange	1.0
6	6	55	13.5	2023-01-25	acerola	1.0
6	5	60	13.5	2023-01-26	bilberry	1.0
13	5	35	7.5	2023-02-16	None	1.0
16	8	50	11.5	None	None	0.5
13	4	35	8.5	None	None	0.5
11	10	None	5.5	None	None	0.5
17	4	60	13.5	None	cloudberry	0.6666666666666666
10	3	20	None	None	kiwi	0.8333333333333334
15	9	45	10.5	None	xigua	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
16	7	50	12.5	2023-02-24	None	1.0
1	7	20	3.5	2023-01-04	date	1.0
8	2	None	2.5	2023-01-29	None	1.0
5	4	35	8.5	2023-01-17	strawberry	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0
13	7	35	6.5	2023-02-14	pineapple	1.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY k1 ORDER BY k2) AS cume_dist_k1_partition_k2 FROM cume_test ORDER BY v1;
-- result:
8	2	None	2.5	2023-01-29	None	0.25
8	6	None	None	2023-02-01	fig	0.5
8	7	None	3.5	2023-01-31	date	0.75
16	5	None	13.5	2023-02-26	bilberry	0.25
11	10	None	5.5	None	None	1.0
13	6	None	7.5	2023-02-15	quince	0.8
1	2	15	2.5	2023-01-02	banana	0.25
1	8	15	3.5	2023-01-03	cherry	0.75
1	10	15	2.5	2023-01-01	apple	1.0
8	8	15	3.5	2023-01-30	None	1.0
9	4	20	5.5	2023-02-07	None	0.5
9	5	20	4.5	2023-02-02	grape	1.0
1	7	20	3.5	2023-01-04	date	0.5
3	3	20	5.5	2023-01-08	kiwi	1.0
3	2	20	5.5	2023-01-09	lemon	0.5
10	3	20	None	None	kiwi	1.0
2	4	20	5.5	2023-01-07	honeydew	0.3333333333333333
2	5	20	4.5	2023-01-06	grape	0.6666666666666666
2	6	20	3.5	2023-01-05	fig	1.0
4	2	25	5.5	2023-01-10	mango	0.14285714285714285
11	9	30	5.5	2023-02-12	orange	0.5
4	9	30	5.5	2023-01-12	orange	0.8571428571428571
4	10	30	5.5	2023-01-11	nectarine	1.0
4	5	35	7.5	2023-01-16	raspberry	0.2857142857142857
4	6	35	7.5	2023-01-15	quince	0.42857142857142855
4	7	35	6.5	2023-01-14	pineapple	0.5714285714285714
4	8	35	6.5	2023-01-13	papaya	0.7142857142857143
12	8	35	6.5	2023-02-13	None	1.0
5	4	35	8.5	2023-01-17	strawberry	0.8
13	4	35	8.5	None	None	0.4
13	5	35	7.5	2023-02-16	None	0.6
13	7	35	6.5	2023-02-14	pineapple	1.0
14	1	40	None	2023-02-20	vanilla	0.3333333333333333
14	2	40	None	2023-02-19	ugli fruit	0.6666666666666666
5	1	40	8.5	2023-01-20	vanilla	0.2
5	2	40	8.5	2023-01-19	ugli fruit	0.4
5	3	40	8.5	2023-01-18	tangerine	0.6
13	3	40	8.5	2023-02-18	tangerine	0.2
14	10	45	9.5	2023-02-21	watermelon	1.0
15	9	45	10.5	None	xigua	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
10	2	45	5.5	2023-02-09	None	0.5
5	10	45	9.5	2023-01-21	watermelon	1.0
16	7	50	12.5	2023-02-24	None	0.75
16	8	50	11.5	None	None	1.0
6	7	50	12.5	2023-01-24	zucchini	0.6
6	8	50	11.5	2023-01-23	yumberry	0.8
16	6	55	13.5	2023-02-25	acerola	0.5
6	6	55	13.5	2023-01-25	acerola	0.4
6	5	60	13.5	2023-01-26	bilberry	0.2
17	3	60	14.5	2023-02-28	dewberry	0.5
17	4	60	13.5	None	cloudberry	1.0
7	3	60	14.5	2023-01-28	dewberry	0.5
7	4	60	13.5	2023-01-27	cloudberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY v4 ORDER BY v3) AS cume_dist_v4_partition_v3 FROM cume_test ORDER BY v2 DESC;
-- result:
7	3	60	14.5	2023-01-28	dewberry	0.5
17	3	60	14.5	2023-02-28	dewberry	1.0
6	5	60	13.5	2023-01-26	bilberry	0.5
16	5	None	13.5	2023-02-26	bilberry	1.0
17	4	60	13.5	None	cloudberry	0.5
7	4	60	13.5	2023-01-27	cloudberry	1.0
6	6	55	13.5	2023-01-25	acerola	0.5
16	6	55	13.5	2023-02-25	acerola	1.0
16	7	50	12.5	2023-02-24	None	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0
6	8	50	11.5	2023-01-23	yumberry	1.0
16	8	50	11.5	None	None	0.3
15	9	45	10.5	None	xigua	0.5
6	9	45	10.5	2023-01-22	xigua	1.0
5	10	45	9.5	2023-01-21	watermelon	0.5
14	10	45	9.5	2023-02-21	watermelon	1.0
5	4	35	8.5	2023-01-17	strawberry	1.0
5	2	40	8.5	2023-01-19	ugli fruit	0.5
13	4	35	8.5	None	None	0.3
5	3	40	8.5	2023-01-18	tangerine	0.5
13	3	40	8.5	2023-02-18	tangerine	1.0
5	1	40	8.5	2023-01-20	vanilla	0.5
4	5	35	7.5	2023-01-16	raspberry	1.0
13	5	35	7.5	2023-02-16	None	0.9
4	6	35	7.5	2023-01-15	quince	0.5
13	6	None	7.5	2023-02-15	quince	1.0
4	7	35	6.5	2023-01-14	pineapple	0.5
13	7	35	6.5	2023-02-14	pineapple	1.0
12	8	35	6.5	2023-02-13	None	0.8
4	8	35	6.5	2023-01-13	papaya	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
3	3	20	5.5	2023-01-08	kiwi	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
11	10	None	5.5	None	None	0.3
9	4	20	5.5	2023-02-07	None	0.6
10	2	45	5.5	2023-02-09	None	0.7
4	2	25	5.5	2023-01-10	mango	1.0
4	9	30	5.5	2023-01-12	orange	0.5
11	9	30	5.5	2023-02-12	orange	1.0
3	2	20	5.5	2023-01-09	lemon	1.0
2	5	20	4.5	2023-01-06	grape	0.5
9	5	20	4.5	2023-02-02	grape	1.0
2	6	20	3.5	2023-01-05	fig	0.5
1	7	20	3.5	2023-01-04	date	0.5
8	7	None	3.5	2023-01-31	date	1.0
8	8	15	3.5	2023-01-30	None	0.5
1	8	15	3.5	2023-01-03	cherry	1.0
1	10	15	2.5	2023-01-01	apple	1.0
8	2	None	2.5	2023-01-29	None	0.4
1	2	15	2.5	2023-01-02	banana	1.0
8	6	None	None	2023-02-01	fig	1.0
10	3	20	None	None	kiwi	0.5
14	2	40	None	2023-02-19	ugli fruit	1.0
14	1	40	None	2023-02-20	vanilla	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (PARTITION BY v1 ORDER BY v3) AS percent_rank_v1_partition_v3 FROM cume_test;
-- result:
17	4	60	13.5	None	cloudberry	0.0
6	5	60	13.5	2023-01-26	bilberry	0.25
7	4	60	13.5	2023-01-27	cloudberry	0.5
7	3	60	14.5	2023-01-28	dewberry	0.75
17	3	60	14.5	2023-02-28	dewberry	1.0
5	3	40	8.5	2023-01-18	tangerine	0.0
5	2	40	8.5	2023-01-19	ugli fruit	0.2
5	1	40	8.5	2023-01-20	vanilla	0.4
13	3	40	8.5	2023-02-18	tangerine	0.6
14	2	40	None	2023-02-19	ugli fruit	0.8
14	1	40	None	2023-02-20	vanilla	1.0
4	10	30	5.5	2023-01-11	nectarine	0.0
4	9	30	5.5	2023-01-12	orange	0.5
11	9	30	5.5	2023-02-12	orange	1.0
16	8	50	11.5	None	None	0.0
6	8	50	11.5	2023-01-23	yumberry	0.3333333333333333
6	7	50	12.5	2023-01-24	zucchini	0.6666666666666666
16	7	50	12.5	2023-02-24	None	1.0
11	10	None	5.5	None	None	0.0
8	2	None	2.5	2023-01-29	None	0.2
8	7	None	3.5	2023-01-31	date	0.4
8	6	None	None	2023-02-01	fig	0.6
13	6	None	7.5	2023-02-15	quince	0.8
16	5	None	13.5	2023-02-26	bilberry	1.0
15	9	45	10.5	None	xigua	0.0
5	10	45	9.5	2023-01-21	watermelon	0.25
6	9	45	10.5	2023-01-22	xigua	0.5
10	2	45	5.5	2023-02-09	None	0.75
14	10	45	9.5	2023-02-21	watermelon	1.0
13	4	35	8.5	None	None	0.0
4	8	35	6.5	2023-01-13	papaya	0.125
4	7	35	6.5	2023-01-14	pineapple	0.25
4	6	35	7.5	2023-01-15	quince	0.375
4	5	35	7.5	2023-01-16	raspberry	0.5
5	4	35	8.5	2023-01-17	strawberry	0.625
12	8	35	6.5	2023-02-13	None	0.75
13	7	35	6.5	2023-02-14	pineapple	0.875
13	5	35	7.5	2023-02-16	None	1.0
10	3	20	None	None	kiwi	0.0
1	7	20	3.5	2023-01-04	date	0.125
2	6	20	3.5	2023-01-05	fig	0.25
2	5	20	4.5	2023-01-06	grape	0.375
2	4	20	5.5	2023-01-07	honeydew	0.5
3	3	20	5.5	2023-01-08	kiwi	0.625
3	2	20	5.5	2023-01-09	lemon	0.75
9	5	20	4.5	2023-02-02	grape	0.875
9	4	20	5.5	2023-02-07	None	1.0
4	2	25	5.5	2023-01-10	mango	0.0
6	6	55	13.5	2023-01-25	acerola	0.0
16	6	55	13.5	2023-02-25	acerola	1.0
1	10	15	2.5	2023-01-01	apple	0.0
1	2	15	2.5	2023-01-02	banana	0.3333333333333333
1	8	15	3.5	2023-01-03	cherry	0.6666666666666666
8	8	15	3.5	2023-01-30	None	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (PARTITION BY v2 ORDER BY v4) AS percent_rank_v2_partition_v4 FROM cume_test;
-- result:
9	5	20	4.5	2023-02-02	grape	0.0
2	5	20	4.5	2023-01-06	grape	0.0
16	8	50	11.5	None	None	0.0
6	8	50	11.5	2023-01-23	yumberry	1.0
6	9	45	10.5	2023-01-22	xigua	0.0
15	9	45	10.5	None	xigua	0.0
16	7	50	12.5	2023-02-24	None	0.0
6	7	50	12.5	2023-01-24	zucchini	1.0
8	6	None	None	2023-02-01	fig	0.0
10	3	20	None	None	kiwi	0.3333333333333333
14	2	40	None	2023-02-19	ugli fruit	0.6666666666666666
14	1	40	None	2023-02-20	vanilla	1.0
8	8	15	3.5	2023-01-30	None	0.0
1	8	15	3.5	2023-01-03	cherry	0.25
8	7	None	3.5	2023-01-31	date	0.5
1	7	20	3.5	2023-01-04	date	0.5
2	6	20	3.5	2023-01-05	fig	1.0
13	5	35	7.5	2023-02-16	None	0.0
4	6	35	7.5	2023-01-15	quince	0.3333333333333333
13	6	None	7.5	2023-02-15	quince	0.3333333333333333
4	5	35	7.5	2023-01-16	raspberry	1.0
5	10	45	9.5	2023-01-21	watermelon	0.0
14	10	45	9.5	2023-02-21	watermelon	0.0
13	4	35	8.5	None	None	0.0
5	4	35	8.5	2023-01-17	strawberry	0.2
5	3	40	8.5	2023-01-18	tangerine	0.4
13	3	40	8.5	2023-02-18	tangerine	0.4
5	2	40	8.5	2023-01-19	ugli fruit	0.8
5	1	40	8.5	2023-01-20	vanilla	1.0
8	2	None	2.5	2023-01-29	None	0.0
1	10	15	2.5	2023-01-01	apple	0.5
1	2	15	2.5	2023-01-02	banana	1.0
11	10	None	5.5	None	None	0.0
10	2	45	5.5	2023-02-09	None	0.0
9	4	20	5.5	2023-02-07	None	0.0
2	4	20	5.5	2023-01-07	honeydew	0.3333333333333333
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444
3	2	20	5.5	2023-01-09	lemon	0.5555555555555556
4	2	25	5.5	2023-01-10	mango	0.6666666666666666
4	10	30	5.5	2023-01-11	nectarine	0.7777777777777778
4	9	30	5.5	2023-01-12	orange	0.8888888888888888
11	9	30	5.5	2023-02-12	orange	0.8888888888888888
6	6	55	13.5	2023-01-25	acerola	0.0
16	6	55	13.5	2023-02-25	acerola	0.0
6	5	60	13.5	2023-01-26	bilberry	0.4
16	5	None	13.5	2023-02-26	bilberry	0.4
17	4	60	13.5	None	cloudberry	0.8
7	4	60	13.5	2023-01-27	cloudberry	0.8
12	8	35	6.5	2023-02-13	None	0.0
4	8	35	6.5	2023-01-13	papaya	0.3333333333333333
4	7	35	6.5	2023-01-14	pineapple	0.6666666666666666
13	7	35	6.5	2023-02-14	pineapple	0.6666666666666666
17	3	60	14.5	2023-02-28	dewberry	0.0
7	3	60	14.5	2023-01-28	dewberry	0.0
-- !result
SELECT *, PERCENT_RANK() OVER (PARTITION BY k2 ORDER BY k1) AS percent_rank_k2_partition_k1 FROM cume_test ORDER BY v1;
-- result:
16	5	None	13.5	2023-02-26	bilberry	1.0
11	10	None	5.5	None	None	0.75
8	2	None	2.5	2023-01-29	None	0.6666666666666666
13	6	None	7.5	2023-02-15	quince	0.8
8	6	None	None	2023-02-01	fig	0.6
8	7	None	3.5	2023-01-31	date	0.6
1	8	15	3.5	2023-01-03	cherry	0.0
8	8	15	3.5	2023-01-30	None	0.6
1	10	15	2.5	2023-01-01	apple	0.0
1	2	15	2.5	2023-01-02	banana	0.0
9	5	20	4.5	2023-02-02	grape	0.6
2	5	20	4.5	2023-01-06	grape	0.0
2	4	20	5.5	2023-01-07	honeydew	0.0
9	4	20	5.5	2023-02-07	None	0.6
3	3	20	5.5	2023-01-08	kiwi	0.0
10	3	20	None	None	kiwi	0.6
3	2	20	5.5	2023-01-09	lemon	0.16666666666666666
2	6	20	3.5	2023-01-05	fig	0.0
1	7	20	3.5	2023-01-04	date	0.0
4	2	25	5.5	2023-01-10	mango	0.3333333333333333
4	9	30	5.5	2023-01-12	orange	0.0
11	9	30	5.5	2023-02-12	orange	0.6666666666666666
4	10	30	5.5	2023-01-11	nectarine	0.25
4	5	35	7.5	2023-01-16	raspberry	0.2
13	5	35	7.5	2023-02-16	None	0.8
4	8	35	6.5	2023-01-13	papaya	0.2
12	8	35	6.5	2023-02-13	None	0.8
5	4	35	8.5	2023-01-17	strawberry	0.2
13	4	35	8.5	None	None	0.8
4	6	35	7.5	2023-01-15	quince	0.2
4	7	35	6.5	2023-01-14	pineapple	0.2
13	7	35	6.5	2023-02-14	pineapple	0.8
5	1	40	8.5	2023-01-20	vanilla	0.0
14	1	40	None	2023-02-20	vanilla	1.0
5	3	40	8.5	2023-01-18	tangerine	0.2
13	3	40	8.5	2023-02-18	tangerine	0.8
5	2	40	8.5	2023-01-19	ugli fruit	0.5
14	2	40	None	2023-02-19	ugli fruit	1.0
6	9	45	10.5	2023-01-22	xigua	0.3333333333333333
15	9	45	10.5	None	xigua	1.0
5	10	45	9.5	2023-01-21	watermelon	0.5
14	10	45	9.5	2023-02-21	watermelon	1.0
10	2	45	5.5	2023-02-09	None	0.8333333333333334
6	8	50	11.5	2023-01-23	yumberry	0.4
16	8	50	11.5	None	None	1.0
6	7	50	12.5	2023-01-24	zucchini	0.4
16	7	50	12.5	2023-02-24	None	1.0
6	6	55	13.5	2023-01-25	acerola	0.4
16	6	55	13.5	2023-02-25	acerola	1.0
6	5	60	13.5	2023-01-26	bilberry	0.4
7	4	60	13.5	2023-01-27	cloudberry	0.4
17	4	60	13.5	None	cloudberry	1.0
7	3	60	14.5	2023-01-28	dewberry	0.4
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, PERCENT_RANK() OVER (PARTITION BY v4 ORDER BY v2) AS percent_rank_v4_partition_v2 FROM cume_test ORDER BY v2 DESC;
-- result:
7	3	60	14.5	2023-01-28	dewberry	0.0
17	3	60	14.5	2023-02-28	dewberry	0.0
16	5	None	13.5	2023-02-26	bilberry	0.0
6	5	60	13.5	2023-01-26	bilberry	0.0
7	4	60	13.5	2023-01-27	cloudberry	0.0
17	4	60	13.5	None	cloudberry	0.0
16	6	55	13.5	2023-02-25	acerola	0.0
6	6	55	13.5	2023-01-25	acerola	0.0
16	7	50	12.5	2023-02-24	None	1.0
6	7	50	12.5	2023-01-24	zucchini	0.0
6	8	50	11.5	2023-01-23	yumberry	0.0
16	8	50	11.5	None	None	0.8888888888888888
6	9	45	10.5	2023-01-22	xigua	0.0
15	9	45	10.5	None	xigua	0.0
14	10	45	9.5	2023-02-21	watermelon	0.0
5	10	45	9.5	2023-01-21	watermelon	0.0
5	4	35	8.5	2023-01-17	strawberry	0.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
13	4	35	8.5	None	None	0.7777777777777778
13	3	40	8.5	2023-02-18	tangerine	0.0
5	3	40	8.5	2023-01-18	tangerine	0.0
5	1	40	8.5	2023-01-20	vanilla	1.0
4	5	35	7.5	2023-01-16	raspberry	0.0
13	5	35	7.5	2023-02-16	None	0.6666666666666666
4	6	35	7.5	2023-01-15	quince	0.0
13	6	None	7.5	2023-02-15	quince	0.0
4	7	35	6.5	2023-01-14	pineapple	0.0
13	7	35	6.5	2023-02-14	pineapple	0.0
12	8	35	6.5	2023-02-13	None	0.5555555555555556
4	8	35	6.5	2023-01-13	papaya	0.0
2	4	20	5.5	2023-01-07	honeydew	0.0
3	3	20	5.5	2023-01-08	kiwi	1.0
4	10	30	5.5	2023-01-11	nectarine	0.0
11	10	None	5.5	None	None	0.2222222222222222
9	4	20	5.5	2023-02-07	None	0.2222222222222222
10	2	45	5.5	2023-02-09	None	0.2222222222222222
4	2	25	5.5	2023-01-10	mango	0.0
4	9	30	5.5	2023-01-12	orange	0.0
11	9	30	5.5	2023-02-12	orange	0.0
3	2	20	5.5	2023-01-09	lemon	0.0
2	5	20	4.5	2023-01-06	grape	0.0
9	5	20	4.5	2023-02-02	grape	0.0
2	6	20	3.5	2023-01-05	fig	1.0
1	7	20	3.5	2023-01-04	date	0.0
8	7	None	3.5	2023-01-31	date	0.0
8	8	15	3.5	2023-01-30	None	0.1111111111111111
1	8	15	3.5	2023-01-03	cherry	0.0
1	10	15	2.5	2023-01-01	apple	0.0
8	2	None	2.5	2023-01-29	None	0.0
1	2	15	2.5	2023-01-02	banana	0.0
8	6	None	None	2023-02-01	fig	0.0
10	3	20	None	None	kiwi	0.0
14	2	40	None	2023-02-19	ugli fruit	0.0
14	1	40	None	2023-02-20	vanilla	0.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, ROW_NUMBER() OVER (ORDER BY v1, v3) AS row_number_v1_v3 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	1
8	2	None	2.5	2023-01-29	None	0.1111111111111111	2
8	7	None	3.5	2023-01-31	date	0.1111111111111111	3
8	6	None	None	2023-02-01	fig	0.1111111111111111	4
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	5
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	6
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	7
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	8
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	9
8	8	15	3.5	2023-01-30	None	0.18518518518518517	10
10	3	20	None	None	kiwi	0.35185185185185186	11
1	7	20	3.5	2023-01-04	date	0.35185185185185186	12
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	13
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	14
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	15
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	16
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	17
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	18
9	4	20	5.5	2023-02-07	None	0.35185185185185186	19
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	20
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	21
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	22
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	23
13	4	35	8.5	None	None	0.5925925925925926	24
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	25
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	26
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	27
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	28
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	29
12	8	35	6.5	2023-02-13	None	0.5925925925925926	30
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	31
13	5	35	7.5	2023-02-16	None	0.5925925925925926	32
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	33
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	34
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	35
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	36
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	37
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	38
15	9	45	10.5	None	xigua	0.7962962962962963	39
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	40
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	41
10	2	45	5.5	2023-02-09	None	0.7962962962962963	42
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	43
16	8	50	11.5	None	None	0.8703703703703703	44
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	45
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	46
16	7	50	12.5	2023-02-24	None	0.8703703703703703	47
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	48
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	49
17	4	60	13.5	None	cloudberry	1.0	50
6	5	60	13.5	2023-01-26	bilberry	1.0	51
7	4	60	13.5	2023-01-27	cloudberry	1.0	52
7	3	60	14.5	2023-01-28	dewberry	1.0	53
17	3	60	14.5	2023-02-28	dewberry	1.0	54
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2, RANK() OVER (ORDER BY v1) AS rank_v1 FROM cume_test;
-- result:
8	6	None	None	2023-02-01	fig	0.07407407407407407	1
8	2	None	2.5	2023-01-29	None	0.12962962962962962	1
8	7	None	3.5	2023-01-31	date	0.2222222222222222	1
11	10	None	5.5	None	None	0.4444444444444444	1
13	6	None	7.5	2023-02-15	quince	0.5925925925925926	1
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629	1
1	2	15	2.5	2023-01-02	banana	0.12962962962962962	7
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	7
8	8	15	3.5	2023-01-30	None	0.2222222222222222	7
1	8	15	3.5	2023-01-03	cherry	0.2222222222222222	7
10	3	20	None	None	kiwi	0.07407407407407407	11
2	6	20	3.5	2023-01-05	fig	0.2222222222222222	11
1	7	20	3.5	2023-01-04	date	0.2222222222222222	11
9	5	20	4.5	2023-02-02	grape	0.25925925925925924	11
2	5	20	4.5	2023-01-06	grape	0.25925925925925924	11
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444	11
9	4	20	5.5	2023-02-07	None	0.4444444444444444	11
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	11
2	4	20	5.5	2023-01-07	honeydew	0.4444444444444444	11
4	2	25	5.5	2023-01-10	mango	0.4444444444444444	20
4	10	30	5.5	2023-01-11	nectarine	0.4444444444444444	21
4	9	30	5.5	2023-01-12	orange	0.4444444444444444	21
11	9	30	5.5	2023-02-12	orange	0.4444444444444444	21
12	8	35	6.5	2023-02-13	None	0.5185185185185185	24
4	8	35	6.5	2023-01-13	papaya	0.5185185185185185	24
4	7	35	6.5	2023-01-14	pineapple	0.5185185185185185	24
13	7	35	6.5	2023-02-14	pineapple	0.5185185185185185	24
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	24
13	5	35	7.5	2023-02-16	None	0.5925925925925926	24
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	24
5	4	35	8.5	2023-01-17	strawberry	0.7037037037037037	24
13	4	35	8.5	None	None	0.7037037037037037	24
14	2	40	None	2023-02-19	ugli fruit	0.07407407407407407	33
14	1	40	None	2023-02-20	vanilla	0.07407407407407407	33
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	33
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	33
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	33
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	33
10	2	45	5.5	2023-02-09	None	0.4444444444444444	39
5	10	45	9.5	2023-01-21	watermelon	0.7407407407407407	39
14	10	45	9.5	2023-02-21	watermelon	0.7407407407407407	39
6	9	45	10.5	2023-01-22	xigua	0.7777777777777778	39
15	9	45	10.5	None	xigua	0.7777777777777778	39
6	8	50	11.5	2023-01-23	yumberry	0.8148148148148148	44
16	8	50	11.5	None	None	0.8148148148148148	44
6	7	50	12.5	2023-01-24	zucchini	0.8518518518518519	44
16	7	50	12.5	2023-02-24	None	0.8518518518518519	44
6	6	55	13.5	2023-01-25	acerola	0.9629629629629629	48
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	48
6	5	60	13.5	2023-01-26	bilberry	0.9629629629629629	50
17	4	60	13.5	None	cloudberry	0.9629629629629629	50
7	4	60	13.5	2023-01-27	cloudberry	0.9629629629629629	50
17	3	60	14.5	2023-02-28	dewberry	1.0	50
7	3	60	14.5	2023-01-28	dewberry	1.0	50
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3, DENSE_RANK() OVER (ORDER BY v1) AS dense_rank_v1 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	1
8	2	None	2.5	2023-01-29	None	0.6481481481481481	1
8	7	None	3.5	2023-01-31	date	0.6851851851851852	1
8	6	None	None	2023-02-01	fig	0.7037037037037037	1
13	6	None	7.5	2023-02-15	quince	0.8333333333333334	1
16	5	None	13.5	2023-02-26	bilberry	0.9814814814814815	1
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	2
1	2	15	2.5	2023-01-02	banana	0.14814814814814814	2
1	8	15	3.5	2023-01-03	cherry	0.16666666666666666	2
8	8	15	3.5	2023-01-30	None	0.6666666666666666	2
10	3	20	None	None	kiwi	0.1111111111111111	3
1	7	20	3.5	2023-01-04	date	0.18518518518518517	3
2	6	20	3.5	2023-01-05	fig	0.2037037037037037	3
2	5	20	4.5	2023-01-06	grape	0.2222222222222222	3
2	4	20	5.5	2023-01-07	honeydew	0.24074074074074073	3
3	3	20	5.5	2023-01-08	kiwi	0.25925925925925924	3
3	2	20	5.5	2023-01-09	lemon	0.2777777777777778	3
9	5	20	4.5	2023-02-02	grape	0.7222222222222222	3
9	4	20	5.5	2023-02-07	None	0.7407407407407407	3
4	2	25	5.5	2023-01-10	mango	0.2962962962962963	4
4	10	30	5.5	2023-01-11	nectarine	0.3148148148148148	5
4	9	30	5.5	2023-01-12	orange	0.3333333333333333	5
11	9	30	5.5	2023-02-12	orange	0.7777777777777778	5
13	4	35	8.5	None	None	0.1111111111111111	6
4	8	35	6.5	2023-01-13	papaya	0.35185185185185186	6
4	7	35	6.5	2023-01-14	pineapple	0.37037037037037035	6
4	6	35	7.5	2023-01-15	quince	0.3888888888888889	6
4	5	35	7.5	2023-01-16	raspberry	0.4074074074074074	6
5	4	35	8.5	2023-01-17	strawberry	0.42592592592592593	6
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148	6
12	8	35	6.5	2023-02-13	None	0.7962962962962963	6
13	5	35	7.5	2023-02-16	None	0.8518518518518519	6
5	3	40	8.5	2023-01-18	tangerine	0.4444444444444444	7
5	2	40	8.5	2023-01-19	ugli fruit	0.46296296296296297	7
5	1	40	8.5	2023-01-20	vanilla	0.48148148148148145	7
13	3	40	8.5	2023-02-18	tangerine	0.8703703703703703	7
14	2	40	None	2023-02-19	ugli fruit	0.8888888888888888	7
14	1	40	None	2023-02-20	vanilla	0.9074074074074074	7
15	9	45	10.5	None	xigua	0.1111111111111111	8
5	10	45	9.5	2023-01-21	watermelon	0.5	8
6	9	45	10.5	2023-01-22	xigua	0.5185185185185185	8
10	2	45	5.5	2023-02-09	None	0.7592592592592593	8
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	8
16	8	50	11.5	None	None	0.1111111111111111	9
6	8	50	11.5	2023-01-23	yumberry	0.5370370370370371	9
6	7	50	12.5	2023-01-24	zucchini	0.5555555555555556	9
16	7	50	12.5	2023-02-24	None	0.9444444444444444	9
6	6	55	13.5	2023-01-25	acerola	0.5740740740740741	10
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	10
17	4	60	13.5	None	cloudberry	0.1111111111111111	11
6	5	60	13.5	2023-01-26	bilberry	0.5925925925925926	11
7	4	60	13.5	2023-01-27	cloudberry	0.6111111111111112	11
7	3	60	14.5	2023-01-28	dewberry	0.6296296296296297	11
17	3	60	14.5	2023-02-28	dewberry	1.0	11
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4, NTILE(5) OVER (ORDER BY v1, v3) AS ntile_v1 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.18518518518518517	1
8	2	None	2.5	2023-01-29	None	0.18518518518518517	1
8	7	None	3.5	2023-01-31	date	0.3888888888888889	1
8	6	None	None	2023-02-01	fig	0.46296296296296297	1
13	6	None	7.5	2023-02-15	quince	0.7407407407407407	1
16	5	None	13.5	2023-02-26	bilberry	0.2962962962962963	1
1	10	15	2.5	2023-01-01	apple	0.24074074074074073	1
1	2	15	2.5	2023-01-02	banana	0.25925925925925924	1
1	8	15	3.5	2023-01-03	cherry	0.3148148148148148	1
8	8	15	3.5	2023-01-30	None	0.18518518518518517	1
10	3	20	None	None	kiwi	0.5555555555555556	1
1	7	20	3.5	2023-01-04	date	0.3888888888888889	2
2	6	20	3.5	2023-01-05	fig	0.46296296296296297	2
2	5	20	4.5	2023-01-06	grape	0.5	2
2	4	20	5.5	2023-01-07	honeydew	0.5185185185185185	2
3	3	20	5.5	2023-01-08	kiwi	0.5555555555555556	2
3	2	20	5.5	2023-01-09	lemon	0.5740740740740741	2
9	5	20	4.5	2023-02-02	grape	0.5	2
9	4	20	5.5	2023-02-07	None	0.18518518518518517	2
4	2	25	5.5	2023-01-10	mango	0.5925925925925926	2
4	10	30	5.5	2023-01-11	nectarine	0.6111111111111112	2
4	9	30	5.5	2023-01-12	orange	0.6481481481481481	2
11	9	30	5.5	2023-02-12	orange	0.6481481481481481	3
13	4	35	8.5	None	None	0.18518518518518517	3
4	8	35	6.5	2023-01-13	papaya	0.6666666666666666	3
4	7	35	6.5	2023-01-14	pineapple	0.7037037037037037	3
4	6	35	7.5	2023-01-15	quince	0.7407407407407407	3
4	5	35	7.5	2023-01-16	raspberry	0.7592592592592593	3
5	4	35	8.5	2023-01-17	strawberry	0.7777777777777778	3
12	8	35	6.5	2023-02-13	None	0.18518518518518517	3
13	7	35	6.5	2023-02-14	pineapple	0.7037037037037037	3
13	5	35	7.5	2023-02-16	None	0.18518518518518517	3
5	3	40	8.5	2023-01-18	tangerine	0.8148148148148148	3
5	2	40	8.5	2023-01-19	ugli fruit	0.8518518518518519	4
5	1	40	8.5	2023-01-20	vanilla	0.8888888888888888	4
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148	4
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519	4
14	1	40	None	2023-02-20	vanilla	0.8888888888888888	4
15	9	45	10.5	None	xigua	0.9629629629629629	4
5	10	45	9.5	2023-01-21	watermelon	0.9259259259259259	4
6	9	45	10.5	2023-01-22	xigua	0.9629629629629629	4
10	2	45	5.5	2023-02-09	None	0.18518518518518517	4
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	4
16	8	50	11.5	None	None	0.18518518518518517	4
6	8	50	11.5	2023-01-23	yumberry	0.9814814814814815	5
6	7	50	12.5	2023-01-24	zucchini	1.0	5
16	7	50	12.5	2023-02-24	None	0.18518518518518517	5
6	6	55	13.5	2023-01-25	acerola	0.2222222222222222	5
16	6	55	13.5	2023-02-25	acerola	0.2222222222222222	5
17	4	60	13.5	None	cloudberry	0.35185185185185186	5
6	5	60	13.5	2023-01-26	bilberry	0.2962962962962963	5
7	4	60	13.5	2023-01-27	cloudberry	0.35185185185185186	5
7	3	60	14.5	2023-01-28	dewberry	0.42592592592592593	5
17	3	60	14.5	2023-02-28	dewberry	0.42592592592592593	5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, LAG(v2) OVER (ORDER BY v1, v3) AS lag_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	None
8	2	None	2.5	2023-01-29	None	0.1111111111111111	5.5
8	7	None	3.5	2023-01-31	date	0.1111111111111111	2.5
8	6	None	None	2023-02-01	fig	0.1111111111111111	3.5
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	None
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	7.5
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	13.5
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	2.5
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	2.5
8	8	15	3.5	2023-01-30	None	0.18518518518518517	3.5
10	3	20	None	None	kiwi	0.35185185185185186	3.5
1	7	20	3.5	2023-01-04	date	0.35185185185185186	None
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	3.5
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	3.5
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	4.5
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	5.5
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	5.5
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	5.5
9	4	20	5.5	2023-02-07	None	0.35185185185185186	4.5
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	5.5
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	5.5
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	5.5
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	5.5
13	4	35	8.5	None	None	0.5925925925925926	5.5
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	8.5
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	6.5
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	6.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	7.5
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	7.5
12	8	35	6.5	2023-02-13	None	0.5925925925925926	8.5
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	6.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	6.5
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	7.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	8.5
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	8.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	8.5
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	8.5
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	None
15	9	45	10.5	None	xigua	0.7962962962962963	None
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	10.5
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	9.5
10	2	45	5.5	2023-02-09	None	0.7962962962962963	10.5
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	5.5
16	8	50	11.5	None	None	0.8703703703703703	9.5
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	11.5
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	11.5
16	7	50	12.5	2023-02-24	None	0.8703703703703703	12.5
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	12.5
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	13.5
17	4	60	13.5	None	cloudberry	1.0	13.5
6	5	60	13.5	2023-01-26	bilberry	1.0	13.5
7	4	60	13.5	2023-01-27	cloudberry	1.0	13.5
7	3	60	14.5	2023-01-28	dewberry	1.0	13.5
17	3	60	14.5	2023-02-28	dewberry	1.0	14.5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2, LEAD(v2) OVER (ORDER BY v1, v3) AS lead_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.4444444444444444	2.5
8	2	None	2.5	2023-01-29	None	0.12962962962962962	3.5
8	7	None	3.5	2023-01-31	date	0.2222222222222222	None
8	6	None	None	2023-02-01	fig	0.07407407407407407	7.5
13	6	None	7.5	2023-02-15	quince	0.5925925925925926	13.5
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629	2.5
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	2.5
1	2	15	2.5	2023-01-02	banana	0.12962962962962962	3.5
1	8	15	3.5	2023-01-03	cherry	0.2222222222222222	3.5
8	8	15	3.5	2023-01-30	None	0.2222222222222222	None
10	3	20	None	None	kiwi	0.07407407407407407	3.5
1	7	20	3.5	2023-01-04	date	0.2222222222222222	3.5
2	6	20	3.5	2023-01-05	fig	0.2222222222222222	4.5
2	5	20	4.5	2023-01-06	grape	0.25925925925925924	5.5
2	4	20	5.5	2023-01-07	honeydew	0.4444444444444444	5.5
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444	5.5
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	4.5
9	5	20	4.5	2023-02-02	grape	0.25925925925925924	5.5
9	4	20	5.5	2023-02-07	None	0.4444444444444444	5.5
4	2	25	5.5	2023-01-10	mango	0.4444444444444444	5.5
4	10	30	5.5	2023-01-11	nectarine	0.4444444444444444	5.5
4	9	30	5.5	2023-01-12	orange	0.4444444444444444	5.5
11	9	30	5.5	2023-02-12	orange	0.4444444444444444	8.5
13	4	35	8.5	None	None	0.7037037037037037	6.5
4	8	35	6.5	2023-01-13	papaya	0.5185185185185185	6.5
4	7	35	6.5	2023-01-14	pineapple	0.5185185185185185	7.5
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	7.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	8.5
5	4	35	8.5	2023-01-17	strawberry	0.7037037037037037	6.5
12	8	35	6.5	2023-02-13	None	0.5185185185185185	6.5
13	7	35	6.5	2023-02-14	pineapple	0.5185185185185185	7.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	8.5
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	8.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	8.5
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	8.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	None
14	2	40	None	2023-02-19	ugli fruit	0.07407407407407407	None
14	1	40	None	2023-02-20	vanilla	0.07407407407407407	10.5
15	9	45	10.5	None	xigua	0.7777777777777778	9.5
5	10	45	9.5	2023-01-21	watermelon	0.7407407407407407	10.5
6	9	45	10.5	2023-01-22	xigua	0.7777777777777778	5.5
10	2	45	5.5	2023-02-09	None	0.4444444444444444	9.5
14	10	45	9.5	2023-02-21	watermelon	0.7407407407407407	11.5
16	8	50	11.5	None	None	0.8148148148148148	11.5
6	8	50	11.5	2023-01-23	yumberry	0.8148148148148148	12.5
6	7	50	12.5	2023-01-24	zucchini	0.8518518518518519	12.5
16	7	50	12.5	2023-02-24	None	0.8518518518518519	13.5
6	6	55	13.5	2023-01-25	acerola	0.9629629629629629	13.5
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	13.5
17	4	60	13.5	None	cloudberry	0.9629629629629629	13.5
6	5	60	13.5	2023-01-26	bilberry	0.9629629629629629	13.5
7	4	60	13.5	2023-01-27	cloudberry	0.9629629629629629	14.5
7	3	60	14.5	2023-01-28	dewberry	1.0	14.5
17	3	60	14.5	2023-02-28	dewberry	1.0	None
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3, FIRST_VALUE(v2) OVER (ORDER BY v1, v3) AS first_value_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	5.5
8	2	None	2.5	2023-01-29	None	0.6481481481481481	5.5
8	7	None	3.5	2023-01-31	date	0.6851851851851852	5.5
8	6	None	None	2023-02-01	fig	0.7037037037037037	5.5
13	6	None	7.5	2023-02-15	quince	0.8333333333333334	5.5
16	5	None	13.5	2023-02-26	bilberry	0.9814814814814815	5.5
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	5.5
1	2	15	2.5	2023-01-02	banana	0.14814814814814814	5.5
1	8	15	3.5	2023-01-03	cherry	0.16666666666666666	5.5
8	8	15	3.5	2023-01-30	None	0.6666666666666666	5.5
10	3	20	None	None	kiwi	0.1111111111111111	5.5
1	7	20	3.5	2023-01-04	date	0.18518518518518517	5.5
2	6	20	3.5	2023-01-05	fig	0.2037037037037037	5.5
2	5	20	4.5	2023-01-06	grape	0.2222222222222222	5.5
2	4	20	5.5	2023-01-07	honeydew	0.24074074074074073	5.5
3	3	20	5.5	2023-01-08	kiwi	0.25925925925925924	5.5
3	2	20	5.5	2023-01-09	lemon	0.2777777777777778	5.5
9	5	20	4.5	2023-02-02	grape	0.7222222222222222	5.5
9	4	20	5.5	2023-02-07	None	0.7407407407407407	5.5
4	2	25	5.5	2023-01-10	mango	0.2962962962962963	5.5
4	10	30	5.5	2023-01-11	nectarine	0.3148148148148148	5.5
4	9	30	5.5	2023-01-12	orange	0.3333333333333333	5.5
11	9	30	5.5	2023-02-12	orange	0.7777777777777778	5.5
13	4	35	8.5	None	None	0.1111111111111111	5.5
4	8	35	6.5	2023-01-13	papaya	0.35185185185185186	5.5
4	7	35	6.5	2023-01-14	pineapple	0.37037037037037035	5.5
4	6	35	7.5	2023-01-15	quince	0.3888888888888889	5.5
4	5	35	7.5	2023-01-16	raspberry	0.4074074074074074	5.5
5	4	35	8.5	2023-01-17	strawberry	0.42592592592592593	5.5
12	8	35	6.5	2023-02-13	None	0.7962962962962963	5.5
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148	5.5
13	5	35	7.5	2023-02-16	None	0.8518518518518519	5.5
5	3	40	8.5	2023-01-18	tangerine	0.4444444444444444	5.5
5	2	40	8.5	2023-01-19	ugli fruit	0.46296296296296297	5.5
5	1	40	8.5	2023-01-20	vanilla	0.48148148148148145	5.5
13	3	40	8.5	2023-02-18	tangerine	0.8703703703703703	5.5
14	2	40	None	2023-02-19	ugli fruit	0.8888888888888888	5.5
14	1	40	None	2023-02-20	vanilla	0.9074074074074074	5.5
15	9	45	10.5	None	xigua	0.1111111111111111	5.5
5	10	45	9.5	2023-01-21	watermelon	0.5	5.5
6	9	45	10.5	2023-01-22	xigua	0.5185185185185185	5.5
10	2	45	5.5	2023-02-09	None	0.7592592592592593	5.5
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	5.5
16	8	50	11.5	None	None	0.1111111111111111	5.5
6	8	50	11.5	2023-01-23	yumberry	0.5370370370370371	5.5
6	7	50	12.5	2023-01-24	zucchini	0.5555555555555556	5.5
16	7	50	12.5	2023-02-24	None	0.9444444444444444	5.5
6	6	55	13.5	2023-01-25	acerola	0.5740740740740741	5.5
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	5.5
17	4	60	13.5	None	cloudberry	0.1111111111111111	5.5
6	5	60	13.5	2023-01-26	bilberry	0.5925925925925926	5.5
7	4	60	13.5	2023-01-27	cloudberry	0.6111111111111112	5.5
7	3	60	14.5	2023-01-28	dewberry	0.6296296296296297	5.5
17	3	60	14.5	2023-02-28	dewberry	1.0	5.5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4, LAST_VALUE(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_value_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.18518518518518517	14.5
8	2	None	2.5	2023-01-29	None	0.18518518518518517	14.5
8	7	None	3.5	2023-01-31	date	0.3888888888888889	14.5
8	6	None	None	2023-02-01	fig	0.46296296296296297	14.5
13	6	None	7.5	2023-02-15	quince	0.7407407407407407	14.5
16	5	None	13.5	2023-02-26	bilberry	0.2962962962962963	14.5
1	10	15	2.5	2023-01-01	apple	0.24074074074074073	14.5
1	2	15	2.5	2023-01-02	banana	0.25925925925925924	14.5
1	8	15	3.5	2023-01-03	cherry	0.3148148148148148	14.5
8	8	15	3.5	2023-01-30	None	0.18518518518518517	14.5
10	3	20	None	None	kiwi	0.5555555555555556	14.5
1	7	20	3.5	2023-01-04	date	0.3888888888888889	14.5
2	6	20	3.5	2023-01-05	fig	0.46296296296296297	14.5
2	5	20	4.5	2023-01-06	grape	0.5	14.5
2	4	20	5.5	2023-01-07	honeydew	0.5185185185185185	14.5
3	3	20	5.5	2023-01-08	kiwi	0.5555555555555556	14.5
3	2	20	5.5	2023-01-09	lemon	0.5740740740740741	14.5
9	5	20	4.5	2023-02-02	grape	0.5	14.5
9	4	20	5.5	2023-02-07	None	0.18518518518518517	14.5
4	2	25	5.5	2023-01-10	mango	0.5925925925925926	14.5
4	10	30	5.5	2023-01-11	nectarine	0.6111111111111112	14.5
4	9	30	5.5	2023-01-12	orange	0.6481481481481481	14.5
11	9	30	5.5	2023-02-12	orange	0.6481481481481481	14.5
13	4	35	8.5	None	None	0.18518518518518517	14.5
4	8	35	6.5	2023-01-13	papaya	0.6666666666666666	14.5
4	7	35	6.5	2023-01-14	pineapple	0.7037037037037037	14.5
4	6	35	7.5	2023-01-15	quince	0.7407407407407407	14.5
4	5	35	7.5	2023-01-16	raspberry	0.7592592592592593	14.5
5	4	35	8.5	2023-01-17	strawberry	0.7777777777777778	14.5
12	8	35	6.5	2023-02-13	None	0.18518518518518517	14.5
13	7	35	6.5	2023-02-14	pineapple	0.7037037037037037	14.5
13	5	35	7.5	2023-02-16	None	0.18518518518518517	14.5
5	3	40	8.5	2023-01-18	tangerine	0.8148148148148148	14.5
5	2	40	8.5	2023-01-19	ugli fruit	0.8518518518518519	14.5
5	1	40	8.5	2023-01-20	vanilla	0.8888888888888888	14.5
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148	14.5
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519	14.5
14	1	40	None	2023-02-20	vanilla	0.8888888888888888	14.5
15	9	45	10.5	None	xigua	0.9629629629629629	14.5
5	10	45	9.5	2023-01-21	watermelon	0.9259259259259259	14.5
6	9	45	10.5	2023-01-22	xigua	0.9629629629629629	14.5
10	2	45	5.5	2023-02-09	None	0.18518518518518517	14.5
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	14.5
16	8	50	11.5	None	None	0.18518518518518517	14.5
6	8	50	11.5	2023-01-23	yumberry	0.9814814814814815	14.5
6	7	50	12.5	2023-01-24	zucchini	1.0	14.5
16	7	50	12.5	2023-02-24	None	0.18518518518518517	14.5
6	6	55	13.5	2023-01-25	acerola	0.2222222222222222	14.5
16	6	55	13.5	2023-02-25	acerola	0.2222222222222222	14.5
17	4	60	13.5	None	cloudberry	0.35185185185185186	14.5
6	5	60	13.5	2023-01-26	bilberry	0.2962962962962963	14.5
7	4	60	13.5	2023-01-27	cloudberry	0.35185185185185186	14.5
7	3	60	14.5	2023-01-28	dewberry	0.42592592592592593	14.5
17	3	60	14.5	2023-02-28	dewberry	0.42592592592592593	14.5
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v1) AS percent_rank_v1, ROW_NUMBER() OVER (ORDER BY v1, v3) AS row_number_v1_v3 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.0	1
8	2	None	2.5	2023-01-29	None	0.0	2
8	7	None	3.5	2023-01-31	date	0.0	3
8	6	None	None	2023-02-01	fig	0.0	4
13	6	None	7.5	2023-02-15	quince	0.0	5
16	5	None	13.5	2023-02-26	bilberry	0.0	6
1	10	15	2.5	2023-01-01	apple	0.11320754716981132	7
1	2	15	2.5	2023-01-02	banana	0.11320754716981132	8
1	8	15	3.5	2023-01-03	cherry	0.11320754716981132	9
8	8	15	3.5	2023-01-30	None	0.11320754716981132	10
10	3	20	None	None	kiwi	0.18867924528301888	11
1	7	20	3.5	2023-01-04	date	0.18867924528301888	12
2	6	20	3.5	2023-01-05	fig	0.18867924528301888	13
2	5	20	4.5	2023-01-06	grape	0.18867924528301888	14
2	4	20	5.5	2023-01-07	honeydew	0.18867924528301888	15
3	3	20	5.5	2023-01-08	kiwi	0.18867924528301888	16
3	2	20	5.5	2023-01-09	lemon	0.18867924528301888	17
9	5	20	4.5	2023-02-02	grape	0.18867924528301888	18
9	4	20	5.5	2023-02-07	None	0.18867924528301888	19
4	2	25	5.5	2023-01-10	mango	0.3584905660377358	20
4	10	30	5.5	2023-01-11	nectarine	0.37735849056603776	21
4	9	30	5.5	2023-01-12	orange	0.37735849056603776	22
11	9	30	5.5	2023-02-12	orange	0.37735849056603776	23
13	4	35	8.5	None	None	0.4339622641509434	24
4	8	35	6.5	2023-01-13	papaya	0.4339622641509434	25
4	7	35	6.5	2023-01-14	pineapple	0.4339622641509434	26
4	6	35	7.5	2023-01-15	quince	0.4339622641509434	27
4	5	35	7.5	2023-01-16	raspberry	0.4339622641509434	28
5	4	35	8.5	2023-01-17	strawberry	0.4339622641509434	29
12	8	35	6.5	2023-02-13	None	0.4339622641509434	30
13	7	35	6.5	2023-02-14	pineapple	0.4339622641509434	31
13	5	35	7.5	2023-02-16	None	0.4339622641509434	32
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604	33
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604	34
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604	35
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604	36
14	2	40	None	2023-02-19	ugli fruit	0.6037735849056604	37
14	1	40	None	2023-02-20	vanilla	0.6037735849056604	38
15	9	45	10.5	None	xigua	0.7169811320754716	39
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716	40
6	9	45	10.5	2023-01-22	xigua	0.7169811320754716	41
10	2	45	5.5	2023-02-09	None	0.7169811320754716	42
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716	43
16	8	50	11.5	None	None	0.8113207547169812	44
6	8	50	11.5	2023-01-23	yumberry	0.8113207547169812	45
6	7	50	12.5	2023-01-24	zucchini	0.8113207547169812	46
16	7	50	12.5	2023-02-24	None	0.8113207547169812	47
6	6	55	13.5	2023-01-25	acerola	0.8867924528301887	48
16	6	55	13.5	2023-02-25	acerola	0.8867924528301887	49
17	4	60	13.5	None	cloudberry	0.9245283018867925	50
6	5	60	13.5	2023-01-26	bilberry	0.9245283018867925	51
7	4	60	13.5	2023-01-27	cloudberry	0.9245283018867925	52
7	3	60	14.5	2023-01-28	dewberry	0.9245283018867925	53
17	3	60	14.5	2023-02-28	dewberry	0.9245283018867925	54
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v2) AS percent_rank_v2, RANK() OVER (ORDER BY v1) AS rank_v1 FROM cume_test;
-- result:
8	6	None	None	2023-02-01	fig	0.0	1
8	2	None	2.5	2023-01-29	None	0.07547169811320754	1
8	7	None	3.5	2023-01-31	date	0.1320754716981132	1
11	10	None	5.5	None	None	0.2641509433962264	1
13	6	None	7.5	2023-02-15	quince	0.5283018867924528	1
16	5	None	13.5	2023-02-26	bilberry	0.8679245283018868	1
1	2	15	2.5	2023-01-02	banana	0.07547169811320754	7
1	10	15	2.5	2023-01-01	apple	0.07547169811320754	7
8	8	15	3.5	2023-01-30	None	0.1320754716981132	7
1	8	15	3.5	2023-01-03	cherry	0.1320754716981132	7
10	3	20	None	None	kiwi	0.0	11
2	6	20	3.5	2023-01-05	fig	0.1320754716981132	11
1	7	20	3.5	2023-01-04	date	0.1320754716981132	11
9	5	20	4.5	2023-02-02	grape	0.22641509433962265	11
2	5	20	4.5	2023-01-06	grape	0.22641509433962265	11
3	3	20	5.5	2023-01-08	kiwi	0.2641509433962264	11
9	4	20	5.5	2023-02-07	None	0.2641509433962264	11
3	2	20	5.5	2023-01-09	lemon	0.2641509433962264	11
2	4	20	5.5	2023-01-07	honeydew	0.2641509433962264	11
4	2	25	5.5	2023-01-10	mango	0.2641509433962264	20
4	10	30	5.5	2023-01-11	nectarine	0.2641509433962264	21
4	9	30	5.5	2023-01-12	orange	0.2641509433962264	21
11	9	30	5.5	2023-02-12	orange	0.2641509433962264	21
12	8	35	6.5	2023-02-13	None	0.4528301886792453	24
4	8	35	6.5	2023-01-13	papaya	0.4528301886792453	24
4	7	35	6.5	2023-01-14	pineapple	0.4528301886792453	24
13	7	35	6.5	2023-02-14	pineapple	0.4528301886792453	24
4	6	35	7.5	2023-01-15	quince	0.5283018867924528	24
13	5	35	7.5	2023-02-16	None	0.5283018867924528	24
4	5	35	7.5	2023-01-16	raspberry	0.5283018867924528	24
5	4	35	8.5	2023-01-17	strawberry	0.6037735849056604	24
13	4	35	8.5	None	None	0.6037735849056604	24
14	2	40	None	2023-02-19	ugli fruit	0.0	33
14	1	40	None	2023-02-20	vanilla	0.0	33
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604	33
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604	33
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604	33
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604	33
10	2	45	5.5	2023-02-09	None	0.2641509433962264	39
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716	39
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716	39
6	9	45	10.5	2023-01-22	xigua	0.7547169811320755	39
15	9	45	10.5	None	xigua	0.7547169811320755	39
6	8	50	11.5	2023-01-23	yumberry	0.7924528301886793	44
16	8	50	11.5	None	None	0.7924528301886793	44
6	7	50	12.5	2023-01-24	zucchini	0.8301886792452831	44
16	7	50	12.5	2023-02-24	None	0.8301886792452831	44
6	6	55	13.5	2023-01-25	acerola	0.8679245283018868	48
16	6	55	13.5	2023-02-25	acerola	0.8679245283018868	48
6	5	60	13.5	2023-01-26	bilberry	0.8679245283018868	50
17	4	60	13.5	None	cloudberry	0.8679245283018868	50
7	4	60	13.5	2023-01-27	cloudberry	0.8679245283018868	50
17	3	60	14.5	2023-02-28	dewberry	0.9811320754716981	50
7	3	60	14.5	2023-01-28	dewberry	0.9811320754716981	50
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v3) AS percent_rank_v3, DENSE_RANK() OVER (ORDER BY v1) AS dense_rank_v1 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.0	1
8	2	None	2.5	2023-01-29	None	0.6415094339622641	1
8	7	None	3.5	2023-01-31	date	0.6792452830188679	1
8	6	None	None	2023-02-01	fig	0.6981132075471698	1
13	6	None	7.5	2023-02-15	quince	0.8301886792452831	1
16	5	None	13.5	2023-02-26	bilberry	0.9811320754716981	1
1	10	15	2.5	2023-01-01	apple	0.11320754716981132	2
1	2	15	2.5	2023-01-02	banana	0.1320754716981132	2
1	8	15	3.5	2023-01-03	cherry	0.1509433962264151	2
8	8	15	3.5	2023-01-30	None	0.660377358490566	2
10	3	20	None	None	kiwi	0.0	3
1	7	20	3.5	2023-01-04	date	0.16981132075471697	3
2	6	20	3.5	2023-01-05	fig	0.18867924528301888	3
2	5	20	4.5	2023-01-06	grape	0.20754716981132076	3
2	4	20	5.5	2023-01-07	honeydew	0.22641509433962265	3
3	3	20	5.5	2023-01-08	kiwi	0.24528301886792453	3
3	2	20	5.5	2023-01-09	lemon	0.2641509433962264	3
9	5	20	4.5	2023-02-02	grape	0.7169811320754716	3
9	4	20	5.5	2023-02-07	None	0.7358490566037735	3
4	2	25	5.5	2023-01-10	mango	0.2830188679245283	4
4	10	30	5.5	2023-01-11	nectarine	0.3018867924528302	5
4	9	30	5.5	2023-01-12	orange	0.32075471698113206	5
11	9	30	5.5	2023-02-12	orange	0.7735849056603774	5
13	4	35	8.5	None	None	0.0	6
4	8	35	6.5	2023-01-13	papaya	0.33962264150943394	6
4	7	35	6.5	2023-01-14	pineapple	0.3584905660377358	6
4	6	35	7.5	2023-01-15	quince	0.37735849056603776	6
4	5	35	7.5	2023-01-16	raspberry	0.39622641509433965	6
5	4	35	8.5	2023-01-17	strawberry	0.41509433962264153	6
13	7	35	6.5	2023-02-14	pineapple	0.8113207547169812	6
12	8	35	6.5	2023-02-13	None	0.7924528301886793	6
13	5	35	7.5	2023-02-16	None	0.8490566037735849	6
5	3	40	8.5	2023-01-18	tangerine	0.4339622641509434	7
5	2	40	8.5	2023-01-19	ugli fruit	0.4528301886792453	7
5	1	40	8.5	2023-01-20	vanilla	0.4716981132075472	7
13	3	40	8.5	2023-02-18	tangerine	0.8679245283018868	7
14	2	40	None	2023-02-19	ugli fruit	0.8867924528301887	7
14	1	40	None	2023-02-20	vanilla	0.9056603773584906	7
15	9	45	10.5	None	xigua	0.0	8
5	10	45	9.5	2023-01-21	watermelon	0.49056603773584906	8
6	9	45	10.5	2023-01-22	xigua	0.5094339622641509	8
10	2	45	5.5	2023-02-09	None	0.7547169811320755	8
14	10	45	9.5	2023-02-21	watermelon	0.9245283018867925	8
16	8	50	11.5	None	None	0.0	9
6	8	50	11.5	2023-01-23	yumberry	0.5283018867924528	9
6	7	50	12.5	2023-01-24	zucchini	0.5471698113207547	9
16	7	50	12.5	2023-02-24	None	0.9433962264150944	9
6	6	55	13.5	2023-01-25	acerola	0.5660377358490566	10
16	6	55	13.5	2023-02-25	acerola	0.9622641509433962	10
17	4	60	13.5	None	cloudberry	0.0	11
6	5	60	13.5	2023-01-26	bilberry	0.5849056603773585	11
7	4	60	13.5	2023-01-27	cloudberry	0.6037735849056604	11
7	3	60	14.5	2023-01-28	dewberry	0.6226415094339622	11
17	3	60	14.5	2023-02-28	dewberry	1.0	11
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v4) AS percent_rank_v4, NTILE(5) OVER (ORDER BY v1, v3) AS ntile_v1 FROM cume_test ;
-- result:
11	10	None	5.5	None	None	0.0	1
8	2	None	2.5	2023-01-29	None	0.0	1
8	7	None	3.5	2023-01-31	date	0.3584905660377358	1
8	6	None	None	2023-02-01	fig	0.4339622641509434	1
13	6	None	7.5	2023-02-15	quince	0.7169811320754716	1
16	5	None	13.5	2023-02-26	bilberry	0.2641509433962264	1
1	10	15	2.5	2023-01-01	apple	0.22641509433962265	1
1	2	15	2.5	2023-01-02	banana	0.24528301886792453	1
1	8	15	3.5	2023-01-03	cherry	0.3018867924528302	1
8	8	15	3.5	2023-01-30	None	0.0	1
10	3	20	None	None	kiwi	0.5283018867924528	1
1	7	20	3.5	2023-01-04	date	0.3584905660377358	2
2	6	20	3.5	2023-01-05	fig	0.4339622641509434	2
2	5	20	4.5	2023-01-06	grape	0.4716981132075472	2
2	4	20	5.5	2023-01-07	honeydew	0.5094339622641509	2
3	3	20	5.5	2023-01-08	kiwi	0.5283018867924528	2
3	2	20	5.5	2023-01-09	lemon	0.5660377358490566	2
9	5	20	4.5	2023-02-02	grape	0.4716981132075472	2
9	4	20	5.5	2023-02-07	None	0.0	2
4	2	25	5.5	2023-01-10	mango	0.5849056603773585	2
4	10	30	5.5	2023-01-11	nectarine	0.6037735849056604	2
4	9	30	5.5	2023-01-12	orange	0.6226415094339622	2
11	9	30	5.5	2023-02-12	orange	0.6226415094339622	3
13	4	35	8.5	None	None	0.0	3
4	8	35	6.5	2023-01-13	papaya	0.660377358490566	3
4	7	35	6.5	2023-01-14	pineapple	0.6792452830188679	3
4	6	35	7.5	2023-01-15	quince	0.7169811320754716	3
4	5	35	7.5	2023-01-16	raspberry	0.7547169811320755	3
5	4	35	8.5	2023-01-17	strawberry	0.7735849056603774	3
12	8	35	6.5	2023-02-13	None	0.0	3
13	7	35	6.5	2023-02-14	pineapple	0.6792452830188679	3
13	5	35	7.5	2023-02-16	None	0.0	3
5	3	40	8.5	2023-01-18	tangerine	0.7924528301886793	3
5	2	40	8.5	2023-01-19	ugli fruit	0.8301886792452831	4
5	1	40	8.5	2023-01-20	vanilla	0.8679245283018868	4
13	3	40	8.5	2023-02-18	tangerine	0.7924528301886793	4
14	2	40	None	2023-02-19	ugli fruit	0.8301886792452831	4
14	1	40	None	2023-02-20	vanilla	0.8679245283018868	4
15	9	45	10.5	None	xigua	0.9433962264150944	4
5	10	45	9.5	2023-01-21	watermelon	0.9056603773584906	4
6	9	45	10.5	2023-01-22	xigua	0.9433962264150944	4
10	2	45	5.5	2023-02-09	None	0.0	4
14	10	45	9.5	2023-02-21	watermelon	0.9056603773584906	4
16	8	50	11.5	None	None	0.0	4
6	8	50	11.5	2023-01-23	yumberry	0.9811320754716981	5
6	7	50	12.5	2023-01-24	zucchini	1.0	5
16	7	50	12.5	2023-02-24	None	0.0	5
6	6	55	13.5	2023-01-25	acerola	0.18867924528301888	5
16	6	55	13.5	2023-02-25	acerola	0.18867924528301888	5
17	4	60	13.5	None	cloudberry	0.32075471698113206	5
6	5	60	13.5	2023-01-26	bilberry	0.2641509433962264	5
7	4	60	13.5	2023-01-27	cloudberry	0.32075471698113206	5
7	3	60	14.5	2023-01-28	dewberry	0.39622641509433965	5
17	3	60	14.5	2023-02-28	dewberry	0.39622641509433965	5
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v1) AS percent_rank_v1, LAG(v2) OVER (ORDER BY v1, v3) AS lag_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.0	None
8	2	None	2.5	2023-01-29	None	0.0	5.5
8	7	None	3.5	2023-01-31	date	0.0	2.5
8	6	None	None	2023-02-01	fig	0.0	3.5
13	6	None	7.5	2023-02-15	quince	0.0	None
16	5	None	13.5	2023-02-26	bilberry	0.0	7.5
1	10	15	2.5	2023-01-01	apple	0.11320754716981132	13.5
1	2	15	2.5	2023-01-02	banana	0.11320754716981132	2.5
1	8	15	3.5	2023-01-03	cherry	0.11320754716981132	2.5
8	8	15	3.5	2023-01-30	None	0.11320754716981132	3.5
10	3	20	None	None	kiwi	0.18867924528301888	3.5
1	7	20	3.5	2023-01-04	date	0.18867924528301888	None
2	6	20	3.5	2023-01-05	fig	0.18867924528301888	3.5
2	5	20	4.5	2023-01-06	grape	0.18867924528301888	3.5
2	4	20	5.5	2023-01-07	honeydew	0.18867924528301888	4.5
3	3	20	5.5	2023-01-08	kiwi	0.18867924528301888	5.5
3	2	20	5.5	2023-01-09	lemon	0.18867924528301888	5.5
9	5	20	4.5	2023-02-02	grape	0.18867924528301888	5.5
9	4	20	5.5	2023-02-07	None	0.18867924528301888	4.5
4	2	25	5.5	2023-01-10	mango	0.3584905660377358	5.5
4	10	30	5.5	2023-01-11	nectarine	0.37735849056603776	5.5
4	9	30	5.5	2023-01-12	orange	0.37735849056603776	5.5
11	9	30	5.5	2023-02-12	orange	0.37735849056603776	5.5
13	4	35	8.5	None	None	0.4339622641509434	5.5
4	8	35	6.5	2023-01-13	papaya	0.4339622641509434	8.5
4	7	35	6.5	2023-01-14	pineapple	0.4339622641509434	6.5
4	6	35	7.5	2023-01-15	quince	0.4339622641509434	6.5
4	5	35	7.5	2023-01-16	raspberry	0.4339622641509434	7.5
5	4	35	8.5	2023-01-17	strawberry	0.4339622641509434	7.5
12	8	35	6.5	2023-02-13	None	0.4339622641509434	8.5
13	7	35	6.5	2023-02-14	pineapple	0.4339622641509434	6.5
13	5	35	7.5	2023-02-16	None	0.4339622641509434	6.5
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604	7.5
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604	8.5
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604	8.5
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604	8.5
14	2	40	None	2023-02-19	ugli fruit	0.6037735849056604	8.5
14	1	40	None	2023-02-20	vanilla	0.6037735849056604	None
15	9	45	10.5	None	xigua	0.7169811320754716	None
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716	10.5
6	9	45	10.5	2023-01-22	xigua	0.7169811320754716	9.5
10	2	45	5.5	2023-02-09	None	0.7169811320754716	10.5
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716	5.5
16	8	50	11.5	None	None	0.8113207547169812	9.5
6	8	50	11.5	2023-01-23	yumberry	0.8113207547169812	11.5
6	7	50	12.5	2023-01-24	zucchini	0.8113207547169812	11.5
16	7	50	12.5	2023-02-24	None	0.8113207547169812	12.5
6	6	55	13.5	2023-01-25	acerola	0.8867924528301887	12.5
16	6	55	13.5	2023-02-25	acerola	0.8867924528301887	13.5
17	4	60	13.5	None	cloudberry	0.9245283018867925	13.5
6	5	60	13.5	2023-01-26	bilberry	0.9245283018867925	13.5
7	4	60	13.5	2023-01-27	cloudberry	0.9245283018867925	13.5
7	3	60	14.5	2023-01-28	dewberry	0.9245283018867925	13.5
17	3	60	14.5	2023-02-28	dewberry	0.9245283018867925	14.5
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v2) AS percent_rank_v2, LEAD(v2) OVER (ORDER BY v1, v3) AS lead_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.2641509433962264	2.5
8	2	None	2.5	2023-01-29	None	0.07547169811320754	3.5
8	7	None	3.5	2023-01-31	date	0.1320754716981132	None
8	6	None	None	2023-02-01	fig	0.0	7.5
13	6	None	7.5	2023-02-15	quince	0.5283018867924528	13.5
16	5	None	13.5	2023-02-26	bilberry	0.8679245283018868	2.5
1	10	15	2.5	2023-01-01	apple	0.07547169811320754	2.5
1	2	15	2.5	2023-01-02	banana	0.07547169811320754	3.5
1	8	15	3.5	2023-01-03	cherry	0.1320754716981132	3.5
8	8	15	3.5	2023-01-30	None	0.1320754716981132	None
10	3	20	None	None	kiwi	0.0	3.5
1	7	20	3.5	2023-01-04	date	0.1320754716981132	3.5
2	6	20	3.5	2023-01-05	fig	0.1320754716981132	4.5
2	5	20	4.5	2023-01-06	grape	0.22641509433962265	5.5
2	4	20	5.5	2023-01-07	honeydew	0.2641509433962264	5.5
3	3	20	5.5	2023-01-08	kiwi	0.2641509433962264	5.5
3	2	20	5.5	2023-01-09	lemon	0.2641509433962264	4.5
9	5	20	4.5	2023-02-02	grape	0.22641509433962265	5.5
9	4	20	5.5	2023-02-07	None	0.2641509433962264	5.5
4	2	25	5.5	2023-01-10	mango	0.2641509433962264	5.5
4	10	30	5.5	2023-01-11	nectarine	0.2641509433962264	5.5
4	9	30	5.5	2023-01-12	orange	0.2641509433962264	5.5
11	9	30	5.5	2023-02-12	orange	0.2641509433962264	8.5
13	4	35	8.5	None	None	0.6037735849056604	6.5
4	8	35	6.5	2023-01-13	papaya	0.4528301886792453	6.5
4	7	35	6.5	2023-01-14	pineapple	0.4528301886792453	7.5
4	6	35	7.5	2023-01-15	quince	0.5283018867924528	7.5
4	5	35	7.5	2023-01-16	raspberry	0.5283018867924528	8.5
5	4	35	8.5	2023-01-17	strawberry	0.6037735849056604	6.5
12	8	35	6.5	2023-02-13	None	0.4528301886792453	6.5
13	7	35	6.5	2023-02-14	pineapple	0.4528301886792453	7.5
13	5	35	7.5	2023-02-16	None	0.5283018867924528	8.5
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604	8.5
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604	8.5
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604	8.5
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604	None
14	2	40	None	2023-02-19	ugli fruit	0.0	None
14	1	40	None	2023-02-20	vanilla	0.0	10.5
15	9	45	10.5	None	xigua	0.7547169811320755	9.5
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716	10.5
6	9	45	10.5	2023-01-22	xigua	0.7547169811320755	5.5
10	2	45	5.5	2023-02-09	None	0.2641509433962264	9.5
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716	11.5
16	8	50	11.5	None	None	0.7924528301886793	11.5
6	8	50	11.5	2023-01-23	yumberry	0.7924528301886793	12.5
6	7	50	12.5	2023-01-24	zucchini	0.8301886792452831	12.5
16	7	50	12.5	2023-02-24	None	0.8301886792452831	13.5
6	6	55	13.5	2023-01-25	acerola	0.8679245283018868	13.5
16	6	55	13.5	2023-02-25	acerola	0.8679245283018868	13.5
17	4	60	13.5	None	cloudberry	0.8679245283018868	13.5
6	5	60	13.5	2023-01-26	bilberry	0.8679245283018868	13.5
7	4	60	13.5	2023-01-27	cloudberry	0.8679245283018868	14.5
7	3	60	14.5	2023-01-28	dewberry	0.9811320754716981	14.5
17	3	60	14.5	2023-02-28	dewberry	0.9811320754716981	None
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v3) AS percent_rank_v3, FIRST_VALUE(v2) OVER (ORDER BY v1, v3) AS first_value_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.0	5.5
8	2	None	2.5	2023-01-29	None	0.6415094339622641	5.5
8	7	None	3.5	2023-01-31	date	0.6792452830188679	5.5
8	6	None	None	2023-02-01	fig	0.6981132075471698	5.5
13	6	None	7.5	2023-02-15	quince	0.8301886792452831	5.5
16	5	None	13.5	2023-02-26	bilberry	0.9811320754716981	5.5
1	10	15	2.5	2023-01-01	apple	0.11320754716981132	5.5
1	2	15	2.5	2023-01-02	banana	0.1320754716981132	5.5
1	8	15	3.5	2023-01-03	cherry	0.1509433962264151	5.5
8	8	15	3.5	2023-01-30	None	0.660377358490566	5.5
10	3	20	None	None	kiwi	0.0	5.5
1	7	20	3.5	2023-01-04	date	0.16981132075471697	5.5
2	6	20	3.5	2023-01-05	fig	0.18867924528301888	5.5
2	5	20	4.5	2023-01-06	grape	0.20754716981132076	5.5
2	4	20	5.5	2023-01-07	honeydew	0.22641509433962265	5.5
3	3	20	5.5	2023-01-08	kiwi	0.24528301886792453	5.5
3	2	20	5.5	2023-01-09	lemon	0.2641509433962264	5.5
9	5	20	4.5	2023-02-02	grape	0.7169811320754716	5.5
9	4	20	5.5	2023-02-07	None	0.7358490566037735	5.5
4	2	25	5.5	2023-01-10	mango	0.2830188679245283	5.5
4	10	30	5.5	2023-01-11	nectarine	0.3018867924528302	5.5
4	9	30	5.5	2023-01-12	orange	0.32075471698113206	5.5
11	9	30	5.5	2023-02-12	orange	0.7735849056603774	5.5
13	4	35	8.5	None	None	0.0	5.5
4	8	35	6.5	2023-01-13	papaya	0.33962264150943394	5.5
4	7	35	6.5	2023-01-14	pineapple	0.3584905660377358	5.5
4	6	35	7.5	2023-01-15	quince	0.37735849056603776	5.5
4	5	35	7.5	2023-01-16	raspberry	0.39622641509433965	5.5
5	4	35	8.5	2023-01-17	strawberry	0.41509433962264153	5.5
12	8	35	6.5	2023-02-13	None	0.7924528301886793	5.5
13	7	35	6.5	2023-02-14	pineapple	0.8113207547169812	5.5
13	5	35	7.5	2023-02-16	None	0.8490566037735849	5.5
5	3	40	8.5	2023-01-18	tangerine	0.4339622641509434	5.5
5	2	40	8.5	2023-01-19	ugli fruit	0.4528301886792453	5.5
5	1	40	8.5	2023-01-20	vanilla	0.4716981132075472	5.5
13	3	40	8.5	2023-02-18	tangerine	0.8679245283018868	5.5
14	2	40	None	2023-02-19	ugli fruit	0.8867924528301887	5.5
14	1	40	None	2023-02-20	vanilla	0.9056603773584906	5.5
15	9	45	10.5	None	xigua	0.0	5.5
5	10	45	9.5	2023-01-21	watermelon	0.49056603773584906	5.5
6	9	45	10.5	2023-01-22	xigua	0.5094339622641509	5.5
10	2	45	5.5	2023-02-09	None	0.7547169811320755	5.5
14	10	45	9.5	2023-02-21	watermelon	0.9245283018867925	5.5
16	8	50	11.5	None	None	0.0	5.5
6	8	50	11.5	2023-01-23	yumberry	0.5283018867924528	5.5
6	7	50	12.5	2023-01-24	zucchini	0.5471698113207547	5.5
16	7	50	12.5	2023-02-24	None	0.9433962264150944	5.5
6	6	55	13.5	2023-01-25	acerola	0.5660377358490566	5.5
16	6	55	13.5	2023-02-25	acerola	0.9622641509433962	5.5
17	4	60	13.5	None	cloudberry	0.0	5.5
6	5	60	13.5	2023-01-26	bilberry	0.5849056603773585	5.5
7	4	60	13.5	2023-01-27	cloudberry	0.6037735849056604	5.5
7	3	60	14.5	2023-01-28	dewberry	0.6226415094339622	5.5
17	3	60	14.5	2023-02-28	dewberry	1.0	5.5
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v4) AS percent_rank_v4, LAST_VALUE(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_value_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.0	14.5
8	2	None	2.5	2023-01-29	None	0.0	14.5
8	7	None	3.5	2023-01-31	date	0.3584905660377358	14.5
8	6	None	None	2023-02-01	fig	0.4339622641509434	14.5
13	6	None	7.5	2023-02-15	quince	0.7169811320754716	14.5
16	5	None	13.5	2023-02-26	bilberry	0.2641509433962264	14.5
1	10	15	2.5	2023-01-01	apple	0.22641509433962265	14.5
1	2	15	2.5	2023-01-02	banana	0.24528301886792453	14.5
1	8	15	3.5	2023-01-03	cherry	0.3018867924528302	14.5
8	8	15	3.5	2023-01-30	None	0.0	14.5
10	3	20	None	None	kiwi	0.5283018867924528	14.5
1	7	20	3.5	2023-01-04	date	0.3584905660377358	14.5
2	6	20	3.5	2023-01-05	fig	0.4339622641509434	14.5
2	5	20	4.5	2023-01-06	grape	0.4716981132075472	14.5
2	4	20	5.5	2023-01-07	honeydew	0.5094339622641509	14.5
3	3	20	5.5	2023-01-08	kiwi	0.5283018867924528	14.5
3	2	20	5.5	2023-01-09	lemon	0.5660377358490566	14.5
9	5	20	4.5	2023-02-02	grape	0.4716981132075472	14.5
9	4	20	5.5	2023-02-07	None	0.0	14.5
4	2	25	5.5	2023-01-10	mango	0.5849056603773585	14.5
4	10	30	5.5	2023-01-11	nectarine	0.6037735849056604	14.5
4	9	30	5.5	2023-01-12	orange	0.6226415094339622	14.5
11	9	30	5.5	2023-02-12	orange	0.6226415094339622	14.5
13	4	35	8.5	None	None	0.0	14.5
4	8	35	6.5	2023-01-13	papaya	0.660377358490566	14.5
4	7	35	6.5	2023-01-14	pineapple	0.6792452830188679	14.5
4	6	35	7.5	2023-01-15	quince	0.7169811320754716	14.5
4	5	35	7.5	2023-01-16	raspberry	0.7547169811320755	14.5
5	4	35	8.5	2023-01-17	strawberry	0.7735849056603774	14.5
12	8	35	6.5	2023-02-13	None	0.0	14.5
13	7	35	6.5	2023-02-14	pineapple	0.6792452830188679	14.5
13	5	35	7.5	2023-02-16	None	0.0	14.5
5	3	40	8.5	2023-01-18	tangerine	0.7924528301886793	14.5
5	2	40	8.5	2023-01-19	ugli fruit	0.8301886792452831	14.5
5	1	40	8.5	2023-01-20	vanilla	0.8679245283018868	14.5
13	3	40	8.5	2023-02-18	tangerine	0.7924528301886793	14.5
14	2	40	None	2023-02-19	ugli fruit	0.8301886792452831	14.5
14	1	40	None	2023-02-20	vanilla	0.8679245283018868	14.5
15	9	45	10.5	None	xigua	0.9433962264150944	14.5
5	10	45	9.5	2023-01-21	watermelon	0.9056603773584906	14.5
6	9	45	10.5	2023-01-22	xigua	0.9433962264150944	14.5
10	2	45	5.5	2023-02-09	None	0.0	14.5
14	10	45	9.5	2023-02-21	watermelon	0.9056603773584906	14.5
16	8	50	11.5	None	None	0.0	14.5
6	8	50	11.5	2023-01-23	yumberry	0.9811320754716981	14.5
6	7	50	12.5	2023-01-24	zucchini	1.0	14.5
16	7	50	12.5	2023-02-24	None	0.0	14.5
6	6	55	13.5	2023-01-25	acerola	0.18867924528301888	14.5
16	6	55	13.5	2023-02-25	acerola	0.18867924528301888	14.5
17	4	60	13.5	None	cloudberry	0.32075471698113206	14.5
6	5	60	13.5	2023-01-26	bilberry	0.2641509433962264	14.5
7	4	60	13.5	2023-01-27	cloudberry	0.32075471698113206	14.5
7	3	60	14.5	2023-01-28	dewberry	0.39622641509433965	14.5
17	3	60	14.5	2023-02-28	dewberry	0.39622641509433965	14.5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, PERCENT_RANK() OVER (ORDER BY v3) AS percent_rank_v3 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	0.0
10	3	20	None	None	kiwi	0.35185185185185186	0.0
13	4	35	8.5	None	None	0.5925925925925926	0.0
15	9	45	10.5	None	xigua	0.7962962962962963	0.0
16	8	50	11.5	None	None	0.8703703703703703	0.0
17	4	60	13.5	None	cloudberry	1.0	0.0
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	0.11320754716981132
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	0.1320754716981132
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	0.1509433962264151
1	7	20	3.5	2023-01-04	date	0.35185185185185186	0.16981132075471697
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	0.18867924528301888
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	0.20754716981132076
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	0.22641509433962265
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	0.24528301886792453
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	0.2641509433962264
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	0.2830188679245283
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	0.3018867924528302
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	0.32075471698113206
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	0.33962264150943394
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	0.3584905660377358
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	0.37735849056603776
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	0.39622641509433965
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	0.41509433962264153
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	0.4339622641509434
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	0.4528301886792453
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	0.4716981132075472
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	0.49056603773584906
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	0.5094339622641509
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	0.5283018867924528
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	0.5471698113207547
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	0.5660377358490566
6	5	60	13.5	2023-01-26	bilberry	1.0	0.5849056603773585
7	4	60	13.5	2023-01-27	cloudberry	1.0	0.6037735849056604
7	3	60	14.5	2023-01-28	dewberry	1.0	0.6226415094339622
8	2	None	2.5	2023-01-29	None	0.1111111111111111	0.6415094339622641
8	8	15	3.5	2023-01-30	None	0.18518518518518517	0.660377358490566
8	7	None	3.5	2023-01-31	date	0.1111111111111111	0.6792452830188679
8	6	None	None	2023-02-01	fig	0.1111111111111111	0.6981132075471698
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	0.7169811320754716
9	4	20	5.5	2023-02-07	None	0.35185185185185186	0.7358490566037735
10	2	45	5.5	2023-02-09	None	0.7962962962962963	0.7547169811320755
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	0.7735849056603774
12	8	35	6.5	2023-02-13	None	0.5925925925925926	0.7924528301886793
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	0.8113207547169812
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	0.8301886792452831
13	5	35	7.5	2023-02-16	None	0.5925925925925926	0.8490566037735849
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	0.8679245283018868
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	0.8867924528301887
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	0.9056603773584906
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	0.9245283018867925
16	7	50	12.5	2023-02-24	None	0.8703703703703703	0.9433962264150944
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	0.9622641509433962
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	0.9811320754716981
17	3	60	14.5	2023-02-28	dewberry	1.0	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2, PERCENT_RANK() OVER (ORDER BY v2) AS percent_rank_v2 FROM cume_test;
-- result:
14	2	40	None	2023-02-19	ugli fruit	0.07407407407407407	0.0
14	1	40	None	2023-02-20	vanilla	0.07407407407407407	0.0
8	6	None	None	2023-02-01	fig	0.07407407407407407	0.0
10	3	20	None	None	kiwi	0.07407407407407407	0.0
8	2	None	2.5	2023-01-29	None	0.12962962962962962	0.07547169811320754
1	2	15	2.5	2023-01-02	banana	0.12962962962962962	0.07547169811320754
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	0.07547169811320754
8	7	None	3.5	2023-01-31	date	0.2222222222222222	0.1320754716981132
2	6	20	3.5	2023-01-05	fig	0.2222222222222222	0.1320754716981132
1	7	20	3.5	2023-01-04	date	0.2222222222222222	0.1320754716981132
8	8	15	3.5	2023-01-30	None	0.2222222222222222	0.1320754716981132
1	8	15	3.5	2023-01-03	cherry	0.2222222222222222	0.1320754716981132
2	5	20	4.5	2023-01-06	grape	0.25925925925925924	0.22641509433962265
9	5	20	4.5	2023-02-02	grape	0.25925925925925924	0.22641509433962265
4	2	25	5.5	2023-01-10	mango	0.4444444444444444	0.2641509433962264
4	10	30	5.5	2023-01-11	nectarine	0.4444444444444444	0.2641509433962264
4	9	30	5.5	2023-01-12	orange	0.4444444444444444	0.2641509433962264
11	9	30	5.5	2023-02-12	orange	0.4444444444444444	0.2641509433962264
11	10	None	5.5	None	None	0.4444444444444444	0.2641509433962264
2	4	20	5.5	2023-01-07	honeydew	0.4444444444444444	0.2641509433962264
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444	0.2641509433962264
9	4	20	5.5	2023-02-07	None	0.4444444444444444	0.2641509433962264
10	2	45	5.5	2023-02-09	None	0.4444444444444444	0.2641509433962264
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	0.2641509433962264
4	8	35	6.5	2023-01-13	papaya	0.5185185185185185	0.4528301886792453
4	7	35	6.5	2023-01-14	pineapple	0.5185185185185185	0.4528301886792453
13	7	35	6.5	2023-02-14	pineapple	0.5185185185185185	0.4528301886792453
12	8	35	6.5	2023-02-13	None	0.5185185185185185	0.4528301886792453
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	0.5283018867924528
13	5	35	7.5	2023-02-16	None	0.5925925925925926	0.5283018867924528
13	6	None	7.5	2023-02-15	quince	0.5925925925925926	0.5283018867924528
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	0.5283018867924528
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	0.6037735849056604
13	4	35	8.5	None	None	0.7037037037037037	0.6037735849056604
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	0.6037735849056604
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	0.6037735849056604
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	0.6037735849056604
5	4	35	8.5	2023-01-17	strawberry	0.7037037037037037	0.6037735849056604
14	10	45	9.5	2023-02-21	watermelon	0.7407407407407407	0.7169811320754716
5	10	45	9.5	2023-01-21	watermelon	0.7407407407407407	0.7169811320754716
6	9	45	10.5	2023-01-22	xigua	0.7777777777777778	0.7547169811320755
15	9	45	10.5	None	xigua	0.7777777777777778	0.7547169811320755
16	8	50	11.5	None	None	0.8148148148148148	0.7924528301886793
6	8	50	11.5	2023-01-23	yumberry	0.8148148148148148	0.7924528301886793
16	7	50	12.5	2023-02-24	None	0.8518518518518519	0.8301886792452831
6	7	50	12.5	2023-01-24	zucchini	0.8518518518518519	0.8301886792452831
7	4	60	13.5	2023-01-27	cloudberry	0.9629629629629629	0.8679245283018868
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629	0.8679245283018868
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	0.8679245283018868
6	5	60	13.5	2023-01-26	bilberry	0.9629629629629629	0.8679245283018868
6	6	55	13.5	2023-01-25	acerola	0.9629629629629629	0.8679245283018868
17	4	60	13.5	None	cloudberry	0.9629629629629629	0.8679245283018868
7	3	60	14.5	2023-01-28	dewberry	1.0	0.9811320754716981
17	3	60	14.5	2023-02-28	dewberry	1.0	0.9811320754716981
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3, PERCENT_RANK() OVER (ORDER BY v3) AS percent_rank_v3 FROM cume_test WHERE v3 IS NOT NULL;
-- result:
1	10	15	2.5	2023-01-01	apple	0.020833333333333332	0.0
1	2	15	2.5	2023-01-02	banana	0.041666666666666664	0.02127659574468085
1	8	15	3.5	2023-01-03	cherry	0.0625	0.0425531914893617
1	7	20	3.5	2023-01-04	date	0.08333333333333333	0.06382978723404255
2	6	20	3.5	2023-01-05	fig	0.10416666666666667	0.0851063829787234
2	5	20	4.5	2023-01-06	grape	0.125	0.10638297872340426
2	4	20	5.5	2023-01-07	honeydew	0.14583333333333334	0.1276595744680851
3	3	20	5.5	2023-01-08	kiwi	0.16666666666666666	0.14893617021276595
3	2	20	5.5	2023-01-09	lemon	0.1875	0.1702127659574468
4	2	25	5.5	2023-01-10	mango	0.20833333333333334	0.19148936170212766
4	10	30	5.5	2023-01-11	nectarine	0.22916666666666666	0.2127659574468085
4	9	30	5.5	2023-01-12	orange	0.25	0.23404255319148937
4	8	35	6.5	2023-01-13	papaya	0.2708333333333333	0.2553191489361702
4	7	35	6.5	2023-01-14	pineapple	0.2916666666666667	0.2765957446808511
4	6	35	7.5	2023-01-15	quince	0.3125	0.2978723404255319
4	5	35	7.5	2023-01-16	raspberry	0.3333333333333333	0.3191489361702128
5	4	35	8.5	2023-01-17	strawberry	0.3541666666666667	0.3404255319148936
5	3	40	8.5	2023-01-18	tangerine	0.375	0.3617021276595745
5	2	40	8.5	2023-01-19	ugli fruit	0.3958333333333333	0.3829787234042553
5	1	40	8.5	2023-01-20	vanilla	0.4166666666666667	0.40425531914893614
5	10	45	9.5	2023-01-21	watermelon	0.4375	0.425531914893617
6	9	45	10.5	2023-01-22	xigua	0.4583333333333333	0.44680851063829785
6	8	50	11.5	2023-01-23	yumberry	0.4791666666666667	0.46808510638297873
6	7	50	12.5	2023-01-24	zucchini	0.5	0.48936170212765956
6	6	55	13.5	2023-01-25	acerola	0.5208333333333334	0.5106382978723404
6	5	60	13.5	2023-01-26	bilberry	0.5416666666666666	0.5319148936170213
7	4	60	13.5	2023-01-27	cloudberry	0.5625	0.5531914893617021
7	3	60	14.5	2023-01-28	dewberry	0.5833333333333334	0.574468085106383
8	2	None	2.5	2023-01-29	None	0.6041666666666666	0.5957446808510638
8	8	15	3.5	2023-01-30	None	0.625	0.6170212765957447
8	7	None	3.5	2023-01-31	date	0.6458333333333334	0.6382978723404256
8	6	None	None	2023-02-01	fig	0.6666666666666666	0.6595744680851063
9	5	20	4.5	2023-02-02	grape	0.6875	0.6808510638297872
9	4	20	5.5	2023-02-07	None	0.7083333333333334	0.7021276595744681
10	2	45	5.5	2023-02-09	None	0.7291666666666666	0.723404255319149
11	9	30	5.5	2023-02-12	orange	0.75	0.7446808510638298
12	8	35	6.5	2023-02-13	None	0.7708333333333334	0.7659574468085106
13	7	35	6.5	2023-02-14	pineapple	0.7916666666666666	0.7872340425531915
13	6	None	7.5	2023-02-15	quince	0.8125	0.8085106382978723
13	5	35	7.5	2023-02-16	None	0.8333333333333334	0.8297872340425532
13	3	40	8.5	2023-02-18	tangerine	0.8541666666666666	0.851063829787234
14	2	40	None	2023-02-19	ugli fruit	0.875	0.8723404255319149
14	1	40	None	2023-02-20	vanilla	0.8958333333333334	0.8936170212765957
14	10	45	9.5	2023-02-21	watermelon	0.9166666666666666	0.9148936170212766
16	7	50	12.5	2023-02-24	None	0.9375	0.9361702127659575
16	6	55	13.5	2023-02-25	acerola	0.9583333333333334	0.9574468085106383
16	5	None	13.5	2023-02-26	bilberry	0.9791666666666666	0.9787234042553191
17	3	60	14.5	2023-02-28	dewberry	1.0	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4 DESC) AS cume_dist_v4, PERCENT_RANK() OVER (ORDER BY v1 DESC) AS percent_rank_v1 FROM cume_test;
-- result:
7	3	60	14.5	2023-01-28	dewberry	0.6111111111111112	0.0
17	3	60	14.5	2023-02-28	dewberry	0.6111111111111112	0.0
7	4	60	13.5	2023-01-27	cloudberry	0.6851851851851852	0.0
17	4	60	13.5	None	cloudberry	0.6851851851851852	0.0
6	5	60	13.5	2023-01-26	bilberry	0.7407407407407407	0.0
16	6	55	13.5	2023-02-25	acerola	0.8148148148148148	0.09433962264150944
6	6	55	13.5	2023-01-25	acerola	0.8148148148148148	0.09433962264150944
6	7	50	12.5	2023-01-24	zucchini	0.018518518518518517	0.1320754716981132
6	8	50	11.5	2023-01-23	yumberry	0.037037037037037035	0.1320754716981132
16	7	50	12.5	2023-02-24	None	1.0	0.1320754716981132
16	8	50	11.5	None	None	1.0	0.1320754716981132
6	9	45	10.5	2023-01-22	xigua	0.07407407407407407	0.20754716981132076
15	9	45	10.5	None	xigua	0.07407407407407407	0.20754716981132076
14	10	45	9.5	2023-02-21	watermelon	0.1111111111111111	0.20754716981132076
5	10	45	9.5	2023-01-21	watermelon	0.1111111111111111	0.20754716981132076
10	2	45	5.5	2023-02-09	None	1.0	0.20754716981132076
14	1	40	None	2023-02-20	vanilla	0.14814814814814814	0.3018867924528302
5	1	40	8.5	2023-01-20	vanilla	0.14814814814814814	0.3018867924528302
14	2	40	None	2023-02-19	ugli fruit	0.18518518518518517	0.3018867924528302
5	2	40	8.5	2023-01-19	ugli fruit	0.18518518518518517	0.3018867924528302
13	3	40	8.5	2023-02-18	tangerine	0.2222222222222222	0.3018867924528302
5	3	40	8.5	2023-01-18	tangerine	0.2222222222222222	0.3018867924528302
5	4	35	8.5	2023-01-17	strawberry	0.24074074074074073	0.41509433962264153
4	5	35	7.5	2023-01-16	raspberry	0.25925925925925924	0.41509433962264153
4	6	35	7.5	2023-01-15	quince	0.2962962962962963	0.41509433962264153
13	7	35	6.5	2023-02-14	pineapple	0.3333333333333333	0.41509433962264153
4	7	35	6.5	2023-01-14	pineapple	0.3333333333333333	0.41509433962264153
4	8	35	6.5	2023-01-13	papaya	0.35185185185185186	0.41509433962264153
13	5	35	7.5	2023-02-16	None	1.0	0.41509433962264153
13	4	35	8.5	None	None	1.0	0.41509433962264153
12	8	35	6.5	2023-02-13	None	1.0	0.41509433962264153
4	9	30	5.5	2023-01-12	orange	0.3888888888888889	0.5849056603773585
11	9	30	5.5	2023-02-12	orange	0.3888888888888889	0.5849056603773585
4	10	30	5.5	2023-01-11	nectarine	0.4074074074074074	0.5849056603773585
4	2	25	5.5	2023-01-10	mango	0.42592592592592593	0.6415094339622641
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	0.660377358490566
3	3	20	5.5	2023-01-08	kiwi	0.48148148148148145	0.660377358490566
10	3	20	None	None	kiwi	0.48148148148148145	0.660377358490566
2	4	20	5.5	2023-01-07	honeydew	0.5	0.660377358490566
2	5	20	4.5	2023-01-06	grape	0.5370370370370371	0.660377358490566
9	5	20	4.5	2023-02-02	grape	0.5370370370370371	0.660377358490566
2	6	20	3.5	2023-01-05	fig	0.5740740740740741	0.660377358490566
1	7	20	3.5	2023-01-04	date	0.6481481481481481	0.660377358490566
9	4	20	5.5	2023-02-07	None	1.0	0.660377358490566
1	8	15	3.5	2023-01-03	cherry	0.7037037037037037	0.8301886792452831
1	2	15	2.5	2023-01-02	banana	0.7592592592592593	0.8301886792452831
1	10	15	2.5	2023-01-01	apple	0.7777777777777778	0.8301886792452831
8	8	15	3.5	2023-01-30	None	1.0	0.8301886792452831
13	6	None	7.5	2023-02-15	quince	0.2962962962962963	0.9056603773584906
8	6	None	None	2023-02-01	fig	0.5740740740740741	0.9056603773584906
8	7	None	3.5	2023-01-31	date	0.6481481481481481	0.9056603773584906
16	5	None	13.5	2023-02-26	bilberry	0.7407407407407407	0.9056603773584906
11	10	None	5.5	None	None	1.0	0.9056603773584906
8	2	None	2.5	2023-01-29	None	1.0	0.9056603773584906
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY k1 ORDER BY k2) AS percent_rank_k1_partition_k2, PERCENT_RANK() OVER (ORDER BY v1) AS percent_rank_v1 FROM cume_test;
-- result:
8	2	None	2.5	2023-01-29	None	0.25	0.0
8	6	None	None	2023-02-01	fig	0.5	0.0
8	7	None	3.5	2023-01-31	date	0.75	0.0
16	5	None	13.5	2023-02-26	bilberry	0.25	0.0
11	10	None	5.5	None	None	1.0	0.0
13	6	None	7.5	2023-02-15	quince	0.8	0.0
1	2	15	2.5	2023-01-02	banana	0.25	0.11320754716981132
1	8	15	3.5	2023-01-03	cherry	0.75	0.11320754716981132
1	10	15	2.5	2023-01-01	apple	1.0	0.11320754716981132
8	8	15	3.5	2023-01-30	None	1.0	0.11320754716981132
9	4	20	5.5	2023-02-07	None	0.5	0.18867924528301888
9	5	20	4.5	2023-02-02	grape	1.0	0.18867924528301888
1	7	20	3.5	2023-01-04	date	0.5	0.18867924528301888
3	3	20	5.5	2023-01-08	kiwi	1.0	0.18867924528301888
3	2	20	5.5	2023-01-09	lemon	0.5	0.18867924528301888
10	3	20	None	None	kiwi	1.0	0.18867924528301888
2	4	20	5.5	2023-01-07	honeydew	0.3333333333333333	0.18867924528301888
2	5	20	4.5	2023-01-06	grape	0.6666666666666666	0.18867924528301888
2	6	20	3.5	2023-01-05	fig	1.0	0.18867924528301888
4	2	25	5.5	2023-01-10	mango	0.14285714285714285	0.3584905660377358
11	9	30	5.5	2023-02-12	orange	0.5	0.37735849056603776
4	9	30	5.5	2023-01-12	orange	0.8571428571428571	0.37735849056603776
4	10	30	5.5	2023-01-11	nectarine	1.0	0.37735849056603776
4	5	35	7.5	2023-01-16	raspberry	0.2857142857142857	0.4339622641509434
4	6	35	7.5	2023-01-15	quince	0.42857142857142855	0.4339622641509434
4	7	35	6.5	2023-01-14	pineapple	0.5714285714285714	0.4339622641509434
4	8	35	6.5	2023-01-13	papaya	0.7142857142857143	0.4339622641509434
12	8	35	6.5	2023-02-13	None	1.0	0.4339622641509434
5	4	35	8.5	2023-01-17	strawberry	0.8	0.4339622641509434
13	4	35	8.5	None	None	0.4	0.4339622641509434
13	5	35	7.5	2023-02-16	None	0.6	0.4339622641509434
13	7	35	6.5	2023-02-14	pineapple	1.0	0.4339622641509434
14	1	40	None	2023-02-20	vanilla	0.3333333333333333	0.6037735849056604
14	2	40	None	2023-02-19	ugli fruit	0.6666666666666666	0.6037735849056604
5	1	40	8.5	2023-01-20	vanilla	0.2	0.6037735849056604
5	2	40	8.5	2023-01-19	ugli fruit	0.4	0.6037735849056604
5	3	40	8.5	2023-01-18	tangerine	0.6	0.6037735849056604
13	3	40	8.5	2023-02-18	tangerine	0.2	0.6037735849056604
14	10	45	9.5	2023-02-21	watermelon	1.0	0.7169811320754716
15	9	45	10.5	None	xigua	1.0	0.7169811320754716
6	9	45	10.5	2023-01-22	xigua	1.0	0.7169811320754716
10	2	45	5.5	2023-02-09	None	0.5	0.7169811320754716
5	10	45	9.5	2023-01-21	watermelon	1.0	0.7169811320754716
16	7	50	12.5	2023-02-24	None	0.75	0.8113207547169812
16	8	50	11.5	None	None	1.0	0.8113207547169812
6	7	50	12.5	2023-01-24	zucchini	0.6	0.8113207547169812
6	8	50	11.5	2023-01-23	yumberry	0.8	0.8113207547169812
16	6	55	13.5	2023-02-25	acerola	0.5	0.8867924528301887
6	6	55	13.5	2023-01-25	acerola	0.4	0.8867924528301887
6	5	60	13.5	2023-01-26	bilberry	0.2	0.9245283018867925
17	3	60	14.5	2023-02-28	dewberry	0.5	0.9245283018867925
17	4	60	13.5	None	cloudberry	1.0	0.9245283018867925
7	3	60	14.5	2023-01-28	dewberry	0.5	0.9245283018867925
7	4	60	13.5	2023-01-27	cloudberry	1.0	0.9245283018867925
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY v3 ORDER BY v4) AS percent_rank_v3_partition_v4, PERCENT_RANK() OVER (PARTITION BY v4 ORDER BY v3) AS percent_rank_v4_partition_v3 FROM cume_test;
-- result:
1	10	15	2.5	2023-01-01	apple	1.0	0.0
6	5	60	13.5	2023-01-26	bilberry	1.0	0.0
16	5	None	13.5	2023-02-26	bilberry	1.0	1.0
4	5	35	7.5	2023-01-16	raspberry	1.0	0.0
6	8	50	11.5	2023-01-23	yumberry	1.0	0.0
4	10	30	5.5	2023-01-11	nectarine	1.0	0.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0	0.0
14	2	40	None	2023-02-19	ugli fruit	1.0	1.0
2	5	20	4.5	2023-01-06	grape	1.0	0.0
9	5	20	4.5	2023-02-02	grape	1.0	1.0
4	8	35	6.5	2023-01-13	papaya	1.0	0.0
4	2	25	5.5	2023-01-10	mango	1.0	0.0
4	6	35	7.5	2023-01-15	quince	1.0	0.0
13	6	None	7.5	2023-02-15	quince	1.0	1.0
1	8	15	3.5	2023-01-03	cherry	1.0	0.0
5	3	40	8.5	2023-01-18	tangerine	1.0	0.0
13	3	40	8.5	2023-02-18	tangerine	1.0	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0	0.0
17	3	60	14.5	2023-02-28	dewberry	1.0	1.0
4	9	30	5.5	2023-01-12	orange	1.0	0.0
11	9	30	5.5	2023-02-12	orange	1.0	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0	0.0
10	3	20	None	None	kiwi	0.8333333333333334	0.0
3	3	20	5.5	2023-01-08	kiwi	1.0	1.0
11	10	None	5.5	None	None	0.5	0.0
13	4	35	8.5	None	None	0.5	0.0
16	8	50	11.5	None	None	0.5	0.0
8	2	None	2.5	2023-01-29	None	1.0	0.3333333333333333
8	8	15	3.5	2023-01-30	None	1.0	0.4444444444444444
9	4	20	5.5	2023-02-07	None	1.0	0.5555555555555556
10	2	45	5.5	2023-02-09	None	1.0	0.6666666666666666
12	8	35	6.5	2023-02-13	None	1.0	0.7777777777777778
13	5	35	7.5	2023-02-16	None	1.0	0.8888888888888888
16	7	50	12.5	2023-02-24	None	1.0	1.0
2	6	20	3.5	2023-01-05	fig	1.0	0.0
8	6	None	None	2023-02-01	fig	1.0	1.0
3	2	20	5.5	2023-01-09	lemon	1.0	0.0
1	7	20	3.5	2023-01-04	date	1.0	0.0
8	7	None	3.5	2023-01-31	date	1.0	1.0
5	10	45	9.5	2023-01-21	watermelon	1.0	0.0
14	10	45	9.5	2023-02-21	watermelon	1.0	1.0
1	2	15	2.5	2023-01-02	banana	1.0	0.0
17	4	60	13.5	None	cloudberry	0.6666666666666666	0.0
7	4	60	13.5	2023-01-27	cloudberry	1.0	1.0
15	9	45	10.5	None	xigua	1.0	0.0
6	9	45	10.5	2023-01-22	xigua	1.0	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0	0.0
4	7	35	6.5	2023-01-14	pineapple	1.0	0.0
13	7	35	6.5	2023-02-14	pineapple	1.0	1.0
5	4	35	8.5	2023-01-17	strawberry	1.0	0.0
6	6	55	13.5	2023-01-25	acerola	1.0	0.0
16	6	55	13.5	2023-02-25	acerola	1.0	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0	0.0
14	1	40	None	2023-02-20	vanilla	1.0	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, AVG(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS avg_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	5.5
8	2	None	2.5	2023-01-29	None	0.1111111111111111	4.0
8	7	None	3.5	2023-01-31	date	0.1111111111111111	3.8333333333333335
8	6	None	None	2023-02-01	fig	0.1111111111111111	3.8333333333333335
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	4.75
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	6.5
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	5.833333333333333
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	5.357142857142857
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	5.125
8	8	15	3.5	2023-01-30	None	0.18518518518518517	4.944444444444445
10	3	20	None	None	kiwi	0.35185185185185186	4.944444444444445
1	7	20	3.5	2023-01-04	date	0.35185185185185186	4.8
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	4.681818181818182
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	4.666666666666667
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	4.730769230769231
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	4.785714285714286
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	4.833333333333333
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	4.8125
9	4	20	5.5	2023-02-07	None	0.35185185185185186	4.852941176470588
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	4.888888888888889
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	4.921052631578948
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	4.95
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	4.976190476190476
13	4	35	8.5	None	None	0.5925925925925926	5.136363636363637
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	5.195652173913044
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	5.25
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	5.34
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	5.423076923076923
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	5.537037037037037
12	8	35	6.5	2023-02-13	None	0.5925925925925926	5.571428571428571
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	5.603448275862069
13	5	35	7.5	2023-02-16	None	0.5925925925925926	5.666666666666667
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	5.758064516129032
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	5.84375
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	5.924242424242424
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	6.0
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	6.0
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	6.0
15	9	45	10.5	None	xigua	0.7962962962962963	6.128571428571429
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	6.222222222222222
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	6.337837837837838
10	2	45	5.5	2023-02-09	None	0.7962962962962963	6.315789473684211
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	6.397435897435898
16	8	50	11.5	None	None	0.8703703703703703	6.525
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	6.646341463414634
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	6.785714285714286
16	7	50	12.5	2023-02-24	None	0.8703703703703703	6.9186046511627906
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	7.068181818181818
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	7.211111111111111
17	4	60	13.5	None	cloudberry	1.0	7.3478260869565215
6	5	60	13.5	2023-01-26	bilberry	1.0	7.4787234042553195
7	4	60	13.5	2023-01-27	cloudberry	1.0	7.604166666666667
7	3	60	14.5	2023-01-28	dewberry	1.0	7.744897959183674
17	3	60	14.5	2023-02-28	dewberry	1.0	7.88
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2, SUM(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS sum_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.4444444444444444	5.5
8	2	None	2.5	2023-01-29	None	0.12962962962962962	8.0
8	7	None	3.5	2023-01-31	date	0.2222222222222222	11.5
8	6	None	None	2023-02-01	fig	0.07407407407407407	11.5
13	6	None	7.5	2023-02-15	quince	0.5925925925925926	19.0
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629	32.5
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	35.0
1	2	15	2.5	2023-01-02	banana	0.12962962962962962	37.5
1	8	15	3.5	2023-01-03	cherry	0.2222222222222222	41.0
8	8	15	3.5	2023-01-30	None	0.2222222222222222	44.5
10	3	20	None	None	kiwi	0.07407407407407407	44.5
1	7	20	3.5	2023-01-04	date	0.2222222222222222	48.0
2	6	20	3.5	2023-01-05	fig	0.2222222222222222	51.5
2	5	20	4.5	2023-01-06	grape	0.25925925925925924	56.0
2	4	20	5.5	2023-01-07	honeydew	0.4444444444444444	61.5
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444	67.0
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	72.5
9	5	20	4.5	2023-02-02	grape	0.25925925925925924	77.0
9	4	20	5.5	2023-02-07	None	0.4444444444444444	82.5
4	2	25	5.5	2023-01-10	mango	0.4444444444444444	88.0
4	10	30	5.5	2023-01-11	nectarine	0.4444444444444444	93.5
4	9	30	5.5	2023-01-12	orange	0.4444444444444444	99.0
11	9	30	5.5	2023-02-12	orange	0.4444444444444444	104.5
13	4	35	8.5	None	None	0.7037037037037037	113.0
4	8	35	6.5	2023-01-13	papaya	0.5185185185185185	119.5
4	7	35	6.5	2023-01-14	pineapple	0.5185185185185185	126.0
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	133.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	141.0
5	4	35	8.5	2023-01-17	strawberry	0.7037037037037037	149.5
12	8	35	6.5	2023-02-13	None	0.5185185185185185	156.0
13	7	35	6.5	2023-02-14	pineapple	0.5185185185185185	162.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	170.0
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	178.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	187.0
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	195.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	204.0
14	2	40	None	2023-02-19	ugli fruit	0.07407407407407407	204.0
14	1	40	None	2023-02-20	vanilla	0.07407407407407407	204.0
15	9	45	10.5	None	xigua	0.7777777777777778	214.5
5	10	45	9.5	2023-01-21	watermelon	0.7407407407407407	224.0
6	9	45	10.5	2023-01-22	xigua	0.7777777777777778	234.5
10	2	45	5.5	2023-02-09	None	0.4444444444444444	240.0
14	10	45	9.5	2023-02-21	watermelon	0.7407407407407407	249.5
16	8	50	11.5	None	None	0.8148148148148148	261.0
6	8	50	11.5	2023-01-23	yumberry	0.8148148148148148	272.5
6	7	50	12.5	2023-01-24	zucchini	0.8518518518518519	285.0
16	7	50	12.5	2023-02-24	None	0.8518518518518519	297.5
6	6	55	13.5	2023-01-25	acerola	0.9629629629629629	311.0
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	324.5
17	4	60	13.5	None	cloudberry	0.9629629629629629	338.0
6	5	60	13.5	2023-01-26	bilberry	0.9629629629629629	351.5
7	4	60	13.5	2023-01-27	cloudberry	0.9629629629629629	365.0
7	3	60	14.5	2023-01-28	dewberry	1.0	379.5
17	3	60	14.5	2023-02-28	dewberry	1.0	394.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, MIN(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	5.5
8	2	None	2.5	2023-01-29	None	0.1111111111111111	2.5
8	7	None	3.5	2023-01-31	date	0.1111111111111111	2.5
8	6	None	None	2023-02-01	fig	0.1111111111111111	2.5
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	2.5
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	2.5
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	2.5
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	2.5
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	2.5
8	8	15	3.5	2023-01-30	None	0.18518518518518517	2.5
10	3	20	None	None	kiwi	0.35185185185185186	2.5
1	7	20	3.5	2023-01-04	date	0.35185185185185186	2.5
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	2.5
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	2.5
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	2.5
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	2.5
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	2.5
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	2.5
9	4	20	5.5	2023-02-07	None	0.35185185185185186	2.5
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	2.5
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	2.5
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	2.5
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	2.5
13	4	35	8.5	None	None	0.5925925925925926	2.5
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	2.5
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	2.5
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	2.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	2.5
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	2.5
12	8	35	6.5	2023-02-13	None	0.5925925925925926	2.5
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	2.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	2.5
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	2.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	2.5
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	2.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	2.5
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	2.5
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	2.5
15	9	45	10.5	None	xigua	0.7962962962962963	2.5
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	2.5
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	2.5
10	2	45	5.5	2023-02-09	None	0.7962962962962963	2.5
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	2.5
16	8	50	11.5	None	None	0.8703703703703703	2.5
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	2.5
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	2.5
16	7	50	12.5	2023-02-24	None	0.8703703703703703	2.5
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	2.5
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	2.5
17	4	60	13.5	None	cloudberry	1.0	2.5
6	5	60	13.5	2023-01-26	bilberry	1.0	2.5
7	4	60	13.5	2023-01-27	cloudberry	1.0	2.5
7	3	60	14.5	2023-01-28	dewberry	1.0	2.5
17	3	60	14.5	2023-02-28	dewberry	1.0	2.5
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v1) AS percent_rank_v1, AVG(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS avg_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.0	5.5
8	2	None	2.5	2023-01-29	None	0.0	4.0
8	7	None	3.5	2023-01-31	date	0.0	3.8333333333333335
8	6	None	None	2023-02-01	fig	0.0	3.8333333333333335
13	6	None	7.5	2023-02-15	quince	0.0	4.75
16	5	None	13.5	2023-02-26	bilberry	0.0	6.5
1	10	15	2.5	2023-01-01	apple	0.11320754716981132	5.833333333333333
1	2	15	2.5	2023-01-02	banana	0.11320754716981132	5.357142857142857
1	8	15	3.5	2023-01-03	cherry	0.11320754716981132	5.125
8	8	15	3.5	2023-01-30	None	0.11320754716981132	4.944444444444445
10	3	20	None	None	kiwi	0.18867924528301888	4.944444444444445
1	7	20	3.5	2023-01-04	date	0.18867924528301888	4.8
2	6	20	3.5	2023-01-05	fig	0.18867924528301888	4.681818181818182
2	5	20	4.5	2023-01-06	grape	0.18867924528301888	4.666666666666667
2	4	20	5.5	2023-01-07	honeydew	0.18867924528301888	4.730769230769231
3	3	20	5.5	2023-01-08	kiwi	0.18867924528301888	4.785714285714286
3	2	20	5.5	2023-01-09	lemon	0.18867924528301888	4.833333333333333
9	5	20	4.5	2023-02-02	grape	0.18867924528301888	4.8125
9	4	20	5.5	2023-02-07	None	0.18867924528301888	4.852941176470588
4	2	25	5.5	2023-01-10	mango	0.3584905660377358	4.888888888888889
4	10	30	5.5	2023-01-11	nectarine	0.37735849056603776	4.921052631578948
4	9	30	5.5	2023-01-12	orange	0.37735849056603776	4.95
11	9	30	5.5	2023-02-12	orange	0.37735849056603776	4.976190476190476
13	4	35	8.5	None	None	0.4339622641509434	5.136363636363637
4	8	35	6.5	2023-01-13	papaya	0.4339622641509434	5.195652173913044
4	7	35	6.5	2023-01-14	pineapple	0.4339622641509434	5.25
4	6	35	7.5	2023-01-15	quince	0.4339622641509434	5.34
4	5	35	7.5	2023-01-16	raspberry	0.4339622641509434	5.423076923076923
5	4	35	8.5	2023-01-17	strawberry	0.4339622641509434	5.537037037037037
12	8	35	6.5	2023-02-13	None	0.4339622641509434	5.571428571428571
13	7	35	6.5	2023-02-14	pineapple	0.4339622641509434	5.603448275862069
13	5	35	7.5	2023-02-16	None	0.4339622641509434	5.666666666666667
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604	5.758064516129032
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604	5.84375
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604	5.924242424242424
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604	6.0
14	2	40	None	2023-02-19	ugli fruit	0.6037735849056604	6.0
14	1	40	None	2023-02-20	vanilla	0.6037735849056604	6.0
15	9	45	10.5	None	xigua	0.7169811320754716	6.128571428571429
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716	6.222222222222222
6	9	45	10.5	2023-01-22	xigua	0.7169811320754716	6.337837837837838
10	2	45	5.5	2023-02-09	None	0.7169811320754716	6.315789473684211
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716	6.397435897435898
16	8	50	11.5	None	None	0.8113207547169812	6.525
6	8	50	11.5	2023-01-23	yumberry	0.8113207547169812	6.646341463414634
6	7	50	12.5	2023-01-24	zucchini	0.8113207547169812	6.785714285714286
16	7	50	12.5	2023-02-24	None	0.8113207547169812	6.9186046511627906
6	6	55	13.5	2023-01-25	acerola	0.8867924528301887	7.068181818181818
16	6	55	13.5	2023-02-25	acerola	0.8867924528301887	7.211111111111111
17	4	60	13.5	None	cloudberry	0.9245283018867925	7.3478260869565215
6	5	60	13.5	2023-01-26	bilberry	0.9245283018867925	7.4787234042553195
7	4	60	13.5	2023-01-27	cloudberry	0.9245283018867925	7.604166666666667
7	3	60	14.5	2023-01-28	dewberry	0.9245283018867925	7.744897959183674
17	3	60	14.5	2023-02-28	dewberry	0.9245283018867925	7.88
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v2) AS percent_rank_v2, SUM(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS sum_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.2641509433962264	5.5
8	2	None	2.5	2023-01-29	None	0.07547169811320754	8.0
8	7	None	3.5	2023-01-31	date	0.1320754716981132	11.5
8	6	None	None	2023-02-01	fig	0.0	11.5
13	6	None	7.5	2023-02-15	quince	0.5283018867924528	19.0
16	5	None	13.5	2023-02-26	bilberry	0.8679245283018868	32.5
1	10	15	2.5	2023-01-01	apple	0.07547169811320754	35.0
1	2	15	2.5	2023-01-02	banana	0.07547169811320754	37.5
1	8	15	3.5	2023-01-03	cherry	0.1320754716981132	41.0
8	8	15	3.5	2023-01-30	None	0.1320754716981132	44.5
10	3	20	None	None	kiwi	0.0	44.5
1	7	20	3.5	2023-01-04	date	0.1320754716981132	48.0
2	6	20	3.5	2023-01-05	fig	0.1320754716981132	51.5
2	5	20	4.5	2023-01-06	grape	0.22641509433962265	56.0
2	4	20	5.5	2023-01-07	honeydew	0.2641509433962264	61.5
3	3	20	5.5	2023-01-08	kiwi	0.2641509433962264	67.0
3	2	20	5.5	2023-01-09	lemon	0.2641509433962264	72.5
9	5	20	4.5	2023-02-02	grape	0.22641509433962265	77.0
9	4	20	5.5	2023-02-07	None	0.2641509433962264	82.5
4	2	25	5.5	2023-01-10	mango	0.2641509433962264	88.0
4	10	30	5.5	2023-01-11	nectarine	0.2641509433962264	93.5
4	9	30	5.5	2023-01-12	orange	0.2641509433962264	99.0
11	9	30	5.5	2023-02-12	orange	0.2641509433962264	104.5
13	4	35	8.5	None	None	0.6037735849056604	113.0
4	8	35	6.5	2023-01-13	papaya	0.4528301886792453	119.5
4	7	35	6.5	2023-01-14	pineapple	0.4528301886792453	126.0
4	6	35	7.5	2023-01-15	quince	0.5283018867924528	133.5
4	5	35	7.5	2023-01-16	raspberry	0.5283018867924528	141.0
5	4	35	8.5	2023-01-17	strawberry	0.6037735849056604	149.5
12	8	35	6.5	2023-02-13	None	0.4528301886792453	156.0
13	7	35	6.5	2023-02-14	pineapple	0.4528301886792453	162.5
13	5	35	7.5	2023-02-16	None	0.5283018867924528	170.0
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604	178.5
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604	187.0
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604	195.5
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604	204.0
14	2	40	None	2023-02-19	ugli fruit	0.0	204.0
14	1	40	None	2023-02-20	vanilla	0.0	204.0
15	9	45	10.5	None	xigua	0.7547169811320755	214.5
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716	224.0
6	9	45	10.5	2023-01-22	xigua	0.7547169811320755	234.5
10	2	45	5.5	2023-02-09	None	0.2641509433962264	240.0
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716	249.5
16	8	50	11.5	None	None	0.7924528301886793	261.0
6	8	50	11.5	2023-01-23	yumberry	0.7924528301886793	272.5
6	7	50	12.5	2023-01-24	zucchini	0.8301886792452831	285.0
16	7	50	12.5	2023-02-24	None	0.8301886792452831	297.5
6	6	55	13.5	2023-01-25	acerola	0.8679245283018868	311.0
16	6	55	13.5	2023-02-25	acerola	0.8679245283018868	324.5
17	4	60	13.5	None	cloudberry	0.8679245283018868	338.0
6	5	60	13.5	2023-01-26	bilberry	0.8679245283018868	351.5
7	4	60	13.5	2023-01-27	cloudberry	0.8679245283018868	365.0
7	3	60	14.5	2023-01-28	dewberry	0.9811320754716981	379.5
17	3	60	14.5	2023-02-28	dewberry	0.9811320754716981	394.0
-- !result
SELECT *, PERCENT_RANK() OVER (ORDER BY v1) AS percent_rank_v1, MIN(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.0	5.5
8	2	None	2.5	2023-01-29	None	0.0	2.5
8	7	None	3.5	2023-01-31	date	0.0	2.5
8	6	None	None	2023-02-01	fig	0.0	2.5
13	6	None	7.5	2023-02-15	quince	0.0	2.5
16	5	None	13.5	2023-02-26	bilberry	0.0	2.5
1	10	15	2.5	2023-01-01	apple	0.11320754716981132	2.5
1	2	15	2.5	2023-01-02	banana	0.11320754716981132	2.5
1	8	15	3.5	2023-01-03	cherry	0.11320754716981132	2.5
8	8	15	3.5	2023-01-30	None	0.11320754716981132	2.5
10	3	20	None	None	kiwi	0.18867924528301888	2.5
1	7	20	3.5	2023-01-04	date	0.18867924528301888	2.5
2	6	20	3.5	2023-01-05	fig	0.18867924528301888	2.5
2	5	20	4.5	2023-01-06	grape	0.18867924528301888	2.5
2	4	20	5.5	2023-01-07	honeydew	0.18867924528301888	2.5
3	3	20	5.5	2023-01-08	kiwi	0.18867924528301888	2.5
3	2	20	5.5	2023-01-09	lemon	0.18867924528301888	2.5
9	5	20	4.5	2023-02-02	grape	0.18867924528301888	2.5
9	4	20	5.5	2023-02-07	None	0.18867924528301888	2.5
4	2	25	5.5	2023-01-10	mango	0.3584905660377358	2.5
4	10	30	5.5	2023-01-11	nectarine	0.37735849056603776	2.5
4	9	30	5.5	2023-01-12	orange	0.37735849056603776	2.5
11	9	30	5.5	2023-02-12	orange	0.37735849056603776	2.5
13	4	35	8.5	None	None	0.4339622641509434	2.5
4	8	35	6.5	2023-01-13	papaya	0.4339622641509434	2.5
4	7	35	6.5	2023-01-14	pineapple	0.4339622641509434	2.5
4	6	35	7.5	2023-01-15	quince	0.4339622641509434	2.5
4	5	35	7.5	2023-01-16	raspberry	0.4339622641509434	2.5
5	4	35	8.5	2023-01-17	strawberry	0.4339622641509434	2.5
12	8	35	6.5	2023-02-13	None	0.4339622641509434	2.5
13	7	35	6.5	2023-02-14	pineapple	0.4339622641509434	2.5
13	5	35	7.5	2023-02-16	None	0.4339622641509434	2.5
5	3	40	8.5	2023-01-18	tangerine	0.6037735849056604	2.5
5	2	40	8.5	2023-01-19	ugli fruit	0.6037735849056604	2.5
5	1	40	8.5	2023-01-20	vanilla	0.6037735849056604	2.5
13	3	40	8.5	2023-02-18	tangerine	0.6037735849056604	2.5
14	2	40	None	2023-02-19	ugli fruit	0.6037735849056604	2.5
14	1	40	None	2023-02-20	vanilla	0.6037735849056604	2.5
15	9	45	10.5	None	xigua	0.7169811320754716	2.5
5	10	45	9.5	2023-01-21	watermelon	0.7169811320754716	2.5
6	9	45	10.5	2023-01-22	xigua	0.7169811320754716	2.5
10	2	45	5.5	2023-02-09	None	0.7169811320754716	2.5
14	10	45	9.5	2023-02-21	watermelon	0.7169811320754716	2.5
16	8	50	11.5	None	None	0.8113207547169812	2.5
6	8	50	11.5	2023-01-23	yumberry	0.8113207547169812	2.5
6	7	50	12.5	2023-01-24	zucchini	0.8113207547169812	2.5
16	7	50	12.5	2023-02-24	None	0.8113207547169812	2.5
6	6	55	13.5	2023-01-25	acerola	0.8867924528301887	2.5
16	6	55	13.5	2023-02-25	acerola	0.8867924528301887	2.5
17	4	60	13.5	None	cloudberry	0.9245283018867925	2.5
6	5	60	13.5	2023-01-26	bilberry	0.9245283018867925	2.5
7	4	60	13.5	2023-01-27	cloudberry	0.9245283018867925	2.5
7	3	60	14.5	2023-01-28	dewberry	0.9245283018867925	2.5
17	3	60	14.5	2023-02-28	dewberry	0.9245283018867925	2.5
-- !result
DROP TABLE IF EXISTS `cume_test`;
-- result:
-- !result
