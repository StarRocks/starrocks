-- name: test_cume_window_function
DROP TABLE IF EXISTS `cume_test`;
-- result:
-- !result
CREATE TABLE IF NOT EXISTS `cume_test` (
  k1 INT,
  k2 INT,
  v1 INT SUM,
  v2 DOUBLE MAX,
  v3 DATE MIN,
  v4 VARCHAR(20) REPLACE
)
ENGINE = olap
AGGREGATE KEY(k1, k2)
DISTRIBUTED BY HASH(`k1`)
PROPERTIES(
  "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `cume_test` (k1, k2, v1, v2, v3, v4)
VALUES (1, 10, 15, 2.5, '2023-01-01', 'apple'),
       (1, 2, 15, 2.5, '2023-01-02', 'banana'),
       (1, 8, 15, 3.5, '2023-01-03', 'cherry'),
       (1, 7, 20, 3.5, '2023-01-04', 'date'),
       (2, 6, 20, 3.5, '2023-01-05', 'fig'),
       (2, 5, 20, 4.5, '2023-01-06', 'grape'),
       (2, 4, 20, 5.5, '2023-01-07', 'honeydew'),
       (3, 3, 20, 5.5, '2023-01-08', 'kiwi'),
       (3, 2, 20, 5.5, '2023-01-09', 'lemon'),
       (4, 2, 25, 5.5, '2023-01-10', 'mango'),
       (4, 10, 30, 5.5, '2023-01-11', 'nectarine'),
       (4, 9, 30, 5.5, '2023-01-12', 'orange'),
       (4, 8, 35, 6.5, '2023-01-13', 'papaya'),
       (4, 7, 35, 6.5, '2023-01-14', 'pineapple'),
       (4, 6, 35, 7.5, '2023-01-15', 'quince'),
       (4, 5, 35, 7.5, '2023-01-16', 'raspberry'),
       (5, 4, 35, 8.5, '2023-01-17', 'strawberry'),
       (5, 3, 40, 8.5, '2023-01-18', 'tangerine'),
       (5, 2, 40, 8.5, '2023-01-19', 'ugli fruit'),
       (5, 1, 40, 8.5, '2023-01-20', 'vanilla'),
       (5, 10, 45, 9.5, '2023-01-21', 'watermelon'),
       (6, 9, 45, 10.5, '2023-01-22', 'xigua'),
       (6, 8, 50, 11.5, '2023-01-23', 'yumberry'),
       (6, 7, 50, 12.5, '2023-01-24', 'zucchini'),
       (6, 6, 55, 13.5, '2023-01-25', 'acerola'),
       (6, 5, 60, 13.5, '2023-01-26', 'bilberry'),
       (7, 4, 60, 13.5, '2023-01-27', 'cloudberry'),
       (7, 3, 60, 14.5, '2023-01-28', 'dewberry'),
       (8, 2, null, 2.5, '2023-01-29', null),
       (8, 8, 15, 3.5, '2023-01-30', null),
       (8, 7, null, 3.5, '2023-01-31', 'date'),
       (8, 6, null, null, '2023-02-01', 'fig'),
       (9, 5, 20, 4.5, '2023-02-02', 'grape'),
       (9, 4, 20, 5.5, '2023-02-07', null),
       (10, 3, 20, null, null, 'kiwi'),
       (10, 2, 20, 5.5, '2023-02-09', 'lemon'),
       (10, 2, 25, 5.5, '2023-02-10', null),
       (11, 10, null, 5.5, null, null),
       (11, 9, 30, 5.5, '2023-02-12', 'orange'),
       (12, 8, 35, 6.5, '2023-02-13', null),
       (13, 7, 35, 6.5, '2023-02-14', 'pineapple'),
       (13, 6, null, 7.5, '2023-02-15', 'quince'),
       (13, 5, 35, 7.5, '2023-02-16', null),
       (13, 4, 35, 8.5, null, null),
       (13, 3, 40, 8.5, '2023-02-18', 'tangerine'),
       (14, 2, 40, null, '2023-02-19', 'ugli fruit'),
       (14, 1, 40, null, '2023-02-20', 'vanilla'),
       (14, 10, 45, 9.5, '2023-02-21', 'watermelon'),
       (15, 9, 45, 10.5, null, 'xigua'),
       (16, 8, 50, 11.5, null, null),
       (16, 7, 50, 12.5, '2023-02-24', null),
       (16, 6, 55, 13.5, '2023-02-25', 'acerola'),
       (16, 5, null, 13.5, '2023-02-26', 'bilberry'),
       (17, 4, 60, 13.5, null, 'cloudberry'),
       (17, 3, 60, 14.5, '2023-02-28', 'dewberry');
-- result:
-- !result
SELECT *, CUME_DIST() OVER () AS cume_dist_without_order_by FROM cume_test;
-- result:
3	2	20	5.5	2023-01-09	lemon	1.0
3	3	20	5.5	2023-01-08	kiwi	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
5	3	40	8.5	2023-01-18	tangerine	1.0
5	4	35	8.5	2023-01-17	strawberry	1.0
5	10	45	9.5	2023-01-21	watermelon	1.0
6	5	60	13.5	2023-01-26	bilberry	1.0
6	6	55	13.5	2023-01-25	acerola	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0
6	8	50	11.5	2023-01-23	yumberry	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
9	4	20	5.5	2023-02-07	None	1.0
9	5	20	4.5	2023-02-02	grape	1.0
10	2	45	5.5	2023-02-09	None	1.0
10	3	20	None	None	kiwi	1.0
12	8	35	6.5	2023-02-13	None	1.0
15	9	45	10.5	None	xigua	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
17	4	60	13.5	None	cloudberry	1.0
1	2	15	2.5	2023-01-02	banana	1.0
1	7	20	3.5	2023-01-04	date	1.0
1	8	15	3.5	2023-01-03	cherry	1.0
1	10	15	2.5	2023-01-01	apple	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
2	5	20	4.5	2023-01-06	grape	1.0
2	6	20	3.5	2023-01-05	fig	1.0
4	2	25	5.5	2023-01-10	mango	1.0
4	5	35	7.5	2023-01-16	raspberry	1.0
4	6	35	7.5	2023-01-15	quince	1.0
4	7	35	6.5	2023-01-14	pineapple	1.0
4	8	35	6.5	2023-01-13	papaya	1.0
4	9	30	5.5	2023-01-12	orange	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
8	2	None	2.5	2023-01-29	None	1.0
8	6	None	None	2023-02-01	fig	1.0
8	7	None	3.5	2023-01-31	date	1.0
8	8	15	3.5	2023-01-30	None	1.0
11	9	30	5.5	2023-02-12	orange	1.0
11	10	None	5.5	None	None	1.0
13	3	40	8.5	2023-02-18	tangerine	1.0
13	4	35	8.5	None	None	1.0
13	5	35	7.5	2023-02-16	None	1.0
13	6	None	7.5	2023-02-15	quince	1.0
13	7	35	6.5	2023-02-14	pineapple	1.0
14	1	40	None	2023-02-20	vanilla	1.0
14	2	40	None	2023-02-19	ugli fruit	1.0
14	10	45	9.5	2023-02-21	watermelon	1.0
16	5	None	13.5	2023-02-26	bilberry	1.0
16	6	55	13.5	2023-02-25	acerola	1.0
16	7	50	12.5	2023-02-24	None	1.0
16	8	50	11.5	None	None	1.0
-- !result
SELECT *, CUME_DIST() OVER () AS cume_dist_without_order_by FROM cume_test ORDER BY v1 DESC;
-- result:
17	4	60	13.5	None	cloudberry	1.0
6	5	60	13.5	2023-01-26	bilberry	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
6	6	55	13.5	2023-01-25	acerola	1.0
16	6	55	13.5	2023-02-25	acerola	1.0
6	8	50	11.5	2023-01-23	yumberry	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0
16	8	50	11.5	None	None	1.0
16	7	50	12.5	2023-02-24	None	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
5	10	45	9.5	2023-01-21	watermelon	1.0
10	2	45	5.5	2023-02-09	None	1.0
14	10	45	9.5	2023-02-21	watermelon	1.0
15	9	45	10.5	None	xigua	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0
13	3	40	8.5	2023-02-18	tangerine	1.0
5	3	40	8.5	2023-01-18	tangerine	1.0
14	1	40	None	2023-02-20	vanilla	1.0
14	2	40	None	2023-02-19	ugli fruit	1.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
5	4	35	8.5	2023-01-17	strawberry	1.0
12	8	35	6.5	2023-02-13	None	1.0
13	4	35	8.5	None	None	1.0
13	5	35	7.5	2023-02-16	None	1.0
13	7	35	6.5	2023-02-14	pineapple	1.0
4	8	35	6.5	2023-01-13	papaya	1.0
4	7	35	6.5	2023-01-14	pineapple	1.0
4	6	35	7.5	2023-01-15	quince	1.0
4	5	35	7.5	2023-01-16	raspberry	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
4	9	30	5.5	2023-01-12	orange	1.0
11	9	30	5.5	2023-02-12	orange	1.0
4	2	25	5.5	2023-01-10	mango	1.0
9	5	20	4.5	2023-02-02	grape	1.0
3	3	20	5.5	2023-01-08	kiwi	1.0
3	2	20	5.5	2023-01-09	lemon	1.0
10	3	20	None	None	kiwi	1.0
2	6	20	3.5	2023-01-05	fig	1.0
2	5	20	4.5	2023-01-06	grape	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
1	7	20	3.5	2023-01-04	date	1.0
9	4	20	5.5	2023-02-07	None	1.0
8	8	15	3.5	2023-01-30	None	1.0
1	10	15	2.5	2023-01-01	apple	1.0
1	8	15	3.5	2023-01-03	cherry	1.0
1	2	15	2.5	2023-01-02	banana	1.0
16	5	None	13.5	2023-02-26	bilberry	1.0
13	6	None	7.5	2023-02-15	quince	1.0
11	10	None	5.5	None	None	1.0
8	7	None	3.5	2023-01-31	date	1.0
8	6	None	None	2023-02-01	fig	1.0
8	2	None	2.5	2023-01-29	None	1.0
-- !result
SELECT *, CUME_DIST() OVER () AS cume_dist_without_order_by FROM cume_test ORDER BY v2;
-- result:
14	2	40	None	2023-02-19	ugli fruit	1.0
14	1	40	None	2023-02-20	vanilla	1.0
8	6	None	None	2023-02-01	fig	1.0
10	3	20	None	None	kiwi	1.0
1	10	15	2.5	2023-01-01	apple	1.0
1	2	15	2.5	2023-01-02	banana	1.0
8	2	None	2.5	2023-01-29	None	1.0
8	8	15	3.5	2023-01-30	None	1.0
2	6	20	3.5	2023-01-05	fig	1.0
1	8	15	3.5	2023-01-03	cherry	1.0
1	7	20	3.5	2023-01-04	date	1.0
8	7	None	3.5	2023-01-31	date	1.0
2	5	20	4.5	2023-01-06	grape	1.0
9	5	20	4.5	2023-02-02	grape	1.0
4	9	30	5.5	2023-01-12	orange	1.0
10	2	45	5.5	2023-02-09	None	1.0
9	4	20	5.5	2023-02-07	None	1.0
11	9	30	5.5	2023-02-12	orange	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
11	10	None	5.5	None	None	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
3	3	20	5.5	2023-01-08	kiwi	1.0
3	2	20	5.5	2023-01-09	lemon	1.0
4	2	25	5.5	2023-01-10	mango	1.0
12	8	35	6.5	2023-02-13	None	1.0
13	7	35	6.5	2023-02-14	pineapple	1.0
4	7	35	6.5	2023-01-14	pineapple	1.0
4	8	35	6.5	2023-01-13	papaya	1.0
13	5	35	7.5	2023-02-16	None	1.0
13	6	None	7.5	2023-02-15	quince	1.0
4	5	35	7.5	2023-01-16	raspberry	1.0
4	6	35	7.5	2023-01-15	quince	1.0
5	3	40	8.5	2023-01-18	tangerine	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
13	3	40	8.5	2023-02-18	tangerine	1.0
13	4	35	8.5	None	None	1.0
5	4	35	8.5	2023-01-17	strawberry	1.0
5	10	45	9.5	2023-01-21	watermelon	1.0
14	10	45	9.5	2023-02-21	watermelon	1.0
15	9	45	10.5	None	xigua	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
6	8	50	11.5	2023-01-23	yumberry	1.0
16	8	50	11.5	None	None	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0
16	7	50	12.5	2023-02-24	None	1.0
17	4	60	13.5	None	cloudberry	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
6	6	55	13.5	2023-01-25	acerola	1.0
6	5	60	13.5	2023-01-26	bilberry	1.0
16	5	None	13.5	2023-02-26	bilberry	1.0
16	6	55	13.5	2023-02-25	acerola	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER () AS cume_dist_without_order_by, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1 FROM cume_test;
-- result:
16	5	None	13.5	2023-02-26	bilberry	1.0	0.1111111111111111
13	6	None	7.5	2023-02-15	quince	1.0	0.1111111111111111
11	10	None	5.5	None	None	1.0	0.1111111111111111
8	7	None	3.5	2023-01-31	date	1.0	0.1111111111111111
8	6	None	None	2023-02-01	fig	1.0	0.1111111111111111
8	2	None	2.5	2023-01-29	None	1.0	0.1111111111111111
1	2	15	2.5	2023-01-02	banana	1.0	0.18518518518518517
1	8	15	3.5	2023-01-03	cherry	1.0	0.18518518518518517
8	8	15	3.5	2023-01-30	None	1.0	0.18518518518518517
1	10	15	2.5	2023-01-01	apple	1.0	0.18518518518518517
3	2	20	5.5	2023-01-09	lemon	1.0	0.35185185185185186
3	3	20	5.5	2023-01-08	kiwi	1.0	0.35185185185185186
9	4	20	5.5	2023-02-07	None	1.0	0.35185185185185186
9	5	20	4.5	2023-02-02	grape	1.0	0.35185185185185186
10	3	20	None	None	kiwi	1.0	0.35185185185185186
2	5	20	4.5	2023-01-06	grape	1.0	0.35185185185185186
1	7	20	3.5	2023-01-04	date	1.0	0.35185185185185186
2	6	20	3.5	2023-01-05	fig	1.0	0.35185185185185186
2	4	20	5.5	2023-01-07	honeydew	1.0	0.35185185185185186
4	2	25	5.5	2023-01-10	mango	1.0	0.37037037037037035
11	9	30	5.5	2023-02-12	orange	1.0	0.42592592592592593
4	10	30	5.5	2023-01-11	nectarine	1.0	0.42592592592592593
4	9	30	5.5	2023-01-12	orange	1.0	0.42592592592592593
5	4	35	8.5	2023-01-17	strawberry	1.0	0.5925925925925926
12	8	35	6.5	2023-02-13	None	1.0	0.5925925925925926
4	8	35	6.5	2023-01-13	papaya	1.0	0.5925925925925926
4	7	35	6.5	2023-01-14	pineapple	1.0	0.5925925925925926
13	4	35	8.5	None	None	1.0	0.5925925925925926
13	5	35	7.5	2023-02-16	None	1.0	0.5925925925925926
4	6	35	7.5	2023-01-15	quince	1.0	0.5925925925925926
13	7	35	6.5	2023-02-14	pineapple	1.0	0.5925925925925926
4	5	35	7.5	2023-01-16	raspberry	1.0	0.5925925925925926
5	1	40	8.5	2023-01-20	vanilla	1.0	0.7037037037037037
5	2	40	8.5	2023-01-19	ugli fruit	1.0	0.7037037037037037
5	3	40	8.5	2023-01-18	tangerine	1.0	0.7037037037037037
13	3	40	8.5	2023-02-18	tangerine	1.0	0.7037037037037037
14	1	40	None	2023-02-20	vanilla	1.0	0.7037037037037037
14	2	40	None	2023-02-19	ugli fruit	1.0	0.7037037037037037
5	10	45	9.5	2023-01-21	watermelon	1.0	0.7962962962962963
6	9	45	10.5	2023-01-22	xigua	1.0	0.7962962962962963
10	2	45	5.5	2023-02-09	None	1.0	0.7962962962962963
15	9	45	10.5	None	xigua	1.0	0.7962962962962963
14	10	45	9.5	2023-02-21	watermelon	1.0	0.7962962962962963
6	7	50	12.5	2023-01-24	zucchini	1.0	0.8703703703703703
6	8	50	11.5	2023-01-23	yumberry	1.0	0.8703703703703703
16	7	50	12.5	2023-02-24	None	1.0	0.8703703703703703
16	8	50	11.5	None	None	1.0	0.8703703703703703
6	6	55	13.5	2023-01-25	acerola	1.0	0.9074074074074074
16	6	55	13.5	2023-02-25	acerola	1.0	0.9074074074074074
6	5	60	13.5	2023-01-26	bilberry	1.0	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0	1.0
17	4	60	13.5	None	cloudberry	1.0	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1 FROM cume_test;
-- result:
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111
13	6	None	7.5	2023-02-15	quince	0.1111111111111111
11	10	None	5.5	None	None	0.1111111111111111
8	7	None	3.5	2023-01-31	date	0.1111111111111111
8	6	None	None	2023-02-01	fig	0.1111111111111111
8	2	None	2.5	2023-01-29	None	0.1111111111111111
1	2	15	2.5	2023-01-02	banana	0.18518518518518517
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517
8	8	15	3.5	2023-01-30	None	0.18518518518518517
1	10	15	2.5	2023-01-01	apple	0.18518518518518517
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186
9	4	20	5.5	2023-02-07	None	0.35185185185185186
9	5	20	4.5	2023-02-02	grape	0.35185185185185186
10	3	20	None	None	kiwi	0.35185185185185186
2	5	20	4.5	2023-01-06	grape	0.35185185185185186
1	7	20	3.5	2023-01-04	date	0.35185185185185186
2	6	20	3.5	2023-01-05	fig	0.35185185185185186
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186
4	2	25	5.5	2023-01-10	mango	0.37037037037037035
11	9	30	5.5	2023-02-12	orange	0.42592592592592593
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593
4	9	30	5.5	2023-01-12	orange	0.42592592592592593
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926
12	8	35	6.5	2023-02-13	None	0.5925925925925926
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926
13	4	35	8.5	None	None	0.5925925925925926
13	5	35	7.5	2023-02-16	None	0.5925925925925926
4	6	35	7.5	2023-01-15	quince	0.5925925925925926
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037
14	1	40	None	2023-02-20	vanilla	0.7037037037037037
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963
10	2	45	5.5	2023-02-09	None	0.7962962962962963
15	9	45	10.5	None	xigua	0.7962962962962963
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703
16	7	50	12.5	2023-02-24	None	0.8703703703703703
16	8	50	11.5	None	None	0.8703703703703703
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074
6	5	60	13.5	2023-01-26	bilberry	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
17	4	60	13.5	None	cloudberry	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2 DESC) AS cume_dist_v2 FROM cume_test;
-- result:
17	3	60	14.5	2023-02-28	dewberry	0.037037037037037035
7	3	60	14.5	2023-01-28	dewberry	0.037037037037037035
6	5	60	13.5	2023-01-26	bilberry	0.14814814814814814
6	6	55	13.5	2023-01-25	acerola	0.14814814814814814
17	4	60	13.5	None	cloudberry	0.14814814814814814
16	5	None	13.5	2023-02-26	bilberry	0.14814814814814814
7	4	60	13.5	2023-01-27	cloudberry	0.14814814814814814
16	6	55	13.5	2023-02-25	acerola	0.14814814814814814
6	7	50	12.5	2023-01-24	zucchini	0.18518518518518517
16	7	50	12.5	2023-02-24	None	0.18518518518518517
6	8	50	11.5	2023-01-23	yumberry	0.2222222222222222
16	8	50	11.5	None	None	0.2222222222222222
6	9	45	10.5	2023-01-22	xigua	0.25925925925925924
15	9	45	10.5	None	xigua	0.25925925925925924
5	10	45	9.5	2023-01-21	watermelon	0.2962962962962963
14	10	45	9.5	2023-02-21	watermelon	0.2962962962962963
5	1	40	8.5	2023-01-20	vanilla	0.4074074074074074
5	2	40	8.5	2023-01-19	ugli fruit	0.4074074074074074
5	3	40	8.5	2023-01-18	tangerine	0.4074074074074074
5	4	35	8.5	2023-01-17	strawberry	0.4074074074074074
13	4	35	8.5	None	None	0.4074074074074074
13	3	40	8.5	2023-02-18	tangerine	0.4074074074074074
13	5	35	7.5	2023-02-16	None	0.48148148148148145
4	6	35	7.5	2023-01-15	quince	0.48148148148148145
4	5	35	7.5	2023-01-16	raspberry	0.48148148148148145
13	6	None	7.5	2023-02-15	quince	0.48148148148148145
12	8	35	6.5	2023-02-13	None	0.5555555555555556
4	7	35	6.5	2023-01-14	pineapple	0.5555555555555556
4	8	35	6.5	2023-01-13	papaya	0.5555555555555556
13	7	35	6.5	2023-02-14	pineapple	0.5555555555555556
3	2	20	5.5	2023-01-09	lemon	0.7407407407407407
3	3	20	5.5	2023-01-08	kiwi	0.7407407407407407
9	4	20	5.5	2023-02-07	None	0.7407407407407407
10	2	45	5.5	2023-02-09	None	0.7407407407407407
4	9	30	5.5	2023-01-12	orange	0.7407407407407407
4	10	30	5.5	2023-01-11	nectarine	0.7407407407407407
11	9	30	5.5	2023-02-12	orange	0.7407407407407407
11	10	None	5.5	None	None	0.7407407407407407
4	2	25	5.5	2023-01-10	mango	0.7407407407407407
2	4	20	5.5	2023-01-07	honeydew	0.7407407407407407
9	5	20	4.5	2023-02-02	grape	0.7777777777777778
2	5	20	4.5	2023-01-06	grape	0.7777777777777778
1	7	20	3.5	2023-01-04	date	0.8703703703703703
1	8	15	3.5	2023-01-03	cherry	0.8703703703703703
8	7	None	3.5	2023-01-31	date	0.8703703703703703
8	8	15	3.5	2023-01-30	None	0.8703703703703703
2	6	20	3.5	2023-01-05	fig	0.8703703703703703
1	2	15	2.5	2023-01-02	banana	0.9259259259259259
1	10	15	2.5	2023-01-01	apple	0.9259259259259259
8	2	None	2.5	2023-01-29	None	0.9259259259259259
10	3	20	None	None	kiwi	1.0
14	2	40	None	2023-02-19	ugli fruit	1.0
14	1	40	None	2023-02-20	vanilla	1.0
8	6	None	None	2023-02-01	fig	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3 FROM cume_test;
-- result:
17	4	60	13.5	None	cloudberry	0.1111111111111111
15	9	45	10.5	None	xigua	0.1111111111111111
10	3	20	None	None	kiwi	0.1111111111111111
16	8	50	11.5	None	None	0.1111111111111111
13	4	35	8.5	None	None	0.1111111111111111
11	10	None	5.5	None	None	0.1111111111111111
1	10	15	2.5	2023-01-01	apple	0.12962962962962962
1	2	15	2.5	2023-01-02	banana	0.14814814814814814
1	8	15	3.5	2023-01-03	cherry	0.16666666666666666
1	7	20	3.5	2023-01-04	date	0.18518518518518517
2	6	20	3.5	2023-01-05	fig	0.2037037037037037
2	5	20	4.5	2023-01-06	grape	0.2222222222222222
2	4	20	5.5	2023-01-07	honeydew	0.24074074074074073
3	3	20	5.5	2023-01-08	kiwi	0.25925925925925924
3	2	20	5.5	2023-01-09	lemon	0.2777777777777778
4	2	25	5.5	2023-01-10	mango	0.2962962962962963
4	10	30	5.5	2023-01-11	nectarine	0.3148148148148148
4	9	30	5.5	2023-01-12	orange	0.3333333333333333
4	8	35	6.5	2023-01-13	papaya	0.35185185185185186
4	7	35	6.5	2023-01-14	pineapple	0.37037037037037035
4	6	35	7.5	2023-01-15	quince	0.3888888888888889
4	5	35	7.5	2023-01-16	raspberry	0.4074074074074074
5	4	35	8.5	2023-01-17	strawberry	0.42592592592592593
5	3	40	8.5	2023-01-18	tangerine	0.4444444444444444
5	2	40	8.5	2023-01-19	ugli fruit	0.46296296296296297
5	1	40	8.5	2023-01-20	vanilla	0.48148148148148145
5	10	45	9.5	2023-01-21	watermelon	0.5
6	9	45	10.5	2023-01-22	xigua	0.5185185185185185
6	8	50	11.5	2023-01-23	yumberry	0.5370370370370371
6	7	50	12.5	2023-01-24	zucchini	0.5555555555555556
6	6	55	13.5	2023-01-25	acerola	0.5740740740740741
6	5	60	13.5	2023-01-26	bilberry	0.5925925925925926
7	4	60	13.5	2023-01-27	cloudberry	0.6111111111111112
7	3	60	14.5	2023-01-28	dewberry	0.6296296296296297
8	2	None	2.5	2023-01-29	None	0.6481481481481481
8	8	15	3.5	2023-01-30	None	0.6666666666666666
8	7	None	3.5	2023-01-31	date	0.6851851851851852
8	6	None	None	2023-02-01	fig	0.7037037037037037
9	5	20	4.5	2023-02-02	grape	0.7222222222222222
9	4	20	5.5	2023-02-07	None	0.7407407407407407
10	2	45	5.5	2023-02-09	None	0.7592592592592593
11	9	30	5.5	2023-02-12	orange	0.7777777777777778
12	8	35	6.5	2023-02-13	None	0.7962962962962963
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148
13	6	None	7.5	2023-02-15	quince	0.8333333333333334
13	5	35	7.5	2023-02-16	None	0.8518518518518519
13	3	40	8.5	2023-02-18	tangerine	0.8703703703703703
14	2	40	None	2023-02-19	ugli fruit	0.8888888888888888
14	1	40	None	2023-02-20	vanilla	0.9074074074074074
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259
16	7	50	12.5	2023-02-24	None	0.9444444444444444
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629
16	5	None	13.5	2023-02-26	bilberry	0.9814814814814815
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4 FROM cume_test;
-- result:
12	8	35	6.5	2023-02-13	None	0.18518518518518517
10	2	45	5.5	2023-02-09	None	0.18518518518518517
9	4	20	5.5	2023-02-07	None	0.18518518518518517
16	8	50	11.5	None	None	0.18518518518518517
16	7	50	12.5	2023-02-24	None	0.18518518518518517
13	5	35	7.5	2023-02-16	None	0.18518518518518517
13	4	35	8.5	None	None	0.18518518518518517
11	10	None	5.5	None	None	0.18518518518518517
8	8	15	3.5	2023-01-30	None	0.18518518518518517
8	2	None	2.5	2023-01-29	None	0.18518518518518517
6	6	55	13.5	2023-01-25	acerola	0.2222222222222222
16	6	55	13.5	2023-02-25	acerola	0.2222222222222222
1	10	15	2.5	2023-01-01	apple	0.24074074074074073
1	2	15	2.5	2023-01-02	banana	0.25925925925925924
6	5	60	13.5	2023-01-26	bilberry	0.2962962962962963
16	5	None	13.5	2023-02-26	bilberry	0.2962962962962963
1	8	15	3.5	2023-01-03	cherry	0.3148148148148148
17	4	60	13.5	None	cloudberry	0.35185185185185186
7	4	60	13.5	2023-01-27	cloudberry	0.35185185185185186
1	7	20	3.5	2023-01-04	date	0.3888888888888889
8	7	None	3.5	2023-01-31	date	0.3888888888888889
17	3	60	14.5	2023-02-28	dewberry	0.42592592592592593
7	3	60	14.5	2023-01-28	dewberry	0.42592592592592593
2	6	20	3.5	2023-01-05	fig	0.46296296296296297
8	6	None	None	2023-02-01	fig	0.46296296296296297
9	5	20	4.5	2023-02-02	grape	0.5
2	5	20	4.5	2023-01-06	grape	0.5
2	4	20	5.5	2023-01-07	honeydew	0.5185185185185185
3	3	20	5.5	2023-01-08	kiwi	0.5555555555555556
10	3	20	None	None	kiwi	0.5555555555555556
3	2	20	5.5	2023-01-09	lemon	0.5740740740740741
4	2	25	5.5	2023-01-10	mango	0.5925925925925926
4	10	30	5.5	2023-01-11	nectarine	0.6111111111111112
4	9	30	5.5	2023-01-12	orange	0.6481481481481481
11	9	30	5.5	2023-02-12	orange	0.6481481481481481
4	8	35	6.5	2023-01-13	papaya	0.6666666666666666
13	7	35	6.5	2023-02-14	pineapple	0.7037037037037037
4	7	35	6.5	2023-01-14	pineapple	0.7037037037037037
13	6	None	7.5	2023-02-15	quince	0.7407407407407407
4	6	35	7.5	2023-01-15	quince	0.7407407407407407
4	5	35	7.5	2023-01-16	raspberry	0.7592592592592593
5	4	35	8.5	2023-01-17	strawberry	0.7777777777777778
5	3	40	8.5	2023-01-18	tangerine	0.8148148148148148
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148
5	2	40	8.5	2023-01-19	ugli fruit	0.8518518518518519
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519
5	1	40	8.5	2023-01-20	vanilla	0.8888888888888888
14	1	40	None	2023-02-20	vanilla	0.8888888888888888
5	10	45	9.5	2023-01-21	watermelon	0.9259259259259259
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259
6	9	45	10.5	2023-01-22	xigua	0.9629629629629629
15	9	45	10.5	None	xigua	0.9629629629629629
6	8	50	11.5	2023-01-23	yumberry	0.9814814814814815
6	7	50	12.5	2023-01-24	zucchini	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1 FROM cume_test WHERE v1 IS NOT NULL;
-- result:
1	8	15	3.5	2023-01-03	cherry	0.08333333333333333
1	10	15	2.5	2023-01-01	apple	0.08333333333333333
1	2	15	2.5	2023-01-02	banana	0.08333333333333333
8	8	15	3.5	2023-01-30	None	0.08333333333333333
3	2	20	5.5	2023-01-09	lemon	0.2708333333333333
3	3	20	5.5	2023-01-08	kiwi	0.2708333333333333
9	4	20	5.5	2023-02-07	None	0.2708333333333333
9	5	20	4.5	2023-02-02	grape	0.2708333333333333
10	3	20	None	None	kiwi	0.2708333333333333
1	7	20	3.5	2023-01-04	date	0.2708333333333333
2	4	20	5.5	2023-01-07	honeydew	0.2708333333333333
2	5	20	4.5	2023-01-06	grape	0.2708333333333333
2	6	20	3.5	2023-01-05	fig	0.2708333333333333
4	2	25	5.5	2023-01-10	mango	0.2916666666666667
4	9	30	5.5	2023-01-12	orange	0.3541666666666667
4	10	30	5.5	2023-01-11	nectarine	0.3541666666666667
11	9	30	5.5	2023-02-12	orange	0.3541666666666667
5	4	35	8.5	2023-01-17	strawberry	0.5416666666666666
12	8	35	6.5	2023-02-13	None	0.5416666666666666
4	5	35	7.5	2023-01-16	raspberry	0.5416666666666666
4	6	35	7.5	2023-01-15	quince	0.5416666666666666
4	7	35	6.5	2023-01-14	pineapple	0.5416666666666666
4	8	35	6.5	2023-01-13	papaya	0.5416666666666666
13	4	35	8.5	None	None	0.5416666666666666
13	5	35	7.5	2023-02-16	None	0.5416666666666666
13	7	35	6.5	2023-02-14	pineapple	0.5416666666666666
5	1	40	8.5	2023-01-20	vanilla	0.6666666666666666
5	2	40	8.5	2023-01-19	ugli fruit	0.6666666666666666
5	3	40	8.5	2023-01-18	tangerine	0.6666666666666666
14	2	40	None	2023-02-19	ugli fruit	0.6666666666666666
13	3	40	8.5	2023-02-18	tangerine	0.6666666666666666
14	1	40	None	2023-02-20	vanilla	0.6666666666666666
5	10	45	9.5	2023-01-21	watermelon	0.7708333333333334
6	9	45	10.5	2023-01-22	xigua	0.7708333333333334
10	2	45	5.5	2023-02-09	None	0.7708333333333334
15	9	45	10.5	None	xigua	0.7708333333333334
14	10	45	9.5	2023-02-21	watermelon	0.7708333333333334
6	7	50	12.5	2023-01-24	zucchini	0.8541666666666666
6	8	50	11.5	2023-01-23	yumberry	0.8541666666666666
16	8	50	11.5	None	None	0.8541666666666666
16	7	50	12.5	2023-02-24	None	0.8541666666666666
6	6	55	13.5	2023-01-25	acerola	0.8958333333333334
16	6	55	13.5	2023-02-25	acerola	0.8958333333333334
6	5	60	13.5	2023-01-26	bilberry	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
17	4	60	13.5	None	cloudberry	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2 DESC) AS cume_dist_v2 FROM cume_test WHERE v2 IS NOT NULL;
-- result:
17	3	60	14.5	2023-02-28	dewberry	0.04
7	3	60	14.5	2023-01-28	dewberry	0.04
6	5	60	13.5	2023-01-26	bilberry	0.16
6	6	55	13.5	2023-01-25	acerola	0.16
17	4	60	13.5	None	cloudberry	0.16
16	6	55	13.5	2023-02-25	acerola	0.16
16	5	None	13.5	2023-02-26	bilberry	0.16
7	4	60	13.5	2023-01-27	cloudberry	0.16
6	7	50	12.5	2023-01-24	zucchini	0.2
16	7	50	12.5	2023-02-24	None	0.2
6	8	50	11.5	2023-01-23	yumberry	0.24
16	8	50	11.5	None	None	0.24
6	9	45	10.5	2023-01-22	xigua	0.28
15	9	45	10.5	None	xigua	0.28
5	10	45	9.5	2023-01-21	watermelon	0.32
14	10	45	9.5	2023-02-21	watermelon	0.32
5	1	40	8.5	2023-01-20	vanilla	0.44
5	2	40	8.5	2023-01-19	ugli fruit	0.44
5	3	40	8.5	2023-01-18	tangerine	0.44
5	4	35	8.5	2023-01-17	strawberry	0.44
13	3	40	8.5	2023-02-18	tangerine	0.44
13	4	35	8.5	None	None	0.44
13	5	35	7.5	2023-02-16	None	0.52
4	5	35	7.5	2023-01-16	raspberry	0.52
4	6	35	7.5	2023-01-15	quince	0.52
13	6	None	7.5	2023-02-15	quince	0.52
12	8	35	6.5	2023-02-13	None	0.6
4	7	35	6.5	2023-01-14	pineapple	0.6
4	8	35	6.5	2023-01-13	papaya	0.6
13	7	35	6.5	2023-02-14	pineapple	0.6
3	2	20	5.5	2023-01-09	lemon	0.8
3	3	20	5.5	2023-01-08	kiwi	0.8
9	4	20	5.5	2023-02-07	None	0.8
10	2	45	5.5	2023-02-09	None	0.8
4	2	25	5.5	2023-01-10	mango	0.8
4	9	30	5.5	2023-01-12	orange	0.8
4	10	30	5.5	2023-01-11	nectarine	0.8
2	4	20	5.5	2023-01-07	honeydew	0.8
11	9	30	5.5	2023-02-12	orange	0.8
11	10	None	5.5	None	None	0.8
9	5	20	4.5	2023-02-02	grape	0.84
2	5	20	4.5	2023-01-06	grape	0.84
2	6	20	3.5	2023-01-05	fig	0.94
8	8	15	3.5	2023-01-30	None	0.94
8	7	None	3.5	2023-01-31	date	0.94
1	8	15	3.5	2023-01-03	cherry	0.94
1	7	20	3.5	2023-01-04	date	0.94
8	2	None	2.5	2023-01-29	None	1.0
1	10	15	2.5	2023-01-01	apple	1.0
1	2	15	2.5	2023-01-02	banana	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3 FROM cume_test WHERE v3 IS NOT NULL;
-- result:
1	10	15	2.5	2023-01-01	apple	0.020833333333333332
1	2	15	2.5	2023-01-02	banana	0.041666666666666664
1	8	15	3.5	2023-01-03	cherry	0.0625
1	7	20	3.5	2023-01-04	date	0.08333333333333333
2	6	20	3.5	2023-01-05	fig	0.10416666666666667
2	5	20	4.5	2023-01-06	grape	0.125
2	4	20	5.5	2023-01-07	honeydew	0.14583333333333334
3	3	20	5.5	2023-01-08	kiwi	0.16666666666666666
3	2	20	5.5	2023-01-09	lemon	0.1875
4	2	25	5.5	2023-01-10	mango	0.20833333333333334
4	10	30	5.5	2023-01-11	nectarine	0.22916666666666666
4	9	30	5.5	2023-01-12	orange	0.25
4	8	35	6.5	2023-01-13	papaya	0.2708333333333333
4	7	35	6.5	2023-01-14	pineapple	0.2916666666666667
4	6	35	7.5	2023-01-15	quince	0.3125
4	5	35	7.5	2023-01-16	raspberry	0.3333333333333333
5	4	35	8.5	2023-01-17	strawberry	0.3541666666666667
5	3	40	8.5	2023-01-18	tangerine	0.375
5	2	40	8.5	2023-01-19	ugli fruit	0.3958333333333333
5	1	40	8.5	2023-01-20	vanilla	0.4166666666666667
5	10	45	9.5	2023-01-21	watermelon	0.4375
6	9	45	10.5	2023-01-22	xigua	0.4583333333333333
6	8	50	11.5	2023-01-23	yumberry	0.4791666666666667
6	7	50	12.5	2023-01-24	zucchini	0.5
6	6	55	13.5	2023-01-25	acerola	0.5208333333333334
6	5	60	13.5	2023-01-26	bilberry	0.5416666666666666
7	4	60	13.5	2023-01-27	cloudberry	0.5625
7	3	60	14.5	2023-01-28	dewberry	0.5833333333333334
8	2	None	2.5	2023-01-29	None	0.6041666666666666
8	8	15	3.5	2023-01-30	None	0.625
8	7	None	3.5	2023-01-31	date	0.6458333333333334
8	6	None	None	2023-02-01	fig	0.6666666666666666
9	5	20	4.5	2023-02-02	grape	0.6875
9	4	20	5.5	2023-02-07	None	0.7083333333333334
10	2	45	5.5	2023-02-09	None	0.7291666666666666
11	9	30	5.5	2023-02-12	orange	0.75
12	8	35	6.5	2023-02-13	None	0.7708333333333334
13	7	35	6.5	2023-02-14	pineapple	0.7916666666666666
13	6	None	7.5	2023-02-15	quince	0.8125
13	5	35	7.5	2023-02-16	None	0.8333333333333334
13	3	40	8.5	2023-02-18	tangerine	0.8541666666666666
14	2	40	None	2023-02-19	ugli fruit	0.875
14	1	40	None	2023-02-20	vanilla	0.8958333333333334
14	10	45	9.5	2023-02-21	watermelon	0.9166666666666666
16	7	50	12.5	2023-02-24	None	0.9375
16	6	55	13.5	2023-02-25	acerola	0.9583333333333334
16	5	None	13.5	2023-02-26	bilberry	0.9791666666666666
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4 FROM cume_test WHERE v4 IS NOT NULL;
-- result:
6	6	55	13.5	2023-01-25	acerola	0.045454545454545456
16	6	55	13.5	2023-02-25	acerola	0.045454545454545456
1	10	15	2.5	2023-01-01	apple	0.06818181818181818
1	2	15	2.5	2023-01-02	banana	0.09090909090909091
6	5	60	13.5	2023-01-26	bilberry	0.13636363636363635
16	5	None	13.5	2023-02-26	bilberry	0.13636363636363635
1	8	15	3.5	2023-01-03	cherry	0.1590909090909091
17	4	60	13.5	None	cloudberry	0.20454545454545456
7	4	60	13.5	2023-01-27	cloudberry	0.20454545454545456
1	7	20	3.5	2023-01-04	date	0.25
8	7	None	3.5	2023-01-31	date	0.25
17	3	60	14.5	2023-02-28	dewberry	0.29545454545454547
7	3	60	14.5	2023-01-28	dewberry	0.29545454545454547
2	6	20	3.5	2023-01-05	fig	0.3409090909090909
8	6	None	None	2023-02-01	fig	0.3409090909090909
9	5	20	4.5	2023-02-02	grape	0.38636363636363635
2	5	20	4.5	2023-01-06	grape	0.38636363636363635
2	4	20	5.5	2023-01-07	honeydew	0.4090909090909091
3	3	20	5.5	2023-01-08	kiwi	0.45454545454545453
10	3	20	None	None	kiwi	0.45454545454545453
3	2	20	5.5	2023-01-09	lemon	0.4772727272727273
4	2	25	5.5	2023-01-10	mango	0.5
4	10	30	5.5	2023-01-11	nectarine	0.5227272727272727
11	9	30	5.5	2023-02-12	orange	0.5681818181818182
4	9	30	5.5	2023-01-12	orange	0.5681818181818182
4	8	35	6.5	2023-01-13	papaya	0.5909090909090909
13	7	35	6.5	2023-02-14	pineapple	0.6363636363636364
4	7	35	6.5	2023-01-14	pineapple	0.6363636363636364
13	6	None	7.5	2023-02-15	quince	0.6818181818181818
4	6	35	7.5	2023-01-15	quince	0.6818181818181818
4	5	35	7.5	2023-01-16	raspberry	0.7045454545454546
5	4	35	8.5	2023-01-17	strawberry	0.7272727272727273
5	3	40	8.5	2023-01-18	tangerine	0.7727272727272727
13	3	40	8.5	2023-02-18	tangerine	0.7727272727272727
5	2	40	8.5	2023-01-19	ugli fruit	0.8181818181818182
14	2	40	None	2023-02-19	ugli fruit	0.8181818181818182
5	1	40	8.5	2023-01-20	vanilla	0.8636363636363636
14	1	40	None	2023-02-20	vanilla	0.8636363636363636
5	10	45	9.5	2023-01-21	watermelon	0.9090909090909091
14	10	45	9.5	2023-02-21	watermelon	0.9090909090909091
6	9	45	10.5	2023-01-22	xigua	0.9545454545454546
15	9	45	10.5	None	xigua	0.9545454545454546
6	8	50	11.5	2023-01-23	yumberry	0.9772727272727273
6	7	50	12.5	2023-01-24	zucchini	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY k1, k2) AS cume_dist_k1_k2 FROM cume_test;
-- result:
1	2	15	2.5	2023-01-02	banana	0.018518518518518517
1	7	20	3.5	2023-01-04	date	0.037037037037037035
1	8	15	3.5	2023-01-03	cherry	0.05555555555555555
1	10	15	2.5	2023-01-01	apple	0.07407407407407407
2	4	20	5.5	2023-01-07	honeydew	0.09259259259259259
2	5	20	4.5	2023-01-06	grape	0.1111111111111111
2	6	20	3.5	2023-01-05	fig	0.12962962962962962
3	2	20	5.5	2023-01-09	lemon	0.14814814814814814
3	3	20	5.5	2023-01-08	kiwi	0.16666666666666666
4	2	25	5.5	2023-01-10	mango	0.18518518518518517
4	5	35	7.5	2023-01-16	raspberry	0.2037037037037037
4	6	35	7.5	2023-01-15	quince	0.2222222222222222
4	7	35	6.5	2023-01-14	pineapple	0.24074074074074073
4	8	35	6.5	2023-01-13	papaya	0.25925925925925924
4	9	30	5.5	2023-01-12	orange	0.2777777777777778
4	10	30	5.5	2023-01-11	nectarine	0.2962962962962963
5	1	40	8.5	2023-01-20	vanilla	0.3148148148148148
5	2	40	8.5	2023-01-19	ugli fruit	0.3333333333333333
5	3	40	8.5	2023-01-18	tangerine	0.35185185185185186
5	4	35	8.5	2023-01-17	strawberry	0.37037037037037035
5	10	45	9.5	2023-01-21	watermelon	0.3888888888888889
6	5	60	13.5	2023-01-26	bilberry	0.4074074074074074
6	6	55	13.5	2023-01-25	acerola	0.42592592592592593
6	7	50	12.5	2023-01-24	zucchini	0.4444444444444444
6	8	50	11.5	2023-01-23	yumberry	0.46296296296296297
6	9	45	10.5	2023-01-22	xigua	0.48148148148148145
7	3	60	14.5	2023-01-28	dewberry	0.5
7	4	60	13.5	2023-01-27	cloudberry	0.5185185185185185
8	2	None	2.5	2023-01-29	None	0.5370370370370371
8	6	None	None	2023-02-01	fig	0.5555555555555556
8	7	None	3.5	2023-01-31	date	0.5740740740740741
8	8	15	3.5	2023-01-30	None	0.5925925925925926
9	4	20	5.5	2023-02-07	None	0.6111111111111112
9	5	20	4.5	2023-02-02	grape	0.6296296296296297
10	2	45	5.5	2023-02-09	None	0.6481481481481481
10	3	20	None	None	kiwi	0.6666666666666666
11	9	30	5.5	2023-02-12	orange	0.6851851851851852
11	10	None	5.5	None	None	0.7037037037037037
12	8	35	6.5	2023-02-13	None	0.7222222222222222
13	3	40	8.5	2023-02-18	tangerine	0.7407407407407407
13	4	35	8.5	None	None	0.7592592592592593
13	5	35	7.5	2023-02-16	None	0.7777777777777778
13	6	None	7.5	2023-02-15	quince	0.7962962962962963
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148
14	1	40	None	2023-02-20	vanilla	0.8333333333333334
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519
14	10	45	9.5	2023-02-21	watermelon	0.8703703703703703
15	9	45	10.5	None	xigua	0.8888888888888888
16	5	None	13.5	2023-02-26	bilberry	0.9074074074074074
16	6	55	13.5	2023-02-25	acerola	0.9259259259259259
16	7	50	12.5	2023-02-24	None	0.9444444444444444
16	8	50	11.5	None	None	0.9629629629629629
17	3	60	14.5	2023-02-28	dewberry	0.9814814814814815
17	4	60	13.5	None	cloudberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY k1 ASC, k2 DESC) AS cume_dist_k1_asc_k2_desc FROM cume_test;
-- result:
1	10	15	2.5	2023-01-01	apple	0.018518518518518517
1	8	15	3.5	2023-01-03	cherry	0.037037037037037035
1	7	20	3.5	2023-01-04	date	0.05555555555555555
1	2	15	2.5	2023-01-02	banana	0.07407407407407407
2	6	20	3.5	2023-01-05	fig	0.09259259259259259
2	5	20	4.5	2023-01-06	grape	0.1111111111111111
2	4	20	5.5	2023-01-07	honeydew	0.12962962962962962
3	3	20	5.5	2023-01-08	kiwi	0.14814814814814814
3	2	20	5.5	2023-01-09	lemon	0.16666666666666666
4	10	30	5.5	2023-01-11	nectarine	0.18518518518518517
4	9	30	5.5	2023-01-12	orange	0.2037037037037037
4	8	35	6.5	2023-01-13	papaya	0.2222222222222222
4	7	35	6.5	2023-01-14	pineapple	0.24074074074074073
4	6	35	7.5	2023-01-15	quince	0.25925925925925924
4	5	35	7.5	2023-01-16	raspberry	0.2777777777777778
4	2	25	5.5	2023-01-10	mango	0.2962962962962963
5	10	45	9.5	2023-01-21	watermelon	0.3148148148148148
5	4	35	8.5	2023-01-17	strawberry	0.3333333333333333
5	3	40	8.5	2023-01-18	tangerine	0.35185185185185186
5	2	40	8.5	2023-01-19	ugli fruit	0.37037037037037035
5	1	40	8.5	2023-01-20	vanilla	0.3888888888888889
6	9	45	10.5	2023-01-22	xigua	0.4074074074074074
6	8	50	11.5	2023-01-23	yumberry	0.42592592592592593
6	7	50	12.5	2023-01-24	zucchini	0.4444444444444444
6	6	55	13.5	2023-01-25	acerola	0.46296296296296297
6	5	60	13.5	2023-01-26	bilberry	0.48148148148148145
7	4	60	13.5	2023-01-27	cloudberry	0.5
7	3	60	14.5	2023-01-28	dewberry	0.5185185185185185
8	8	15	3.5	2023-01-30	None	0.5370370370370371
8	7	None	3.5	2023-01-31	date	0.5555555555555556
8	6	None	None	2023-02-01	fig	0.5740740740740741
8	2	None	2.5	2023-01-29	None	0.5925925925925926
9	5	20	4.5	2023-02-02	grape	0.6111111111111112
9	4	20	5.5	2023-02-07	None	0.6296296296296297
10	3	20	None	None	kiwi	0.6481481481481481
10	2	45	5.5	2023-02-09	None	0.6666666666666666
11	10	None	5.5	None	None	0.6851851851851852
11	9	30	5.5	2023-02-12	orange	0.7037037037037037
12	8	35	6.5	2023-02-13	None	0.7222222222222222
13	7	35	6.5	2023-02-14	pineapple	0.7407407407407407
13	6	None	7.5	2023-02-15	quince	0.7592592592592593
13	5	35	7.5	2023-02-16	None	0.7777777777777778
13	4	35	8.5	None	None	0.7962962962962963
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148
14	10	45	9.5	2023-02-21	watermelon	0.8333333333333334
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519
14	1	40	None	2023-02-20	vanilla	0.8703703703703703
15	9	45	10.5	None	xigua	0.8888888888888888
16	8	50	11.5	None	None	0.9074074074074074
16	7	50	12.5	2023-02-24	None	0.9259259259259259
16	6	55	13.5	2023-02-25	acerola	0.9444444444444444
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629
17	4	60	13.5	None	cloudberry	0.9814814814814815
17	3	60	14.5	2023-02-28	dewberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY v1 ORDER BY v2) AS cume_dist_v1_partition_v2 FROM cume_test;
-- result:
6	6	55	13.5	2023-01-25	acerola	1.0
16	6	55	13.5	2023-02-25	acerola	1.0
8	6	None	None	2023-02-01	fig	0.16666666666666666
8	2	None	2.5	2023-01-29	None	0.3333333333333333
8	7	None	3.5	2023-01-31	date	0.5
11	10	None	5.5	None	None	0.6666666666666666
13	6	None	7.5	2023-02-15	quince	0.8333333333333334
16	5	None	13.5	2023-02-26	bilberry	1.0
10	2	45	5.5	2023-02-09	None	0.2
14	10	45	9.5	2023-02-21	watermelon	0.6
5	10	45	9.5	2023-01-21	watermelon	0.6
15	9	45	10.5	None	xigua	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
10	3	20	None	None	kiwi	0.1111111111111111
1	7	20	3.5	2023-01-04	date	0.3333333333333333
2	6	20	3.5	2023-01-05	fig	0.3333333333333333
9	5	20	4.5	2023-02-02	grape	0.5555555555555556
2	5	20	4.5	2023-01-06	grape	0.5555555555555556
3	3	20	5.5	2023-01-08	kiwi	1.0
9	4	20	5.5	2023-02-07	None	1.0
3	2	20	5.5	2023-01-09	lemon	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
4	2	25	5.5	2023-01-10	mango	1.0
14	2	40	None	2023-02-19	ugli fruit	0.3333333333333333
14	1	40	None	2023-02-20	vanilla	0.3333333333333333
5	3	40	8.5	2023-01-18	tangerine	1.0
13	3	40	8.5	2023-02-18	tangerine	1.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0
4	9	30	5.5	2023-01-12	orange	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
11	9	30	5.5	2023-02-12	orange	1.0
6	8	50	11.5	2023-01-23	yumberry	0.5
16	8	50	11.5	None	None	0.5
6	7	50	12.5	2023-01-24	zucchini	1.0
16	7	50	12.5	2023-02-24	None	1.0
6	5	60	13.5	2023-01-26	bilberry	0.6
17	4	60	13.5	None	cloudberry	0.6
7	4	60	13.5	2023-01-27	cloudberry	0.6
17	3	60	14.5	2023-02-28	dewberry	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
1	2	15	2.5	2023-01-02	banana	0.5
1	10	15	2.5	2023-01-01	apple	0.5
1	8	15	3.5	2023-01-03	cherry	1.0
8	8	15	3.5	2023-01-30	None	1.0
12	8	35	6.5	2023-02-13	None	0.4444444444444444
4	7	35	6.5	2023-01-14	pineapple	0.4444444444444444
4	8	35	6.5	2023-01-13	papaya	0.4444444444444444
13	7	35	6.5	2023-02-14	pineapple	0.4444444444444444
4	5	35	7.5	2023-01-16	raspberry	0.7777777777777778
4	6	35	7.5	2023-01-15	quince	0.7777777777777778
13	5	35	7.5	2023-02-16	None	0.7777777777777778
5	4	35	8.5	2023-01-17	strawberry	1.0
13	4	35	8.5	None	None	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY v3 ORDER BY v4) AS cume_dist_v3_partition_v4 FROM cume_test;
-- result:
3	2	20	5.5	2023-01-09	lemon	1.0
5	10	45	9.5	2023-01-21	watermelon	1.0
11	9	30	5.5	2023-02-12	orange	1.0
5	4	35	8.5	2023-01-17	strawberry	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0
13	7	35	6.5	2023-02-14	pineapple	1.0
7	4	60	13.5	2023-01-27	cloudberry	1.0
8	6	None	None	2023-02-01	fig	1.0
9	5	20	4.5	2023-02-02	grape	1.0
9	4	20	5.5	2023-02-07	None	1.0
2	6	20	3.5	2023-01-05	fig	1.0
8	7	None	3.5	2023-01-31	date	1.0
14	10	45	9.5	2023-02-21	watermelon	1.0
1	2	15	2.5	2023-01-02	banana	1.0
1	8	15	3.5	2023-01-03	cherry	1.0
8	8	15	3.5	2023-01-30	None	1.0
5	2	40	8.5	2023-01-19	ugli fruit	1.0
4	2	25	5.5	2023-01-10	mango	1.0
4	9	30	5.5	2023-01-12	orange	1.0
16	8	50	11.5	None	None	0.5
13	4	35	8.5	None	None	0.5
11	10	None	5.5	None	None	0.5
17	4	60	13.5	None	cloudberry	0.6666666666666666
10	3	20	None	None	kiwi	0.8333333333333334
15	9	45	10.5	None	xigua	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
16	7	50	12.5	2023-02-24	None	1.0
10	2	45	5.5	2023-02-09	None	1.0
12	8	35	6.5	2023-02-13	None	1.0
2	5	20	4.5	2023-01-06	grape	1.0
16	6	55	13.5	2023-02-25	acerola	1.0
16	5	None	13.5	2023-02-26	bilberry	1.0
5	1	40	8.5	2023-01-20	vanilla	1.0
7	3	60	14.5	2023-01-28	dewberry	1.0
17	3	60	14.5	2023-02-28	dewberry	1.0
3	3	20	5.5	2023-01-08	kiwi	1.0
4	8	35	6.5	2023-01-13	papaya	1.0
14	2	40	None	2023-02-19	ugli fruit	1.0
1	7	20	3.5	2023-01-04	date	1.0
8	2	None	2.5	2023-01-29	None	1.0
1	10	15	2.5	2023-01-01	apple	1.0
4	6	35	7.5	2023-01-15	quince	1.0
5	3	40	8.5	2023-01-18	tangerine	1.0
6	8	50	11.5	2023-01-23	yumberry	1.0
13	6	None	7.5	2023-02-15	quince	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
4	7	35	6.5	2023-01-14	pineapple	1.0
4	5	35	7.5	2023-01-16	raspberry	1.0
13	3	40	8.5	2023-02-18	tangerine	1.0
14	1	40	None	2023-02-20	vanilla	1.0
6	6	55	13.5	2023-01-25	acerola	1.0
6	5	60	13.5	2023-01-26	bilberry	1.0
13	5	35	7.5	2023-02-16	None	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY k1 ORDER BY k2) AS cume_dist_k1_partition_k2 FROM cume_test ORDER BY v1;
-- result:
8	2	None	2.5	2023-01-29	None	0.25
8	6	None	None	2023-02-01	fig	0.5
8	7	None	3.5	2023-01-31	date	0.75
16	5	None	13.5	2023-02-26	bilberry	0.25
11	10	None	5.5	None	None	1.0
13	6	None	7.5	2023-02-15	quince	0.8
1	10	15	2.5	2023-01-01	apple	1.0
1	2	15	2.5	2023-01-02	banana	0.25
8	8	15	3.5	2023-01-30	None	1.0
1	8	15	3.5	2023-01-03	cherry	0.75
3	3	20	5.5	2023-01-08	kiwi	1.0
3	2	20	5.5	2023-01-09	lemon	0.5
9	5	20	4.5	2023-02-02	grape	1.0
1	7	20	3.5	2023-01-04	date	0.5
10	3	20	None	None	kiwi	1.0
9	4	20	5.5	2023-02-07	None	0.5
2	4	20	5.5	2023-01-07	honeydew	0.3333333333333333
2	5	20	4.5	2023-01-06	grape	0.6666666666666666
2	6	20	3.5	2023-01-05	fig	1.0
4	2	25	5.5	2023-01-10	mango	0.14285714285714285
11	9	30	5.5	2023-02-12	orange	0.5
4	9	30	5.5	2023-01-12	orange	0.8571428571428571
4	10	30	5.5	2023-01-11	nectarine	1.0
12	8	35	6.5	2023-02-13	None	1.0
4	5	35	7.5	2023-01-16	raspberry	0.2857142857142857
4	6	35	7.5	2023-01-15	quince	0.42857142857142855
4	7	35	6.5	2023-01-14	pineapple	0.5714285714285714
4	8	35	6.5	2023-01-13	papaya	0.7142857142857143
5	4	35	8.5	2023-01-17	strawberry	0.8
13	4	35	8.5	None	None	0.4
13	5	35	7.5	2023-02-16	None	0.6
13	7	35	6.5	2023-02-14	pineapple	1.0
14	1	40	None	2023-02-20	vanilla	0.3333333333333333
14	2	40	None	2023-02-19	ugli fruit	0.6666666666666666
5	2	40	8.5	2023-01-19	ugli fruit	0.4
5	3	40	8.5	2023-01-18	tangerine	0.6
5	1	40	8.5	2023-01-20	vanilla	0.2
13	3	40	8.5	2023-02-18	tangerine	0.2
14	10	45	9.5	2023-02-21	watermelon	1.0
15	9	45	10.5	None	xigua	1.0
6	9	45	10.5	2023-01-22	xigua	1.0
10	2	45	5.5	2023-02-09	None	0.5
5	10	45	9.5	2023-01-21	watermelon	1.0
16	7	50	12.5	2023-02-24	None	0.75
16	8	50	11.5	None	None	1.0
6	7	50	12.5	2023-01-24	zucchini	0.6
6	8	50	11.5	2023-01-23	yumberry	0.8
16	6	55	13.5	2023-02-25	acerola	0.5
6	6	55	13.5	2023-01-25	acerola	0.4
6	5	60	13.5	2023-01-26	bilberry	0.2
17	3	60	14.5	2023-02-28	dewberry	0.5
17	4	60	13.5	None	cloudberry	1.0
7	3	60	14.5	2023-01-28	dewberry	0.5
7	4	60	13.5	2023-01-27	cloudberry	1.0
-- !result
SELECT *, CUME_DIST() OVER (PARTITION BY v4 ORDER BY v3) AS cume_dist_v4_partition_v3 FROM cume_test ORDER BY v2 DESC;
-- result:
7	3	60	14.5	2023-01-28	dewberry	0.5
17	3	60	14.5	2023-02-28	dewberry	1.0
6	5	60	13.5	2023-01-26	bilberry	0.5
17	4	60	13.5	None	cloudberry	0.5
7	4	60	13.5	2023-01-27	cloudberry	1.0
16	5	None	13.5	2023-02-26	bilberry	1.0
6	6	55	13.5	2023-01-25	acerola	0.5
16	6	55	13.5	2023-02-25	acerola	1.0
16	7	50	12.5	2023-02-24	None	1.0
6	7	50	12.5	2023-01-24	zucchini	1.0
6	8	50	11.5	2023-01-23	yumberry	1.0
16	8	50	11.5	None	None	0.3
6	9	45	10.5	2023-01-22	xigua	1.0
15	9	45	10.5	None	xigua	0.5
14	10	45	9.5	2023-02-21	watermelon	1.0
5	10	45	9.5	2023-01-21	watermelon	0.5
5	4	35	8.5	2023-01-17	strawberry	1.0
13	4	35	8.5	None	None	0.3
5	3	40	8.5	2023-01-18	tangerine	0.5
13	3	40	8.5	2023-02-18	tangerine	1.0
5	2	40	8.5	2023-01-19	ugli fruit	0.5
5	1	40	8.5	2023-01-20	vanilla	0.5
13	5	35	7.5	2023-02-16	None	0.9
4	6	35	7.5	2023-01-15	quince	0.5
13	6	None	7.5	2023-02-15	quince	1.0
4	5	35	7.5	2023-01-16	raspberry	1.0
12	8	35	6.5	2023-02-13	None	0.8
13	7	35	6.5	2023-02-14	pineapple	1.0
4	7	35	6.5	2023-01-14	pineapple	0.5
4	8	35	6.5	2023-01-13	papaya	1.0
3	3	20	5.5	2023-01-08	kiwi	1.0
2	4	20	5.5	2023-01-07	honeydew	1.0
4	10	30	5.5	2023-01-11	nectarine	1.0
11	10	None	5.5	None	None	0.3
9	4	20	5.5	2023-02-07	None	0.6
10	2	45	5.5	2023-02-09	None	0.7
4	2	25	5.5	2023-01-10	mango	1.0
4	9	30	5.5	2023-01-12	orange	0.5
11	9	30	5.5	2023-02-12	orange	1.0
3	2	20	5.5	2023-01-09	lemon	1.0
9	5	20	4.5	2023-02-02	grape	1.0
2	5	20	4.5	2023-01-06	grape	0.5
1	7	20	3.5	2023-01-04	date	0.5
8	7	None	3.5	2023-01-31	date	1.0
8	8	15	3.5	2023-01-30	None	0.5
1	8	15	3.5	2023-01-03	cherry	1.0
2	6	20	3.5	2023-01-05	fig	0.5
1	10	15	2.5	2023-01-01	apple	1.0
8	2	None	2.5	2023-01-29	None	0.4
1	2	15	2.5	2023-01-02	banana	1.0
8	6	None	None	2023-02-01	fig	1.0
10	3	20	None	None	kiwi	0.5
14	2	40	None	2023-02-19	ugli fruit	1.0
14	1	40	None	2023-02-20	vanilla	1.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, ROW_NUMBER() OVER (ORDER BY v1, v3) AS row_number_v1_v3 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	1
8	2	None	2.5	2023-01-29	None	0.1111111111111111	2
8	7	None	3.5	2023-01-31	date	0.1111111111111111	3
8	6	None	None	2023-02-01	fig	0.1111111111111111	4
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	5
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	6
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	7
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	8
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	9
8	8	15	3.5	2023-01-30	None	0.18518518518518517	10
10	3	20	None	None	kiwi	0.35185185185185186	11
1	7	20	3.5	2023-01-04	date	0.35185185185185186	12
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	13
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	14
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	15
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	16
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	17
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	18
9	4	20	5.5	2023-02-07	None	0.35185185185185186	19
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	20
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	21
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	22
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	23
13	4	35	8.5	None	None	0.5925925925925926	24
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	25
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	26
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	27
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	28
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	29
12	8	35	6.5	2023-02-13	None	0.5925925925925926	30
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	31
13	5	35	7.5	2023-02-16	None	0.5925925925925926	32
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	33
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	34
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	35
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	36
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	37
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	38
15	9	45	10.5	None	xigua	0.7962962962962963	39
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	40
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	41
10	2	45	5.5	2023-02-09	None	0.7962962962962963	42
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	43
16	8	50	11.5	None	None	0.8703703703703703	44
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	45
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	46
16	7	50	12.5	2023-02-24	None	0.8703703703703703	47
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	48
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	49
17	4	60	13.5	None	cloudberry	1.0	50
6	5	60	13.5	2023-01-26	bilberry	1.0	51
7	4	60	13.5	2023-01-27	cloudberry	1.0	52
7	3	60	14.5	2023-01-28	dewberry	1.0	53
17	3	60	14.5	2023-02-28	dewberry	1.0	54
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2, RANK() OVER (ORDER BY v1) AS rank_v1 FROM cume_test;
-- result:
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629	1
13	6	None	7.5	2023-02-15	quince	0.5925925925925926	1
11	10	None	5.5	None	None	0.4444444444444444	1
8	6	None	None	2023-02-01	fig	0.07407407407407407	1
8	2	None	2.5	2023-01-29	None	0.12962962962962962	1
8	7	None	3.5	2023-01-31	date	0.2222222222222222	1
1	2	15	2.5	2023-01-02	banana	0.12962962962962962	7
8	8	15	3.5	2023-01-30	None	0.2222222222222222	7
1	8	15	3.5	2023-01-03	cherry	0.2222222222222222	7
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	7
2	4	20	5.5	2023-01-07	honeydew	0.4444444444444444	11
2	6	20	3.5	2023-01-05	fig	0.2222222222222222	11
1	7	20	3.5	2023-01-04	date	0.2222222222222222	11
9	5	20	4.5	2023-02-02	grape	0.25925925925925924	11
2	5	20	4.5	2023-01-06	grape	0.25925925925925924	11
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444	11
9	4	20	5.5	2023-02-07	None	0.4444444444444444	11
10	3	20	None	None	kiwi	0.07407407407407407	11
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	11
4	2	25	5.5	2023-01-10	mango	0.4444444444444444	20
4	10	30	5.5	2023-01-11	nectarine	0.4444444444444444	21
4	9	30	5.5	2023-01-12	orange	0.4444444444444444	21
11	9	30	5.5	2023-02-12	orange	0.4444444444444444	21
5	4	35	8.5	2023-01-17	strawberry	0.7037037037037037	24
12	8	35	6.5	2023-02-13	None	0.5185185185185185	24
4	8	35	6.5	2023-01-13	papaya	0.5185185185185185	24
4	7	35	6.5	2023-01-14	pineapple	0.5185185185185185	24
13	7	35	6.5	2023-02-14	pineapple	0.5185185185185185	24
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	24
13	5	35	7.5	2023-02-16	None	0.5925925925925926	24
13	4	35	8.5	None	None	0.7037037037037037	24
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	24
14	2	40	None	2023-02-19	ugli fruit	0.07407407407407407	33
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	33
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	33
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	33
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	33
14	1	40	None	2023-02-20	vanilla	0.07407407407407407	33
5	10	45	9.5	2023-01-21	watermelon	0.7407407407407407	39
14	10	45	9.5	2023-02-21	watermelon	0.7407407407407407	39
6	9	45	10.5	2023-01-22	xigua	0.7777777777777778	39
15	9	45	10.5	None	xigua	0.7777777777777778	39
10	2	45	5.5	2023-02-09	None	0.4444444444444444	39
6	8	50	11.5	2023-01-23	yumberry	0.8148148148148148	44
16	8	50	11.5	None	None	0.8148148148148148	44
6	7	50	12.5	2023-01-24	zucchini	0.8518518518518519	44
16	7	50	12.5	2023-02-24	None	0.8518518518518519	44
6	6	55	13.5	2023-01-25	acerola	0.9629629629629629	48
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	48
6	5	60	13.5	2023-01-26	bilberry	0.9629629629629629	50
17	4	60	13.5	None	cloudberry	0.9629629629629629	50
7	4	60	13.5	2023-01-27	cloudberry	0.9629629629629629	50
17	3	60	14.5	2023-02-28	dewberry	1.0	50
7	3	60	14.5	2023-01-28	dewberry	1.0	50
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3, DENSE_RANK() OVER (ORDER BY v1) AS dense_rank_v1 FROM cume_test;
-- result:
16	5	None	13.5	2023-02-26	bilberry	0.9814814814814815	1
13	6	None	7.5	2023-02-15	quince	0.8333333333333334	1
8	6	None	None	2023-02-01	fig	0.7037037037037037	1
8	7	None	3.5	2023-01-31	date	0.6851851851851852	1
8	2	None	2.5	2023-01-29	None	0.6481481481481481	1
11	10	None	5.5	None	None	0.1111111111111111	1
1	2	15	2.5	2023-01-02	banana	0.14814814814814814	2
1	8	15	3.5	2023-01-03	cherry	0.16666666666666666	2
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	2
8	8	15	3.5	2023-01-30	None	0.6666666666666666	2
1	7	20	3.5	2023-01-04	date	0.18518518518518517	3
2	6	20	3.5	2023-01-05	fig	0.2037037037037037	3
2	5	20	4.5	2023-01-06	grape	0.2222222222222222	3
2	4	20	5.5	2023-01-07	honeydew	0.24074074074074073	3
3	3	20	5.5	2023-01-08	kiwi	0.25925925925925924	3
3	2	20	5.5	2023-01-09	lemon	0.2777777777777778	3
10	3	20	None	None	kiwi	0.1111111111111111	3
9	5	20	4.5	2023-02-02	grape	0.7222222222222222	3
9	4	20	5.5	2023-02-07	None	0.7407407407407407	3
4	2	25	5.5	2023-01-10	mango	0.2962962962962963	4
11	9	30	5.5	2023-02-12	orange	0.7777777777777778	5
4	10	30	5.5	2023-01-11	nectarine	0.3148148148148148	5
4	9	30	5.5	2023-01-12	orange	0.3333333333333333	5
4	7	35	6.5	2023-01-14	pineapple	0.37037037037037035	6
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148	6
12	8	35	6.5	2023-02-13	None	0.7962962962962963	6
13	5	35	7.5	2023-02-16	None	0.8518518518518519	6
5	4	35	8.5	2023-01-17	strawberry	0.42592592592592593	6
4	5	35	7.5	2023-01-16	raspberry	0.4074074074074074	6
4	6	35	7.5	2023-01-15	quince	0.3888888888888889	6
4	8	35	6.5	2023-01-13	papaya	0.35185185185185186	6
13	4	35	8.5	None	None	0.1111111111111111	6
13	3	40	8.5	2023-02-18	tangerine	0.8703703703703703	7
14	1	40	None	2023-02-20	vanilla	0.9074074074074074	7
14	2	40	None	2023-02-19	ugli fruit	0.8888888888888888	7
5	1	40	8.5	2023-01-20	vanilla	0.48148148148148145	7
5	2	40	8.5	2023-01-19	ugli fruit	0.46296296296296297	7
5	3	40	8.5	2023-01-18	tangerine	0.4444444444444444	7
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	8
6	9	45	10.5	2023-01-22	xigua	0.5185185185185185	8
10	2	45	5.5	2023-02-09	None	0.7592592592592593	8
15	9	45	10.5	None	xigua	0.1111111111111111	8
5	10	45	9.5	2023-01-21	watermelon	0.5	8
16	7	50	12.5	2023-02-24	None	0.9444444444444444	9
16	8	50	11.5	None	None	0.1111111111111111	9
6	7	50	12.5	2023-01-24	zucchini	0.5555555555555556	9
6	8	50	11.5	2023-01-23	yumberry	0.5370370370370371	9
6	6	55	13.5	2023-01-25	acerola	0.5740740740740741	10
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	10
7	3	60	14.5	2023-01-28	dewberry	0.6296296296296297	11
7	4	60	13.5	2023-01-27	cloudberry	0.6111111111111112	11
6	5	60	13.5	2023-01-26	bilberry	0.5925925925925926	11
17	4	60	13.5	None	cloudberry	0.1111111111111111	11
17	3	60	14.5	2023-02-28	dewberry	1.0	11
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4, NTILE(5) OVER (ORDER BY v1, v3) AS ntile_v1 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.18518518518518517	1
8	2	None	2.5	2023-01-29	None	0.18518518518518517	1
8	7	None	3.5	2023-01-31	date	0.3888888888888889	1
8	6	None	None	2023-02-01	fig	0.46296296296296297	1
13	6	None	7.5	2023-02-15	quince	0.7407407407407407	1
16	5	None	13.5	2023-02-26	bilberry	0.2962962962962963	1
1	10	15	2.5	2023-01-01	apple	0.24074074074074073	1
1	2	15	2.5	2023-01-02	banana	0.25925925925925924	1
1	8	15	3.5	2023-01-03	cherry	0.3148148148148148	1
8	8	15	3.5	2023-01-30	None	0.18518518518518517	1
10	3	20	None	None	kiwi	0.5555555555555556	1
1	7	20	3.5	2023-01-04	date	0.3888888888888889	2
2	6	20	3.5	2023-01-05	fig	0.46296296296296297	2
2	5	20	4.5	2023-01-06	grape	0.5	2
2	4	20	5.5	2023-01-07	honeydew	0.5185185185185185	2
3	3	20	5.5	2023-01-08	kiwi	0.5555555555555556	2
3	2	20	5.5	2023-01-09	lemon	0.5740740740740741	2
9	5	20	4.5	2023-02-02	grape	0.5	2
9	4	20	5.5	2023-02-07	None	0.18518518518518517	2
4	2	25	5.5	2023-01-10	mango	0.5925925925925926	2
4	10	30	5.5	2023-01-11	nectarine	0.6111111111111112	2
4	9	30	5.5	2023-01-12	orange	0.6481481481481481	2
11	9	30	5.5	2023-02-12	orange	0.6481481481481481	3
13	4	35	8.5	None	None	0.18518518518518517	3
4	8	35	6.5	2023-01-13	papaya	0.6666666666666666	3
4	7	35	6.5	2023-01-14	pineapple	0.7037037037037037	3
4	6	35	7.5	2023-01-15	quince	0.7407407407407407	3
4	5	35	7.5	2023-01-16	raspberry	0.7592592592592593	3
5	4	35	8.5	2023-01-17	strawberry	0.7777777777777778	3
12	8	35	6.5	2023-02-13	None	0.18518518518518517	3
13	7	35	6.5	2023-02-14	pineapple	0.7037037037037037	3
13	5	35	7.5	2023-02-16	None	0.18518518518518517	3
5	3	40	8.5	2023-01-18	tangerine	0.8148148148148148	3
5	2	40	8.5	2023-01-19	ugli fruit	0.8518518518518519	4
5	1	40	8.5	2023-01-20	vanilla	0.8888888888888888	4
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148	4
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519	4
14	1	40	None	2023-02-20	vanilla	0.8888888888888888	4
15	9	45	10.5	None	xigua	0.9629629629629629	4
5	10	45	9.5	2023-01-21	watermelon	0.9259259259259259	4
6	9	45	10.5	2023-01-22	xigua	0.9629629629629629	4
10	2	45	5.5	2023-02-09	None	0.18518518518518517	4
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	4
16	8	50	11.5	None	None	0.18518518518518517	4
6	8	50	11.5	2023-01-23	yumberry	0.9814814814814815	5
6	7	50	12.5	2023-01-24	zucchini	1.0	5
16	7	50	12.5	2023-02-24	None	0.18518518518518517	5
6	6	55	13.5	2023-01-25	acerola	0.2222222222222222	5
16	6	55	13.5	2023-02-25	acerola	0.2222222222222222	5
17	4	60	13.5	None	cloudberry	0.35185185185185186	5
6	5	60	13.5	2023-01-26	bilberry	0.2962962962962963	5
7	4	60	13.5	2023-01-27	cloudberry	0.35185185185185186	5
7	3	60	14.5	2023-01-28	dewberry	0.42592592592592593	5
17	3	60	14.5	2023-02-28	dewberry	0.42592592592592593	5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, LAG(v2) OVER (ORDER BY v1, v3) AS lag_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	None
8	2	None	2.5	2023-01-29	None	0.1111111111111111	5.5
8	7	None	3.5	2023-01-31	date	0.1111111111111111	2.5
8	6	None	None	2023-02-01	fig	0.1111111111111111	3.5
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	None
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	7.5
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	13.5
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	2.5
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	2.5
8	8	15	3.5	2023-01-30	None	0.18518518518518517	3.5
10	3	20	None	None	kiwi	0.35185185185185186	3.5
1	7	20	3.5	2023-01-04	date	0.35185185185185186	None
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	3.5
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	3.5
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	4.5
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	5.5
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	5.5
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	5.5
9	4	20	5.5	2023-02-07	None	0.35185185185185186	4.5
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	5.5
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	5.5
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	5.5
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	5.5
13	4	35	8.5	None	None	0.5925925925925926	5.5
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	8.5
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	6.5
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	6.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	7.5
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	7.5
12	8	35	6.5	2023-02-13	None	0.5925925925925926	8.5
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	6.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	6.5
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	7.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	8.5
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	8.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	8.5
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	8.5
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	None
15	9	45	10.5	None	xigua	0.7962962962962963	None
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	10.5
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	9.5
10	2	45	5.5	2023-02-09	None	0.7962962962962963	10.5
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	5.5
16	8	50	11.5	None	None	0.8703703703703703	9.5
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	11.5
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	11.5
16	7	50	12.5	2023-02-24	None	0.8703703703703703	12.5
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	12.5
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	13.5
17	4	60	13.5	None	cloudberry	1.0	13.5
6	5	60	13.5	2023-01-26	bilberry	1.0	13.5
7	4	60	13.5	2023-01-27	cloudberry	1.0	13.5
7	3	60	14.5	2023-01-28	dewberry	1.0	13.5
17	3	60	14.5	2023-02-28	dewberry	1.0	14.5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2, LEAD(v2) OVER (ORDER BY v1, v3) AS lead_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.4444444444444444	2.5
8	2	None	2.5	2023-01-29	None	0.12962962962962962	3.5
8	7	None	3.5	2023-01-31	date	0.2222222222222222	None
8	6	None	None	2023-02-01	fig	0.07407407407407407	7.5
13	6	None	7.5	2023-02-15	quince	0.5925925925925926	13.5
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629	2.5
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	2.5
1	2	15	2.5	2023-01-02	banana	0.12962962962962962	3.5
1	8	15	3.5	2023-01-03	cherry	0.2222222222222222	3.5
8	8	15	3.5	2023-01-30	None	0.2222222222222222	None
10	3	20	None	None	kiwi	0.07407407407407407	3.5
1	7	20	3.5	2023-01-04	date	0.2222222222222222	3.5
2	6	20	3.5	2023-01-05	fig	0.2222222222222222	4.5
2	5	20	4.5	2023-01-06	grape	0.25925925925925924	5.5
2	4	20	5.5	2023-01-07	honeydew	0.4444444444444444	5.5
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444	5.5
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	4.5
9	5	20	4.5	2023-02-02	grape	0.25925925925925924	5.5
9	4	20	5.5	2023-02-07	None	0.4444444444444444	5.5
4	2	25	5.5	2023-01-10	mango	0.4444444444444444	5.5
4	10	30	5.5	2023-01-11	nectarine	0.4444444444444444	5.5
4	9	30	5.5	2023-01-12	orange	0.4444444444444444	5.5
11	9	30	5.5	2023-02-12	orange	0.4444444444444444	8.5
13	4	35	8.5	None	None	0.7037037037037037	6.5
4	8	35	6.5	2023-01-13	papaya	0.5185185185185185	6.5
4	7	35	6.5	2023-01-14	pineapple	0.5185185185185185	7.5
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	7.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	8.5
5	4	35	8.5	2023-01-17	strawberry	0.7037037037037037	6.5
12	8	35	6.5	2023-02-13	None	0.5185185185185185	6.5
13	7	35	6.5	2023-02-14	pineapple	0.5185185185185185	7.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	8.5
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	8.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	8.5
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	8.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	None
14	2	40	None	2023-02-19	ugli fruit	0.07407407407407407	None
14	1	40	None	2023-02-20	vanilla	0.07407407407407407	10.5
15	9	45	10.5	None	xigua	0.7777777777777778	9.5
5	10	45	9.5	2023-01-21	watermelon	0.7407407407407407	10.5
6	9	45	10.5	2023-01-22	xigua	0.7777777777777778	5.5
10	2	45	5.5	2023-02-09	None	0.4444444444444444	9.5
14	10	45	9.5	2023-02-21	watermelon	0.7407407407407407	11.5
16	8	50	11.5	None	None	0.8148148148148148	11.5
6	8	50	11.5	2023-01-23	yumberry	0.8148148148148148	12.5
6	7	50	12.5	2023-01-24	zucchini	0.8518518518518519	12.5
16	7	50	12.5	2023-02-24	None	0.8518518518518519	13.5
6	6	55	13.5	2023-01-25	acerola	0.9629629629629629	13.5
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	13.5
17	4	60	13.5	None	cloudberry	0.9629629629629629	13.5
6	5	60	13.5	2023-01-26	bilberry	0.9629629629629629	13.5
7	4	60	13.5	2023-01-27	cloudberry	0.9629629629629629	14.5
7	3	60	14.5	2023-01-28	dewberry	1.0	14.5
17	3	60	14.5	2023-02-28	dewberry	1.0	None
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v3) AS cume_dist_v3, FIRST_VALUE(v2) OVER (ORDER BY v1, v3) AS first_value_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	5.5
8	2	None	2.5	2023-01-29	None	0.6481481481481481	5.5
8	7	None	3.5	2023-01-31	date	0.6851851851851852	5.5
8	6	None	None	2023-02-01	fig	0.7037037037037037	5.5
13	6	None	7.5	2023-02-15	quince	0.8333333333333334	5.5
16	5	None	13.5	2023-02-26	bilberry	0.9814814814814815	5.5
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	5.5
1	2	15	2.5	2023-01-02	banana	0.14814814814814814	5.5
1	8	15	3.5	2023-01-03	cherry	0.16666666666666666	5.5
8	8	15	3.5	2023-01-30	None	0.6666666666666666	5.5
10	3	20	None	None	kiwi	0.1111111111111111	5.5
1	7	20	3.5	2023-01-04	date	0.18518518518518517	5.5
2	6	20	3.5	2023-01-05	fig	0.2037037037037037	5.5
2	5	20	4.5	2023-01-06	grape	0.2222222222222222	5.5
2	4	20	5.5	2023-01-07	honeydew	0.24074074074074073	5.5
3	3	20	5.5	2023-01-08	kiwi	0.25925925925925924	5.5
3	2	20	5.5	2023-01-09	lemon	0.2777777777777778	5.5
9	5	20	4.5	2023-02-02	grape	0.7222222222222222	5.5
9	4	20	5.5	2023-02-07	None	0.7407407407407407	5.5
4	2	25	5.5	2023-01-10	mango	0.2962962962962963	5.5
4	10	30	5.5	2023-01-11	nectarine	0.3148148148148148	5.5
4	9	30	5.5	2023-01-12	orange	0.3333333333333333	5.5
11	9	30	5.5	2023-02-12	orange	0.7777777777777778	5.5
13	4	35	8.5	None	None	0.1111111111111111	5.5
4	8	35	6.5	2023-01-13	papaya	0.35185185185185186	5.5
4	7	35	6.5	2023-01-14	pineapple	0.37037037037037035	5.5
4	6	35	7.5	2023-01-15	quince	0.3888888888888889	5.5
4	5	35	7.5	2023-01-16	raspberry	0.4074074074074074	5.5
5	4	35	8.5	2023-01-17	strawberry	0.42592592592592593	5.5
12	8	35	6.5	2023-02-13	None	0.7962962962962963	5.5
13	7	35	6.5	2023-02-14	pineapple	0.8148148148148148	5.5
13	5	35	7.5	2023-02-16	None	0.8518518518518519	5.5
5	3	40	8.5	2023-01-18	tangerine	0.4444444444444444	5.5
5	2	40	8.5	2023-01-19	ugli fruit	0.46296296296296297	5.5
5	1	40	8.5	2023-01-20	vanilla	0.48148148148148145	5.5
13	3	40	8.5	2023-02-18	tangerine	0.8703703703703703	5.5
14	2	40	None	2023-02-19	ugli fruit	0.8888888888888888	5.5
14	1	40	None	2023-02-20	vanilla	0.9074074074074074	5.5
15	9	45	10.5	None	xigua	0.1111111111111111	5.5
5	10	45	9.5	2023-01-21	watermelon	0.5	5.5
6	9	45	10.5	2023-01-22	xigua	0.5185185185185185	5.5
10	2	45	5.5	2023-02-09	None	0.7592592592592593	5.5
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	5.5
16	8	50	11.5	None	None	0.1111111111111111	5.5
6	8	50	11.5	2023-01-23	yumberry	0.5370370370370371	5.5
6	7	50	12.5	2023-01-24	zucchini	0.5555555555555556	5.5
16	7	50	12.5	2023-02-24	None	0.9444444444444444	5.5
6	6	55	13.5	2023-01-25	acerola	0.5740740740740741	5.5
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	5.5
17	4	60	13.5	None	cloudberry	0.1111111111111111	5.5
6	5	60	13.5	2023-01-26	bilberry	0.5925925925925926	5.5
7	4	60	13.5	2023-01-27	cloudberry	0.6111111111111112	5.5
7	3	60	14.5	2023-01-28	dewberry	0.6296296296296297	5.5
17	3	60	14.5	2023-02-28	dewberry	1.0	5.5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v4) AS cume_dist_v4, LAST_VALUE(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_value_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.18518518518518517	14.5
8	2	None	2.5	2023-01-29	None	0.18518518518518517	14.5
8	7	None	3.5	2023-01-31	date	0.3888888888888889	14.5
8	6	None	None	2023-02-01	fig	0.46296296296296297	14.5
13	6	None	7.5	2023-02-15	quince	0.7407407407407407	14.5
16	5	None	13.5	2023-02-26	bilberry	0.2962962962962963	14.5
1	10	15	2.5	2023-01-01	apple	0.24074074074074073	14.5
1	2	15	2.5	2023-01-02	banana	0.25925925925925924	14.5
1	8	15	3.5	2023-01-03	cherry	0.3148148148148148	14.5
8	8	15	3.5	2023-01-30	None	0.18518518518518517	14.5
10	3	20	None	None	kiwi	0.5555555555555556	14.5
1	7	20	3.5	2023-01-04	date	0.3888888888888889	14.5
2	6	20	3.5	2023-01-05	fig	0.46296296296296297	14.5
2	5	20	4.5	2023-01-06	grape	0.5	14.5
2	4	20	5.5	2023-01-07	honeydew	0.5185185185185185	14.5
3	3	20	5.5	2023-01-08	kiwi	0.5555555555555556	14.5
3	2	20	5.5	2023-01-09	lemon	0.5740740740740741	14.5
9	5	20	4.5	2023-02-02	grape	0.5	14.5
9	4	20	5.5	2023-02-07	None	0.18518518518518517	14.5
4	2	25	5.5	2023-01-10	mango	0.5925925925925926	14.5
4	10	30	5.5	2023-01-11	nectarine	0.6111111111111112	14.5
4	9	30	5.5	2023-01-12	orange	0.6481481481481481	14.5
11	9	30	5.5	2023-02-12	orange	0.6481481481481481	14.5
13	4	35	8.5	None	None	0.18518518518518517	14.5
4	8	35	6.5	2023-01-13	papaya	0.6666666666666666	14.5
4	7	35	6.5	2023-01-14	pineapple	0.7037037037037037	14.5
4	6	35	7.5	2023-01-15	quince	0.7407407407407407	14.5
4	5	35	7.5	2023-01-16	raspberry	0.7592592592592593	14.5
5	4	35	8.5	2023-01-17	strawberry	0.7777777777777778	14.5
12	8	35	6.5	2023-02-13	None	0.18518518518518517	14.5
13	7	35	6.5	2023-02-14	pineapple	0.7037037037037037	14.5
13	5	35	7.5	2023-02-16	None	0.18518518518518517	14.5
5	3	40	8.5	2023-01-18	tangerine	0.8148148148148148	14.5
5	2	40	8.5	2023-01-19	ugli fruit	0.8518518518518519	14.5
5	1	40	8.5	2023-01-20	vanilla	0.8888888888888888	14.5
13	3	40	8.5	2023-02-18	tangerine	0.8148148148148148	14.5
14	2	40	None	2023-02-19	ugli fruit	0.8518518518518519	14.5
14	1	40	None	2023-02-20	vanilla	0.8888888888888888	14.5
15	9	45	10.5	None	xigua	0.9629629629629629	14.5
5	10	45	9.5	2023-01-21	watermelon	0.9259259259259259	14.5
6	9	45	10.5	2023-01-22	xigua	0.9629629629629629	14.5
10	2	45	5.5	2023-02-09	None	0.18518518518518517	14.5
14	10	45	9.5	2023-02-21	watermelon	0.9259259259259259	14.5
16	8	50	11.5	None	None	0.18518518518518517	14.5
6	8	50	11.5	2023-01-23	yumberry	0.9814814814814815	14.5
6	7	50	12.5	2023-01-24	zucchini	1.0	14.5
16	7	50	12.5	2023-02-24	None	0.18518518518518517	14.5
6	6	55	13.5	2023-01-25	acerola	0.2222222222222222	14.5
16	6	55	13.5	2023-02-25	acerola	0.2222222222222222	14.5
17	4	60	13.5	None	cloudberry	0.35185185185185186	14.5
6	5	60	13.5	2023-01-26	bilberry	0.2962962962962963	14.5
7	4	60	13.5	2023-01-27	cloudberry	0.35185185185185186	14.5
7	3	60	14.5	2023-01-28	dewberry	0.42592592592592593	14.5
17	3	60	14.5	2023-02-28	dewberry	0.42592592592592593	14.5
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, AVG(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS avg_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	5.5
8	2	None	2.5	2023-01-29	None	0.1111111111111111	4.0
8	7	None	3.5	2023-01-31	date	0.1111111111111111	3.8333333333333335
8	6	None	None	2023-02-01	fig	0.1111111111111111	3.8333333333333335
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	4.75
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	6.5
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	5.833333333333333
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	5.357142857142857
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	5.125
8	8	15	3.5	2023-01-30	None	0.18518518518518517	4.944444444444445
10	3	20	None	None	kiwi	0.35185185185185186	4.944444444444445
1	7	20	3.5	2023-01-04	date	0.35185185185185186	4.8
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	4.681818181818182
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	4.666666666666667
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	4.730769230769231
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	4.785714285714286
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	4.833333333333333
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	4.8125
9	4	20	5.5	2023-02-07	None	0.35185185185185186	4.852941176470588
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	4.888888888888889
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	4.921052631578948
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	4.95
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	4.976190476190476
13	4	35	8.5	None	None	0.5925925925925926	5.136363636363637
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	5.195652173913044
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	5.25
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	5.34
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	5.423076923076923
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	5.537037037037037
12	8	35	6.5	2023-02-13	None	0.5925925925925926	5.571428571428571
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	5.603448275862069
13	5	35	7.5	2023-02-16	None	0.5925925925925926	5.666666666666667
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	5.758064516129032
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	5.84375
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	5.924242424242424
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	6.0
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	6.0
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	6.0
15	9	45	10.5	None	xigua	0.7962962962962963	6.128571428571429
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	6.222222222222222
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	6.337837837837838
10	2	45	5.5	2023-02-09	None	0.7962962962962963	6.315789473684211
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	6.397435897435898
16	8	50	11.5	None	None	0.8703703703703703	6.525
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	6.646341463414634
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	6.785714285714286
16	7	50	12.5	2023-02-24	None	0.8703703703703703	6.9186046511627906
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	7.068181818181818
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	7.211111111111111
17	4	60	13.5	None	cloudberry	1.0	7.3478260869565215
6	5	60	13.5	2023-01-26	bilberry	1.0	7.4787234042553195
7	4	60	13.5	2023-01-27	cloudberry	1.0	7.604166666666667
7	3	60	14.5	2023-01-28	dewberry	1.0	7.744897959183674
17	3	60	14.5	2023-02-28	dewberry	1.0	7.88
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v2) AS cume_dist_v2, SUM(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS sum_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.4444444444444444	5.5
8	2	None	2.5	2023-01-29	None	0.12962962962962962	8.0
8	7	None	3.5	2023-01-31	date	0.2222222222222222	11.5
8	6	None	None	2023-02-01	fig	0.07407407407407407	11.5
13	6	None	7.5	2023-02-15	quince	0.5925925925925926	19.0
16	5	None	13.5	2023-02-26	bilberry	0.9629629629629629	32.5
1	10	15	2.5	2023-01-01	apple	0.12962962962962962	35.0
1	2	15	2.5	2023-01-02	banana	0.12962962962962962	37.5
1	8	15	3.5	2023-01-03	cherry	0.2222222222222222	41.0
8	8	15	3.5	2023-01-30	None	0.2222222222222222	44.5
10	3	20	None	None	kiwi	0.07407407407407407	44.5
1	7	20	3.5	2023-01-04	date	0.2222222222222222	48.0
2	6	20	3.5	2023-01-05	fig	0.2222222222222222	51.5
2	5	20	4.5	2023-01-06	grape	0.25925925925925924	56.0
2	4	20	5.5	2023-01-07	honeydew	0.4444444444444444	61.5
3	3	20	5.5	2023-01-08	kiwi	0.4444444444444444	67.0
3	2	20	5.5	2023-01-09	lemon	0.4444444444444444	72.5
9	5	20	4.5	2023-02-02	grape	0.25925925925925924	77.0
9	4	20	5.5	2023-02-07	None	0.4444444444444444	82.5
4	2	25	5.5	2023-01-10	mango	0.4444444444444444	88.0
4	10	30	5.5	2023-01-11	nectarine	0.4444444444444444	93.5
4	9	30	5.5	2023-01-12	orange	0.4444444444444444	99.0
11	9	30	5.5	2023-02-12	orange	0.4444444444444444	104.5
13	4	35	8.5	None	None	0.7037037037037037	113.0
4	8	35	6.5	2023-01-13	papaya	0.5185185185185185	119.5
4	7	35	6.5	2023-01-14	pineapple	0.5185185185185185	126.0
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	133.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	141.0
5	4	35	8.5	2023-01-17	strawberry	0.7037037037037037	149.5
12	8	35	6.5	2023-02-13	None	0.5185185185185185	156.0
13	7	35	6.5	2023-02-14	pineapple	0.5185185185185185	162.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	170.0
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	178.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	187.0
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	195.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	204.0
14	2	40	None	2023-02-19	ugli fruit	0.07407407407407407	204.0
14	1	40	None	2023-02-20	vanilla	0.07407407407407407	204.0
15	9	45	10.5	None	xigua	0.7777777777777778	214.5
5	10	45	9.5	2023-01-21	watermelon	0.7407407407407407	224.0
6	9	45	10.5	2023-01-22	xigua	0.7777777777777778	234.5
10	2	45	5.5	2023-02-09	None	0.4444444444444444	240.0
14	10	45	9.5	2023-02-21	watermelon	0.7407407407407407	249.5
16	8	50	11.5	None	None	0.8148148148148148	261.0
6	8	50	11.5	2023-01-23	yumberry	0.8148148148148148	272.5
6	7	50	12.5	2023-01-24	zucchini	0.8518518518518519	285.0
16	7	50	12.5	2023-02-24	None	0.8518518518518519	297.5
6	6	55	13.5	2023-01-25	acerola	0.9629629629629629	311.0
16	6	55	13.5	2023-02-25	acerola	0.9629629629629629	324.5
17	4	60	13.5	None	cloudberry	0.9629629629629629	338.0
6	5	60	13.5	2023-01-26	bilberry	0.9629629629629629	351.5
7	4	60	13.5	2023-01-27	cloudberry	0.9629629629629629	365.0
7	3	60	14.5	2023-01-28	dewberry	1.0	379.5
17	3	60	14.5	2023-02-28	dewberry	1.0	394.0
-- !result
SELECT *, CUME_DIST() OVER (ORDER BY v1) AS cume_dist_v1, MIN(v2) OVER (ORDER BY v1, v3 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_v2 FROM cume_test;
-- result:
11	10	None	5.5	None	None	0.1111111111111111	5.5
8	2	None	2.5	2023-01-29	None	0.1111111111111111	2.5
8	7	None	3.5	2023-01-31	date	0.1111111111111111	2.5
8	6	None	None	2023-02-01	fig	0.1111111111111111	2.5
13	6	None	7.5	2023-02-15	quince	0.1111111111111111	2.5
16	5	None	13.5	2023-02-26	bilberry	0.1111111111111111	2.5
1	10	15	2.5	2023-01-01	apple	0.18518518518518517	2.5
1	2	15	2.5	2023-01-02	banana	0.18518518518518517	2.5
1	8	15	3.5	2023-01-03	cherry	0.18518518518518517	2.5
8	8	15	3.5	2023-01-30	None	0.18518518518518517	2.5
10	3	20	None	None	kiwi	0.35185185185185186	2.5
1	7	20	3.5	2023-01-04	date	0.35185185185185186	2.5
2	6	20	3.5	2023-01-05	fig	0.35185185185185186	2.5
2	5	20	4.5	2023-01-06	grape	0.35185185185185186	2.5
2	4	20	5.5	2023-01-07	honeydew	0.35185185185185186	2.5
3	3	20	5.5	2023-01-08	kiwi	0.35185185185185186	2.5
3	2	20	5.5	2023-01-09	lemon	0.35185185185185186	2.5
9	5	20	4.5	2023-02-02	grape	0.35185185185185186	2.5
9	4	20	5.5	2023-02-07	None	0.35185185185185186	2.5
4	2	25	5.5	2023-01-10	mango	0.37037037037037035	2.5
4	10	30	5.5	2023-01-11	nectarine	0.42592592592592593	2.5
4	9	30	5.5	2023-01-12	orange	0.42592592592592593	2.5
11	9	30	5.5	2023-02-12	orange	0.42592592592592593	2.5
13	4	35	8.5	None	None	0.5925925925925926	2.5
4	8	35	6.5	2023-01-13	papaya	0.5925925925925926	2.5
4	7	35	6.5	2023-01-14	pineapple	0.5925925925925926	2.5
4	6	35	7.5	2023-01-15	quince	0.5925925925925926	2.5
4	5	35	7.5	2023-01-16	raspberry	0.5925925925925926	2.5
5	4	35	8.5	2023-01-17	strawberry	0.5925925925925926	2.5
12	8	35	6.5	2023-02-13	None	0.5925925925925926	2.5
13	7	35	6.5	2023-02-14	pineapple	0.5925925925925926	2.5
13	5	35	7.5	2023-02-16	None	0.5925925925925926	2.5
5	3	40	8.5	2023-01-18	tangerine	0.7037037037037037	2.5
5	2	40	8.5	2023-01-19	ugli fruit	0.7037037037037037	2.5
5	1	40	8.5	2023-01-20	vanilla	0.7037037037037037	2.5
13	3	40	8.5	2023-02-18	tangerine	0.7037037037037037	2.5
14	2	40	None	2023-02-19	ugli fruit	0.7037037037037037	2.5
14	1	40	None	2023-02-20	vanilla	0.7037037037037037	2.5
15	9	45	10.5	None	xigua	0.7962962962962963	2.5
5	10	45	9.5	2023-01-21	watermelon	0.7962962962962963	2.5
6	9	45	10.5	2023-01-22	xigua	0.7962962962962963	2.5
10	2	45	5.5	2023-02-09	None	0.7962962962962963	2.5
14	10	45	9.5	2023-02-21	watermelon	0.7962962962962963	2.5
16	8	50	11.5	None	None	0.8703703703703703	2.5
6	8	50	11.5	2023-01-23	yumberry	0.8703703703703703	2.5
6	7	50	12.5	2023-01-24	zucchini	0.8703703703703703	2.5
16	7	50	12.5	2023-02-24	None	0.8703703703703703	2.5
6	6	55	13.5	2023-01-25	acerola	0.9074074074074074	2.5
16	6	55	13.5	2023-02-25	acerola	0.9074074074074074	2.5
17	4	60	13.5	None	cloudberry	1.0	2.5
6	5	60	13.5	2023-01-26	bilberry	1.0	2.5
7	4	60	13.5	2023-01-27	cloudberry	1.0	2.5
7	3	60	14.5	2023-01-28	dewberry	1.0	2.5
17	3	60	14.5	2023-02-28	dewberry	1.0	2.5
-- !result
DROP TABLE IF EXISTS `cume_test`;
-- result:
-- !result