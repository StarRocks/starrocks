-- name: test_format
SELECT FORMAT(NULL, 4), FORMAT(12332.123456, NULL), FORMAT(NULL, NULL);

SELECT FORMAT(12332.123456, 4), FORMAT(-12332.123456, 4);

SELECT FORMAT(12332.123456, -4), FORMAT(-12332.123456, -4), FORMAT(12332.623456, -4), FORMAT(-12332.623456, -4), FORMAT(1.1,-4);

SELECT FORMAT(12332.1,4), FORMAT(-12332.1,4);

SELECT FORMAT(12332.2,0), FORMAT(-12332.2,0);

SELECT FORMAT(12332.2,2), FORMAT(-12332.2,2);

SELECT FORMAT(0, 4), FORMAT(0.0, 4),FORMAT(0, 0);

SELECT FORMAT(-0, 4), FORMAT(-0.0, 4),FORMAT(-0, 0);

SELECT FORMAT(999999,0), FORMAT(-999999,0);

SELECT FORMAT(999999,2), FORMAT(-999999,2);

SELECT FORMAT(000.001,4), FORMAT(312.03511,4);

SELECT FORMAT(-000.001,4), FORMAT(-312.03511,4);

SELECT FORMAT(9223372036854775807, 4), FORMAT(-9223372036854775808, 4);

SELECT FORMAT(92233720368547758070, 4), FORMAT(-92233720368547758080, 4);

SELECT FORMAT(0.123456789012345678,18), FORMAT(1.23456789012345678,17), FORMAT(12.3456789012345678,16);

SELECT FORMAT(0.0123456789012345678901234567890123456,37), FORMAT(-0.0123456789012345678901234567890123456,37);

SELECT FORMAT(CAST(32000352.1234567899999912 as DECIMALV2), 4);

CREATE TABLE `t_test_format` (
  `c_id` int(11) NOT NULL,
  `c_d32` decimal(9,3) NULL,
  `c_d64` decimal(18,5) NULL,
  `c_d128` decimal(38,7) NULL,
  `c_int` int NULL,
  `c_bigint` bigint NULL,
  `c_largeint` largeint NULL,
  `c_double` double NULL,
  `c_d` int NULL
) ENGINE=OLAP
DUPLICATE KEY(`c_id`)
DISTRIBUTED BY HASH(`c_id`) BUCKETS 10
PROPERTIES (
 "replication_num" = "1"
);

INSERT INTO `t_test_format` (c_id, c_d32, c_d64, c_d128, c_int, c_bigint, c_largeint, c_double, c_d) values
   (1, 999999.99, 9999999999999.99999, 9999999999999999999999999999999.9999999, 2147483647, 9223372036854775807, 92233720368547758071, 32000352.280935, 4),
   (2, -999999.99, -9999999999999.99999, -9999999999999999999999999999999.9999999, -2147483647, -9223372036854775807, -92233720368547758071, -32000352.280935, 4),
   (3, 999999.99, 9999999999999.99999, 9999999999999999999999999999999.9999999, 2147483647, 9223372036854775807, 92233720368547758071, 32000352.280935, 2),
   (4, -999999.99, -9999999999999.99999, -9999999999999999999999999999999.9999999, -2147483647, -9223372036854775807, -92233720368547758071, -32000352.280935, NULL),
   (5, 999999.99, 9999999999999.99999, 9999999999999999999999999999999.9999999, 2147483647, 9223372036854775807, 92233720368547758071, 32000352.280935, 0),
   (6, 999999.33, 9999999999999.33333, 9999999999999999999999999999999.3333333, NULL, 9223372036854775806, 92233720368547758068, 32000352.280955, 4),
   (7, -999999.33, -9999999999999.33333, -9999999999999999999999999999999.3333333, -2147483646, NULL, NULL, -32000352.280955, 3),
   (8, -999999.33, -9999999999999.33333, NULL, -2147483646, NULL, NULL, -32000352.280955, -3);

SELECT
	c_id, format(c_d32, c_d), format(c_d64, c_d), format(c_d128, c_d), format(c_int, c_d), format(c_bigint, c_d), format(c_largeint, c_d), format(c_double, c_d), format(c_d, c_d)
FROM `t_test_format`
order by c_id;

SELECT
	c_id, format(c_d32, 3), format(c_d64, 3), format(c_d128, 3), format(c_int, 3), format(c_bigint, 3), format(c_largeint, 3), format(c_double, 3), format(c_d, 3)
FROM `t_test_format`
order by c_id;