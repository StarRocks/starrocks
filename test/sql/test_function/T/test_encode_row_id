-- name: test_encode_row_id

create table t1 (id int, v1 bigint, v2 string, v3 array<int>) distributed by hash(id) properties ("replication_num" = "1");

select ENCODE_ROW_ID(NULL) ;
select ENCODE_ROW_ID(NULL, NULL) ;
select ENCODE_ROW_ID(NULL, NULL, NULL) ;
select ENCODE_ROW_ID(NULL, NULL, NULL, NULL) ;
select ENCODE_ROW_ID('', 9223372036854775807) ;
select ENCODE_ROW_ID('', 9223372036854775807, NULL) ;
select ENCODE_ROW_ID('', -9223372036854775807, 465254298) ;
select ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL) ;
select ENCODE_ROW_ID('', 9223372036854775807, NULL) ;
select ENCODE_ROW_ID('', 9223372036854775807, 465254298) ;
select ENCODE_ROW_ID('', -9223372036854775807, 465254298) ;
select ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL) ;

select ENCODE_FINGERPRINT_SHA256(NULL) ;
select ENCODE_FINGERPRINT_SHA256(NULL, NULL) ;
select ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL) ;
select ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL, NULL) ;
select ENCODE_FINGERPRINT_SHA256('', 9223372036854775807) ;
select ENCODE_FINGERPRINT_SHA256('', 9223372036854775807, NULL) ;
select ENCODE_FINGERPRINT_SHA256('', -9223372036854775807, 465254298) ;
select ENCODE_FINGERPRINT_SHA256('', 9223372036854775806, 465254298, NULL) ;

select ENCODE_SORT_KEY(NULL) ;
select ENCODE_SORT_KEY(NULL, NULL) ;
select ENCODE_SORT_KEY(NULL, NULL, NULL) ;
select ENCODE_SORT_KEY(NULL, NULL, NULL, NULL) ;
select ENCODE_SORT_KEY('', 9223372036854775807) ;
select ENCODE_SORT_KEY('', 9223372036854775807, NULL) ;
select ENCODE_SORT_KEY('', -9223372036854775807, 465254298) ;
select ENCODE_SORT_KEY('', 9223372036854775806, 465254298, NULL) ;

insert into t1 values(1, 9223372036854775807, 'STARROCKS', [1, 2, 3]), (2, -9223372036854775807, 'STARROCKS', [1, 2, 3]), (3, 9223372036854775806, 'STARROCKS', [1, 2, 3]);

select ENCODE_ROW_ID(v1) from t1;
select ENCODE_ROW_ID(v1, v2) from t1;
select ENCODE_ROW_ID(v1, v2, v3) from t1;
select ENCODE_ROW_ID(NULL, v1, v2) from t1;
select ENCODE_ROW_ID(NULL, v1, v2, v3) from t1;
select ENCODE_ROW_ID(v1, NULL, v2, v3) from t1;
select ENCODE_ROW_ID(v1, v2, NULL, v3) from t1;
select ENCODE_ROW_ID(v1, v2, v3, NULL) from t1;

select ENCODE_FINGERPRINT_SHA256(v1) from t1;
select ENCODE_FINGERPRINT_SHA256(v1, v2) from t1;
select ENCODE_FINGERPRINT_SHA256(v1, v2, v3) from t1;
select ENCODE_FINGERPRINT_SHA256(NULL, v1, v2) from t1;
select ENCODE_FINGERPRINT_SHA256(NULL, v1, v2, v3) from t1;
select ENCODE_FINGERPRINT_SHA256(v1, NULL, v2, v3) from t1;
select ENCODE_FINGERPRINT_SHA256(v1, v2, NULL, v3) from t1;
select ENCODE_FINGERPRINT_SHA256(v1, v2, v3, NULL) from t1;

select ENCODE_SORT_KEY(v1) from t1;
select ENCODE_SORT_KEY(v1, v2) from t1;
select ENCODE_SORT_KEY(v1, v2, v3) from t1;
select ENCODE_SORT_KEY(NULL, v1, v2) from t1;
select ENCODE_SORT_KEY(NULL, v1, v2, v3) from t1;
select ENCODE_SORT_KEY(v1, NULL, v2, v3) from t1;
select ENCODE_SORT_KEY(v1, v2, NULL, v3) from t1;
select ENCODE_SORT_KEY(v1, v2, v3, NULL) from t1;
