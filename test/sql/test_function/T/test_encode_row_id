-- name: test_encode_row_id

create table t1 (id int, v1 bigint, v2 string, v3 array<int>) distributed by hash(id) properties ("replication_num" = "1");

select FROM_BINARY(ENCODE_ROW_ID(NULL), 'hex');
select FROM_BINARY(ENCODE_ROW_ID(NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID(NULL, NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID(NULL, NULL, NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807, NULL), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', -9223372036854775807, 465254298), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807, NULL), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807, 465254298), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', -9223372036854775807, 465254298), 'hex') ;
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL), 'hex') ;

select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL), 'hex') ;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', 9223372036854775807), 'hex') ;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', 9223372036854775807, NULL), 'hex') ;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', -9223372036854775807, 465254298), 'hex') ;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', 9223372036854775806, 465254298, NULL), 'hex') ;

select FROM_BINARY(ENCODE_SORT_KEY(NULL), 'hex') ;
select FROM_BINARY(ENCODE_SORT_KEY(NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_SORT_KEY(NULL, NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_SORT_KEY(NULL, NULL, NULL, NULL), 'hex') ;
select FROM_BINARY(ENCODE_SORT_KEY('', 9223372036854775807), 'hex') ;
select FROM_BINARY(ENCODE_SORT_KEY('', 9223372036854775807, NULL), 'hex') ;
select FROM_BINARY(ENCODE_SORT_KEY('', -9223372036854775807, 465254298), 'hex') ;
select FROM_BINARY(ENCODE_SORT_KEY('', 9223372036854775806, 465254298, NULL), 'hex') ;

insert into t1 values(1, 9223372036854775807, 'STARROCKS', [1, 2, 3]), (2, -9223372036854775807, 'STARROCKS', [1, 2, 3]), (3, 9223372036854775806, 'STARROCKS', [1, 2, 3]);

select FROM_BINARY(ENCODE_ROW_ID(v1), 'hex') from t1;
select FROM_BINARY(ENCODE_ROW_ID(v1, v2), 'hex') from t1;
select FROM_BINARY(ENCODE_ROW_ID(v1, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_ROW_ID(NULL, v1, v2), 'hex') from t1;
select FROM_BINARY(ENCODE_ROW_ID(NULL, v1, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_ROW_ID(v1, NULL, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_ROW_ID(v1, v2, NULL, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_ROW_ID(v1, v2, v3, NULL), 'hex') from t1;


select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1), 'hex') from t1;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2), 'hex') from t1;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, v1, v2), 'hex') from t1;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, v1, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, NULL, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2, NULL, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2, v3, NULL), 'hex') from t1;

select FROM_BINARY(ENCODE_SORT_KEY(v1), 'hex') from t1;
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2), 'hex') from t1;
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_SORT_KEY(NULL, v1, v2), 'hex') from t1;
select FROM_BINARY(ENCODE_SORT_KEY(NULL, v1, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_SORT_KEY(v1, NULL, v2, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2, NULL, v3), 'hex') from t1;
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2, v3, NULL), 'hex') from t1;
