-- name: test_time_slice

set disable_function_fold_constants=off;
select time_slice('9999-12-31 23:59:59',interval 5 year, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 month, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 day, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 quarter, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 week, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 hour, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 minute, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 second, ceil);
select time_slice('2023-12-31 03:12:04',interval 2147483647 year);
select time_slice('2023-12-31 03:12:04',interval 2147483647 month);
select time_slice('2023-12-31 03:12:04',interval 2147483647 day);
select time_slice('2023-12-31 03:12:04',interval 2147483647 quarter);
select time_slice('2023-12-31 03:12:04',interval 2147483647 week);
select time_slice('2023-12-31 03:12:04',interval 2147483647 hour);
select time_slice('2023-12-31 03:12:04',interval 2147483647 minute);
select time_slice('2023-12-31 03:12:04',interval 2147483647 second);
select time_slice('0000-01-01',interval 5 year);
select time_slice('0000-01-01',interval 5 month);
select time_slice('0000-01-01',interval 5 day);
select time_slice('0000-01-01',interval 5 quarter);
select time_slice('0000-01-01',interval 5 week);
select time_slice('9999-12-31',interval 5 year, ceil);
select time_slice('9999-12-31',interval 5 month, ceil);
select time_slice('9999-12-31',interval 5 day, ceil);
select time_slice('9999-12-31',interval 5 quarter, ceil);
select time_slice('9999-12-31',interval 5 week, ceil);
select time_slice('2023-12-31 03:12:04',interval 2147483647 year);
select time_slice('2023-12-31 03:12:04',interval 2147483647 month);
select time_slice('2023-12-31 03:12:04',interval 2147483647 day);
select time_slice('2023-12-31 03:12:04',interval 2147483647 quarter);
select time_slice('2023-12-31 03:12:04',interval 2147483647 week);
select date_slice('2023-12-31 03:12:04',interval 3.2 year);
select date_slice('2023-12-31 03:12:04',interval 3.2 month);
select date_slice('2023-12-31 03:12:04',interval 3.2 day);
select date_slice('2023-12-31 03:12:04',interval 3.2 quarter);
select date_slice('2023-12-31 03:12:04',interval 3.2 week);
select date_slice('2023-12-31 03:12:04',interval -3.2 week);
set disable_function_fold_constants=on;
select time_slice('9999-12-31 23:59:59',interval 5 year, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 month, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 day, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 quarter, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 week, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 hour, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 minute, ceil);
select time_slice('9999-12-31 23:59:59',interval 5 second, ceil);
select time_slice('2023-12-31 03:12:04',interval 2147483647 year);
select time_slice('2023-12-31 03:12:04',interval 2147483647 month);
select time_slice('2023-12-31 03:12:04',interval 2147483647 day);
select time_slice('2023-12-31 03:12:04',interval 2147483647 quarter);
select time_slice('2023-12-31 03:12:04',interval 2147483647 week);
select time_slice('2023-12-31 03:12:04',interval 2147483647 hour);
select time_slice('2023-12-31 03:12:04',interval 2147483647 minute);
select time_slice('2023-12-31 03:12:04',interval 2147483647 second);
select time_slice('0000-01-01',interval 5 year);
select time_slice('0000-01-01',interval 5 month);
select time_slice('0000-01-01',interval 5 day);
select time_slice('0000-01-01',interval 5 quarter);
select time_slice('0000-01-01',interval 5 week);
select time_slice('9999-12-31',interval 5 year, ceil);
select time_slice('9999-12-31',interval 5 month, ceil);
select time_slice('9999-12-31',interval 5 day, ceil);
select time_slice('9999-12-31',interval 5 quarter, ceil);
select time_slice('9999-12-31',interval 5 week, ceil);
select time_slice('2023-12-31 03:12:04',interval 2147483647 year);
select time_slice('2023-12-31 03:12:04',interval 2147483647 month);
select time_slice('2023-12-31 03:12:04',interval 2147483647 day);
select time_slice('2023-12-31 03:12:04',interval 2147483647 quarter);
select time_slice('2023-12-31 03:12:04',interval 2147483647 week);
select date_slice('2023-12-31 03:12:04',interval 3.2 year);
select date_slice('2023-12-31 03:12:04',interval 3.2 month);
select date_slice('2023-12-31 03:12:04',interval 3.2 day);
select date_slice('2023-12-31 03:12:04',interval 3.2 quarter);
select date_slice('2023-12-31 03:12:04',interval 3.2 week);
select date_slice('2023-12-31 03:12:04',interval -3.2 week);

-- name: test_time_slice_2
select time_slice('2023-10-31 23:59:59',interval 1 millisecond);
select time_slice('2023-10-31 23:59:59',interval 1 millisecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 17 millisecond);
select time_slice('2023-10-31 23:59:59',interval 17 millisecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 1000 millisecond);
select time_slice('2023-10-31 23:59:59',interval 1000 millisecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 1001 millisecond);
select time_slice('2023-10-31 23:59:59',interval 1001 millisecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 86400000 millisecond);
select time_slice('2023-10-31 23:59:59',interval 86400000 millisecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 172800000 millisecond);
select time_slice('2023-10-31 23:59:59',interval 172800000 millisecond, ceil);

select time_slice('2023-10-31 23:59:59',interval 1 microsecond);
select time_slice('2023-10-31 23:59:59',interval 1 microsecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 17 microsecond);
select time_slice('2023-10-31 23:59:59',interval 17 microsecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 1000 microsecond);
select time_slice('2023-10-31 23:59:59',interval 1000 microsecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 1001 microsecond);
select time_slice('2023-10-31 23:59:59',interval 1001 microsecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 1000000 microsecond);
select time_slice('2023-10-31 23:59:59',interval 1000000 microsecond, ceil);
select time_slice('2023-10-31 23:59:59',interval 1000001 microsecond);
select time_slice('2023-10-31 23:59:59',interval 1000001 microsecond, ceil);
