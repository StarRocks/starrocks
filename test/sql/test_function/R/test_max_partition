-- name: test_max_partition
create database db_${uuid0};
-- result:
-- !result:
use db_${uuid0};
-- result:
-- !result:
DROP TABLE IF EXISTS `t0`;
-- result:
-- !result
CREATE TABLE `t0` (
  `dt` date NOT NULL COMMENT "",
  `k1` varchar(100) NOT NULL COMMENT "",
  `k2` varchar(100) NOT NULL COMMENT "",
  `v1` bigint(20) NOT NULL COMMENT ""
) ENGINE=OLAP 
DUPLICATE KEY(`dt`, `k1`, `k2`)
COMMENT "OLAP"
PARTITION BY RANGE(`dt`)
(PARTITION p20230101 VALUES [("2023-01-01"), ("2023-01-02")),
PARTITION p20230102 VALUES [("2023-01-02"), ("2023-01-03")),
PARTITION p20230103 VALUES [("2023-01-03"), ("2023-01-04")),
PARTITION p20230104 VALUES [("2023-01-04"), ("2023-01-05")),
PARTITION p20230105 VALUES [("2023-01-05"), ("2023-01-06")),
PARTITION p20230106 VALUES [("2023-01-06"), ("2023-01-07")),
PARTITION p20230107 VALUES [("2023-01-07"), ("2023-01-08")),
PARTITION p20230108 VALUES [("2023-01-08"), ("2023-01-09")),
PARTITION p20230109 VALUES [("2023-01-09"), ("2023-01-10")))
DISTRIBUTED BY HASH(`k1`, `k2`) BUCKETS 4 
PROPERTIES (
"replication_num" = "1",
"in_memory" = "false",
"enable_persistent_index" = "false",
"replicated_storage" = "true",
"compression" = "LZ4"
);
-- result:
-- !result:
select max_partition('test_max_partition.t0');
-- result:
None
-- !result:
insert into t0 values('2023-01-01', 'foo_0001', 'bar_0010', 1);
-- result:
-- !result:
select max_partition('test_max_partition.t0');
-- result:
2023-01-01
-- !result:
insert into t0 values('2023-01-03', 'foo_0001', 'bar_0012', 1);
-- result:
-- !result:
select max_partition('test_max_partition.t0');
-- result:
2023-01-03
-- !result:
insert into t0 values('2023-01-02', 'foo_0001', 'bar_0011', 1);
-- result:
-- !result:
select max_partition('test_max_partition.t0');
-- result:
2023-01-03
-- !result:
select max_partition('t0');
-- result:
2023-01-03
-- !result:
select max_partition('default_catalog.test_max_partition.t0');
-- result:
2023-01-03
