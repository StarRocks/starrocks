-- name: test_encryption_aes_encrypt_decrypt
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3'));
-- result:
uv/Lhzm74syo8JlfWarwKA==
-- !result
select AES_DECRYPT(from_base64('uv/Lhzm74syo8JlfWarwKA=='),'F3229A0B371ED2D9441B830D21A390C3');
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_ECB", "test"));
-- result:
E: (1064, 'Getting analyzing error from line 1, column 17 to line 1, column 104. Detail message: aes_encrypt with 5 parameters requires GCM mode to use AAD parameter, but got mode: AES_128_ECB. Only GCM modes (AES_128_GCM, AES_192_GCM, AES_256_GCM) support AAD parameter..')
-- !result
select AES_DECRYPT(from_base64('uv/Lhzm74syo8JlfWarwKA=='),'F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_ECB", "test");
-- result:
E: (1064, 'Getting analyzing error from line 1, column 7 to line 1, column 122. Detail message: aes_decrypt with 5 parameters requires GCM mode to use AAD parameter, but got mode: AES_128_ECB. Only GCM modes (AES_128_GCM, AES_192_GCM, AES_256_GCM) support AAD parameter..')
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_ECB"));
-- result:
uv/Lhzm74syo8JlfWarwKA==
-- !result
select AES_DECRYPT(from_base64('uv/Lhzm74syo8JlfWarwKA=='),'F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_ECB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_ECB"));
-- result:
uv/Lhzm74syo8JlfWarwKA==
-- !result
select AES_DECRYPT(from_base64('uv/Lhzm74syo8JlfWarwKA=='),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_ECB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_192_ECB"));
-- result:
xaf+kW/d5YPRSYFGnFkOfQ==
-- !result
select AES_DECRYPT(from_base64('xaf+kW/d5YPRSYFGnFkOfQ=='),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_192_ECB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_256_ECB"));
-- result:
o8B7eV7n6BqEuO7N453Y4A==
-- !result
select AES_DECRYPT(from_base64('o8B7eV7n6BqEuO7N453Y4A=='),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_256_ECB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CBC"));
-- result:
ne2YHEKECQSni3/kRI/nBg==
-- !result
select AES_DECRYPT(from_base64('ne2YHEKECQSni3/kRI/nBg=='),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CBC");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_CBC"));
-- result:
None
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CBC"));
-- result:
taXlwIvir9yff94F5Uv/KA==
-- !result
select AES_DECRYPT(from_base64('taXlwIvir9yff94F5Uv/KA=='),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CBC");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CBC"));
-- result:
QK83BHrWHqCWD1mA1u7WGQ==
-- !result
select AES_DECRYPT(from_base64('QK83BHrWHqCWD1mA1u7WGQ=='),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CBC");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CBC"));
-- result:
4w0ceQx2FqG8GGTivC0QPg==
-- !result
select AES_DECRYPT(from_base64('4w0ceQx2FqG8GGTivC0QPg=='),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CBC");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB"));
-- result:
3wGmUeFO4/Ex
-- !result
select AES_DECRYPT(from_base64('3wGmUeFO4/Ex'),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_CFB"));
-- result:
None
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB"));
-- result:
POcBNCCAYPCc
-- !result
select AES_DECRYPT(from_base64('POcBNCCAYPCc'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB"));
-- result:
Ma7ozVBB4lGP
-- !result
select AES_DECRYPT(from_base64('Ma7ozVBB4lGP'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB"));
-- result:
p6+axkiBSNf2
-- !result
select AES_DECRYPT(from_base64('p6+axkiBSNf2'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB1"));
-- result:
2NB6ZTf15qlj
-- !result
select AES_DECRYPT(from_base64('2NB6ZTf15qlj'),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB1");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_CFB1"));
-- result:
None
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB1"));
-- result:
JrWt4rBZ2JRl
-- !result
select AES_DECRYPT(from_base64('JrWt4rBZ2JRl'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB1");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB1"));
-- result:
MltCAryodTud
-- !result
select AES_DECRYPT(from_base64('MltCAryodTud'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB1");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB1"));
-- result:
h5rRJ9HmkeqM
-- !result
select AES_DECRYPT(from_base64('h5rRJ9HmkeqM'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB1");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB8"));
-- result:
3yAMoqwMEKHp
-- !result
select AES_DECRYPT(from_base64('3yAMoqwMEKHp'),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB8");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_CFB8"));
-- result:
None
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB8"));
-- result:
PLbtNmFObZU6
-- !result
select AES_DECRYPT(from_base64('PLbtNmFObZU6'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB8");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB8"));
-- result:
MS8Gi0HaPkf8
-- !result
select AES_DECRYPT(from_base64('MS8Gi0HaPkf8'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB8");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB8"));
-- result:
p8NH5PX2mufr
-- !result
select AES_DECRYPT(from_base64('p8NH5PX2mufr'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB8");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB128"));
-- result:
3wGmUeFO4/Ex
-- !result
select AES_DECRYPT(from_base64('3wGmUeFO4/Ex'),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CFB128");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_CFB128"));
-- result:
None
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB128"));
-- result:
POcBNCCAYPCc
-- !result
select AES_DECRYPT(from_base64('POcBNCCAYPCc'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CFB128");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB128"));
-- result:
Ma7ozVBB4lGP
-- !result
select AES_DECRYPT(from_base64('Ma7ozVBB4lGP'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CFB128");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB128"));
-- result:
p6+axkiBSNf2
-- !result
select AES_DECRYPT(from_base64('p6+axkiBSNf2'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CFB128");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_OFB"));
-- result:
3wGmUeFO4/Ex
-- !result
select AES_DECRYPT(from_base64('3wGmUeFO4/Ex'),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_OFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_OFB"));
-- result:
None
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_OFB"));
-- result:
POcBNCCAYPCc
-- !result
select AES_DECRYPT(from_base64('POcBNCCAYPCc'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_OFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_OFB"));
-- result:
Ma7ozVBB4lGP
-- !result
select AES_DECRYPT(from_base64('Ma7ozVBB4lGP'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_OFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_OFB"));
-- result:
p6+axkiBSNf2
-- !result
select AES_DECRYPT(from_base64('p6+axkiBSNf2'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_OFB");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CTR"));
-- result:
3wGmUeFO4/Ex
-- !result
select AES_DECRYPT(from_base64('3wGmUeFO4/Ex'),'F3229A0B371ED2D9441B830D21A390C3', "", "AES_128_CTR");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', NULL, "AES_128_CTR"));
-- result:
None
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CTR"));
-- result:
POcBNCCAYPCc
-- !result
select AES_DECRYPT(from_base64('POcBNCCAYPCc'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_128_CTR");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CTR"));
-- result:
Ma7ozVBB4lGP
-- !result
select AES_DECRYPT(from_base64('Ma7ozVBB4lGP'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_192_CTR");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CTR"));
-- result:
p6+axkiBSNf2
-- !result
select AES_DECRYPT(from_base64('p6+axkiBSNf2'),'F3229A0B371ED2D9441B830D21A390C3', "abcdefg", "AES_256_CTR");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefghijklmnop", "AES_128_GCM", "abcdefg"));
-- result:
YWJjZGVmZ2hpamtsdpJC2rnrGmvqKQv/WcoO6NuOCXvUnC8pCw==
-- !result
select AES_DECRYPT(from_base64('YWJjZGVmZ2hpamtsdpJC2rnrGmvqKQv/WcoO6NuOCXvUnC8pCw=='),'F3229A0B371ED2D9441B830D21A390C3', "abcdefghijklmnop", "AES_128_GCM", "abcdefg");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefghijklmnop", "AES_192_GCM", "abcdefg"));
-- result:
YWJjZGVmZ2hpamtsIpxL5blh0/zHNXw5nG/tL68lc1BJZ/fCPA==
-- !result
select AES_DECRYPT(from_base64('YWJjZGVmZ2hpamtsIpxL5blh0/zHNXw5nG/tL68lc1BJZ/fCPA=='),'F3229A0B371ED2D9441B830D21A390C3', "abcdefghijklmnop", "AES_192_GCM", "abcdefg");
-- result:
starrocks
-- !result
select to_base64(AES_ENCRYPT('starrocks','F3229A0B371ED2D9441B830D21A390C3', "abcdefghijklmnop", "AES_256_GCM", "abcdefg"));
-- result:
YWJjZGVmZ2hpamts2bRovmWbg/Y5qmz8Lt1L2oebY6lOV92Ozw==
-- !result
select AES_DECRYPT(from_base64('YWJjZGVmZ2hpamts2bRovmWbg/Y5qmz8Lt1L2oebY6lOV92Ozw=='),'F3229A0B371ED2D9441B830D21A390C3', "abcdefghijklmnop", "AES_256_GCM", "abcdefg");
-- result:
starrocks
-- !result