-- name: test_format
SELECT FORMAT(NULL, 4), FORMAT(12332.123456, NULL), FORMAT(NULL, NULL);
-- result:
None	None	None
-- !result
SELECT FORMAT(12332.123456, 4), FORMAT(-12332.123456, 4);
-- result:
12,332.1235	-12,332.1235
-- !result
SELECT FORMAT(12332.123456, -4), FORMAT(-12332.123456, -4), FORMAT(12332.623456, -4), FORMAT(-12332.623456, -4), FORMAT(1.1,-4);
-- result:
12,332	-12,332	12,333	-12,333	1
-- !result
SELECT FORMAT(12332.1,4), FORMAT(-12332.1,4);
-- result:
12,332.1000	-12,332.1000
-- !result
SELECT FORMAT(12332.2,0), FORMAT(-12332.2,0);
-- result:
12,332	-12,332
-- !result
SELECT FORMAT(12332.2,2), FORMAT(-12332.2,2);
-- result:
12,332.20	-12,332.20
-- !result
SELECT FORMAT(0, 4), FORMAT(0.0, 4),FORMAT(0, 0);
-- result:
0.0000	0.0000	0
-- !result
SELECT FORMAT(-0, 4), FORMAT(-0.0, 4),FORMAT(-0, 0);
-- result:
0.0000	0.0000	0
-- !result
SELECT FORMAT(999999,0), FORMAT(-999999,0);
-- result:
999,999	-999,999
-- !result
SELECT FORMAT(999999,2), FORMAT(-999999,2);
-- result:
999,999.00	-999,999.00
-- !result
SELECT FORMAT(000.001,4), FORMAT(312.03511,4);
-- result:
0.0010	312.0351
-- !result
SELECT FORMAT(-000.001,4), FORMAT(-312.03511,4);
-- result:
-0.0010	-312.0351
-- !result
SELECT FORMAT(9223372036854775807, 4), FORMAT(-9223372036854775808, 4);
-- result:
9,223,372,036,854,775,807.0000	-9,223,372,036,854,775,808.0000
-- !result
SELECT FORMAT(92233720368547758070, 4), FORMAT(-92233720368547758080, 4);
-- result:
92,233,720,368,547,758,070.0000	-92,233,720,368,547,758,080.0000
-- !result
SELECT FORMAT(0.123456789012345678,18), FORMAT(1.23456789012345678,17), FORMAT(12.3456789012345678,16);
-- result:
0.123456789012345678	1.23456789012345678	12.3456789012345678
-- !result
SELECT FORMAT(0.0123456789012345678901234567890123456,37), FORMAT(-0.0123456789012345678901234567890123456,37);
-- result:
0.0123456789012345678901234567890123456	-0.0123456789012345678901234567890123456
-- !result
SELECT FORMAT(CAST(32000352.1234567899999912 as DECIMALV2), 4);
-- result:
32,000,352.1235
-- !result
CREATE TABLE `t_test_format` (
  `c_id` int(11) NOT NULL,
  `c_d32` decimal(9,3) NULL,
  `c_d64` decimal(18,5) NULL,
  `c_d128` decimal(38,7) NULL,
  `c_int` int NULL,
  `c_bigint` bigint NULL,
  `c_largeint` largeint NULL,
  `c_double` double NULL,
  `c_d` int NULL
) ENGINE=OLAP
DUPLICATE KEY(`c_id`)
DISTRIBUTED BY HASH(`c_id`) BUCKETS 10
PROPERTIES (
 "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t_test_format` (c_id, c_d32, c_d64, c_d128, c_int, c_bigint, c_largeint, c_double, c_d) values
   (1, 999999.99, 9999999999999.99999, 9999999999999999999999999999999.9999999, 2147483647, 9223372036854775807, 92233720368547758071, 32000352.280935, 4),
   (2, -999999.99, -9999999999999.99999, -9999999999999999999999999999999.9999999, -2147483647, -9223372036854775807, -92233720368547758071, -32000352.280935, 4),
   (3, 999999.99, 9999999999999.99999, 9999999999999999999999999999999.9999999, 2147483647, 9223372036854775807, 92233720368547758071, 32000352.280935, 2),
   (4, -999999.99, -9999999999999.99999, -9999999999999999999999999999999.9999999, -2147483647, -9223372036854775807, -92233720368547758071, -32000352.280935, NULL),
   (5, 999999.99, 9999999999999.99999, 9999999999999999999999999999999.9999999, 2147483647, 9223372036854775807, 92233720368547758071, 32000352.280935, 0),
   (6, 999999.33, 9999999999999.33333, 9999999999999999999999999999999.3333333, NULL, 9223372036854775806, 92233720368547758068, 32000352.280955, 4),
   (7, -999999.33, -9999999999999.33333, -9999999999999999999999999999999.3333333, -2147483646, NULL, NULL, -32000352.280955, 3),
   (8, -999999.33, -9999999999999.33333, NULL, -2147483646, NULL, NULL, -32000352.280955, -3);
-- result:
-- !result
SELECT
	c_id, format(c_d32, c_d), format(c_d64, c_d), format(c_d128, c_d), format(c_int, c_d), format(c_bigint, c_d), format(c_largeint, c_d), format(c_double, c_d), format(c_d, c_d)
FROM `t_test_format`
order by c_id;
-- result:
1	999,999.9900	10,000,000,000,000.0000	10,000,000,000,000,000,000,000,000,000,000.0000	2,147,483,647.0000	9,223,372,036,854,775,807.0000	92,233,720,368,547,758,071.0000	32,000,352.2809	4.0000
2	-999,999.9900	-10,000,000,000,000.0000	-10,000,000,000,000,000,000,000,000,000,000.0000	-2,147,483,647.0000	-9,223,372,036,854,775,807.0000	-92,233,720,368,547,758,071.0000	-32,000,352.2809	4.0000
3	999,999.99	10,000,000,000,000.00	10,000,000,000,000,000,000,000,000,000,000.00	2,147,483,647.00	9,223,372,036,854,775,807.00	92,233,720,368,547,758,071.00	32,000,352.28	2.00
4	None	None	None	None	None	None	None	None
5	1,000,000	10,000,000,000,000	10,000,000,000,000,000,000,000,000,000,000	2,147,483,647	9,223,372,036,854,775,807	92,233,720,368,547,758,071	32,000,352	0
6	999,999.3300	9,999,999,999,999.3333	9,999,999,999,999,999,999,999,999,999,999.3333	None	9,223,372,036,854,775,806.0000	92,233,720,368,547,758,068.0000	32,000,352.2810	4.0000
7	-999,999.330	-9,999,999,999,999.333	-9,999,999,999,999,999,999,999,999,999,999.333	-2,147,483,646.000	None	None	-32,000,352.281	3.000
8	-999,999	-9,999,999,999,999	None	-2,147,483,646	None	None	-32,000,352	-3
-- !result
SELECT
	c_id, format(c_d32, 3), format(c_d64, 3), format(c_d128, 3), format(c_int, 3), format(c_bigint, 3), format(c_largeint, 3), format(c_double, 3), format(c_d, 3)
FROM `t_test_format`
order by c_id;
-- result:
1	999,999.990	10,000,000,000,000.000	10,000,000,000,000,000,000,000,000,000,000.000	2,147,483,647.000	9,223,372,036,854,775,807.000	92,233,720,368,547,758,071.000	32,000,352.281	4.000
2	-999,999.990	-10,000,000,000,000.000	-10,000,000,000,000,000,000,000,000,000,000.000	-2,147,483,647.000	-9,223,372,036,854,775,807.000	-92,233,720,368,547,758,071.000	-32,000,352.281	4.000
3	999,999.990	10,000,000,000,000.000	10,000,000,000,000,000,000,000,000,000,000.000	2,147,483,647.000	9,223,372,036,854,775,807.000	92,233,720,368,547,758,071.000	32,000,352.281	2.000
4	-999,999.990	-10,000,000,000,000.000	-10,000,000,000,000,000,000,000,000,000,000.000	-2,147,483,647.000	-9,223,372,036,854,775,807.000	-92,233,720,368,547,758,071.000	-32,000,352.281	None
5	999,999.990	10,000,000,000,000.000	10,000,000,000,000,000,000,000,000,000,000.000	2,147,483,647.000	9,223,372,036,854,775,807.000	92,233,720,368,547,758,071.000	32,000,352.281	0.000
6	999,999.330	9,999,999,999,999.333	9,999,999,999,999,999,999,999,999,999,999.333	None	9,223,372,036,854,775,806.000	92,233,720,368,547,758,068.000	32,000,352.281	4.000
7	-999,999.330	-9,999,999,999,999.333	-9,999,999,999,999,999,999,999,999,999,999.333	-2,147,483,646.000	None	None	-32,000,352.281	3.000
8	-999,999.330	-9,999,999,999,999.333	None	-2,147,483,646.000	None	None	-32,000,352.281	-3.000
-- !result