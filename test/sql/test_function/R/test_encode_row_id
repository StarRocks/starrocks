-- name: test_encode_row_id
create table t1 (id int, v1 bigint, v2 string, v3 array<int>) distributed by hash(id) properties ("replication_num" = "1");
-- result:
-- !result
select FROM_BINARY(ENCODE_ROW_ID(NULL), 'hex');
-- result:
6E340B9CFFB37A989CA544E6BB780A2C78901D3FB33738768511A30617AFA01D
-- !result
select FROM_BINARY(ENCODE_ROW_ID(NULL, NULL), 'hex') ;
-- result:
96A296D224F285C67BEE93C30F8A309157F0DAA35DC5B87E410B78630A09CFC7
-- !result
select FROM_BINARY(ENCODE_ROW_ID(NULL, NULL, NULL), 'hex') ;
-- result:
709E80C88487A2411E1EE4DFB9F22A861492D20C4765150C0C794ABD70F8147C
-- !result
select FROM_BINARY(ENCODE_ROW_ID(NULL, NULL, NULL, NULL), 'hex') ;
-- result:
DF3F619804A92FDB4057192DC43DD748EA778ADC52BC498CE80524C014B81119
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807), 'hex') ;
-- result:
940BF2CF7F45CCAB48F07F36838E94FD936B1417283FAAC8BF4E8B3E02865E69
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807, NULL), 'hex') ;
-- result:
20A94D113927EB2BEB49BDBE70649EF65368C805280E0161188B1DA0EBE43A87
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', -9223372036854775807, 465254298), 'hex') ;
-- result:
BD1621F1BCEF969921D69060E02B20C0A5FFC518CCD7EC557981E343134580B1
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL), 'hex') ;
-- result:
6466581AB842EE2979452D22C5BDB74A1DBBA3EA60095884EF3DD87F5E595523
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807, NULL), 'hex') ;
-- result:
20A94D113927EB2BEB49BDBE70649EF65368C805280E0161188B1DA0EBE43A87
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775807, 465254298), 'hex') ;
-- result:
080C949F5B6555CDAABBA83C621F2700EB5DAEFBF34C77AD3C06C787F2C8882E
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', -9223372036854775807, 465254298), 'hex') ;
-- result:
BD1621F1BCEF969921D69060E02B20C0A5FFC518CCD7EC557981E343134580B1
-- !result
select FROM_BINARY(ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL), 'hex') ;
-- result:
6466581AB842EE2979452D22C5BDB74A1DBBA3EA60095884EF3DD87F5E595523
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL), 'hex') ;
-- result:
6E340B9CFFB37A989CA544E6BB780A2C78901D3FB33738768511A30617AFA01D
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, NULL), 'hex') ;
-- result:
96A296D224F285C67BEE93C30F8A309157F0DAA35DC5B87E410B78630A09CFC7
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL), 'hex') ;
-- result:
709E80C88487A2411E1EE4DFB9F22A861492D20C4765150C0C794ABD70F8147C
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL, NULL), 'hex') ;
-- result:
DF3F619804A92FDB4057192DC43DD748EA778ADC52BC498CE80524C014B81119
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', 9223372036854775807), 'hex') ;
-- result:
940BF2CF7F45CCAB48F07F36838E94FD936B1417283FAAC8BF4E8B3E02865E69
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', 9223372036854775807, NULL), 'hex') ;
-- result:
20A94D113927EB2BEB49BDBE70649EF65368C805280E0161188B1DA0EBE43A87
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', -9223372036854775807, 465254298), 'hex') ;
-- result:
BD1621F1BCEF969921D69060E02B20C0A5FFC518CCD7EC557981E343134580B1
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256('', 9223372036854775806, 465254298, NULL), 'hex') ;
-- result:
6466581AB842EE2979452D22C5BDB74A1DBBA3EA60095884EF3DD87F5E595523
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(NULL), 'hex') ;
-- result:
00
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(NULL, NULL), 'hex') ;
-- result:
000000
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(NULL, NULL, NULL), 'hex') ;
-- result:
0000000000
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(NULL, NULL, NULL, NULL), 'hex') ;
-- result:
00000000000000
-- !result
select FROM_BINARY(ENCODE_SORT_KEY('', 9223372036854775807), 'hex') ;
-- result:
0100000001FFFFFFFFFFFFFFFF
-- !result
select FROM_BINARY(ENCODE_SORT_KEY('', 9223372036854775807, NULL), 'hex') ;
-- result:
0100000001FFFFFFFFFFFFFFFF0000
-- !result
select FROM_BINARY(ENCODE_SORT_KEY('', -9223372036854775807, 465254298), 'hex') ;
-- result:
0100000001000000000000000100019BBB379A
-- !result
select FROM_BINARY(ENCODE_SORT_KEY('', 9223372036854775806, 465254298, NULL), 'hex') ;
-- result:
0100000001FFFFFFFFFFFFFFFE00019BBB379A0000
-- !result
insert into t1 values(1, 9223372036854775807, 'STARROCKS', [1, 2, 3]), (2, -9223372036854775807, 'STARROCKS', [1, 2, 3]), (3, 9223372036854775806, 'STARROCKS', [1, 2, 3]);
-- result:
-- !result
select FROM_BINARY(ENCODE_ROW_ID(v1), 'hex') from t1;
-- result:
CDA8EA46E928A213DDDEBE437B9AB5C5F4E5DC0303B883CFF6B9BE923D456671
7C965C21C6EFEBB551A837F20B6DB3ADF133086615FD662B9E183A8E087BC956
D716377AABAC50C896B31182AEFB48AD74893E9658176E66BD6957748CD50D51
-- !result
select FROM_BINARY(ENCODE_ROW_ID(v1, v2), 'hex') from t1;
-- result:
F72938BCE4B038764E6506DC9385B4D0079D06B2F0D8B130DBB1A3879BB7DC87
52499A9E66B47B2A493D54D0C249EABAA0061047894CD47EF8E912AED8A2C293
E7F0491A4CE61F6B5F998F4866C0EFE9C2F01213FD35373C6DD47C66E552CD77
-- !result
select FROM_BINARY(ENCODE_ROW_ID(v1, v2, v3), 'hex') from t1;
-- result:
E7F0491A4CE61F6B5F998F4866C0EFE9C2F01213FD35373C6DD47C66E552CD77
52499A9E66B47B2A493D54D0C249EABAA0061047894CD47EF8E912AED8A2C293
F72938BCE4B038764E6506DC9385B4D0079D06B2F0D8B130DBB1A3879BB7DC87
-- !result
select FROM_BINARY(ENCODE_ROW_ID(NULL, v1, v2), 'hex') from t1;
-- result:
A4B538C8AAD60061B69CE7EFF4A0E58FD55810E9022EE262BFA28831C50F3B73
16E4E4E985FA0CF8F570224F2DC3CE2FCD67B418429C5B60A882D11B3EAFDA2B
1F6A3DC7C6866611FE9B9586476363A3B5709CDA1ECCBFAD472BAB1802F98D7E
-- !result
select FROM_BINARY(ENCODE_ROW_ID(NULL, v1, v2, v3), 'hex') from t1;
-- result:
16E4E4E985FA0CF8F570224F2DC3CE2FCD67B418429C5B60A882D11B3EAFDA2B
A4B538C8AAD60061B69CE7EFF4A0E58FD55810E9022EE262BFA28831C50F3B73
1F6A3DC7C6866611FE9B9586476363A3B5709CDA1ECCBFAD472BAB1802F98D7E
-- !result
select FROM_BINARY(ENCODE_ROW_ID(v1, NULL, v2, v3), 'hex') from t1;
-- result:
AA973EE127857C2E5021BAFDE67381A60399ADD429FF7989F86AF219AC3F036B
5DD82C92C631E6295CD13A7B18141E72EDD76ED691FD1229C61F97A6D469643F
CC5420D30A22EFB77641450A71BE27C917B2F35BC5CCA5239D4593814C82ED35
-- !result
select FROM_BINARY(ENCODE_ROW_ID(v1, v2, NULL, v3), 'hex') from t1;
-- result:
6A09419A1710CC9114A424E425F2DE1DB39A5997B4CD3A94BBB8654B1D96C2AD
3BBE7A562C17A4853B34CE1145E5C4E5F7DD93F2965BB78911F38892F38637E9
905F8218F220FDC19DF1EFB1815357DC82B04EC7A96383DBAC0DE46D8CA8BD1F
-- !result
select FROM_BINARY(ENCODE_ROW_ID(v1, v2, v3, NULL), 'hex') from t1;
-- result:
6A09419A1710CC9114A424E425F2DE1DB39A5997B4CD3A94BBB8654B1D96C2AD
905F8218F220FDC19DF1EFB1815357DC82B04EC7A96383DBAC0DE46D8CA8BD1F
3BBE7A562C17A4853B34CE1145E5C4E5F7DD93F2965BB78911F38892F38637E9
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1), 'hex') from t1;
-- result:
D716377AABAC50C896B31182AEFB48AD74893E9658176E66BD6957748CD50D51
7C965C21C6EFEBB551A837F20B6DB3ADF133086615FD662B9E183A8E087BC956
CDA8EA46E928A213DDDEBE437B9AB5C5F4E5DC0303B883CFF6B9BE923D456671
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2), 'hex') from t1;
-- result:
52499A9E66B47B2A493D54D0C249EABAA0061047894CD47EF8E912AED8A2C293
F72938BCE4B038764E6506DC9385B4D0079D06B2F0D8B130DBB1A3879BB7DC87
E7F0491A4CE61F6B5F998F4866C0EFE9C2F01213FD35373C6DD47C66E552CD77
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2, v3), 'hex') from t1;
-- result:
F72938BCE4B038764E6506DC9385B4D0079D06B2F0D8B130DBB1A3879BB7DC87
52499A9E66B47B2A493D54D0C249EABAA0061047894CD47EF8E912AED8A2C293
E7F0491A4CE61F6B5F998F4866C0EFE9C2F01213FD35373C6DD47C66E552CD77
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, v1, v2), 'hex') from t1;
-- result:
A4B538C8AAD60061B69CE7EFF4A0E58FD55810E9022EE262BFA28831C50F3B73
16E4E4E985FA0CF8F570224F2DC3CE2FCD67B418429C5B60A882D11B3EAFDA2B
1F6A3DC7C6866611FE9B9586476363A3B5709CDA1ECCBFAD472BAB1802F98D7E
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(NULL, v1, v2, v3), 'hex') from t1;
-- result:
1F6A3DC7C6866611FE9B9586476363A3B5709CDA1ECCBFAD472BAB1802F98D7E
16E4E4E985FA0CF8F570224F2DC3CE2FCD67B418429C5B60A882D11B3EAFDA2B
A4B538C8AAD60061B69CE7EFF4A0E58FD55810E9022EE262BFA28831C50F3B73
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, NULL, v2, v3), 'hex') from t1;
-- result:
CC5420D30A22EFB77641450A71BE27C917B2F35BC5CCA5239D4593814C82ED35
5DD82C92C631E6295CD13A7B18141E72EDD76ED691FD1229C61F97A6D469643F
AA973EE127857C2E5021BAFDE67381A60399ADD429FF7989F86AF219AC3F036B
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2, NULL, v3), 'hex') from t1;
-- result:
905F8218F220FDC19DF1EFB1815357DC82B04EC7A96383DBAC0DE46D8CA8BD1F
3BBE7A562C17A4853B34CE1145E5C4E5F7DD93F2965BB78911F38892F38637E9
6A09419A1710CC9114A424E425F2DE1DB39A5997B4CD3A94BBB8654B1D96C2AD
-- !result
select FROM_BINARY(ENCODE_FINGERPRINT_SHA256(v1, v2, v3, NULL), 'hex') from t1;
-- result:
3BBE7A562C17A4853B34CE1145E5C4E5F7DD93F2965BB78911F38892F38637E9
6A09419A1710CC9114A424E425F2DE1DB39A5997B4CD3A94BBB8654B1D96C2AD
905F8218F220FDC19DF1EFB1815357DC82B04EC7A96383DBAC0DE46D8CA8BD1F
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(v1), 'hex') from t1;
-- result:
01FFFFFFFFFFFFFFFE
01FFFFFFFFFFFFFFFF
010000000000000001
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2), 'hex') from t1;
-- result:
01FFFFFFFFFFFFFFFF000153544152524F434B53
010000000000000001000153544152524F434B53
01FFFFFFFFFFFFFFFE000153544152524F434B53
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2, v3), 'hex') from t1;
-- result:
[REGEX]E:.*
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(NULL, v1, v2), 'hex') from t1;
-- result:
000001FFFFFFFFFFFFFFFF000153544152524F434B53
000001FFFFFFFFFFFFFFFE000153544152524F434B53
0000010000000000000001000153544152524F434B53
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(NULL, v1, v2, v3), 'hex') from t1;
-- result:
[REGEX]E:.*
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(v1, NULL, v2, v3), 'hex') from t1;
-- result:
[REGEX]E:.*
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2, NULL, v3), 'hex') from t1;
-- result:
[REGEX]E:.*
-- !result
select FROM_BINARY(ENCODE_SORT_KEY(v1, v2, v3, NULL), 'hex') from t1;
-- result:
[REGEX]E:.*
-- !result