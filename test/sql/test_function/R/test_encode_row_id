-- name: test_encode_row_id
create table t1 (id int, v1 bigint, v2 string, v3 array<int>) distributed by hash(id) properties ("replication_num" = "1");
-- result:
-- !result
select ENCODE_ROW_ID(NULL) ;
-- result:
None
-- !result
select ENCODE_ROW_ID(NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_ROW_ID(NULL, NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_ROW_ID(NULL, NULL, NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_ROW_ID('', 9223372036854775807) ;
-- result:
b'\x94\x0b\xf2\xcf\x7fE\xcc\xabH\xf0\x7f6\x83\x8e\x94\xfd\x93k\x14\x17(?\xaa\xc8\xbfN\x8b>\x02\x86^i'
-- !result
select ENCODE_ROW_ID('', 9223372036854775807, NULL) ;
-- result:
None
-- !result
select ENCODE_ROW_ID('', -9223372036854775807, 465254298) ;
-- result:
b'\xbd\x16!\xf1\xbc\xef\x96\x99!\xd6\x90`\xe0+ \xc0\xa5\xff\xc5\x18\xcc\xd7\xecUy\x81\xe3C\x13E\x80\xb1'
-- !result
select ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL) ;
-- result:
None
-- !result
select ENCODE_ROW_ID('', 9223372036854775807, NULL) ;
-- result:
None
-- !result
select ENCODE_ROW_ID('', 9223372036854775807, 465254298) ;
-- result:
b"\x08\x0c\x94\x9f[eU\xcd\xaa\xbb\xa8<b\x1f'\x00\xeb]\xae\xfb\xf3Lw\xad<\x06\xc7\x87\xf2\xc8\x88."
-- !result
select ENCODE_ROW_ID('', -9223372036854775807, 465254298) ;
-- result:
b'\xbd\x16!\xf1\xbc\xef\x96\x99!\xd6\x90`\xe0+ \xc0\xa5\xff\xc5\x18\xcc\xd7\xecUy\x81\xe3C\x13E\x80\xb1'
-- !result
select ENCODE_ROW_ID('', 9223372036854775806, 465254298, NULL) ;
-- result:
None
-- !result
select ENCODE_FINGERPRINT_SHA256(NULL) ;
-- result:
None
-- !result
select ENCODE_FINGERPRINT_SHA256(NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_FINGERPRINT_SHA256(NULL, NULL, NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_FINGERPRINT_SHA256('', 9223372036854775807) ;
-- result:
b'\x94\x0b\xf2\xcf\x7fE\xcc\xabH\xf0\x7f6\x83\x8e\x94\xfd\x93k\x14\x17(?\xaa\xc8\xbfN\x8b>\x02\x86^i'
-- !result
select ENCODE_FINGERPRINT_SHA256('', 9223372036854775807, NULL) ;
-- result:
None
-- !result
select ENCODE_FINGERPRINT_SHA256('', -9223372036854775807, 465254298) ;
-- result:
b'\xbd\x16!\xf1\xbc\xef\x96\x99!\xd6\x90`\xe0+ \xc0\xa5\xff\xc5\x18\xcc\xd7\xecUy\x81\xe3C\x13E\x80\xb1'
-- !result
select ENCODE_FINGERPRINT_SHA256('', 9223372036854775806, 465254298, NULL) ;
-- result:
None
-- !result
select ENCODE_SORT_KEY(NULL) ;
-- result:
None
-- !result
select ENCODE_SORT_KEY(NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_SORT_KEY(NULL, NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_SORT_KEY(NULL, NULL, NULL, NULL) ;
-- result:
None
-- !result
select ENCODE_SORT_KEY('', 9223372036854775807) ;
-- result:
b'\x01\x00\x00\x00\x01\xff\xff\xff\xff\xff\xff\xff\xff'
-- !result
select ENCODE_SORT_KEY('', 9223372036854775807, NULL) ;
-- result:
None
-- !result
select ENCODE_SORT_KEY('', -9223372036854775807, 465254298) ;
-- result:
b'\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x01\x9b\xbb7\x9a'
-- !result
select ENCODE_SORT_KEY('', 9223372036854775806, 465254298, NULL) ;
-- result:
None
-- !result
insert into t1 values(1, 9223372036854775807, 'STARROCKS', [1, 2, 3]), (2, -9223372036854775807, 'STARROCKS', [1, 2, 3]), (3, 9223372036854775806, 'STARROCKS', [1, 2, 3]);
-- result:
-- !result
select ENCODE_ROW_ID(v1) from t1;
-- result:
b'|\x96\\!\xc6\xef\xeb\xb5Q\xa87\xf2\x0bm\xb3\xad\xf13\x08f\x15\xfdf+\x9e\x18:\x8e\x08{\xc9V'
b'\xd7\x167z\xab\xacP\xc8\x96\xb3\x11\x82\xae\xfbH\xadt\x89>\x96X\x17nf\xbdiWt\x8c\xd5\rQ'
b'\xcd\xa8\xeaF\xe9(\xa2\x13\xdd\xde\xbeC{\x9a\xb5\xc5\xf4\xe5\xdc\x03\x03\xb8\x83\xcf\xf6\xb9\xbe\x92=Efq'
-- !result
select ENCODE_ROW_ID(v1, v2) from t1;
-- result:
b'\xe7\xf0I\x1aL\xe6\x1fk_\x99\x8fHf\xc0\xef\xe9\xc2\xf0\x12\x13\xfd57<m\xd4|f\xe5R\xcdw'
b'\xf7)8\xbc\xe4\xb08vNe\x06\xdc\x93\x85\xb4\xd0\x07\x9d\x06\xb2\xf0\xd8\xb10\xdb\xb1\xa3\x87\x9b\xb7\xdc\x87'
b'RI\x9a\x9ef\xb4{*I=T\xd0\xc2I\xea\xba\xa0\x06\x10G\x89L\xd4~\xf8\xe9\x12\xae\xd8\xa2\xc2\x93'
-- !result
select ENCODE_ROW_ID(v1, v2, v3) from t1;
-- result:
b'\xe7\xf0I\x1aL\xe6\x1fk_\x99\x8fHf\xc0\xef\xe9\xc2\xf0\x12\x13\xfd57<m\xd4|f\xe5R\xcdw'
b'\xf7)8\xbc\xe4\xb08vNe\x06\xdc\x93\x85\xb4\xd0\x07\x9d\x06\xb2\xf0\xd8\xb10\xdb\xb1\xa3\x87\x9b\xb7\xdc\x87'
b'RI\x9a\x9ef\xb4{*I=T\xd0\xc2I\xea\xba\xa0\x06\x10G\x89L\xd4~\xf8\xe9\x12\xae\xd8\xa2\xc2\x93'
-- !result
select ENCODE_ROW_ID(NULL, v1, v2) from t1;
-- result:
b'\xa4\xb58\xc8\xaa\xd6\x00a\xb6\x9c\xe7\xef\xf4\xa0\xe5\x8f\xd5X\x10\xe9\x02.\xe2b\xbf\xa2\x881\xc5\x0f;s'
b'\x16\xe4\xe4\xe9\x85\xfa\x0c\xf8\xf5p"O-\xc3\xce/\xcdg\xb4\x18B\x9c[`\xa8\x82\xd1\x1b>\xaf\xda+'
b'\x1fj=\xc7\xc6\x86f\x11\xfe\x9b\x95\x86Gcc\xa3\xb5p\x9c\xda\x1e\xcc\xbf\xadG+\xab\x18\x02\xf9\x8d~'
-- !result
select ENCODE_ROW_ID(NULL, v1, v2, v3) from t1;
-- result:
b'\xa4\xb58\xc8\xaa\xd6\x00a\xb6\x9c\xe7\xef\xf4\xa0\xe5\x8f\xd5X\x10\xe9\x02.\xe2b\xbf\xa2\x881\xc5\x0f;s'
b'\x1fj=\xc7\xc6\x86f\x11\xfe\x9b\x95\x86Gcc\xa3\xb5p\x9c\xda\x1e\xcc\xbf\xadG+\xab\x18\x02\xf9\x8d~'
b'\x16\xe4\xe4\xe9\x85\xfa\x0c\xf8\xf5p"O-\xc3\xce/\xcdg\xb4\x18B\x9c[`\xa8\x82\xd1\x1b>\xaf\xda+'
-- !result
select ENCODE_ROW_ID(v1, NULL, v2, v3) from t1;
-- result:
b'\xccT \xd3\n"\xef\xb7vAE\nq\xbe\'\xc9\x17\xb2\xf3[\xc5\xcc\xa5#\x9dE\x93\x81L\x82\xed5'
b"\xaa\x97>\xe1'\x85|.P!\xba\xfd\xe6s\x81\xa6\x03\x99\xad\xd4)\xffy\x89\xf8j\xf2\x19\xac?\x03k"
b']\xd8,\x92\xc61\xe6)\\\xd1:{\x18\x14\x1er\xed\xd7n\xd6\x91\xfd\x12)\xc6\x1f\x97\xa6\xd4id?'
-- !result
select ENCODE_ROW_ID(v1, v2, NULL, v3) from t1;
-- result:
b';\xbezV,\x17\xa4\x85;4\xce\x11E\xe5\xc4\xe5\xf7\xdd\x93\xf2\x96[\xb7\x89\x11\xf3\x88\x92\xf3\x867\xe9'
b'\x90_\x82\x18\xf2 \xfd\xc1\x9d\xf1\xef\xb1\x81SW\xdc\x82\xb0N\xc7\xa9c\x83\xdb\xac\r\xe4m\x8c\xa8\xbd\x1f'
b'j\tA\x9a\x17\x10\xcc\x91\x14\xa4$\xe4%\xf2\xde\x1d\xb3\x9aY\x97\xb4\xcd:\x94\xbb\xb8eK\x1d\x96\xc2\xad'
-- !result
select ENCODE_ROW_ID(v1, v2, v3, NULL) from t1;
-- result:
b'\x90_\x82\x18\xf2 \xfd\xc1\x9d\xf1\xef\xb1\x81SW\xdc\x82\xb0N\xc7\xa9c\x83\xdb\xac\r\xe4m\x8c\xa8\xbd\x1f'
b'j\tA\x9a\x17\x10\xcc\x91\x14\xa4$\xe4%\xf2\xde\x1d\xb3\x9aY\x97\xb4\xcd:\x94\xbb\xb8eK\x1d\x96\xc2\xad'
b';\xbezV,\x17\xa4\x85;4\xce\x11E\xe5\xc4\xe5\xf7\xdd\x93\xf2\x96[\xb7\x89\x11\xf3\x88\x92\xf3\x867\xe9'
-- !result
select ENCODE_FINGERPRINT_SHA256(v1) from t1;
-- result:
b'\xd7\x167z\xab\xacP\xc8\x96\xb3\x11\x82\xae\xfbH\xadt\x89>\x96X\x17nf\xbdiWt\x8c\xd5\rQ'
b'|\x96\\!\xc6\xef\xeb\xb5Q\xa87\xf2\x0bm\xb3\xad\xf13\x08f\x15\xfdf+\x9e\x18:\x8e\x08{\xc9V'
b'\xcd\xa8\xeaF\xe9(\xa2\x13\xdd\xde\xbeC{\x9a\xb5\xc5\xf4\xe5\xdc\x03\x03\xb8\x83\xcf\xf6\xb9\xbe\x92=Efq'
-- !result
select ENCODE_FINGERPRINT_SHA256(v1, v2) from t1;
-- result:
b'\xe7\xf0I\x1aL\xe6\x1fk_\x99\x8fHf\xc0\xef\xe9\xc2\xf0\x12\x13\xfd57<m\xd4|f\xe5R\xcdw'
b'RI\x9a\x9ef\xb4{*I=T\xd0\xc2I\xea\xba\xa0\x06\x10G\x89L\xd4~\xf8\xe9\x12\xae\xd8\xa2\xc2\x93'
b'\xf7)8\xbc\xe4\xb08vNe\x06\xdc\x93\x85\xb4\xd0\x07\x9d\x06\xb2\xf0\xd8\xb10\xdb\xb1\xa3\x87\x9b\xb7\xdc\x87'
-- !result
select ENCODE_FINGERPRINT_SHA256(v1, v2, v3) from t1;
-- result:
b'RI\x9a\x9ef\xb4{*I=T\xd0\xc2I\xea\xba\xa0\x06\x10G\x89L\xd4~\xf8\xe9\x12\xae\xd8\xa2\xc2\x93'
b'\xf7)8\xbc\xe4\xb08vNe\x06\xdc\x93\x85\xb4\xd0\x07\x9d\x06\xb2\xf0\xd8\xb10\xdb\xb1\xa3\x87\x9b\xb7\xdc\x87'
b'\xe7\xf0I\x1aL\xe6\x1fk_\x99\x8fHf\xc0\xef\xe9\xc2\xf0\x12\x13\xfd57<m\xd4|f\xe5R\xcdw'
-- !result
select ENCODE_FINGERPRINT_SHA256(NULL, v1, v2) from t1;
-- result:
b'\x16\xe4\xe4\xe9\x85\xfa\x0c\xf8\xf5p"O-\xc3\xce/\xcdg\xb4\x18B\x9c[`\xa8\x82\xd1\x1b>\xaf\xda+'
b'\x1fj=\xc7\xc6\x86f\x11\xfe\x9b\x95\x86Gcc\xa3\xb5p\x9c\xda\x1e\xcc\xbf\xadG+\xab\x18\x02\xf9\x8d~'
b'\xa4\xb58\xc8\xaa\xd6\x00a\xb6\x9c\xe7\xef\xf4\xa0\xe5\x8f\xd5X\x10\xe9\x02.\xe2b\xbf\xa2\x881\xc5\x0f;s'
-- !result
select ENCODE_FINGERPRINT_SHA256(NULL, v1, v2, v3) from t1;
-- result:
b'\x16\xe4\xe4\xe9\x85\xfa\x0c\xf8\xf5p"O-\xc3\xce/\xcdg\xb4\x18B\x9c[`\xa8\x82\xd1\x1b>\xaf\xda+'
b'\x1fj=\xc7\xc6\x86f\x11\xfe\x9b\x95\x86Gcc\xa3\xb5p\x9c\xda\x1e\xcc\xbf\xadG+\xab\x18\x02\xf9\x8d~'
b'\xa4\xb58\xc8\xaa\xd6\x00a\xb6\x9c\xe7\xef\xf4\xa0\xe5\x8f\xd5X\x10\xe9\x02.\xe2b\xbf\xa2\x881\xc5\x0f;s'
-- !result
select ENCODE_FINGERPRINT_SHA256(v1, NULL, v2, v3) from t1;
-- result:
b"\xaa\x97>\xe1'\x85|.P!\xba\xfd\xe6s\x81\xa6\x03\x99\xad\xd4)\xffy\x89\xf8j\xf2\x19\xac?\x03k"
b']\xd8,\x92\xc61\xe6)\\\xd1:{\x18\x14\x1er\xed\xd7n\xd6\x91\xfd\x12)\xc6\x1f\x97\xa6\xd4id?'
b'\xccT \xd3\n"\xef\xb7vAE\nq\xbe\'\xc9\x17\xb2\xf3[\xc5\xcc\xa5#\x9dE\x93\x81L\x82\xed5'
-- !result
select ENCODE_FINGERPRINT_SHA256(v1, v2, NULL, v3) from t1;
-- result:
b';\xbezV,\x17\xa4\x85;4\xce\x11E\xe5\xc4\xe5\xf7\xdd\x93\xf2\x96[\xb7\x89\x11\xf3\x88\x92\xf3\x867\xe9'
b'\x90_\x82\x18\xf2 \xfd\xc1\x9d\xf1\xef\xb1\x81SW\xdc\x82\xb0N\xc7\xa9c\x83\xdb\xac\r\xe4m\x8c\xa8\xbd\x1f'
b'j\tA\x9a\x17\x10\xcc\x91\x14\xa4$\xe4%\xf2\xde\x1d\xb3\x9aY\x97\xb4\xcd:\x94\xbb\xb8eK\x1d\x96\xc2\xad'
-- !result
select ENCODE_FINGERPRINT_SHA256(v1, v2, v3, NULL) from t1;
-- result:
b'\x90_\x82\x18\xf2 \xfd\xc1\x9d\xf1\xef\xb1\x81SW\xdc\x82\xb0N\xc7\xa9c\x83\xdb\xac\r\xe4m\x8c\xa8\xbd\x1f'
b'j\tA\x9a\x17\x10\xcc\x91\x14\xa4$\xe4%\xf2\xde\x1d\xb3\x9aY\x97\xb4\xcd:\x94\xbb\xb8eK\x1d\x96\xc2\xad'
b';\xbezV,\x17\xa4\x85;4\xce\x11E\xe5\xc4\xe5\xf7\xdd\x93\xf2\x96[\xb7\x89\x11\xf3\x88\x92\xf3\x867\xe9'
-- !result
select ENCODE_SORT_KEY(v1) from t1;
-- result:
b'\x01\xff\xff\xff\xff\xff\xff\xff\xfe'
b'\x01\xff\xff\xff\xff\xff\xff\xff\xff'
       
-- !result
select ENCODE_SORT_KEY(v1, v2) from t1;
-- result:
        STARROCKS
b'\x01\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x01STARROCKS'
b'\x01\xff\xff\xff\xff\xff\xff\xff\xff\x00\x01STARROCKS'
-- !result
select ENCODE_SORT_KEY(v1, v2, v3) from t1;
-- result:
E: (1064, 'encode_sort_key: unsupported argument type: BE:10001')
-- !result
select ENCODE_SORT_KEY(NULL, v1, v2) from t1;
-- result:
          STARROCKS
b'\x00\x00\x01\xff\xff\xff\xff\xff\xff\xff\xfe\x00\x01STARROCKS'
b'\x00\x00\x01\xff\xff\xff\xff\xff\xff\xff\xff\x00\x01STARROCKS'
-- !result
select ENCODE_SORT_KEY(NULL, v1, v2, v3) from t1;
-- result:
E: (1064, 'encode_sort_key: unsupported argument type: BE:10001')
-- !result
select ENCODE_SORT_KEY(v1, NULL, v2, v3) from t1;
-- result:
E: (1064, 'encode_sort_key: unsupported argument type: BE:10001')
-- !result
select ENCODE_SORT_KEY(v1, v2, NULL, v3) from t1;
-- result:
E: (1064, 'encode_sort_key: unsupported argument type: BE:10001')
-- !result
select ENCODE_SORT_KEY(v1, v2, v3, NULL) from t1;
-- result:
E: (1064, 'encode_sort_key: unsupported argument type: BE:10001')
-- !result