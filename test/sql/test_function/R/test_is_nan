-- name: test_is_nan_function
CREATE TABLE test_is_nan (
    id INT,
    value_double DOUBLE,
    value_float FLOAT,
    value_int INT,
    value_bigint BIGINT,
    value_decimal DECIMALV2(10, 2)
) ENGINE=OLAP
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 3
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO test_is_nan VALUES
(1, 1.5, 1.5, 1, 1, 1.0),
(2, CAST('inf' AS DOUBLE), CAST('inf' AS FLOAT), NULL, NULL, NULL),
(3, CAST('-inf' AS DOUBLE), CAST('-inf' AS FLOAT), NULL, NULL, NULL),
(4, CAST('nan' AS DOUBLE), CAST('nan' AS FLOAT), NULL, NULL, NULL),
(5, 0.0, 0.0, 0, 0, 0.0),
(6, -0.0, -0.0, NULL, NULL, NULL),
(7, 1.7976931348623157E+308, 3.40282347E+38, NULL, NULL, NULL),
(8, 2.2250738585072014E-308, 1.17549435E-38, NULL, NULL, NULL),
(9, NULL, NULL, NULL, NULL, NULL),
(10, 3.14159, 3.14159, 100, 1000000, 99.99);
-- result:
-- !result
SELECT id, value_double AS input_value, is_nan(value_double) AS result FROM test_is_nan ORDER BY id;
-- result:
1	1.5	0
2	None	None
3	None	None
4	None	None
5	0.0	0
6	0.0	0
7	1.7976931348623157e+308	0
8	0.0	0
9	None	None
10	3.14159	0
-- !result
SELECT id, value_float AS input_value, is_nan(value_float) AS result FROM test_is_nan ORDER BY id;
-- result:
1	1.5	0
2	None	None
3	None	None
4	None	None
5	0.0	0
6	0.0	0
7	3.4028235e+38	0
8	1.1754944e-38	0
9	None	None
10	3.14159	0
-- !result
SELECT is_nan(CAST('nan' AS DOUBLE)) AS result;
-- result:
None
-- !result
SELECT is_nan(CAST('nan' AS FLOAT)) AS result;
-- result:
None
-- !result
SELECT is_nan(CAST('inf' AS DOUBLE)) AS result;
-- result:
None
-- !result
SELECT is_nan(CAST('inf' AS FLOAT)) AS result;
-- result:
None
-- !result
SELECT is_nan(CAST('-inf' AS DOUBLE)) AS result;
-- result:
None
-- !result
SELECT is_nan(CAST('-inf' AS FLOAT)) AS result;
-- result:
None
-- !result
SELECT is_nan(1.0) AS result;
-- result:
0
-- !result
SELECT is_nan(0.0) AS result;
-- result:
0
-- !result
SELECT is_nan(-1.0) AS result;
-- result:
0
-- !result
SELECT is_nan(3.14159) AS result;
-- result:
0
-- !result
SELECT is_nan(CAST(1.0 AS FLOAT)) AS result;
-- result:
0
-- !result
SELECT is_nan(CAST(0.0 AS FLOAT)) AS result;
-- result:
0
-- !result
SELECT is_nan(CAST(-1.0 AS FLOAT)) AS result;
-- result:
0
-- !result
SELECT is_nan(CAST(3.14159 AS FLOAT)) AS result;
-- result:
0
-- !result
SELECT is_nan(NULL) AS result;
-- result:
None
-- !result
SELECT id, value_int, is_nan(value_int) AS result FROM test_is_nan WHERE value_int IS NOT NULL ORDER BY id;
-- result:
1	1	0
5	0	0
10	100	0
-- !result
SELECT id, value_bigint, is_nan(value_bigint) AS result FROM test_is_nan WHERE value_bigint IS NOT NULL ORDER BY id;
-- result:
1	1	0
5	0	0
10	1000000	0
-- !result
SELECT id, value_decimal, is_nan(value_decimal) AS result FROM test_is_nan WHERE value_decimal IS NOT NULL ORDER BY id;
-- result:
1	1	0
5	0	0
10	99.99	0
-- !result
SELECT is_nan(CAST('nan' AS DOUBLE)) AS result;
-- result:
None
-- !result
SELECT is_nan(0.0 / 0.0) AS result;
-- result:
None
-- !result
SELECT is_nan(CAST('nan' AS DOUBLE) + 1.0) AS result;
-- result:
None
-- !result
SELECT is_nan(1.0 / 0.0) AS result;
-- result:
None
-- !result
SELECT is_nan(-1.0 / 0.0) AS result;
-- result:
None
-- !result
DROP TABLE test_is_nan;
-- result:
-- !result