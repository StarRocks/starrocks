-- name: test_decimal256_cast_operations
DROP DATABASE IF EXISTS test_decimal256_cast;
-- result:
-- !result
CREATE DATABASE test_decimal256_cast;
-- result:
-- !result
USE test_decimal256_cast;
-- result:
-- !result
CREATE TABLE cast_test_source (
    id int,
    bool_val boolean,
    tinyint_val tinyint,
    smallint_val smallint,
    int_val int,
    bigint_val bigint,
    largeint_val largeint,
    float_val float,
    double_val double,
    varchar_val varchar(100),
    -- decimal256 columns for testing (precision > 38, <= 76)
    decimal256_50_15 decimal(50,15),  -- 50 digits total, 15 after decimal
    decimal256_76_20 decimal(76,20),  -- 76 digits total, 20 after decimal
    decimal256_76_0 decimal(76,0),    -- 76 digits total, 0 after decimal
    -- regular decimal columns for comparison (precision <= 38)
    decimal_38_10 decimal(38,10),     -- 38 digits total, 10 after decimal
    decimal_20_5 decimal(20,5)        -- 20 digits total, 5 after decimal
) ENGINE=OLAP
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 1
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO cast_test_source VALUES
(1, true, 127, 32767, 2147483647, 9223372036854775807, 170141183460469231731687303715884105727,
 3.14159, 2.718281828459045, '12345678901234567890123456789012345.123456789012345',
 12345678901234567890123456789012345.123456789012345,  -- 35+15=50 digits
 12345678901234567890123456789012345678901234567890123456.12345678901234567890,  -- 56+20=76 digits
 1234567890123456789012345678901234567890123456789012345678901234567890123456,  -- 76 digits
 1234567890123456789012345678.1234567890,  -- 28+10=38 digits
 123456789012345.12345),  -- 15+5=20 digits

(2, false, 0, 0, 0, 0, 0, 0.0, 0.0, '0',
 0.000000000000000,
 0.00000000000000000000,
 0,
 0.0000000000,
 0.00000),

(3, false, -128, -32768, -2147483648, -9223372036854775808, -170141183460469231731687303715884105728,
 -3.14159, -2.718281828459045, '-87654321098765432109876543210987654.987654321098765',
 -87654321098765432109876543210987654.987654321098765,  -- 35+15=50 digits
 -87654321098765432109876543210987654321098765432109876543.98765432109876543210,  -- 56+20=76 digits
 -8765432109876543210987654321098765432109876543210987654321098765432109876543,  -- 76 digits
 -8765432109876543210987654321.9876543210,  -- 28+10=38 digits
 -876543210987654.98765),  -- 15+5=20 digits

(4, true, 127, 32767, 2147483647, 9223372036854775807, 170141183460469231731687303715884105727,
 1.7976931348623157e+308, 1.7976931348623157e+308, '99999999999999999999999999999999999.999999999999999',
 99999999999999999999999999999999999.999999999999999,  -- 35+15=50 digits
 99999999999999999999999999999999999999999999999999999999.99999999999999999999,  -- 56+20=76 digits
 9999999999999999999999999999999999999999999999999999999999999999999999999999,  -- 76 digits
 9999999999999999999999999999.9999999999,  -- 28+10=38 digits
 999999999999999.99999),  -- 15+5=20 digits

(5, false, -128, -32768, -2147483648, -9223372036854775808, -170141183460469231731687303715884105728,
 -1.7976931348623157e+308, -1.7976931348623157e+308, '-99999999999999999999999999999999999.999999999999999',
 -99999999999999999999999999999999999.999999999999999,  -- 35+15=50 digits
 -99999999999999999999999999999999999999999999999999999999.99999999999999999999,  -- 56+20=76 digits
 -9999999999999999999999999999999999999999999999999999999999999999999999999999,  -- 76 digits
 -9999999999999999999999999999.9999999999,  -- 28+10=38 digits
 -999999999999999.99999),  -- 15+5=20 digits

(6, true, 1, 1, 1, 1, 1, 0.000001, 0.000000000000001, '0.000000000000001',
 0.000000000000001,
 0.00000000000000000001,
 1,
 0.0000000001,
 0.00001),

(7, false, 42, 1234, 567890, 123456789012345, 987654321098765432109876543210,
 123.456789, 987.654321123456789, '555555555555555555555555555555555.555555555555555',
 55555555555555555555555555555555555.555555555555555,  -- 35+15=50 digits
 55555555555555555555555555555555555555555555555555555555.55555555555555555555,  -- 56+20=76 digits
 5555555555555555555555555555555555555555555555555555555555555555555555555555,  -- 76 digits
 5555555555555555555555555555.5555555555,  -- 28+10=38 digits
 555555555555555.55555),  -- 15+5=20 digits

(8, true, 1, 10, 100, 1000, 10000,
 1e-10, 1e-15, '0.000000000000001',
 0.000000000000001,
 0.00000000000000000001,
 1,
 0.0000000001,
 0.00001),

(9, false, 99, 9999, 999999999, 999999999999999999, 99999999999999999999999999999999999999,
 999999.999999, 999999999.999999999999, '77777777777777777777777777777777777.777777777777777',
 77777777777777777777777777777777777.777777777777777,  -- 35+15=50 digits
 77777777777777777777777777777777777777777777777777777777.77777777777777777777,  -- 56+20=76 digits
 7777777777777777777777777777777777777777777777777777777777777777777777777777,  -- 76 digits
 7777777777777777777777777777.7777777777,  -- 28+10=38 digits
 777777777777777.77777),  -- 15+5=20 digits

(10, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
-- result:
-- !result
SELECT
    id,
    bool_val,
    CAST(bool_val AS decimal(50,15)) as bool_to_decimal256_50_15,
    CAST(bool_val AS decimal(76,20)) as bool_to_decimal256_76_20,
    CAST(bool_val AS decimal(76,0)) as bool_to_decimal256_76_0,
    CAST(bool_val AS decimal(38,10)) as bool_to_decimal_38_10
FROM cast_test_source
ORDER BY id;
-- result:
1	1	1.000000000000000	1.00000000000000000000	1	1.0000000000
2	0	0E-15	0E-20	0	0E-10
3	0	0E-15	0E-20	0	0E-10
4	1	1.000000000000000	1.00000000000000000000	1	1.0000000000
5	0	0E-15	0E-20	0	0E-10
6	1	1.000000000000000	1.00000000000000000000	1	1.0000000000
7	0	0E-15	0E-20	0	0E-10
8	1	1.000000000000000	1.00000000000000000000	1	1.0000000000
9	0	0E-15	0E-20	0	0E-10
10	None	None	None	None	None
-- !result
SELECT
    id,
    tinyint_val,
    CAST(tinyint_val AS decimal(50,15)) as tinyint_to_decimal256,
    smallint_val,
    CAST(smallint_val AS decimal(50,15)) as smallint_to_decimal256,
    int_val,
    CAST(int_val AS decimal(50,15)) as int_to_decimal256
FROM cast_test_source
ORDER BY id;
-- result:
1	127	127.000000000000000	32767	32767.000000000000000	2147483647	2147483647.000000000000000
2	0	0E-15	0	0E-15	0	0E-15
3	-128	-128.000000000000000	-32768	-32768.000000000000000	-2147483648	-2147483648.000000000000000
4	127	127.000000000000000	32767	32767.000000000000000	2147483647	2147483647.000000000000000
5	-128	-128.000000000000000	-32768	-32768.000000000000000	-2147483648	-2147483648.000000000000000
6	1	1.000000000000000	1	1.000000000000000	1	1.000000000000000
7	42	42.000000000000000	1234	1234.000000000000000	567890	567890.000000000000000
8	1	1.000000000000000	10	10.000000000000000	100	100.000000000000000
9	99	99.000000000000000	9999	9999.000000000000000	999999999	999999999.000000000000000
10	None	None	None	None	None	None
-- !result
SELECT
    id,
    bigint_val,
    CAST(bigint_val AS decimal(76,20)) as bigint_to_decimal256,
    largeint_val,
    CAST(largeint_val AS decimal(76,0)) as largeint_to_decimal256
FROM cast_test_source
ORDER BY id;
-- result:
1	9223372036854775807	9223372036854775807.00000000000000000000	170141183460469231731687303715884105727	170141183460469231731687303715884105727
2	0	0E-20	0	0
3	-9223372036854775808	-9223372036854775808.00000000000000000000	-170141183460469231731687303715884105728	-170141183460469231731687303715884105728
4	9223372036854775807	9223372036854775807.00000000000000000000	170141183460469231731687303715884105727	170141183460469231731687303715884105727
5	-9223372036854775808	-9223372036854775808.00000000000000000000	-170141183460469231731687303715884105728	-170141183460469231731687303715884105728
6	1	1.00000000000000000000	1	1
7	123456789012345	123456789012345.00000000000000000000	987654321098765432109876543210	987654321098765432109876543210
8	1000	1000.00000000000000000000	10000	10000
9	999999999999999999	999999999999999999.00000000000000000000	99999999999999999999999999999999999999	99999999999999999999999999999999999999
10	None	None	None	None
-- !result
SELECT
    id,
    float_val,
    CAST(float_val AS decimal(50,15)) as float_to_decimal256_50_15,
    CAST(float_val AS decimal(76,20)) as float_to_decimal256_76_20,
    double_val,
    CAST(double_val AS decimal(50,15)) as double_to_decimal256_50_15,
    CAST(double_val AS decimal(76,20)) as double_to_decimal256_76_20
FROM cast_test_source
ORDER BY id;
-- result:
1	3.14159	3.141590118408203	3.14159011840820314112	2.718281828459045	2.718281828459045	2.71828182845904519168
2	0.0	0E-15	0E-20	0.0	0E-15	0E-20
3	-3.14159	-3.141590118408203	-3.14159011840820314112	-2.718281828459045	-2.718281828459045	-2.71828182845904519168
4	inf	None	None	1.7976931348623157e+308	None	None
5	-inf	None	None	-1.7976931348623157e+308	None	None
6	1e-06	9.99999997E-7	9.9999999747524E-7	1e-15	1E-15	1.00000E-15
7	123.45679	123.456787109375008	123.45678710937499992064	987.6543211234568	987.654321123456896	987.65432112345690144768
8	1e-10	1.00000E-10	1.0000000134E-10	1e-15	1E-15	1.00000E-15
9	1000000.0	1000000.000000000000000	1000000.00000000004764729344	1000000000.0	999999999.999999983222784	999999999.99999991433150857216
10	None	None	None	None	None	None
-- !result
SELECT
    id,
    varchar_val,
    CAST(varchar_val AS decimal(50,15)) as varchar_to_decimal256_50_15,
    CAST(varchar_val AS decimal(76,20)) as varchar_to_decimal256_76_20,
    CAST(varchar_val AS decimal(76,0)) as varchar_to_decimal256_76_0
FROM cast_test_source
WHERE varchar_val IS NOT NULL
ORDER BY id;
-- result:
1	12345678901234567890123456789012345.123456789012345	12345678901234567890123456789012345.123456789012345	12345678901234567890123456789012345.12345678901234500000	12345678901234567890123456789012345
2	0	0E-15	0E-20	0
3	-87654321098765432109876543210987654.987654321098765	-87654321098765432109876543210987654.987654321098765	-87654321098765432109876543210987654.98765432109876500000	-87654321098765432109876543210987655
4	99999999999999999999999999999999999.999999999999999	99999999999999999999999999999999999.999999999999999	99999999999999999999999999999999999.99999999999999900000	100000000000000000000000000000000000
5	-99999999999999999999999999999999999.999999999999999	-99999999999999999999999999999999999.999999999999999	-99999999999999999999999999999999999.99999999999999900000	-100000000000000000000000000000000000
6	0.000000000000001	1E-15	1.00000E-15	0
7	555555555555555555555555555555555.555555555555555	555555555555555555555555555555555.555555555555555	555555555555555555555555555555555.55555555555555500000	555555555555555555555555555555556
8	0.000000000000001	1E-15	1.00000E-15	0
9	77777777777777777777777777777777777.777777777777777	77777777777777777777777777777777777.777777777777777	77777777777777777777777777777777777.77777777777777700000	77777777777777777777777777777777778
-- !result
SELECT
    id,
    decimal256_50_15,
    CAST(decimal256_50_15 AS boolean) as decimal256_to_bool,
    CAST(decimal256_50_15 AS tinyint) as decimal256_to_tinyint,
    CAST(decimal256_50_15 AS smallint) as decimal256_to_smallint,
    CAST(decimal256_50_15 AS int) as decimal256_to_int,
    CAST(decimal256_50_15 AS bigint) as decimal256_to_bigint,
    CAST(decimal256_50_15 AS largeint) as decimal256_to_largeint
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL
ORDER BY id;
-- result:
1	12345678901234567890123456789012345.123456789012345	1	None	None	None	None	12345678901234567890123456789012345
2	0E-15	0	0	0	0	0	0
3	-87654321098765432109876543210987654.987654321098765	1	None	None	None	None	-87654321098765432109876543210987654
4	99999999999999999999999999999999999.999999999999999	1	None	None	None	None	99999999999999999999999999999999999
5	-99999999999999999999999999999999999.999999999999999	1	None	None	None	None	-99999999999999999999999999999999999
6	1E-15	1	0	0	0	0	0
7	55555555555555555555555555555555555.555555555555555	1	None	None	None	None	55555555555555555555555555555555555
8	1E-15	1	0	0	0	0	0
9	77777777777777777777777777777777777.777777777777777	1	None	None	None	None	77777777777777777777777777777777777
-- !result
SELECT
    id,
    decimal256_76_20,
    CAST(decimal256_76_20 AS float) as decimal256_to_float,
    CAST(decimal256_76_20 AS double) as decimal256_to_double,
    CAST(decimal256_76_20 AS varchar(100)) as decimal256_to_varchar
FROM cast_test_source
WHERE decimal256_76_20 IS NOT NULL
ORDER BY id;
-- result:
1	12345678901234567890123456789012345678901234567890123456.12345678901234567890	inf	1.234567890123457e+55	12345678901234567890123456789012345678901234567890123456.12345678901234567890
2	0E-20	0.0	0.0	0.00000000000000000000
3	-87654321098765432109876543210987654321098765432109876543.98765432109876543210	-inf	-8.765432109876543e+55	-87654321098765432109876543210987654321098765432109876543.98765432109876543210
4	99999999999999999999999999999999999999999999999999999999.99999999999999999999	inf	1e+56	99999999999999999999999999999999999999999999999999999999.99999999999999999999
5	-99999999999999999999999999999999999999999999999999999999.99999999999999999999	-inf	-1e+56	-99999999999999999999999999999999999999999999999999999999.99999999999999999999
6	1E-20	1e-20	1e-20	0.00000000000000000001
7	55555555555555555555555555555555555555555555555555555555.55555555555555555555	inf	5.555555555555556e+55	55555555555555555555555555555555555555555555555555555555.55555555555555555555
8	1E-20	1e-20	1e-20	0.00000000000000000001
9	77777777777777777777777777777777777777777777777777777777.77777777777777777777	inf	7.777777777777777e+55	77777777777777777777777777777777777777777777777777777777.77777777777777777777
-- !result
SELECT
    id,
    decimal256_50_15,
    CAST(decimal256_50_15 AS decimal(76,20)) as decimal256_50_15_to_76_20,
    CAST(decimal256_50_15 AS decimal(76,0)) as decimal256_50_15_to_76_0,
    CAST(decimal256_50_15 AS decimal(38,10)) as decimal256_50_15_to_38_10,
    decimal256_76_20,
    CAST(decimal256_76_20 AS decimal(50,15)) as decimal256_76_20_to_50_15,
    CAST(decimal256_76_20 AS decimal(76,0)) as decimal256_76_20_to_76_0
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND decimal256_76_20 IS NOT NULL
ORDER BY id;
-- result:
1	12345678901234567890123456789012345.123456789012345	12345678901234567890123456789012345.12345678901234500000	12345678901234567890123456789012345	None	12345678901234567890123456789012345678901234567890123456.12345678901234567890	12345678901234567890123456789012345678901234567890123456.123456789012346	12345678901234567890123456789012345678901234567890123456
2	0E-15	0E-20	0	0E-10	0E-20	0E-15	0
3	-87654321098765432109876543210987654.987654321098765	-87654321098765432109876543210987654.98765432109876500000	-87654321098765432109876543210987655	None	-87654321098765432109876543210987654321098765432109876543.98765432109876543210	-87654321098765432109876543210987654321098765432109876543.987654321098765	-87654321098765432109876543210987654321098765432109876544
4	99999999999999999999999999999999999.999999999999999	99999999999999999999999999999999999.99999999999999900000	100000000000000000000000000000000000	None	99999999999999999999999999999999999999999999999999999999.99999999999999999999	100000000000000000000000000000000000000000000000000000000.000000000000000	100000000000000000000000000000000000000000000000000000000
5	-99999999999999999999999999999999999.999999999999999	-99999999999999999999999999999999999.99999999999999900000	-100000000000000000000000000000000000	None	-99999999999999999999999999999999999999999999999999999999.99999999999999999999	-100000000000000000000000000000000000000000000000000000000.000000000000000	-100000000000000000000000000000000000000000000000000000000
6	1E-15	1.00000E-15	0	0E-10	1E-20	0E-15	0
7	55555555555555555555555555555555555.555555555555555	55555555555555555555555555555555555.55555555555555500000	55555555555555555555555555555555556	None	55555555555555555555555555555555555555555555555555555555.55555555555555555555	55555555555555555555555555555555555555555555555555555555.555555555555556	55555555555555555555555555555555555555555555555555555556
8	1E-15	1.00000E-15	0	0E-10	1E-20	0E-15	0
9	77777777777777777777777777777777777.777777777777777	77777777777777777777777777777777777.77777777777777700000	77777777777777777777777777777777778	None	77777777777777777777777777777777777777777777777777777777.77777777777777777777	77777777777777777777777777777777777777777777777777777777.777777777777778	77777777777777777777777777777777777777777777777777777778
-- !result
SELECT
    id,
    decimal_38_10,
    CAST(decimal_38_10 AS decimal(50,15)) as decimal_38_10_to_decimal256_50_15,
    CAST(decimal_38_10 AS decimal(76,20)) as decimal_38_10_to_decimal256_76_20,
    decimal256_50_15,
    CAST(decimal256_50_15 AS decimal(38,10)) as decimal256_50_15_to_decimal_38_10,
    CAST(decimal256_50_15 AS decimal(20,5)) as decimal256_50_15_to_decimal_20_5
FROM cast_test_source
WHERE decimal_38_10 IS NOT NULL AND decimal256_50_15 IS NOT NULL
ORDER BY id;
-- result:
1	1234567890123456789012345678.1234567890	1234567890123456789012345678.123456789000000	1234567890123456789012345678.12345678900000000000	12345678901234567890123456789012345.123456789012345	None	None
2	0E-10	0E-15	0E-20	0E-15	0E-10	0.00000
3	-8765432109876543210987654321.9876543210	-8765432109876543210987654321.987654321000000	-8765432109876543210987654321.98765432100000000000	-87654321098765432109876543210987654.987654321098765	None	None
4	9999999999999999999999999999.9999999999	9999999999999999999999999999.999999999900000	9999999999999999999999999999.99999999990000000000	99999999999999999999999999999999999.999999999999999	None	None
5	-9999999999999999999999999999.9999999999	-9999999999999999999999999999.999999999900000	-9999999999999999999999999999.99999999990000000000	-99999999999999999999999999999999999.999999999999999	None	None
6	1E-10	1.00000E-10	1.0000000000E-10	1E-15	0E-10	0.00000
7	5555555555555555555555555555.5555555555	5555555555555555555555555555.555555555500000	5555555555555555555555555555.55555555550000000000	55555555555555555555555555555555555.555555555555555	None	None
8	1E-10	1.00000E-10	1.0000000000E-10	1E-15	0E-10	0.00000
9	7777777777777777777777777777.7777777777	7777777777777777777777777777.777777777700000	7777777777777777777777777777.77777777770000000000	77777777777777777777777777777777777.777777777777777	None	None
-- !result
SELECT
    id,
    decimal256_50_15 + tinyint_val as decimal256_plus_tinyint,
    decimal256_50_15 + smallint_val as decimal256_plus_smallint,
    decimal256_50_15 + int_val as decimal256_plus_int,
    decimal256_50_15 + bigint_val as decimal256_plus_bigint,
    decimal256_50_15 + largeint_val as decimal256_plus_largeint
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND tinyint_val IS NOT NULL
ORDER BY id;
-- result:
1	12345678901234567890123456789012472.123456789012345	12345678901234567890123456789045112.123456789012345	12345678901234567890123458936495992.123456789012345	12345678901234577113495493643788152.123456789012345	170153529139370466299577427172673118072.123456789012345
2	0E-15	0E-15	0E-15	0E-15	0E-15
3	-87654321098765432109876543210987782.987654321098765	-87654321098765432109876543211020422.987654321098765	-87654321098765432109876545358471302.987654321098765	-87654321098765441333248580065763462.987654321098765	-170228837781567997163797180259095093382.987654321098765
4	100000000000000000000000000000000126.999999999999999	100000000000000000000000000000032766.999999999999999	100000000000000000000000002147483646.999999999999999	100000000000000009223372036854775806.999999999999999	170241183460469231731687303715884105726.999999999999999
5	-100000000000000000000000000000000127.999999999999999	-100000000000000000000000000000032767.999999999999999	-100000000000000000000000002147483647.999999999999999	-100000000000000009223372036854775807.999999999999999	-170241183460469231731687303715884105727.999999999999999
6	1.000000000000001	1.000000000000001	1.000000000000001	1.000000000000001	1.000000000000001
7	55555555555555555555555555555555597.555555555555555	55555555555555555555555555555556789.555555555555555	55555555555555555555555555556123445.555555555555555	55555555555555555555679012344567900.555555555555555	55556543209876654320987665432098765.555555555555555
8	1.000000000000001	10.000000000000001	100.000000000000001	1000.000000000000001	10000.000000000000001
9	77777777777777777777777777777777876.777777777777777	77777777777777777777777777777787776.777777777777777	77777777777777777777777778777777776.777777777777777	77777777777777778777777777777777776.777777777777777	100077777777777777777777777777777777776.777777777777777
-- !result
SELECT
    id,
    decimal256_76_20 + float_val as decimal256_plus_float,
    decimal256_76_20 + double_val as decimal256_plus_double,
    decimal256_50_15 + decimal_38_10 as decimal256_plus_decimal38
FROM cast_test_source
WHERE decimal256_76_20 IS NOT NULL AND float_val IS NOT NULL AND decimal256_50_15 IS NOT NULL AND decimal_38_10 IS NOT NULL
ORDER BY id;
-- result:
1	1.234567890123457e+55	1.234567890123457e+55	12345680135802458013580245801358023.246913578012345
2	0.0	0.0	0E-15
3	-8.765432109876543e+55	-8.765432109876543e+55	-87654329864197541986419754198641976.975308642098765
4	inf	1.7976931348623157e+308	100000009999999999999999999999999999.999999999899999
5	-inf	-1.7976931348623157e+308	-100000009999999999999999999999999999.999999999899999
6	9.999999974752527e-07	1.00001e-15	1.00001E-10
7	5.555555555555556e+55	5.555555555555556e+55	55555561111111111111111111111111111.111111111055555
8	1.000000013451432e-10	1.00001e-15	1.00001E-10
9	7.777777777777777e+55	7.777777777777777e+55	77777785555555555555555555555555555.555555555477777
-- !result
SELECT
    id,
    decimal256_50_15 - tinyint_val as decimal256_minus_tinyint,
    decimal256_50_15 - smallint_val as decimal256_minus_smallint,
    decimal256_50_15 - int_val as decimal256_minus_int,
    decimal256_50_15 - bigint_val as decimal256_minus_bigint,
    decimal256_76_20 - decimal_38_10 as decimal256_minus_decimal38
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND tinyint_val IS NOT NULL AND decimal256_76_20 IS NOT NULL AND decimal_38_10 IS NOT NULL
ORDER BY id;
-- result:
1	12345678901234567890123456789012218.123456789012345	12345678901234567890123456788979578.123456789012345	12345678901234567890123454641528698.123456789012345	12345678901234558666751419934236538.123456789012345	12345678901234567890123456787777777788777777778877777778.00000000001234567890
2	0E-15	0E-15	0E-15	0E-15	0E-20
3	-87654321098765432109876543210987526.987654321098765	-87654321098765432109876543210954886.987654321098765	-87654321098765432109876541063504006.987654321098765	-87654321098765422886504506356211846.987654321098765	-87654321098765432109876543202222222211222222221122222222.00000000009876543210
4	99999999999999999999999999999999872.999999999999999	99999999999999999999999999999967232.999999999999999	99999999999999999999999997852516352.999999999999999	99999999999999990776627963145224192.999999999999999	99999999999999999999999999990000000000000000000000000000.00000000009999999999
5	-99999999999999999999999999999999871.999999999999999	-99999999999999999999999999999967231.999999999999999	-99999999999999999999999997852516351.999999999999999	-99999999999999990776627963145224191.999999999999999	-99999999999999999999999999990000000000000000000000000000.00000000009999999999
6	-0.999999999999999	-0.999999999999999	-0.999999999999999	-0.999999999999999	-9.999999999E-11
7	55555555555555555555555555555555513.555555555555555	55555555555555555555555555555554321.555555555555555	55555555555555555555555555554987665.555555555555555	55555555555555555555432098766543210.555555555555555	55555555555555555555555555550000000000000000000000000000.00000000005555555555
8	-0.999999999999999	-9.999999999999999	-99.999999999999999	-999.999999999999999	-9.999999999E-11
9	77777777777777777777777777777777678.777777777777777	77777777777777777777777777777767778.777777777777777	77777777777777777777777776777777778.777777777777777	77777777777777776777777777777777778.777777777777777	77777777777777777777777777770000000000000000000000000000.00000000007777777777
-- !result
SELECT
    id,
    decimal256_50_15 * tinyint_val as decimal256_multiply_tinyint,
    decimal256_50_15 * smallint_val as decimal256_multiply_smallint,
    decimal256_76_20 * float_val as decimal256_multiply_float,
    decimal256_76_20 * double_val as decimal256_multiply_double,
    decimal256_50_15 * decimal_20_5 as decimal256_multiply_decimal20
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND decimal256_76_20 IS NOT NULL AND tinyint_val IS NOT NULL
    AND float_val IS NOT NULL AND decimal_20_5 IS NOT NULL
ORDER BY id;
-- result:
1	1567901220456790122045679012204567830.679012204567815	404530860556753086055675308605567512660.308605567508615	3.878506284115917e+55	3.3559034617216163e+55	1524157875323876817626947886762694720102881755837.67461130300259899025
2	0E-15	0E-15	0.0	0.0	0E-20
3	11219753100641975310064197531006419838.419753100641920	2872256793764345679376434567937643478635.456793764331520	2.753739489996612e+56	2.3826914822868836e+56	76832800072854806320898565170589857101323732717416.38954291988050525225
4	12699999999999999999999999999999999999.999999999999873	3276699999999999999999999999999999999999.999999999967233	inf	inf	99999999999999999998999999999999999999999999999999.00000000000000000001
5	12799999999999999999999999999999999999.999999999999872	3276799999999999999999999999999999999999.999999999967232	inf	inf	99999999999999999998999999999999999999999999999999.00000000000000000001
6	1E-15	1E-15	9.999999974752427e-27	1e-35	1E-20
7	2333333333333333333333333333333333333.333333333333310	68555555555555555555555555555555555555.555555555554870	6.858710394965278e+57	5.486968450685872e+58	30864197530864197530555555555555555555555555555555.24691358024691358025
8	1E-15	1.0E-14	1.0000000133514319e-30	1e-35	1E-20
9	7699999999999999999999999999999999999.999999999999923	777699999999999999999999999999999999999.999999999992223	7.777777777777778e+61	7.777777777777778e+64	60493827160493827159888888888888888888888888888888.28395061728395061729
-- !result
SELECT
    id,
    decimal256_50_15 / tinyint_val as decimal256_divide_tinyint,
    decimal256_50_15 / smallint_val as decimal256_divide_smallint,
    decimal256_76_20 / float_val as decimal256_divide_float,
    decimal256_76_20 / double_val as decimal256_divide_double,
    decimal256_50_15 / decimal_20_5 as decimal256_divide_decimal20
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND decimal256_76_20 IS NOT NULL
    AND tinyint_val IS NOT NULL AND tinyint_val != 0 AND smallint_val != 0
    AND float_val IS NOT NULL AND float_val != 0 AND double_val IS NOT NULL AND double_val != 0
    AND decimal_20_5 IS NOT NULL AND decimal_20_5 != 0
ORDER BY id;
-- result:
1	97210070088461164489161077078837.363176825110333	376771718534945765255392827814.946291191039430	3.929754817121064e+54	4.54172145506824e+54	100000000000000449915.504049232561083
3	684799383584104938358410493835841.054591049383584	2674997592125409915462540991546.254119496286655	2.790125948803868e+55	3.2246222662075993e+55	99999999999999923956.831082309567732
4	787401574803149606299212598425196.850393700787402	3051850947599719229712820825830.866420484023560	0.0	5.562684646268005e-253	100000000000000000001.000000000000000
5	781250000000000000000000000000000.000000000000000	3051757812500000000000000000000.000000000000000	0.0	5.562684646268005e-253	100000000000000000001.000000000000000
6	1E-15	1E-15	1.0000000025247572e-14	9.999999999999999e-06	1.00000E-10
7	1322751322751322751322751322751322.751322751322751	45020709526382135782459931568521.519899153610661	4.5000001098632844e+53	5.624999999226563e+52	100000000000000000001.000000000000000
8	1E-15	0E-15	9.999999866485681e-11	9.999999999999999e-06	1.00000E-10
9	785634118967452300785634118967452.300785634118967	7778555633341111888966674445222.300007778555633	7.777777777777778e+49	7.777777777777778e+46	100000000000000000001.000000000000000
-- !result
SELECT
    id,
    decimal256_50_15 + decimal256_76_20 as decimal256_addition,
    decimal256_50_15 - decimal256_76_20 as decimal256_subtraction,
    decimal256_50_15 * decimal256_76_0 as decimal256_multiplication,
    decimal256_76_20 / decimal256_76_0 as decimal256_division
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND decimal256_76_20 IS NOT NULL
    AND decimal256_76_0 IS NOT NULL AND decimal256_76_0 != 0
ORDER BY id;
-- result:
1	12345678901234567890135802467913580246791358024679135801.24691357802469067890	-12345678901234567890111111110111111111011111111101111111.00000000000000067890	None	1E-20
3	-87654321098765432109964197532086419753208641975320864198.97530864219753043210	87654321098765432109788888889888888888988888888898888889.00000000000000043210	None	1E-20
4	100000000000000000000099999999999999999999999999999999999.99999999999999899999	-99999999999999999999900000000000000000000000000000000000.00000000000000099999	None	1E-20
5	-100000000000000000000099999999999999999999999999999999999.99999999999999899999	99999999999999999999900000000000000000000000000000000000.00000000000000099999	None	1E-20
6	1.00001E-15	9.9999E-16	1E-15	1E-20
7	55555555555555555555611111111111111111111111111111111111.11111111111111055555	-55555555555555555555500000000000000000000000000000000000.00000000000000055555	None	1E-20
8	1.00001E-15	9.9999E-16	1E-15	1E-20
9	77777777777777777777855555555555555555555555555555555555.55555555555555477777	-77777777777777777777700000000000000000000000000000000000.00000000000000077777	None	1E-20
-- !result
SELECT
    id,
    (decimal256_50_15 + CAST(int_val AS decimal(50,15))) * CAST(float_val AS decimal(50,15)) as complex_expr1,
    (decimal256_76_20 - CAST(bigint_val AS decimal(76,20))) / CAST(double_val AS decimal(76,20)) as complex_expr2,
    CAST(tinyint_val AS decimal(76,0)) + decimal256_76_0 - CAST(smallint_val AS decimal(76,0)) as complex_expr3,
    (decimal256_50_15 + decimal_38_10) * CAST(decimal_20_5 AS decimal(50,15)) as complex_expr4
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND decimal256_76_20 IS NOT NULL AND decimal256_76_0 IS NOT NULL
    AND int_val IS NOT NULL AND float_val IS NOT NULL AND float_val != 0
    AND bigint_val IS NOT NULL AND double_val IS NOT NULL AND double_val != 0
    AND tinyint_val IS NOT NULL AND smallint_val IS NOT NULL
    AND decimal_38_10 IS NOT NULL AND decimal_20_5 IS NOT NULL
ORDER BY id;
-- result:
1	38785062841159159648132622711326664.709912157833965463651916266035	None	1234567890123456789012345678901234567890123456789012345678901234567890090816	None
3	275373948999661140351867390781700148.497562752457348482839749169295	None	-8765432109876543210987654321098765432109876543210987654321098765432109843903	None
4	None	None	9999999999999999999999999999999999999999999999999999999999999999999999967359	None
5	None	None	-9999999999999999999999999999999999999999999999999999999999999999999999967359	None
6	9.99999997000000999999997E-7	-999999999999999.99999000000000000000	1	1.000010000000000E-15
7	6858710394965278222222222222292332097.053765195515273635118272569440	None	5555555555555555555555555555555555555555555555555555555555555555555555554363	None
8	1.0000000000000000100000E-8	-999999999999999999.99999000000000000000	-8	1.000010000000000E-15
9	77777777777777777777777778777777776777777.777777777000000000000000000000	None	7777777777777777777777777777777777777777777777777777777777777777777777767877	None
-- !result
SELECT
    SUM(CAST(tinyint_val AS decimal(76,20))) as sum_tinyint_as_decimal256,
    AVG(CAST(int_val AS decimal(76,20))) as avg_int_as_decimal256,
    MIN(CAST(bigint_val AS decimal(76,20))) as min_bigint_as_decimal256,
    MAX(CAST(largeint_val AS decimal(76,0))) as max_largeint_as_decimal256
FROM cast_test_source
WHERE tinyint_val IS NOT NULL;
-- result:
141.00000000000000000000	111174220.88888888888888888889	-9223372036854775808.00000000000000000000	170141183460469231731687303715884105727
-- !result
SELECT
    SUM(decimal256_50_15) as sum_decimal256_50_15,
    AVG(decimal256_76_20) as avg_decimal256_76_20,
    MIN(decimal256_76_0) as min_decimal256_76_0,
    MAX(decimal256_76_0) as max_decimal256_76_0,
    SUM(decimal_38_10) as sum_decimal_38_10,
    AVG(decimal_20_5) as avg_decimal_20_5
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL;
-- result:
58024691135802469113580246911358023.469135801246914	6447187903978052123731138545706447187903978052123731138.38545953347187928668	-9999999999999999999999999999999999999999999999999999999999999999999999999999	9999999999999999999999999999999999999999999999999999999999999999999999999999	5802469113580246911358024689.4691358014	64471879039780.38546000000
-- !result
SELECT
    id,
    CASE
        WHEN tinyint_val > 0 THEN CAST(tinyint_val AS decimal(50,15))
        WHEN tinyint_val < 0 THEN CAST(ABS(tinyint_val) AS decimal(50,15))
        ELSE 0.000000000000000
    END as case_tinyint_to_decimal256,
    CASE
        WHEN decimal256_50_15 > 0 THEN CAST(decimal256_50_15 AS varchar(100))
        WHEN decimal256_50_15 < 0 THEN CONCAT('negative: ', CAST(ABS(decimal256_50_15) AS varchar(100)))
        ELSE 'zero'
    END as case_decimal256_to_varchar,
    CASE
        WHEN decimal_38_10 > decimal256_50_15 THEN 'decimal38_larger'
        WHEN decimal_38_10 < decimal256_50_15 THEN 'decimal256_larger'
        ELSE 'equal'
    END as case_decimal_comparison
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND decimal_38_10 IS NOT NULL
ORDER BY id;
-- result:
1	127.000000000000000	12345678901234567890123456789012345.123456789012345	decimal256_larger
2	0E-15	zero	equal
3	128.000000000000000	negative: 87654321098765432109876543210987654.987654321098765	decimal38_larger
4	127.000000000000000	99999999999999999999999999999999999.999999999999999	decimal256_larger
5	128.000000000000000	negative: 99999999999999999999999999999999999.999999999999999	decimal38_larger
6	1.000000000000000	0.000000000000001	decimal38_larger
7	42.000000000000000	55555555555555555555555555555555555.555555555555555	decimal256_larger
8	1.000000000000000	0.000000000000001	decimal38_larger
9	99.000000000000000	77777777777777777777777777777777777.777777777777777	decimal256_larger
-- !result
SELECT
    id,
    decimal256_50_15 > CAST(int_val AS decimal(50,15)) as decimal256_gt_int,
    decimal256_76_20 = CAST(float_val AS decimal(76,20)) as decimal256_eq_float,
    decimal256_76_0 < CAST(largeint_val AS decimal(76,0)) as decimal256_lt_largeint,
    CAST(bigint_val AS decimal(76,20)) BETWEEN decimal256_76_20 - 1000 AND decimal256_76_20 + 1000 as bigint_between_decimal256,
    decimal256_50_15 > decimal_38_10 as decimal256_gt_decimal38,
    decimal_20_5 = CAST(decimal256_50_15 AS decimal(20,5)) as decimal20_eq_decimal256_cast
FROM cast_test_source
WHERE decimal256_50_15 IS NOT NULL AND decimal256_76_20 IS NOT NULL AND decimal256_76_0 IS NOT NULL
    AND int_val IS NOT NULL AND float_val IS NOT NULL AND largeint_val IS NOT NULL AND bigint_val IS NOT NULL
    AND decimal_38_10 IS NOT NULL AND decimal_20_5 IS NOT NULL
ORDER BY id;
-- result:
1	1	0	0	0	1	None
2	0	1	0	1	0	1
3	0	0	1	0	0	None
4	1	None	0	0	1	None
5	0	None	1	0	0	None
6	0	0	0	1	0	0
7	1	0	0	0	1	None
8	0	0	1	1	0	0
9	1	0	0	0	1	None
-- !result
SELECT id, CAST(tinyint_val AS decimal(76,20)) as unified_decimal256, 'tinyint' as source_type FROM cast_test_source WHERE tinyint_val IS NOT NULL
UNION ALL
SELECT id, CAST(int_val AS decimal(76,20)) as unified_decimal256, 'int' as source_type FROM cast_test_source WHERE int_val IS NOT NULL
UNION ALL
SELECT id, decimal256_76_20 as unified_decimal256, 'decimal256_76_20' as source_type FROM cast_test_source WHERE decimal256_76_20 IS NOT NULL
UNION ALL
SELECT id, CAST(decimal_38_10 AS decimal(76,20)) as unified_decimal256, 'decimal_38_10' as source_type FROM cast_test_source WHERE decimal_38_10 IS NOT NULL
ORDER BY id, unified_decimal256;
-- result:
1	127.00000000000000000000	tinyint
1	2147483647.00000000000000000000	int
1	1234567890123456789012345678.12345678900000000000	decimal_38_10
1	12345678901234567890123456789012345678901234567890123456.12345678901234567890	decimal256_76_20
2	0E-20	int
2	0E-20	decimal_38_10
2	0E-20	tinyint
2	0E-20	decimal256_76_20
3	-87654321098765432109876543210987654321098765432109876543.98765432109876543210	decimal256_76_20
3	-8765432109876543210987654321.98765432100000000000	decimal_38_10
3	-2147483648.00000000000000000000	int
3	-128.00000000000000000000	tinyint
4	127.00000000000000000000	tinyint
4	2147483647.00000000000000000000	int
4	9999999999999999999999999999.99999999990000000000	decimal_38_10
4	99999999999999999999999999999999999999999999999999999999.99999999999999999999	decimal256_76_20
5	-99999999999999999999999999999999999999999999999999999999.99999999999999999999	decimal256_76_20
5	-9999999999999999999999999999.99999999990000000000	decimal_38_10
5	-2147483648.00000000000000000000	int
5	-128.00000000000000000000	tinyint
6	1E-20	decimal256_76_20
6	1.0000000000E-10	decimal_38_10
6	1.00000000000000000000	int
6	1.00000000000000000000	tinyint
7	42.00000000000000000000	tinyint
7	567890.00000000000000000000	int
7	5555555555555555555555555555.55555555550000000000	decimal_38_10
7	55555555555555555555555555555555555555555555555555555555.55555555555555555555	decimal256_76_20
8	1E-20	decimal256_76_20
8	1.0000000000E-10	decimal_38_10
8	1.00000000000000000000	tinyint
8	100.00000000000000000000	int
9	99.00000000000000000000	tinyint
9	999999999.00000000000000000000	int
9	7777777777777777777777777777.77777777770000000000	decimal_38_10
9	77777777777777777777777777777777777777777777777777777777.77777777777777777777	decimal256_76_20
-- !result
CREATE TABLE cast_test_target (
    id int,
    target_decimal256 decimal(76,20),
    target_decimal38 decimal(38,10),
    target_int bigint
) ENGINE=OLAP
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 1
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO cast_test_target VALUES
(1, 12345678901234567890123456789012345678901234567890123456.12345678901234567890, 1234567890123456789012345678.1234567890, 9223372036854775807),
(2, 0.00000000000000000000, 0.0000000000, 0),
(3, -87654321098765432109876543210987654321098765432109876543.98765432109876543210, -8765432109876543210987654321.9876543210, -9223372036854775808),
(4, 99999999999999999999999999999999999999999999999999999999.99999999999999999999, 9999999999999999999999999999.9999999999, 9223372036854775807),
(5, -99999999999999999999999999999999999999999999999999999999.99999999999999999999, -9999999999999999999999999999.9999999999, -9223372036854775808);
-- result:
-- !result
SELECT
    id,
    CAST('9999999999999999999999999999999999999999999999999999999999999999999999999999' AS decimal(76,0)) as max_decimal256_76_0,
    CAST('99999999999999999999999999999999999999999999999999999999.99999999999999999999' AS decimal(76,20)) as max_decimal256_76_20,
    CAST('99999999999999999999999999999999999.999999999999999' AS decimal(50,15)) as max_decimal256_50_15
FROM cast_test_source
WHERE id = 1;
-- result:
1	9999999999999999999999999999999999999999999999999999999999999999999999999999	99999999999999999999999999999999999999999999999999999999.99999999999999999999	99999999999999999999999999999999999.999999999999999
-- !result
SELECT
    id,
    CAST('0.00000000000000000001' AS decimal(76,20)) as min_decimal256_76_20,
    CAST('0.000000000000001' AS decimal(50,15)) as min_decimal256_50_15,
    CAST('0.0000000001' AS decimal(38,10)) as min_decimal_38_10
FROM cast_test_source
WHERE id = 1;
-- result:
1	1E-20	1E-15	1E-10
-- !result
SELECT
    id,
    decimal256_76_20,
    CAST(decimal256_76_20 AS decimal(50,10)) as decimal256_with_precision_loss,
    CAST(decimal256_50_15 AS decimal(38,5)) as decimal256_with_scale_loss,
    CAST(decimal_38_10 AS decimal(20,5)) as decimal38_with_precision_loss
FROM cast_test_source
WHERE decimal256_76_20 IS NOT NULL AND decimal256_50_15 IS NOT NULL AND decimal_38_10 IS NOT NULL
ORDER BY id;
-- result:
1	12345678901234567890123456789012345678901234567890123456.12345678901234567890	12345678901234567890123456789012345678901234567890123456.1234567890	None	1234567890123456789012345678.12346
2	0E-20	0E-10	0.00000	0.00000
3	-87654321098765432109876543210987654321098765432109876543.98765432109876543210	-87654321098765432109876543210987654321098765432109876543.9876543211	None	-8765432109876543210987654321.98765
4	99999999999999999999999999999999999999999999999999999999.99999999999999999999	100000000000000000000000000000000000000000000000000000000.0000000000	None	10000000000000000000000000000.00000
5	-99999999999999999999999999999999999999999999999999999999.99999999999999999999	-100000000000000000000000000000000000000000000000000000000.0000000000	None	-10000000000000000000000000000.00000
6	1E-20	0E-10	0.00000	0.00000
7	55555555555555555555555555555555555555555555555555555555.55555555555555555555	55555555555555555555555555555555555555555555555555555555.5555555556	None	5555555555555555555555555555.55556
8	1E-20	0E-10	0.00000	0.00000
9	77777777777777777777777777777777777777777777777777777777.77777777777777777777	77777777777777777777777777777777777777777777777777777777.7777777778	None	7777777777777777777777777777.77778
-- !result
SELECT
    id,
    CAST(NULL AS decimal(76,20)) as null_to_decimal256,
    CAST(decimal256_50_15 AS varchar(100)) as decimal256_to_varchar_with_null,
    COALESCE(CAST(tinyint_val AS decimal(50,15)), 0.000000000000000) as coalesce_cast_tinyint,
    COALESCE(CAST(decimal_38_10 AS decimal(76,20)), 0.00000000000000000000) as coalesce_cast_decimal38
FROM cast_test_source
ORDER BY id;
-- result:
1	None	12345678901234567890123456789012345.123456789012345	127.0	1.2345678901234569e+27
2	None	0.000000000000000	0.0	0.0
3	None	-87654321098765432109876543210987654.987654321098765	-128.0	-8.765432109876543e+27
4	None	99999999999999999999999999999999999.999999999999999	127.0	1e+28
5	None	-99999999999999999999999999999999999.999999999999999	-128.0	-1e+28
6	None	0.000000000000001	1.0	1e-10
7	None	55555555555555555555555555555555555.555555555555555	42.0	5.555555555555556e+27
8	None	0.000000000000001	1.0	1e-10
9	None	77777777777777777777777777777777777.777777777777777	99.0	7.777777777777777e+27
10	None	None	0.0	0.0
-- !result