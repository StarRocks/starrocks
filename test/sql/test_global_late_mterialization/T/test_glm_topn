-- name: test_glm_topn_iceberg_v3
create external catalog iceberg_sql_test_${uuid0} PROPERTIES ("type"="iceberg", "iceberg.catalog.type"="hive", "iceberg.catalog.hive.metastore.uris"="${iceberg_catalog_hive_metastore_uris}","enable_iceberg_metadata_cache"="true","aws.s3.access_key" = "${oss_ak}","aws.s3.secret_key" = "${oss_sk}","aws.s3.endpoint" = "${oss_endpoint}");
set enable_global_late_materialization = true;

use iceberg_sql_test_${uuid0}.iceberg_oss_db;

set enable_global_late_materialization = true;

select * from test_v3_t0 order by id limit 10;
select * from test_v3_t0 order by id limit 100, 10;
select * from test_v3_t0 order by id desc limit 10;
select * from test_v3_t0 order by id desc limit 100,10;
select c1 from test_v3_t0 order by id limit 10;
select c1 from test_v3_t0 order by id limit 10, 10;
select c1 from test_v3_t0 order by id desc limit 10;
select c1 from test_v3_t0 order by id desc limit 10,10;

drop catalog iceberg_sql_test_${uuid0};

set catalog default_catalog;