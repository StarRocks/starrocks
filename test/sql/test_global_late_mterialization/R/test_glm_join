-- name: test_glm_join
create table t0 (
	v1 bigint null,
	v2 bigint null,
	v3 bigint null
) engine=olap
duplicate key(v1)
distributed by hash(v1) buckets 3
properties(
'replication_num'='1'
);
-- result:
-- !result
create table t1 (
	v1 bigint null,
	v2 bigint null,
	v3 bigint null
) engine=olap
duplicate key(v1)
distributed by hash(v1) buckets 3
properties(
'replication_num'='1'
);
-- result:
-- !result
create table t2 (
	v1 bigint null,
	v2 bigint null,
	v3 bigint null
) engine=olap
duplicate key(v1)
distributed by hash(v1) buckets 3
properties(
'replication_num'='1'
);
-- result:
-- !result
insert into t0 select generate_series,generate_series,generate_series%10 from table(generate_series(1, 10000));
-- result:
-- !result
insert into t0 values (10001, null, null), (10002, null, null), (10003, null, null);
-- result:
-- !result
insert into t1 select generate_series,generate_series,generate_series%10 from table(generate_series(1, 1000));
-- result:
-- !result
insert into t1 values (10001, null, null), (10002, null, null), (10003, null, null);
-- result:
-- !result
insert into t2 select generate_series,generate_series,generate_series%10 from table(generate_series(1, 1000));
-- result:
-- !result
set enable_global_late_materialization = true;
-- result:
-- !result
select * from t0 inner join t1 on t0.v1 = t1.v1 order by t0.v1 limit 5;
-- result:
1	1	1	1	1	1
2	2	2	2	2	2
3	3	3	3	3	3
4	4	4	4	4	4
5	5	5	5	5	5
-- !result
select * from t0 inner join t1 on t0.v1 = t1.v1 order by t0.v1 desc limit 5;
-- result:
10003	None	None	10003	None	None
10002	None	None	10002	None	None
10001	None	None	10001	None	None
1000	1000	0	1000	1000	0
999	999	9	999	999	9
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 inner join t1 on t0.v1 = t1.v1;
-- result:
1003	1000	1000	1003	1000	1000
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 left outer join t1 on t0.v1 = t1.v1;
-- result:
10003	10000	10000	1003	1000	1000
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 right outer join t1 on t0.v1 = t1.v1;
-- result:
1003	1000	1000	1003	1000	1000
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 full outer join t1 on t0.v1 = t1.v1;
-- result:
10003	10000	10000	1003	1000	1000
-- !result
select * from t0 inner join t1 on t0.v3 = t1.v3 order by 1,2,3,4,5,6 limit 5;
-- result:
1	1	1	1	1	1
1	1	1	11	11	1
1	1	1	21	21	1
1	1	1	31	31	1
1	1	1	41	41	1
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 inner join t1 on t0.v3 = t1.v3;
-- result:
1000000	1000000	1000000	1000000	1000000	1000000
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 left outer join t1 on t0.v3 = t1.v3;
-- result:
1000003	1000000	1000000	1000000	1000000	1000000
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 right outer join t1 on t0.v3 = t1.v3;
-- result:
1000000	1000000	1000000	1000003	1000000	1000000
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 full outer join t1 on t0.v3 = t1.v3;
-- result:
1000003	1000000	1000000	1000003	1000000	1000000
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 full outer join t1 on t0.v1 > t1.v1;
-- result:
9502504	9499501	9499501	9502504	9502500	9502500
-- !result
select count(t0.v1),count(t0.v2),count(t0.v3),count(t1.v1),count(t1.v2),count(t1.v3) from t0 full outer join t1 on t0.v3 > t1.v3;
-- result:
4501003	4501000	4501000	4500103	4500100	4500100
-- !result
select * from t0 join t1 join t2 on t0.v1 = t1.v1 and t0.v2 = t2.v2 order by 1,2,3,4,5,6,7,8,9 limit 10;
-- result:
1	1	1	1	1	1	1	1	1
2	2	2	2	2	2	2	2	2
3	3	3	3	3	3	3	3	3
4	4	4	4	4	4	4	4	4
5	5	5	5	5	5	5	5	5
6	6	6	6	6	6	6	6	6
7	7	7	7	7	7	7	7	7
8	8	8	8	8	8	8	8	8
9	9	9	9	9	9	9	9	9
10	10	0	10	10	0	10	10	0
-- !result
select * from t0 join t1 join t2 on t0.v1 = t1.v1 and t0.v1 = t2.v1 order by 1,2,3,4,5,6,7,8,9 limit 10; 
-- result:
1	1	1	1	1	1	1	1	1
2	2	2	2	2	2	2	2	2
3	3	3	3	3	3	3	3	3
4	4	4	4	4	4	4	4	4
5	5	5	5	5	5	5	5	5
6	6	6	6	6	6	6	6	6
7	7	7	7	7	7	7	7	7
8	8	8	8	8	8	8	8	8
9	9	9	9	9	9	9	9	9
10	10	0	10	10	0	10	10	0
-- !result