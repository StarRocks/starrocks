-- name: test_glm_join_iceberg_c1
create external catalog iceberg_sql_test_${uuid0} PROPERTIES ("type"="iceberg", "iceberg.catalog.type"="hive", "iceberg.catalog.hive.metastore.uris"="${iceberg_catalog_hive_metastore_uris}","enable_iceberg_metadata_cache"="true","aws.s3.access_key" = "${oss_ak}","aws.s3.secret_key" = "${oss_sk}","aws.s3.endpoint" = "${oss_endpoint}");
-- result:
-- !result
set enable_global_late_materialization = true;
-- result:
-- !result
use iceberg_sql_test_${uuid0}.iceberg_oss_db;
-- result:
-- !result
select * from test_v3_t0 inner join test_v3_t1 on test_v3_t0.id = test_v3_t1.id order by test_v3_t0.id limit 5;
-- result:
1	1	1	1	1	1	1	1
2	2	2	2	2	2	2	2
3	3	3	3	3	3	3	3
4	4	4	4	4	4	4	4
5	5	5	5	5	5	5	5
-- !result
select * from test_v3_t0 inner join test_v3_t1 on test_v3_t0.id = test_v3_t1.id order by test_v3_t0.id desc limit 5;
-- result:
10003	None	None	10003	10003	None	None	10003
10002	None	None	10002	10002	None	None	10002
10001	None	None	10001	10001	None	None	10001
1000	1000	0	1000	1000	1000	0	1000
999	999	9	999	999	999	9	999
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 inner join test_v3_t1 on test_v3_t0.id = test_v3_t1.id;
-- result:
1003	1000	1000	1003	1000	1000
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 left outer join test_v3_t1 on test_v3_t0.id = test_v3_t1.id;
-- result:
10003	10000	10000	1003	1000	1000
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 right outer join test_v3_t1 on test_v3_t0.id = test_v3_t1.id;
-- result:
1003	1000	1000	1003	1000	1000
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 full outer join test_v3_t1 on test_v3_t0.id = test_v3_t1.id;
-- result:
10003	10000	10000	1003	1000	1000
-- !result
select * from test_v3_t0 inner join test_v3_t1 on test_v3_t0.c1 = test_v3_t1.c1 order by 1,2,3,4,5,6 limit 5;
-- result:
1	1	1	1	1	1	1	1
1	1	1	1	11	11	1	11
1	1	1	1	21	21	1	21
1	1	1	1	31	31	1	31
1	1	1	1	41	41	1	41
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 inner join test_v3_t1 on test_v3_t0.c1 = test_v3_t1.c1;
-- result:
1000000	1000000	1000000	1000000	1000000	1000000
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 left outer join test_v3_t1 on test_v3_t0.c1 = test_v3_t1.c1;
-- result:
1000003	1000000	1000000	1000000	1000000	1000000
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 right outer join test_v3_t1 on test_v3_t0.c1 = test_v3_t1.c1;
-- result:
1000000	1000000	1000000	1000003	1000000	1000000
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 full outer join test_v3_t1 on test_v3_t0.c1 = test_v3_t1.c1;
-- result:
1000003	1000000	1000000	1000003	1000000	1000000
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 full outer join test_v3_t1 on test_v3_t0.id > test_v3_t1.id;
-- result:
9502504	9499501	9499501	9502504	9502500	9502500
-- !result
select count(test_v3_t0.id),count(test_v3_t0.c0),count(test_v3_t0.c1),count(test_v3_t1.id),count(test_v3_t1.c0),count(test_v3_t1.c1) from test_v3_t0 full outer join test_v3_t1 on test_v3_t0.c1 > test_v3_t1.c1;
-- result:
4501003	4501000	4501000	4500103	4500100	4500100
-- !result
select * from test_v3_t0 join test_v3_t1 join test_v3_t2 on test_v3_t0.id = test_v3_t1.id and test_v3_t0.c0 = test_v3_t2.c0 order by 1,2,3,4,5,6,7,8,9 limit 10;
-- result:
1	1	1	1	1	1	1	1	1	1	1	1
2	2	2	2	2	2	2	2	2	2	2	2
3	3	3	3	3	3	3	3	3	3	3	3
4	4	4	4	4	4	4	4	4	4	4	4
5	5	5	5	5	5	5	5	5	5	5	5
6	6	6	6	6	6	6	6	6	6	6	6
7	7	7	7	7	7	7	7	7	7	7	7
8	8	8	8	8	8	8	8	8	8	8	8
9	9	9	9	9	9	9	9	9	9	9	9
10	10	0	10	10	10	0	10	10	10	0	10
-- !result
select * from test_v3_t0 join test_v3_t1 join test_v3_t2 on test_v3_t0.id = test_v3_t1.id and test_v3_t0.id = test_v3_t2.id order by 1,2,3,4,5,6,7,8,9 limit 10; 

drop catalog iceberg_sql_test_${uuid0};
-- result:
1	1	1	1	1	1	1	1	1	1	1	1
2	2	2	2	2	2	2	2	2	2	2	2
3	3	3	3	3	3	3	3	3	3	3	3
4	4	4	4	4	4	4	4	4	4	4	4
5	5	5	5	5	5	5	5	5	5	5	5
6	6	6	6	6	6	6	6	6	6	6	6
7	7	7	7	7	7	7	7	7	7	7	7
8	8	8	8	8	8	8	8	8	8	8	8
9	9	9	9	9	9	9	9	9	9	9	9
10	10	0	10	10	10	0	10	10	10	0	10
-- !result
set catalog default_catalog;
-- result:
-- !result