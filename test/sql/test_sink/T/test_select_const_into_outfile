-- name: test_select_const_into_outfile

select 1 as a, 2 as b
into outfile "oss://${oss_bucket}/test_sink/test_select_const_into_outfile/${uuid0}/"
format as parquet properties (
    "fs.oss.endpoint" = "${oss_endpoint}",
    "fs.oss.accessKeyId" = "${oss_ak}",
    "fs.oss.accessKeySecret" = "${oss_sk}"
);

select * from files (
	"path" = "oss://${oss_bucket}/test_sink/test_select_const_into_outfile/${uuid0}/*",
    "fs.oss.endpoint" = "${oss_endpoint}",
    "fs.oss.accessKeyId" = "${oss_ak}",
    "fs.oss.accessKeySecret" = "${oss_sk}",
	"format" = "parquet"
);

shell: ossutil64 rm -rf oss://${oss_bucket}/test_sink/test_select_const_into_outfile/${uuid0} >/dev/null || echo "exit 0" >/dev/null