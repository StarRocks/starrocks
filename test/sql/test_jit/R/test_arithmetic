-- name: test_arithmetic
DROP TABLE IF EXISTS `jit_basic`;
-- result:
-- !result
CREATE TABLE IF NOT EXISTS `jit_basic` (
	k1 BIGINT, 
	k2 BIGINT, 
	v1 BIGINT REPLACE, 
	v2 BIGINT REPLACE, 
	v3 BIGINT REPLACE,
	v4 BIGINT REPLACE, 
	v5 BIGINT REPLACE, 
	v6 BIGINT REPLACE,
	v7 BIGINT REPLACE,
	v8 BIGINT REPLACE,
	v9 BIGINT REPLACE
) 
ENGINE = olap 
AGGREGATE KEY(k1, k2) 
DISTRIBUTED BY HASH(k1) BUCKETS 10 
PROPERTIES( 
	"replication_num" = "1" 
);
-- result:
-- !result
INSERT INTO jit_basic (k1, k2, v1, v2, v3, v4, v5, v6, v7, v8, v9) VALUES
(0, 9223372036854775807, -9223372036854775808, -5123, 5123, -2147483648, 2147483647, 0, 0, -32768, 32767),
(100, -9223372036854775808, 9223372036854775807, -100, 200, -200, 0, 10000, -10000, 5000, -5000),
(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
(-1000, 1000, 500, -500, 250, -250, 125, -125, 100000, -100000, 50000),
(100, -200, 300, -400, 500, -600, 700, -800, 900, -1000, 1100),
(-56789, 56789, 12345, -12345, 67890, -67890, 0, 11111, -11111, 9999, -9999),
(1, -1, 2, -2, 3, -3, 4, -4, 5, -5, 6),
(32767, -32768, 2147483647, -2147483648, 9223372036854775807, -9223372036854775808, 100, -100, 200, -200, 0),
(9999999, -9999999, 8888888, -8888888, 7777777, -7777777, 6666666, -6666666, 5555555, -5555555, 4444444),
(0, 1, 131, -142, 1234, 134, -12, 17345, 63456, 341, 14),
(2147483647, -2147483648, 32767, -32768, 100, -100, 200, -200, 0, 1, -1),
(-1, 1, -2, 2, -3, 3, -4, 4, -5, 5, -6),
(9223372036854775807, -9223372036854775808, 2147483647, -2147483648, 32767, -32768, 100, -100, 200, -200, 0),
(1000, -1000, 500, -500, 250, -250, 125, -125, 100000, -100000, 50000),
(200, -400, 600, -800, 1000, -1200, 1400, -1600, 1800, -2000, 2200),
(-123456, 123456, 78901, -78901, 234567, -234567, 0, 54321, -54321, 67890, -67890),
(7, -14, 21, -28, 35, -42, 49, -56, 63, -70, 77),
(9876543, -9876543, 13579246, -13579246, 2468642, -2468642, 86420964, -86420964, 11111, -11111, 99999),
(1234, -645, 9223372036854775807, -9223372036854775808, 1, 2, 3, 0, -1, -2, -3),
(754, -14, 9223372036854775807, -9223372036854775808, 0, 0, 0, 0, 0, 0, 0);
-- result:
-- !result
set jit_level = -1;
-- result:
-- !result
SELECT k1 + k2 + v1 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775220
-9223372036854775069
-2
-1
0
2
14
99
132
200
400
500
500
12345
32766
78901
8888888
13579246
2147483646
2147483646
-- !result
SELECT k1 + v2 + 12 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775042
-9223372036854774562
-2147450869
-3702691
-202345
-69122
-5111
-1488
-588
-288
-130
-9
11
12
12
13
512
1111123
2147450891
9223372034707292171
-- !result
SELECT k1 + 11 + k2 + v1 + v2 + 12 + 13 as result FROM jit_basic ORDER BY result;
-- result:
-5088
-364
-164
22
26
34
34
34
35
36
36
36
36
36
36
36
36
36
624
775
-- !result
SELECT k1 + k2 + v1 + v2 + v3 + v4 + v5 + v6 + v7 + v8 + v9 as result FROM jit_basic ORDER BY result;
-- result:
-6
-3
-3
-3
-2
-1
0
0
0
6
42
588
600
739
1200
50000
50000
82502
99999
4444444
-- !result
SELECT k1 + k2 + v1 + v2 + v3 + v4 + v5 + v6 + v7 + v8 + v9 + 18 as result FROM jit_basic ORDER BY result;
-- result:
12
15
15
15
16
17
18
18
18
24
60
606
618
757
1218
50018
50018
82520
100017
4444462
-- !result
SELECT v1 + v3 + v5 + v7 + v9 as result FROM jit_basic ORDER BY result;
-- result:
-9223372034707291862
-9223372034707254271
-20
0
20
245
3500
7000
33066
59125
64823
150875
150875
191257
33333330
102579962
2147516714
9223372036854761007
9223372036854775807
9223372036854775807
-- !result
SELECT v1 + v2 + v3 + v4 + v5 + v6 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854765909
-600
-300
-21
-2
-2
-1
-1
0
0
0
0
0
0
0
5
11111
18690
54321
9223372036854775807
-- !result
SELECT k1 + k2 + v7 + v9 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854743042
-122211
-21110
-11
-2
0
11
133
199
199
585
740
1900
3800
63471
111110
150000
150000
9999999
9223372036854760908
-- !result
SELECT v2 + v6 + v7 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-2147483548
-2147483548
-99989099
-9999999
-78901
-32968
-12345
-5123
-600
-300
-100
-21
-1
0
1
80659
99375
99375
9223372036854775807
-- !result
SELECT k1 - k2 + v1 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775041
-9223372036854773930
-168011
-101233
-1500
-4
0
1
4
42
99
130
600
1200
2500
28888886
33332332
2147483646
2147549182
4295000062
-- !result
SELECT k1 + v2 - 12 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775066
-9223372036854774586
-2147450893
-3702715
-202369
-69146
-5135
-1512
-612
-312
-154
-33
-13
-12
-12
-11
488
1111099
2147450867
9223372034707292147
-- !result
SELECT k1 + v3 + v4 - 12 as result FROM jit_basic ORDER BY result;
-- result:
-2147478537
-123468
-56801
-1012
-13
-12
-12
-12
-12
-11
88
742
988
1225
1356
32754
9876531
9999987
2147483635
9223372036854775794
-- !result
SELECT k1 + k2 - v1 + v2 - v3 + v4 + v5 - v6 + v7 + v8 - v9 as result FROM jit_basic ORDER BY result;
-- result:
-4295032631
-4294967095
-24444442
-599798
-162694
-75783
-65334
-51250
-51250
-10399
-3200
-1600
-112
-8
0
8
594
741
45054
140646153
-- !result
SELECT k1 + k2 - v1 + v2 - v3 - 632 + v4 + v5 - v6 + v7 + v8 - v9 as result FROM jit_basic ORDER BY result;
-- result:
-4295033263
-4294967727
-24445074
-600430
-163326
-76415
-65966
-51882
-51882
-11031
-3832
-2232
-744
-640
-632
-624
-38
109
44422
140645521
-- !result
SELECT v1 - v3 + v5 + v7 - v9 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775805
-9223372034707330051
-9223372034707291860
-142097
-56657
-2
0
2
21
300
600
32868
50375
50375
62327
8888888
97442680
2147451180
9223372036854770607
9223372036854775807
-- !result
SELECT v1 + v2 - v3 + v4 + v5 - v6 as result FROM jit_basic ORDER BY result;
-- result:
-2222222
-523455
-146891
-65336
-18468
-250
-250
-2
-1
0
2
3
21
199
200
300
600
167904644
9223372036854765307
9223372036854765561
-- !result
SELECT k1 + k2 - v7 + v9 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854770708
-9223372036854743042
-1111111
-63441
-50000
-50000
-13569
-201
-201
-2
-1
0
1
7
100
200
587
740
1112
88888
-- !result
SELECT k1 + k2 + 1235 - v7 + v9 - 742 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854770215
-9223372036854742549
-1110618
-62948
-49507
-49507
-13076
292
292
491
492
493
494
500
593
693
1080
1233
1605
89381
-- !result
SELECT k1 * k2 * v1 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-3444906684190411320
-2305772639395807232
-1202560433934336
-39812507981745
-500000000
-500000000
-48000000
-6000000
-2058
-2
0
0
0
0
2
10556
795930
3563062920787956498
4611756385024081920
-- !result
SELECT k1 * k2 * v1 * 62 as result FROM jit_basic ORDER BY result;
-- result:
-9219009307859746816
-451027795661316516
-74558746903928832
-2468375494868190
-31000000000
-31000000000
-2976000000
-372000000
-127596
-124
0
0
0
0
0
124
654472
49347660
4616048947136364544
7776714464709117552
-- !result
SELECT k1 * k2 - v1 * v2 * v3 + v4 + v5 * v6 + v7 * v8 - v9 as result FROM jit_basic ORDER BY result;
-- result:
-5968650470529538235
-4611685908909038755
-9938565875
-9938565875
-50015200
-10556
-45
-39
0
13209
44385344
58518300
474076600
10343033659949
1460246919573864
4611615651830611120
4611686019501112496
5797552289162423557
9223372034707259393
9223372036853979885
-- !result
SELECT k1 * k2 - 7334 - v1 * v2 * v3 + v4 * 732 + v5 * v6 * 821 + v7 * v8 - v9 - 132 as result FROM jit_basic ORDER BY result;
-- result:
-4611686017361870778
-4611685908941919321
-9951568591
-9951568591
-1363608066
-401127766
-126198968
-50168866
-2275039
-22818
-18438
-18022
-7466
10342984024893
1460246748097921
4611615651798450246
5761107846321305184
6353855526050205893
9223370464896705239
9223372036853973881
-- !result
SELECT v1 * v3 * v5 * v7 - v9 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775802
-42949672940000
-123094994702
-32767
0
0
1
114
126
5000
9999
67890
2268868
94499998900
1511999997800
1562499950000
1562499950000
1407331933224980000
5812928554008897521
8563912641428171636
-- !result
SELECT v1 * v2 - v3 * v4 * v5 - v6 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-8289700656795130320
-4611686016279904156
-4611685908908998556
-2536388551616719916
-6225422122
-1071708856
-152410136
-9900
-44
0
36
71498
1948325
7562625
7562625
209880800
1679521600
4611675016868659200
9223372036854775802
-- !result
SELECT v1 * v2 * 11 - v3 * v4 * v5 - v6 + 622 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775192
-9223372036854775186
-8291544616014414858
-2537178674915484734
-68479099510
-11808798794
-1676399764
-8278
538
618
622
66240
1762927
5063247
5063247
208681422
1674722222
4611675016868659822
4611686042049708754
4611686149420614354
-- !result
SELECT k1 * k2 - v7 + v9 as result FROM jit_basic ORDER BY result;
-- result:
-4611686016279904257
-99999981111112
-97546101541961
-15241397505
-3224989409
-1073709256
-1050000
-1050000
-795932
-79600
-63442
-19800
-10556
-84
-2
0
0
5000
32767
9223372036854775608
-- !result
SELECT v1 + v2 + v3 * 13 - 1124 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854774433
-9223372036854715456
-1163
-1125
-1124
-1112
-1085
-676
175
2126
2126
5276
11676
14907
424846
881446
3048247
32091222
101109977
9223372036854774670
-- !result
SELECT v1 - 1323 - v2 + v3 * 2 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854761762
-1333
-1324
-1323
-1322
-1313
-1204
177
177
377
1418
2077
64412
159147
625613
32094453
33332007
4294965970
4295031506
9223372036854774984
-- !result
SELECT v1 * v2 + v3 + 0 - v6 * 0 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-9223372036854775807
-9223372036854770685
-4611686016279871489
-184395919459874
-79012322098767
-6225133234
-1073708956
-152331135
-479000
-249750
-249750
-119500
-17368
-553
-7
-1
0
300
4611686020574871551
-- !result
SELECT (v1 + v2) * v3 - 1124 as result FROM jit_basic ORDER BY result;
-- result:
-201124
-51124
-33891
-21324
-14698
-1369
-1224
-1125
-1124
-1124
-1124
-1124
-1124
-1124
-1124
-1124
-1124
-1124
9223372036828529555
9223372036854774685
-- !result
SELECT (v1 * v2) - (v3 + 0) - (v6 * 0) as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-4611686016279937023
-184395924397158
-79012337654321
-6225602368
-1073709156
-152466915
-481000
-250250
-250250
-120500
-19836
-623
-100
-7
-1
0
4611686020574871553
9223372036854770685
9223372036854775807
-- !result
SELECT (v1 + v2) + (k1 - k2) * v3 + 7 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854755902
-57917407097
-7710810413
-499993
-32761
-1238
6
7
7
13
13
735
1885
149907
500007
599807
429496729506
48763297729219
155555524444453
9223372036854710279
-- !result
SELECT v1 * (3 - v2) + v3 * 2 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775511
-8
-3
-1
0
16
721
10246
21463
121900
252000
252000
483800
152571840
1073807557
6226073638
79012372098762
184395967603538
4611686022722355195
4611686022722420731
-- !result
SELECT (k1 * k2 + v1) * (k1 - v2) as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-9223231302587711487
-7320258802703636399
-624193973836679383
-1499250000
-79400000
-9850000
-2695
-200
0
3
9
18602
499750000
143330930054144
679076345834425
2305948560182411265
4611686014132420609
9223372035872596954
9223372036846815830
-- !result
SELECT k1 + k2 - v1 * v2 + v3 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775608
-9223372036854775218
-9223372036854775068
-4611686020574871554
0
1
7
616
5122
19837
120400
250250
250250
480800
152466915
1073709155
6225602368
79012337654321
184395924397158
4611686016279937022
-- !result
SELECT (v1 - v2) * (k1 + k2 - v3) as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-140737488322560
-138271577283952
-67044594007864
-37015141734
-1676204100
-6619035
-1680000
-420000
-336609
-250000
-250000
-2058
-740
-588
-12
-12
0
9223372036828525556
9223372036854765908
-- !result
SELECT (k1 * k2 + v1) * v2 + v3 * v4 - v5 as result FROM jit_basic ORDER BY result;
-- result:
-9223372036854775808
-4611686017353613412
-3563253410989630142
-70369817896920
-39900
-15
-11
0
637
146766
7579300
62318600
499687375
499687375
39807746530620
1202499186889046
3444767178038806381
6917458661044387740
9223361033148563457
9223372036854775807
-- !result
SELECT (k1 * k2 + v1) * v2 + v3 * v4 - v5 + null, K1 +v1+null, K1/null as result FROM jit_basic ORDER BY result;
-- result:
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
None	None	None
-- !result
select bitnot(cast(power(-2,127) as largeint)+1);
-- result:
170141183460469231731687303715884105726
-- !result
create table num_test(c_dis int,c_tinyint tinyint,c_smallint smallint,c_int int,c_bigint bigint,
            c_largeint largeint,c_float float,c_double double,c_dec32p1s0 decimal32(1,0),
            c_dec32p9s9 decimal32(9,9),c_dec32p7s3 decimal(7,3),c_dec64p18s0 decimal64(18,0),
            c_dec64p18s18 decimal64(18,18),c_dec64p10s5 decimal64(10,5),c_dec128p38s18 decimal128(38,18),
            c_dec128p38s0 decimal(38,0),c_dec128p38s16 decimal128(38,16))
            distributed by hash(c_dis)  properties("replication_num"="1");
-- result:
-- !result
insert into num_test values(1,127,32767,2147483647,9223372036854775807,170141183460469231731687303715884105727,3.4E+38,1.79E+308,9,0.999999999,9999.999,999999999999999999,0.999999999999999999,99999.99999,99999999999999999999.999999999999999999,99999999999999999999999999999999999999,9999999999999999999999.9999999999999999);
-- result:
-- !result
insert into num_test values(2,-128,-32768,-2147483648,-9223372036854775808,-170141183460469231731687303715884105728,-3.4E+38,-1.79E+308,-9,-0.999999999,-9999.999,-999999999999999999,-0.999999999999999999,-99999.99999,-99999999999999999999.999999999999999999,-99999999999999999999999999999999999999,-9999999999999999999999.9999999999999999);
-- result:
-- !result
select a.c_dis,b.c_largeint + a.c_bigint + b.c_int + a.c_smallint + b.c_tinyint from num_test a left join num_test b
                on b.c_largeint + b.c_bigint + b.c_int + b.c_smallint + b.c_tinyint = a.c_largeint + a.c_bigint + a.c_int + a.c_smallint + a.c_tinyint
                order by 1;
-- result:
1	-170141183460469231722463931676881813381
2	170141183460469231722463931676881813376
-- !result
SELECT (((1 / 1) % 1) * 1);
-- result:
0.0
-- !result
select 1+2 * null;
-- result:
None
-- !result
select 2/null;
-- result:
None
-- !result
SELECT min(((1 / 1) % 1) * 1) from jit_basic;
-- result:
0.0
-- !result
SELECT min(((1 / 1) % 1) * null) from jit_basic;
-- result:
None
-- !result
DROP TABLE IF EXISTS `jit_basic`;
-- result:
-- !result