-- name: test_union_all_with_limit

CREATE TABLE `t0` (
  `c0` int(11) NULL COMMENT "",
  `c1` varchar(20) NULL COMMENT "",
  `c2` varchar(200) NULL COMMENT "",
  `c3` int(11) NULL COMMENT ""
) ENGINE=OLAP
DUPLICATE KEY(`c0`, `c1`)
COMMENT "OLAP"
DISTRIBUTED BY HASH(`c0`, `c1`) BUCKETS 48
PROPERTIES (
"colocate_with" = "${uuid0}",
"replication_num" = "1",
"in_memory" = "false",
"storage_format" = "DEFAULT",
"enable_persistent_index" = "true",
"replicated_storage" = "true",
"compression" = "LZ4"
);

insert into t0 SELECT generate_series, generate_series, generate_series, generate_series FROM TABLE(generate_series(1,  40960));

select count(*) from (select c0 from t0 union all select distinct c0 from t0 limit 1)t;

create table dup_tbl(
col_int int,
col_integer integer,
col_tinyint tinyint,
col_float float,
col_double double,
col_decimal decimal,
col_date date,
col_timestamp datetime,
col_varchar varchar(100),
col_char char(100),
col_boolean boolean)
DUPLICATE KEY(`col_int`)
DISTRIBUTED BY HASH(`col_int`) BUCKETS 1
PROPERTIES ("replication_num" = "1");

insert into dup_tbl select 1,0,1,1.001,10.1,1110.1,'2001-01-01','2021-10-30 12:10:23','hello world','hi hello',true;
insert into dup_tbl select 1,1,1,1.001,10.1,1110.1,'2001-01-02','2021-10-30 12:10:23','hello world','hi hello',true;
set @test_union = (select col_date from dup_tbl where col_date <= '2001-02-01' limit 1);
select col_date from dup_tbl where col_varchar like '%hello' union select @test_union;