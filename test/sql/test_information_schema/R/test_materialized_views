-- name: test_materialized_views
create database db_${uuid0};
-- result:
-- !result
use db_${uuid0};
-- result:
-- !result
CREATE TABLE ss( event_day DATE, pv BIGINT) DUPLICATE KEY(event_day) DISTRIBUTED BY HASH(event_day) BUCKETS 8 PROPERTIES("replication_num" = "1");
-- result:
-- !result
insert into ss values('2020-01-14', 1), ('2020-01-14', 3), ('2020-01-15', 2);
-- result:
-- !result
CREATE MATERIALIZED VIEW mv1 DISTRIBUTED BY hash(event_day) 
REFRESH DEFERRED MANUAL
AS SELECT event_day, sum(pv) as sum_pv FROM ss GROUP BY event_day;
-- result:
-- !result
[UC]REFRESH MATERIALIZED VIEW mv1 with sync mode ;
set enable_evaluate_schema_scan_rule=true;
-- result:
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
E: (1064, 'StarRocks planner use long time 18280 ms in logical phase, This probably because 1. FE Full GC, current query allocated=131.0 MiB, optimizerContextInUse=4.9 MiB2. Hive external table fetch metadata took a long time, 3. The SQL is very complex. You could 1. adjust FE JVM config, 2. try query again, 3. enlarge new_planner_optimize_timeout session variable')
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
E: (1064, 'StarRocks planner use long time 16832 ms in logical phase, This probably because 1. FE Full GC, current query allocated=130.6 MiB, optimizerContextInUse=4.9 MiB2. Hive external table fetch metadata took a long time, 3. The SQL is very complex. You could 1. adjust FE JVM config, 2. try query again, 3. enlarge new_planner_optimize_timeout session variable')
-- !result
set enable_evaluate_schema_scan_rule=false;
-- result:
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
OK
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
OK
-- !result
create database if not exists test_information_schema_materialized_views;
-- result:
-- !result
use test_information_schema_materialized_views;
-- result:
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
OK
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
OK
-- !result
set enable_evaluate_schema_scan_rule=false;
-- result:
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
OK
-- !result
[UC] select if count(*) from information_schema.materialized_views;
-- result:
E: (1064, "Getting syntax error at line 1, column 11. Detail message: Unexpected input 'count', the most similar input is {'('}.")
-- !result
select if (count(*) > 0, "OK", "FAILED") from information_schema.materialized_views;
-- result:
OK
-- !result
drop database if exists test_information_schema_materialized_views;
-- result:
-- !result
drop database db_${uuid0};
-- result:
-- !result