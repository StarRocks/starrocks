-- name: test_pipe_basic
show pipes;
-- result:
E: (1064, 'Getting analyzing error. Detail message: No database selected.')
-- !result
create database db_${uuid0};
-- result:
-- !result
create database db_${uuid1};
-- result:
-- !result
use db_${uuid0};
-- result:
-- !result
show pipes;
-- result:
-- !result
show pipes from db_${uuid1};
-- result:
-- !result
shell: ossutil64 rm -rf oss://${oss_bucket}/test_pipe/col_not_null.parquet >/dev/null || echo "exit 0" >/dev/null
-- result:
0

-- !result
shell: ossutil64 mkdir oss://${oss_bucket}/test_pipe/col_not_null.parquet >/dev/null || echo "exit 0" >/dev/null
-- result:
0

-- !result
shell: ossutil64 cp --force test/sql/test_pipe/data/col_not_null.parquet oss://${oss_bucket}/test_pipe/ | grep -Pv "(average|elapsed)"
-- result:
0
Error: stat test/sql/test_pipe/data/col_not_null.parquet: no such file or directory
-- !result
create database db_${uuid0};
-- result:
E: (1064, "Unexpected exception: Can't create database 'db_35cc2a3a329411eeabf5c9d28a9636a8'; database exists")
-- !result
use db_${uuid0};
-- result:
-- !result
show pipes;
-- result:
-- !result
show pipes from db_${uuid0};
-- result:
-- !result
create table t1 (col_int int, col_map map<string, int>, col_struct struct<a string, b int>) 
properties('replication_num' = '1')
as select * from files('path' = 'oss://${oss_bucket}/test_pipe/col_not_null.parquet', 'format'='parquet');
-- result:
E: (1064, "Getting syntax error at line 3, column 0. Detail message: Unexpected input 'as', the most similar input is {<EOF>, ';'}.")
-- !result
create pipe p1 properties('auto_ingest'='false') as 
    insert into t1 
    select * from files('path' = 'oss://${oss_bucket}/test_pipe/col_not_null.parquet', 'format'='parquet');
-- result:
E: (1064, 'Could not initialize class org.apache.hadoop.fs.aliyun.oss.AliyunOSSFileSystem')
-- !result
[UC]show pipes;
-- result:
-- !result
[UC]desc pipe p1;
-- result:
E: (1064, "Getting analyzing error. Detail message: Unknown pipe 'db_35cc2a3a329411eeabf5c9d28a9636a8.p1'.")
-- !result
select * from t1;
-- result:
E: (1064, "Getting analyzing error. Detail message: Unknown table 'db_35cc2a3a329411eeabf5c9d28a9636a8.t1'.")
-- !result
select * from information_schema.pipes where pipe_name = 'p1';
-- result:
-- !result
select * from information_schema.pipe_files where pipe_name = 'p1';
-- result:
-- !result