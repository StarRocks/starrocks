-- name: testGroupConcat
CREATE TABLE IF NOT EXISTS `lineorder` (
    `lo_orderkey` int(11) NOT NULL COMMENT "",
    `lo_shipmode` varchar(11) NOT NULL COMMENT ""
) ENGINE=OLAP
DUPLICATE KEY(`lo_orderkey`)
COMMENT "OLAP"
DISTRIBUTED BY HASH(`lo_orderkey`) BUCKETS 48
PROPERTIES (
    "replication_num" = "1"
);
-- result:
-- !result
SELECT GROUP_CONCAT(lo_shipmode) orgs FROM lineorder WHERE 1 = 2;
-- result:
None
-- !result
CREATE TABLE `ss` (
  `id` int(11) NULL COMMENT "",
  `name` varchar(255) NULL COMMENT "",
  `subject` varchar(255) NULL COMMENT "",
  `score` int(11) NULL COMMENT ""
) ENGINE=OLAP
DUPLICATE KEY(`id`)
DISTRIBUTED BY HASH(`id`) BUCKETS 4
PROPERTIES (
"replication_num" = "1",
"in_memory" = "false",
"enable_persistent_index" = "false",
"replicated_storage" = "true",
"compression" = "LZ4"
);
-- result:
-- !result
insert into ss values (1,"Tom","English",90);
-- result:
-- !result
insert into ss values (1,"Tom","Math",80);
-- result:
-- !result
insert into ss values (2,"Tom","English",NULL);
-- result:
-- !result
insert into ss values (2,"Tom",NULL,NULL);
-- result:
-- !result
insert into ss values (3,"May",NULL,NULL);
-- result:
-- !result
insert into ss values (3,"Ti","English",98);
-- result:
-- !result
insert into ss values (4,NULL,NULL,NULL);
-- result:
-- !result
insert into ss values (NULL,NULL,NULL,NULL);
-- result:
-- !result
insert into ss values (NULL,"Ti","物理Phy",99);
-- result:
-- !result
insert into ss values (11,"张三此地无银三百两","英文English",98);
-- result:
-- !result
insert into ss values (11,"张三掩耳盗铃","Math数学欧拉方程",78);
-- result:
-- !result
insert into ss values (12,"李四大闹天空","英语外语美誉",NULL);
-- result:
-- !result
insert into ss values (2,"王武程咬金","语文北京上海",22);
-- result:
-- !result
insert into ss values (3,"欧阳诸葛方程","数学大不列颠",NULL);
-- result:
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct id), group_concat(name order by 1) from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	May,Ti,欧阳诸葛方程
Ti物理Phy	0	Ti
TomEnglish,TomMath	1	Tom,Tom
TomEnglish,王武程咬金语文北京上海	1	Tom,Tom,王武程咬金
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	张三掩耳盗铃,张三此地无银三百两
李四大闹天空英语外语美誉	1	李四大闹天空
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by id;
-- result:
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
TiEnglish,欧阳诸葛方程数学大不列颠
None
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1, 2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(distinct name,subject order by 1,2), group_concat(distinct score order by 1) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	98
Ti物理Phy	99
TomEnglish,TomMath	80,90
TomEnglish,王武程咬金语文北京上海	22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	78,98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct name,subject order by 1,score) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,王武程咬金语文北京上海
TomMath,TomEnglish
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct name,subject order by score, 1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat(distinct name,subject order by score,4,2,1) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 62. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by score,4.00, 1,2) from ss group by id order by 1;
-- result:
None
Ti物理Phy
TomEnglish,王武程咬金语文北京上海
TomMath,TomEnglish
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
欧阳诸葛方程数学大不列颠,TiEnglish
-- !result
select group_concat(distinct name,null order by score,1,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat(distinct name,subject order by 1,2, null) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat(distinct name, score order by score,4.00, 1),group_concat(subject order by score,4.00, 1),array_agg(subject order by score,4.00, 1)  from ss group by id order by 1;
-- result:
None	None	[null]
None	英语外语美誉	["英语外语美誉"]
Ti98	数学大不列颠,English	[null,"数学大不列颠","English"]
Ti99	物理Phy	[null,"物理Phy"]
Tom80,Tom90	Math,English	["Math","English"]
张三掩耳盗铃78,张三此地无银三百两98	Math数学欧拉方程,英文English	["Math数学欧拉方程","英文English"]
王武程咬金22	English,语文北京上海	[null,"English","语文北京上海"]
-- !result
select group_concat(distinct score order by 1,2) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 47. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat(distinct score order by 1,name) from ss group by id order by 1;
-- result:
None
None
22
78,98
80,90
98
99
-- !result
select group_concat(distinct 1,2 order by 1,2) from ss group by id order by 1;
-- result:
12
12
12
12
12
12
12
-- !result
select group_concat(distinct 1,2 order by score,2) from ss group by id order by 1;
-- result:
12
12
12
12
12
12
12
-- !result
select group_concat(distinct 3.1323,subject order by 1, 2,-20) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 61. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by 1,2), count(distinct id), max(score) from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	98
Ti物理Phy	0	99
TomEnglish,TomMath	1	90
TomEnglish,王武程咬金语文北京上海	1	22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
-- !result
select group_concat( name,subject order by 1,score), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	98
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
-- !result
select group_concat( name,subject order by score,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat( name,subject order by score,4,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 54. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by score,4.00,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat( name,null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat( name,subject order by 1,2, null) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat( null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat( score order by 1,2) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 39. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat( score order by 1,name) from ss group by id order by 1;
-- result:
None
None
22
78,98
80,90
98
99
-- !result
select group_concat( 1,2 order by 1,2) from ss group by id order by 1;
-- result:
12
12
12,12
12,12
12,12
12,12,12
12,12,12
-- !result
select group_concat( 1,2 order by score,2) from ss group by id order by 1;
-- result:
12
12
12,12
12,12
12,12
12,12,12
12,12,12
-- !result
select group_concat( 3.1323,subject order by 1,2,-20) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 52. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct id), group_concat(name order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	May,Ti,Ti,Tom,Tom,Tom,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(distinct name,subject order by 1,2), group_concat(distinct score order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	22,78,80,90,98,99
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,subject order by 1,2 ,score,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,subject order by length(name),1,2,score), count(distinct id), max(score)  from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,张三此地无银三百两英文English	6	99
-- !result
select group_concat(distinct name,subject order by score+1,1,2,4) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 64. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by 1,2,score,4.00) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat(distinct name,subject order by 1,2, null) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat(distinct name order by 1,score,4.00,1),group_concat(subject order by score,4.00,1),array_agg(subject order by score,4.00,1)  from ss order by 1;
-- result:
May,Ti,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金	English,数学大不列颠,英语外语美誉,语文北京上海,Math数学欧拉方程,Math,English,English,英文English,物理Phy	[null,null,null,null,"English","数学大不列颠","英语外语美誉","语文北京上海","Math数学欧拉方程","Math","English","English","英文English","物理Phy"]
-- !result
select group_concat(distinct score order by 1,2) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 47. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat(distinct score order by 1,name) from ss order by 1;
-- result:
22,78,80,90,98,99
-- !result
select group_concat(distinct 1,2 order by 1,2) from ss order by 1;
-- result:
12
-- !result
select group_concat(distinct 1,2 order by score,2) from ss order by 1;
-- result:
12
-- !result
select group_concat(distinct 3.1323,subject order by 1,-20) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 58. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by 1,2), count(distinct id), max(score) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	99
-- !result
select group_concat( name,subject order by 1,score), count(distinct id), max(score)  from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,TomEnglish,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	99
-- !result
select group_concat( name,subject order by score,1,2), count(distinct id), max(score)  from ss order by 1;
-- result:
TomEnglish,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,TomMath,TomEnglish,TiEnglish,张三此地无银三百两英文English,Ti物理Phy	6	99
-- !result
select group_concat( name,subject order by score,4), count(distinct id), max(score)  from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 50. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by score,4.00,1,2), count(distinct id), max(score)  from ss order by 1;
-- result:
TomEnglish,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,TomMath,TomEnglish,TiEnglish,张三此地无银三百两英文English,Ti物理Phy	6	99
-- !result
select group_concat( name,null order by score,4.00, 1) from ss order by 1;
-- result:
None
-- !result
select group_concat( name,subject order by null,1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat( null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat( score order by 1,2) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 39. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat( score order by 1,name) from ss order by 1;
-- result:
22,78,80,90,98,98,99
-- !result
select group_concat( 1,2 order by 1,2) from ss order by 1;
-- result:
12,12,12,12,12,12,12,12,12,12,12,12,12,12
-- !result
select group_concat( 1,2 order by score,2) from ss order by 1;
-- result:
12,12,12,12,12,12,12,12,12,12,12,12,12,12
-- !result
select group_concat( 3.1323,subject order by 1,-20) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 50. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
set new_planner_agg_stage = 2;
-- result:
-- !result
set streaming_preaggregation_mode = force_streaming;
-- result:
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct id), group_concat(name order by 1) from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	May,Ti,欧阳诸葛方程
Ti物理Phy	0	Ti
TomEnglish,TomMath	1	Tom,Tom
TomEnglish,王武程咬金语文北京上海	1	Tom,Tom,王武程咬金
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	张三掩耳盗铃,张三此地无银三百两
李四大闹天空英语外语美誉	1	李四大闹天空
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by id;
-- result:
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
TiEnglish,欧阳诸葛方程数学大不列颠
None
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1, 2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(distinct name,subject order by 1,2), group_concat(distinct score order by 1) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	98
Ti物理Phy	99
TomEnglish,TomMath	80,90
TomEnglish,王武程咬金语文北京上海	22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	78,98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct name,subject order by 1,score) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,王武程咬金语文北京上海
TomMath,TomEnglish
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct name,subject order by score, 1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat(distinct name,subject order by score,4,2,1) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 62. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by score,4.00, 1,2) from ss group by id order by 1;
-- result:
None
Ti物理Phy
TomEnglish,王武程咬金语文北京上海
TomMath,TomEnglish
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
欧阳诸葛方程数学大不列颠,TiEnglish
-- !result
select group_concat(distinct name,null order by score,1,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat(distinct name,subject order by 1,2, null) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat(distinct name, score order by score,4.00, 1),group_concat(subject order by score,4.00, 1),array_agg(subject order by score,4.00, 1)  from ss group by id order by 1;
-- result:
None	None	[null]
None	英语外语美誉	["英语外语美誉"]
Ti98	数学大不列颠,English	[null,"数学大不列颠","English"]
Ti99	物理Phy	[null,"物理Phy"]
Tom80,Tom90	Math,English	["Math","English"]
张三掩耳盗铃78,张三此地无银三百两98	Math数学欧拉方程,英文English	["Math数学欧拉方程","英文English"]
王武程咬金22	English,语文北京上海	[null,"English","语文北京上海"]
-- !result
select group_concat(distinct score order by 1,2) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 47. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat(distinct score order by 1,name) from ss group by id order by 1;
-- result:
None
None
22
78,98
80,90
98
99
-- !result
select group_concat(distinct 1,2 order by 1,2) from ss group by id order by 1;
-- result:
12
12
12
12
12
12
12
-- !result
select group_concat(distinct 1,2 order by score,2) from ss group by id order by 1;
-- result:
12
12
12
12
12
12
12
-- !result
select group_concat(distinct 3.1323,subject order by 1, 2,-20) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 61. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by 1,2), count(distinct id), max(score) from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	98
Ti物理Phy	0	99
TomEnglish,TomMath	1	90
TomEnglish,王武程咬金语文北京上海	1	22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
-- !result
select group_concat( name,subject order by 1,score), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	98
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
-- !result
select group_concat( name,subject order by score,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat( name,subject order by score,4,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 54. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by score,4.00,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat( name,null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat( name,subject order by 1,2, null) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat( null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat( score order by 1,2) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 39. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat( score order by 1,name) from ss group by id order by 1;
-- result:
None
None
22
78,98
80,90
98
99
-- !result
select group_concat( 1,2 order by 1,2) from ss group by id order by 1;
-- result:
12
12
12,12
12,12
12,12
12,12,12
12,12,12
-- !result
select group_concat( 1,2 order by score,2) from ss group by id order by 1;
-- result:
12
12
12,12
12,12
12,12
12,12,12
12,12,12
-- !result
select group_concat( 3.1323,subject order by 1,2,-20) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 52. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct id), group_concat(name order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	May,Ti,Ti,Tom,Tom,Tom,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(distinct name,subject order by 1,2), group_concat(distinct score order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	22,78,80,90,98,99
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,subject order by 1,2,score,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,subject order by length(name),1,2,score), count(distinct id), max(score)  from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,张三此地无银三百两英文English	6	99
-- !result
select group_concat(distinct name,subject order by score+1,1,2,4) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 64. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by 1,2,score,4.00) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat(distinct name,subject order by 1,2, null) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat(distinct name order by 1,score,4.00, 1),group_concat(subject order by score,4.00, 1),array_agg(subject order by score,4.00, 1)  from ss order by 1;
-- result:
May,Ti,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金	English,数学大不列颠,英语外语美誉,语文北京上海,Math数学欧拉方程,Math,English,English,英文English,物理Phy	[null,null,null,null,"English","数学大不列颠","英语外语美誉","语文北京上海","Math数学欧拉方程","Math","English","English","英文English","物理Phy"]
-- !result
select group_concat(distinct score order by 1,2) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 47. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat(distinct score order by 1,name) from ss order by 1;
-- result:
22,78,80,90,98,99
-- !result
select group_concat(distinct 1,2 order by 1,2) from ss order by 1;
-- result:
12
-- !result
select group_concat(distinct 1,2 order by score,2) from ss order by 1;
-- result:
12
-- !result
select group_concat(distinct 3.1323,subject order by 1,-20) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 58. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by 1,2), count(distinct id), max(score) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	99
-- !result
select group_concat( name,subject order by 1,score), count(distinct id), max(score)  from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,TomEnglish,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	99
-- !result
select group_concat( name,subject order by score,1,2), count(distinct id), max(score)  from ss order by 1;
-- result:
TomEnglish,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,TomMath,TomEnglish,TiEnglish,张三此地无银三百两英文English,Ti物理Phy	6	99
-- !result
select group_concat( name,subject order by score,4), count(distinct id), max(score)  from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 50. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by score,4.00,1,2), count(distinct id), max(score)  from ss order by 1;
-- result:
TomEnglish,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,TomMath,TomEnglish,TiEnglish,张三此地无银三百两英文English,Ti物理Phy	6	99
-- !result
select group_concat( name,null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat( name,subject order by null,1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat( null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat( score order by 1,2) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 39. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat( score order by 1,name) from ss order by 1;
-- result:
22,78,80,90,98,98,99
-- !result
select group_concat( 1,2 order by 1,2) from ss order by 1;
-- result:
12,12,12,12,12,12,12,12,12,12,12,12,12,12
-- !result
select group_concat( 1,2 order by score,2) from ss order by 1;
-- result:
12,12,12,12,12,12,12,12,12,12,12,12,12,12
-- !result
select group_concat( 3.1323,subject order by 1,-20) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 50. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
set new_planner_agg_stage = 0;
-- result:
-- !result
set enable_exchange_pass_through = false;
-- result:
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct id), group_concat(name order by 1) from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	May,Ti,欧阳诸葛方程
Ti物理Phy	0	Ti
TomEnglish,TomMath	1	Tom,Tom
TomEnglish,王武程咬金语文北京上海	1	Tom,Tom,王武程咬金
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	张三掩耳盗铃,张三此地无银三百两
李四大闹天空英语外语美誉	1	李四大闹天空
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by id;
-- result:
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
TiEnglish,欧阳诸葛方程数学大不列颠
None
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1, 2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(distinct name,subject order by 1,2), group_concat(distinct score order by 1) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	98
Ti物理Phy	99
TomEnglish,TomMath	80,90
TomEnglish,王武程咬金语文北京上海	22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	78,98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct name,subject order by 1,score) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,王武程咬金语文北京上海
TomMath,TomEnglish
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct name,subject order by score, 1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat(distinct name,subject order by score,4,2,1) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 62. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by score,4.00, 1,2) from ss group by id order by 1;
-- result:
None
Ti物理Phy
TomEnglish,王武程咬金语文北京上海
TomMath,TomEnglish
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
欧阳诸葛方程数学大不列颠,TiEnglish
-- !result
select group_concat(distinct name,null order by score,1,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat(distinct name,subject order by 1,2, null) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(distinct null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat(distinct name, score order by score,4.00, 1),group_concat(subject order by score,4.00, 1),array_agg(subject order by score,4.00, 1)  from ss group by id order by 1;
-- result:
None	None	[null]
None	英语外语美誉	["英语外语美誉"]
Ti98	数学大不列颠,English	[null,"数学大不列颠","English"]
Ti99	物理Phy	[null,"物理Phy"]
Tom80,Tom90	Math,English	["Math","English"]
张三掩耳盗铃78,张三此地无银三百两98	Math数学欧拉方程,英文English	["Math数学欧拉方程","英文English"]
王武程咬金22	English,语文北京上海	[null,"English","语文北京上海"]
-- !result
select group_concat(distinct score order by 1,2) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 47. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat(distinct score order by 1,name) from ss group by id order by 1;
-- result:
None
None
22
78,98
80,90
98
99
-- !result
select group_concat(distinct 1,2 order by 1,2) from ss group by id order by 1;
-- result:
12
12
12
12
12
12
12
-- !result
select group_concat(distinct 1,2 order by score,2) from ss group by id order by 1;
-- result:
12
12
12
12
12
12
12
-- !result
select group_concat(distinct 3.1323,subject order by 1, 2,-20) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 61. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by 1,2), count(distinct id), max(score) from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	98
Ti物理Phy	0	99
TomEnglish,TomMath	1	90
TomEnglish,王武程咬金语文北京上海	1	22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
-- !result
select group_concat( name,subject order by 1,score,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
TiEnglish,欧阳诸葛方程数学大不列颠	1	98
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
-- !result
select group_concat( name,subject order by score,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat( name,subject order by score,4,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 54. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by score,4.00,1,2), count(distinct id), max(score)  from ss group by id order by 1;
-- result:
None	1	None
Ti物理Phy	0	99
TomEnglish,王武程咬金语文北京上海	1	22
TomMath,TomEnglish	1	90
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	1	98
李四大闹天空英语外语美誉	1	None
欧阳诸葛方程数学大不列颠,TiEnglish	1	98
-- !result
select group_concat( name,null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat( name,subject order by 1,2, null) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat( null order by score,4.00) from ss group by id order by 1;
-- result:
None
None
None
None
None
None
None
-- !result
select group_concat( score order by 1,2) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 39. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat( score order by 1,name) from ss group by id order by 1;
-- result:
None
None
22
78,98
80,90
98
99
-- !result
select group_concat( 1,2 order by 1,2) from ss group by id order by 1;
-- result:
12
12
12,12
12,12
12,12
12,12,12
12,12,12
-- !result
select group_concat( 1,2 order by score,2) from ss group by id order by 1;
-- result:
12
12
12,12
12,12
12,12
12,12,12
12,12,12
-- !result
select group_concat( 3.1323,subject order by 1,2,-20) from ss group by id order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 52. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct id), group_concat(name order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	May,Ti,Ti,Tom,Tom,Tom,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(distinct name,subject order by 1,2), group_concat(distinct score order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	22,78,80,90,98,99
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,subject order by 1,2,score,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,subject order by length(name),1,2,score), count(distinct id), max(score)  from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,张三此地无银三百两英文English	6	99
-- !result
select group_concat(distinct name,subject order by score+1,1,2,4) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 64. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat(distinct name,subject order by 1,2,score,4.00) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct name,null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat(distinct name,subject order by 1,2, null) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(distinct null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat(distinct name order by 1,score,4.00, 1),group_concat(subject order by score,4.00, 1),array_agg(subject order by score,4.00, 1)  from ss order by 1;
-- result:
May,Ti,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金	English,数学大不列颠,英语外语美誉,语文北京上海,Math数学欧拉方程,Math,English,English,英文English,物理Phy	[null,null,null,null,"English","数学大不列颠","英语外语美誉","语文北京上海","Math数学欧拉方程","Math","English","English","英文English","物理Phy"]
-- !result
select group_concat(distinct score order by 1,2) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 47. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat(distinct score order by 1,name) from ss order by 1;
-- result:
22,78,80,90,98,99
-- !result
select group_concat(distinct 1,2 order by 1,2) from ss order by 1;
-- result:
12
-- !result
select group_concat(distinct 1,2 order by score,2) from ss order by 1;
-- result:
12
-- !result
select group_concat(distinct 3.1323,subject order by 1,-20) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 58. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by 1,2), count(distinct id), max(score) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	99
-- !result
select group_concat( name,subject order by 1,score, 2), count(distinct id), max(score)  from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,TomEnglish,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	99
-- !result
select group_concat( name,subject order by score,1,2), count(distinct id), max(score)  from ss order by 1;
-- result:
TomEnglish,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,TomMath,TomEnglish,TiEnglish,张三此地无银三百两英文English,Ti物理Phy	6	99
-- !result
select group_concat( name,subject order by score,4), count(distinct id), max(score)  from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 50. Detail message: ORDER BY position 4 is not in group_concat output list.')
-- !result
select group_concat( name,subject order by score,4.00,1,2), count(distinct id), max(score)  from ss order by 1;
-- result:
TomEnglish,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海,张三掩耳盗铃Math数学欧拉方程,TomMath,TomEnglish,TiEnglish,张三此地无银三百两英文English,Ti物理Phy	6	99
-- !result
select group_concat( name,null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat( name,subject order by null,1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat( null order by score,4.00) from ss order by 1;
-- result:
None
-- !result
select group_concat( score order by 1,2) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 39. Detail message: ORDER BY position 2 is not in group_concat output list.')
-- !result
select group_concat( score order by 1,name) from ss order by 1;
-- result:
22,78,80,90,98,98,99
-- !result
select group_concat( 1,2 order by 1,2) from ss order by 1;
-- result:
12,12,12,12,12,12,12,12,12,12,12,12,12,12
-- !result
select group_concat( 1,2 order by score,2) from ss order by 1;
-- result:
12,12,12,12,12,12,12,12,12,12,12,12,12,12
-- !result
select group_concat( 3.1323,subject order by 1,-20) from ss order by 1;
-- result:
E: (1064, 'Getting syntax error from line 1, column 7 to line 1, column 50. Detail message: ORDER BY position -20 is not in group_concat output list.')
-- !result
set enable_query_cache = true;
-- result:
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct score), group_concat(name order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	May,Ti,Ti,Tom,Tom,Tom,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金
-- !result
select count(distinct score), group_concat(name order by 1) from ss order by 1;
-- result:
6	May,Ti,Ti,Tom,Tom,Tom,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select id, group_concat(distinct name,subject order by 1,2), count(distinct score), group_concat(name order by 1) from ss group by id order by 1;
-- result:
None	Ti物理Phy	1	Ti
1	TomEnglish,TomMath	2	Tom,Tom
2	TomEnglish,王武程咬金语文北京上海	1	Tom,Tom,王武程咬金
3	TiEnglish,欧阳诸葛方程数学大不列颠	1	May,Ti,欧阳诸葛方程
4	None	0	None
11	张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	2	张三掩耳盗铃,张三此地无银三百两
12	李四大闹天空英语外语美誉	0	李四大闹天空
-- !result
select id, count(distinct score), group_concat(name order by 1) from ss group by id order by 1;
-- result:
None	1	Ti
1	2	Tom,Tom
2	1	Tom,Tom,王武程咬金
3	1	May,Ti,欧阳诸葛方程
4	0	None
11	2	张三掩耳盗铃,张三此地无银三百两
12	0	李四大闹天空
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by id;
-- result:
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
TiEnglish,欧阳诸葛方程数学大不列颠
None
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1, 2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
set enable_query_cache = false;
-- result:
-- !result
select group_concat(distinct name,subject order by 1,2), count(distinct score), group_concat(name order by 1) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	6	May,Ti,Ti,Tom,Tom,Tom,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金
-- !result
select count(distinct score), group_concat(name order by 1) from ss order by 1;
-- result:
6	May,Ti,Ti,Tom,Tom,Tom,Tom,张三掩耳盗铃,张三此地无银三百两,李四大闹天空,欧阳诸葛方程,王武程咬金
-- !result
select group_concat(distinct name,subject order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1,2) from ss order by 1;
-- result:
TiEnglish,Ti物理Phy,TomEnglish,TomEnglish,TomMath,张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English,李四大闹天空英语外语美誉,欧阳诸葛方程数学大不列颠,王武程咬金语文北京上海	Ti98,Ti99,Tom80,Tom90,张三掩耳盗铃78,张三此地无银三百两98,王武程咬金22
-- !result
select id, group_concat(distinct name,subject order by 1,2), count(distinct score), group_concat(name order by 1) from ss group by id order by 1;
-- result:
None	Ti物理Phy	1	Ti
1	TomEnglish,TomMath	2	Tom,Tom
2	TomEnglish,王武程咬金语文北京上海	1	Tom,Tom,王武程咬金
3	TiEnglish,欧阳诸葛方程数学大不列颠	1	May,Ti,欧阳诸葛方程
4	None	0	None
11	张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	2	张三掩耳盗铃,张三此地无银三百两
12	李四大闹天空英语外语美誉	0	李四大闹天空
-- !result
select id, count(distinct score), group_concat(name order by 1) from ss group by id order by 1;
-- result:
None	1	Ti
1	2	Tom,Tom
2	1	Tom,Tom,王武程咬金
3	1	May,Ti,欧阳诸葛方程
4	0	None
11	2	张三掩耳盗铃,张三此地无银三百两
12	0	李四大闹天空
-- !result
select group_concat(distinct name,subject order by 1,2) from ss group by id order by id;
-- result:
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
TiEnglish,欧阳诸葛方程数学大不列颠
None
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
select group_concat(name,subject order by 1,2), group_concat(name,score order by 1,2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat(name,subject order by 1,2), group_concat(distinct name,score order by 1, 2) from ss group by id order by 1;
-- result:
None	None
TiEnglish,欧阳诸葛方程数学大不列颠	Ti98
Ti物理Phy	Ti99
TomEnglish,TomMath	Tom80,Tom90
TomEnglish,王武程咬金语文北京上海	王武程咬金22
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English	张三掩耳盗铃78,张三此地无银三百两98
李四大闹天空英语外语美誉	None
-- !result
select group_concat();
-- result:
E: (1064, 'Getting analyzing error from line 1, column 7 to line 1, column 20. Detail message: group_concat should have at least one input.')
-- !result
select group_concat() from ss;
-- result:
E: (1064, 'Getting analyzing error from line 1, column 7 to line 1, column 20. Detail message: group_concat should have at least one input.')
-- !result
select group_concat(',');
-- result:
,
-- !result
select group_concat("中国",name order by 2, id) from ss;
-- result:
中国May,中国Ti,中国Ti,中国Tom,中国Tom,中国Tom,中国Tom,中国张三掩耳盗铃,中国张三此地无银三百两,中国李四大闹天空,中国欧阳诸葛方程,中国王武程咬金
-- !result
select group_concat("中国",name order by 2, id separator NULL) from ss;
-- result:
中国May中国Ti中国Ti中国Tom中国Tom中国Tom中国Tom中国张三掩耳盗铃中国张三此地无银三百两中国李四大闹天空中国欧阳诸葛方程中国王武程咬金
-- !result
select group_concat("中国",name order by 2, "第一", id) from ss;
-- result:
中国May,中国Ti,中国Ti,中国Tom,中国Tom,中国Tom,中国Tom,中国张三掩耳盗铃,中国张三此地无银三百两,中国李四大闹天空,中国欧阳诸葛方程,中国王武程咬金
-- !result
select group_concat("中国",name order by 2, "第一", id separator '\n') from ss;
-- result:
中国May
中国Ti
中国Ti
中国Tom
中国Tom
中国Tom
中国Tom
中国张三掩耳盗铃
中国张三此地无银三百两
中国李四大闹天空
中国欧阳诸葛方程
中国王武程咬金
-- !result
select group_concat("中国",name order by 2, "第一", id separator subject) from ss;
-- result:
中国May中国Ti物理Phy中国TiEnglish中国TomEnglish中国TomMath中国TomEnglish中国Tom中国张三掩耳盗铃Math数学欧拉方程中国张三此地无银三百两英文English中国李四大闹天空英语外语美誉中国欧阳诸葛方程数学大不列颠中国王武程咬金
-- !result
select group_concat("中国" order by "第一" separator 1) from ss;
-- result:
E: (1064, "Getting analyzing error at line 1, column 49. Detail message: group_concat requires separator to be of getType() STRING: group_concat('中国', 1).")
-- !result
select group_concat(  order by score) from ss order by 1;
-- result:
E: (1064, "Getting syntax error at line 1, column 19. Detail message: Unexpected input '(', the most similar input is {<EOF>, ';'}.")
-- !result
select group_concat(distinct  order by score) from ss order by 1;
-- result:
E: (1064, "Getting syntax error at line 1, column 30. Detail message: Unexpected input 'order', the most similar input is {a legal identifier}.")
-- !result
select group_concat([1,2]) from ss;
-- result:
E: (1064, 'Getting analyzing error from line 1, column 7 to line 1, column 25. Detail message: No matching function with signature: group_concat(array<tinyint(4)>, varchar).')
-- !result
select group_concat(json_object("2:3")) from ss;
-- result:
{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null},{"2:3": null}
-- !result
select group_concat(map(2,3)) from ss;
-- result:
E: (1064, 'Getting analyzing error from line 1, column 7 to line 1, column 28. Detail message: No matching function with signature: group_concat(map<tinyint(4),tinyint(4)>, varchar).')
-- !result
select group_concat(null);
-- result:
None
-- !result
select group_concat(order by 1 separator '');
-- result:
E: (1064, "Getting syntax error at line 1, column 19. Detail message: Unexpected input '(', the most similar input is {<EOF>, ';'}.")
-- !result
select group_concat(separator NULL);
-- result:
E: (1064, "Getting syntax error at line 1, column 30. Detail message: No viable statement for input 'group_concat(separator NULL'.")
-- !result
set group_concat_max_len = -121;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
Ti
TiEn
TomE
TomE
张
李
-- !result
set group_concat_max_len = 1;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
Ti
TiEn
TomE
TomE
张
李
-- !result
set group_concat_max_len = 5;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEng
Ti物
TomEn
TomEn
张
李
-- !result
set group_concat_max_len = 6;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEngl
Ti物
TomEng
TomEng
张三
李四
-- !result
set group_concat_max_len = 7;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEngli
Ti物
TomEngl
TomEngl
张三
李四
-- !result
set group_concat_max_len = 8;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEnglis
Ti物理
TomEngli
TomEngli
张三
李四
-- !result
set group_concat_max_len = 9;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEnglish
Ti物理P
TomEnglis
TomEnglis
张三掩
李四大
-- !result
set group_concat_max_len = 121;
-- result:
-- !result
select group_concat(name,subject order by 1,2) from ss group by id order by 1;
-- result:
None
TiEnglish,欧阳诸葛方程数学大不列颠
Ti物理Phy
TomEnglish,TomMath
TomEnglish,王武程咬金语文北京上海
张三掩耳盗铃Math数学欧拉方程,张三此地无银三百两英文English
李四大闹天空英语外语美誉
-- !result
-- name: testLegacyGroupConcat
CREATE TABLE t1 (
    id        tinyint(4)      NULL,
    value   varchar(65533)  NULL
) ENGINE=OLAP
DISTRIBUTED BY HASH(id)
PROPERTIES (
 "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO t1 VALUES
(1,'fruit'),
(1,'fruit'),
(1,'fruit'),
(2,'fruit'),
(2,'fruit'),
(2,'fruit');
-- result:
-- !result
set group_concat_max_len = 1024;
-- result:
-- !result
set sql_mode = 'GROUP_CONCAT_LEGACY';
-- result:
-- !result
select id, group_concat( value ) from t1 group by id order by id;
-- result:
1	fruit, fruit, fruit
2	fruit, fruit, fruit
-- !result
select id, group_concat( value, '-' ) from t1 group by id order by id;
-- result:
1	fruit-fruit-fruit
2	fruit-fruit-fruit
-- !result
select group_concat( value ) from t1;
-- result:
fruit, fruit, fruit, fruit, fruit, fruit
-- !result
select group_concat( value, '-' ) from t1;
-- result:
fruit-fruit-fruit-fruit-fruit-fruit
-- !result
set sql_mode = 32;
-- result:
-- !result
select /*+ set_var(sql_mode = 'GROUP_CONCAT_LEGACY') */ id, group_concat( value ) from t1 group by id order by id;
-- result:
1	fruit, fruit, fruit
2	fruit, fruit, fruit
-- !result
select /*+ set_var(sql_mode = 68719476736) */ group_concat( value, '-' ) from t1;
-- result:
fruit-fruit-fruit-fruit-fruit-fruit
-- !result
select /*+ set_var(sql_mode = 'GROUP_CONCAT_LEGACY') */ /*+ set_var(sql_mode = 'ONLY_FULL_GROUP_BY') */ id, group_concat( value, '-' ) from t1 group by id order by id;
-- result:
1	fruit-,fruit-,fruit-
2	fruit-,fruit-,fruit-
-- !result
select /*+ set_var(sql_mode = 68719476736) */ /*+ set_var(sql_mode = 32) */ group_concat( value ) from t1;
-- result:
fruit,fruit,fruit,fruit,fruit,fruit
-- !result