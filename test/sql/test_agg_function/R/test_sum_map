-- name: test_sum_map
CREATE TABLE t1 (
    c1 int,
    c2 map<int, int>,
    c3 map<varchar(10), bigint>,
    c4 map<int, double>
)
DUPLICATE KEY(c1)
DISTRIBUTED BY HASH(c1) BUCKETS 3
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
INSERT INTO t1 values
    (1, map{1:10, 2:20, 3:30}, map{"a":100, "b":200}, map{1:1.5, 2:2.5}),
    (2, map{1:5, 2:15, 4:40}, map{"a":50, "c":150}, map{1:0.5, 3:3.5}),
    (3, map{2:25, 3:35, 5:50}, map{"b":250, "c":350}, map{2:1.0, 3:2.0});
-- result:
-- !result
select sum_map(c2)[1], sum_map(c2)[2], sum_map(c2)[3], sum_map(c2)[4], sum_map(c2)[5] from t1;
-- result:
15	60	65	40	50
-- !result
select sum_map(c3)["a"], sum_map(c3)["b"], sum_map(c3)["c"] from t1;
-- result:
150	450	500
-- !result
select sum_map(c4)[1], sum_map(c4)[2], sum_map(c4)[3] from t1;
-- result:
2.0	3.5	5.5
-- !result
select c1, sum_map(c2)[1], sum_map(c2)[2], sum_map(c2)[3], sum_map(c2)[4], sum_map(c2)[5] from t1 group by c1 order by c1;
-- result:
1	10	20	30	None	None
2	5	15	None	40	None
3	None	25	35	None	50
-- !result
select sum_map(c2)[1], sum_map(c2)[2], sum_map(c2)[3], sum_map(c2)[4] from t1 where c1 <= 2;
-- result:
15	35	30	40
-- !result
INSERT INTO t1 values (4, null, null, null);
-- result:
-- !result
select sum_map(c2)[1], sum_map(c2)[2], sum_map(c2)[3], sum_map(c2)[4], sum_map(c2)[5] from t1;
-- result:
15	60	65	40	50
-- !result
INSERT INTO t1 values (5, map{}, map{}, map{});
-- result:
-- !result
select sum_map(c2)[1], sum_map(c2)[2], sum_map(c2)[3], sum_map(c2)[4], sum_map(c2)[5] from t1;
-- result:
15	60	65	40	50
-- !result
select sum_map(c2)[1] from t1;
-- result:
15
-- !result
select sum_map(c2)[2] from t1;
-- result:
60
-- !result
select sum_map(c2)[3] from t1;
-- result:
65
-- !result
select sum_map(c2)[4] from t1;
-- result:
40
-- !result
select sum_map(c2)[5] from t1;
-- result:
50
-- !result
set streaming_preaggregation_mode=force_streaming;
-- result:
-- !result
select sum_map(c2)[1], sum_map(c2)[2], sum_map(c2)[3], sum_map(c2)[4], sum_map(c2)[5] from t1;
-- result:
15	60	65	40	50
-- !result
select sum_map(c3)["a"], sum_map(c3)["b"], sum_map(c3)["c"] from t1;
-- result:
150	450	500
-- !result
select sum_map(c4)[1], sum_map(c4)[2], sum_map(c4)[3] from t1;
-- result:
2.0	3.5	5.5
-- !result
set streaming_preaggregation_mode=force_preaggregation;
-- result:
-- !result
select sum_map(c2)[1], sum_map(c2)[2], sum_map(c2)[3], sum_map(c2)[4], sum_map(c2)[5] from t1;
-- result:
15	60	65	40	50
-- !result
select sum_map(c3)["a"], sum_map(c3)["b"], sum_map(c3)["c"] from t1;
-- result:
150	450	500
-- !result
select sum_map(c4)[1], sum_map(c4)[2], sum_map(c4)[3] from t1;
-- result:
2.0	3.5	5.5
-- !result
CREATE TABLE t2 (
    id int,
    m_tinyint map<int, tinyint>,
    m_smallint map<int, smallint>,
    m_int map<int, int>,
    m_bigint map<int, bigint>,
    m_largeint map<int, largeint>,
    m_float map<int, float>,
    m_double map<int, double>
)
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 3
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
INSERT INTO t2 values
    (1, map{1:10, 2:20}, map{1:100, 2:200}, map{1:1000, 2:2000}, map{1:10000, 2:20000}, 
        map{1:100000, 2:200000}, map{1:1.5, 2:2.5}, map{1:10.5, 2:20.5}),
    (2, map{1:5, 3:30}, map{1:50, 3:300}, map{1:500, 3:3000}, map{1:5000, 3:30000},
        map{1:50000, 3:300000}, map{1:0.5, 3:3.5}, map{1:5.5, 3:30.5});
-- result:
-- !result
select sum_map(m_tinyint)[1], sum_map(m_tinyint)[2], sum_map(m_tinyint)[3] from t2;
-- result:
15	20	30
-- !result
select sum_map(m_smallint)[1], sum_map(m_smallint)[2], sum_map(m_smallint)[3] from t2;
-- result:
150	200	300
-- !result
select sum_map(m_int)[1], sum_map(m_int)[2], sum_map(m_int)[3] from t2;
-- result:
1500	2000	3000
-- !result
select sum_map(m_bigint)[1], sum_map(m_bigint)[2], sum_map(m_bigint)[3] from t2;
-- result:
15000	20000	30000
-- !result
select sum_map(m_largeint)[1], sum_map(m_largeint)[2], sum_map(m_largeint)[3] from t2;
-- result:
150000	200000	300000
-- !result
select sum_map(m_float)[1], sum_map(m_float)[2], sum_map(m_float)[3] from t2;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_double)[1], sum_map(m_double)[2], sum_map(m_double)[3] from t2;
-- result:
16.0	20.5	30.5
-- !result
CREATE TABLE t3 (
    id int,
    m_key_tinyint map<tinyint, int>,
    m_key_smallint map<smallint, int>,
    m_key_int map<int, int>,
    m_key_bigint map<bigint, int>,
    m_key_largeint map<largeint, int>,
    m_key_varchar map<varchar(20), int>
)
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 3
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
INSERT INTO t3 values
    (1, map{1:10, 2:20}, map{1:100, 2:200}, map{1:1000, 2:2000}, 
        map{1:10000, 2:20000}, map{1:100000, 2:200000}, map{"a":10, "b":20}),
    (2, map{1:5, 3:30}, map{1:50, 3:300}, map{1:500, 3:3000}, 
        map{1:5000, 3:30000}, map{1:50000, 3:300000}, map{"a":5, "c":30});
-- result:
-- !result
select sum_map(m_key_tinyint)[1], sum_map(m_key_tinyint)[2], sum_map(m_key_tinyint)[3] from t3;
-- result:
15	20	30
-- !result
select sum_map(m_key_smallint)[1], sum_map(m_key_smallint)[2], sum_map(m_key_smallint)[3] from t3;
-- result:
150	200	300
-- !result
select sum_map(m_key_int)[1], sum_map(m_key_int)[2], sum_map(m_key_int)[3] from t3;
-- result:
1500	2000	3000
-- !result
select sum_map(m_key_bigint)[1], sum_map(m_key_bigint)[2], sum_map(m_key_bigint)[3] from t3;
-- result:
15000	20000	30000
-- !result
select sum_map(m_key_largeint)[1], sum_map(m_key_largeint)[2], sum_map(m_key_largeint)[3] from t3;
-- result:
150000	200000	300000
-- !result
select sum_map(m_key_varchar)["a"], sum_map(m_key_varchar)["b"], sum_map(m_key_varchar)["c"] from t3;
-- result:
15	20	30
-- !result
select sum_map(NULL);
-- result:
{}
-- !result
select sum_map(m)[1], sum_map(m)[2], sum_map(m)[3] from (
    select map{1:10, 2:20} as m
    union all
    select NULL as m
    union all
    select map{1:5, 3:30} as m
) t;
-- result:
15	20	30
-- !result
select sum_map(m) from (
    select NULL as m
    union all
    select NULL as m
    union all
    select NULL as m
) t;
-- result:
{}
-- !result
CREATE TABLE t5 (
    id int,
    m_nullable map<int, int>
)
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 3
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
INSERT INTO t5 values
    (1, map{1:10, 2:20, NULL:100}),
    (2, map{1:5, NULL:50, 3:30});
-- result:
-- !result
select sum_map(m_nullable)[1], sum_map(m_nullable)[2], sum_map(m_nullable)[3], sum_map(m_nullable)[NULL] from t5;
-- result:
15	20	30	150
-- !result
INSERT INTO t5 values
    (3, map{1:15, 2:NULL, 4:40});
-- result:
-- !result
select sum_map(m_nullable)[1], sum_map(m_nullable)[2], sum_map(m_nullable)[3], sum_map(m_nullable)[4], sum_map(m_nullable)[NULL] from t5;
-- result:
30	20	30	40	150
-- !result
INSERT INTO t5 values
    (4, map{NULL:25, 5:NULL, 6:60});
-- result:
-- !result
select sum_map(m_nullable)[1], sum_map(m_nullable)[2], sum_map(m_nullable)[3], sum_map(m_nullable)[4], sum_map(m_nullable)[5], sum_map(m_nullable)[6], sum_map(m_nullable)[NULL] from t5;
-- result:
30	20	30	40	None	60	175
-- !result
select sum_map(m)[1], sum_map(m)[2] from (select map{1:10, 2:20} as m) t;
-- result:
10	20
-- !result
select sum_map(m) from ( select map{} as m union all select map{} as m union all select map{} as m ) t;
-- result:
{}
-- !result
select sum_map(m)[1], sum_map(m)[2] from (
    select map{1:10} as m
    union all
    select map{} as m
    union all
    select map{1:5, 2:20} as m
) t;
-- result:
15	20
-- !result
select sum_map(m)[1], sum_map(m)[2], sum_map(m)[5], sum_map(m)[10] from (
    select map{1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10} as m
    union all
    select map{1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10} as m
) t;
-- result:
2	4	10	20
-- !result
select sum_map(m)[1], sum_map(m)[2], sum_map(m)[3], sum_map(m)[4] from (
    select map{1:-10, 2:20, 3:-30} as m
    union all
    select map{1:5, 2:-15, 4:40} as m
) t;
-- result:
-5	5	-30	40
-- !result
select sum_map(m)[1], sum_map(m)[2] from (
    select map{1:0, 2:10} as m
    union all
    select map{1:5, 2:0} as m
) t;
-- result:
5	10
-- !result
select sum_map(m) from (
    select map{1:map{1:10}} as m
) t;
-- result:
[REGEX].*sum_map only support scalar KV.*
-- !result
select sum_map(m) from (
    select map(1,[1,2,3]) as m
) t;
-- result:
[REGEX].*sum_map only support scalar KV.*
-- !result
select sum_map(m) from (
    select map{1:row(1, 'a')} as m
) t;
-- result:
[REGEX].*sum_map only support scalar KV.*
-- !result
CREATE TABLE t8 (
    category varchar(20),
    metrics map<varchar(20), int>
)
DUPLICATE KEY(category)
DISTRIBUTED BY HASH(category) BUCKETS 3
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
INSERT INTO t8 values
    ('A', map{"clicks":100, "views":200}),
    ('A', map{"clicks":50, "impressions":150}),
    ('B', map{"views":300, "impressions":250}),
    ('B', map{"clicks":75, "views":100});
-- result:
-- !result
select category, sum_map(metrics)["clicks"], sum_map(metrics)["views"], sum_map(metrics)["impressions"], count(*) from t8 group by category order by category;
-- result:
A	150	200	150	2
B	75	400	250	2
-- !result
select category, sum_map(metrics)["clicks"] as clicks_total, sum_map(metrics)["views"] as views_total, sum_map(metrics)["impressions"] as impressions_total from t8 group by category having count(*) > 1 order by category;
-- result:
A	150	200	150
B	75	400	250
-- !result
select sum_map(m)[1], sum_map(m)[2], sum_map(m)[3] from (
    select map{3:30, 1:10, 2:20} as m
    union all
    select map{2:25, 3:35, 1:15} as m
) t;
-- result:
25	45	65
-- !result
CREATE TABLE t10 (
    id int,
    data map<int, bigint>
)
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 3
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
INSERT INTO t10 select 
    generate_series as id,
    map{1:generate_series, 2:generate_series*2, 3:generate_series*3} as data
from table(generate_series(1, 100));
-- result:
-- !result
select sum_map(data)[1], sum_map(data)[2], sum_map(data)[3] from t10;
-- result:
5050	10100	15150
-- !result
CREATE TABLE t11_type_matrix (
    id int,
    -- Numeric key types with numeric value types (VALID - 7Ã—7=49 combinations)
    m_ti_ti map<tinyint, tinyint>,
    m_ti_si map<tinyint, smallint>,
    m_ti_i map<tinyint, int>,
    m_ti_bi map<tinyint, bigint>,
    m_ti_li map<tinyint, largeint>,
    m_ti_f map<tinyint, float>,
    m_ti_d map<tinyint, double>,
    
    m_si_ti map<smallint, tinyint>,
    m_si_si map<smallint, smallint>,
    m_si_i map<smallint, int>,
    m_si_bi map<smallint, bigint>,
    m_si_li map<smallint, largeint>,
    m_si_f map<smallint, float>,
    m_si_d map<smallint, double>,
    
    m_i_ti map<int, tinyint>,
    m_i_si map<int, smallint>,
    m_i_i map<int, int>,
    m_i_bi map<int, bigint>,
    m_i_li map<int, largeint>,
    m_i_f map<int, float>,
    m_i_d map<int, double>,
    
    m_bi_ti map<bigint, tinyint>,
    m_bi_si map<bigint, smallint>,
    m_bi_i map<bigint, int>,
    m_bi_bi map<bigint, bigint>,
    m_bi_li map<bigint, largeint>,
    m_bi_f map<bigint, float>,
    m_bi_d map<bigint, double>,
    
    m_li_ti map<largeint, tinyint>,
    m_li_si map<largeint, smallint>,
    m_li_i map<largeint, int>,
    m_li_bi map<largeint, bigint>,
    m_li_li map<largeint, largeint>,
    m_li_f map<largeint, float>,
    m_li_d map<largeint, double>,
    
    m_f_ti map<float, tinyint>,
    m_f_si map<float, smallint>,
    m_f_i map<float, int>,
    m_f_bi map<float, bigint>,
    m_f_li map<float, largeint>,
    m_f_f map<float, float>,
    m_f_d map<float, double>,
    
    m_d_ti map<double, tinyint>,
    m_d_si map<double, smallint>,
    m_d_i map<double, int>,
    m_d_bi map<double, bigint>,
    m_d_li map<double, largeint>,
    m_d_f map<double, float>,
    m_d_d map<double, double>,
    
    -- Date/datetime keys with numeric values (7 combinations)
    m_date_i map<date, int>,
    m_dt_i map<datetime, int>,
    
    -- String key with numeric values
    m_str_i map<varchar(10), int>,
    
    -- Non-numeric value types (should fail - documenting expected errors)
    m_i_date map<int, date>,
    m_i_dt map<int, datetime>,
    m_i_str map<int, varchar(10)>
)
DUPLICATE KEY(id)
DISTRIBUTED BY HASH(id) BUCKETS 3
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
INSERT INTO t11_type_matrix VALUES (
    1,
    -- tinyint keys
    map{1:10, 2:20}, map{1:100, 2:200}, map{1:1000, 2:2000}, map{1:10000, 2:20000},
    map{1:100000, 2:200000}, map{1:1.5, 2:2.5}, map{1:10.5, 2:20.5},
    -- smallint keys
    map{1:10, 2:20}, map{1:100, 2:200}, map{1:1000, 2:2000}, map{1:10000, 2:20000},
    map{1:100000, 2:200000}, map{1:1.5, 2:2.5}, map{1:10.5, 2:20.5},
    -- int keys
    map{1:10, 2:20}, map{1:100, 2:200}, map{1:1000, 2:2000}, map{1:10000, 2:20000},
    map{1:100000, 2:200000}, map{1:1.5, 2:2.5}, map{1:10.5, 2:20.5},
    -- bigint keys
    map{1:10, 2:20}, map{1:100, 2:200}, map{1:1000, 2:2000}, map{1:10000, 2:20000},
    map{1:100000, 2:200000}, map{1:1.5, 2:2.5}, map{1:10.5, 2:20.5},
    -- largeint keys
    map{1:10, 2:20}, map{1:100, 2:200}, map{1:1000, 2:2000}, map{1:10000, 2:20000},
    map{1:100000, 2:200000}, map{1:1.5, 2:2.5}, map{1:10.5, 2:20.5},
    -- float keys
    map{1.0:10, 2.0:20}, map{1.0:100, 2.0:200}, map{1.0:1000, 2.0:2000}, map{1.0:10000, 2.0:20000},
    map{1.0:100000, 2.0:200000}, map{1.0:1.5, 2.0:2.5}, map{1.0:10.5, 2.0:20.5},
    -- double keys
    map{1.0:10, 2.0:20}, map{1.0:100, 2.0:200}, map{1.0:1000, 2.0:2000}, map{1.0:10000, 2.0:20000},
    map{1.0:100000, 2.0:200000}, map{1.0:1.5, 2.0:2.5}, map{1.0:10.5, 2.0:20.5},
    -- date/datetime/string keys with numeric values
    map{'2024-01-01':100, '2024-01-02':200}, map{'2024-01-01 10:00:00':100, '2024-01-01 11:00:00':200},
    map{"a":100, "b":200},
    -- Non-numeric values (will cause errors if tested)
    map{1:'2024-01-01', 2:'2024-01-02'}, map{1:'2024-01-01 10:00:00', 2:'2024-01-01 11:00:00'},
    map{1:"a", 2:"b"}
);
-- result:
-- !result
INSERT INTO t11_type_matrix VALUES (
    2,
    -- tinyint keys
    map{1:5, 3:30}, map{1:50, 3:300}, map{1:500, 3:3000}, map{1:5000, 3:30000},
    map{1:50000, 3:300000}, map{1:0.5, 3:3.5}, map{1:5.5, 3:30.5},
    -- smallint keys
    map{1:5, 3:30}, map{1:50, 3:300}, map{1:500, 3:3000}, map{1:5000, 3:30000},
    map{1:50000, 3:300000}, map{1:0.5, 3:3.5}, map{1:5.5, 3:30.5},
    -- int keys
    map{1:5, 3:30}, map{1:50, 3:300}, map{1:500, 3:3000}, map{1:5000, 3:30000},
    map{1:50000, 3:300000}, map{1:0.5, 3:3.5}, map{1:5.5, 3:30.5},
    -- bigint keys
    map{1:5, 3:30}, map{1:50, 3:300}, map{1:500, 3:3000}, map{1:5000, 3:30000},
    map{1:50000, 3:300000}, map{1:0.5, 3:3.5}, map{1:5.5, 3:30.5},
    -- largeint keys
    map{1:5, 3:30}, map{1:50, 3:300}, map{1:500, 3:3000}, map{1:5000, 3:30000},
    map{1:50000, 3:300000}, map{1:0.5, 3:3.5}, map{1:5.5, 3:30.5},
    -- float keys
    map{1.0:5, 3.0:30}, map{1.0:50, 3.0:300}, map{1.0:500, 3.0:3000}, map{1.0:5000, 3.0:30000},
    map{1.0:50000, 3.0:300000}, map{1.0:0.5, 3.0:3.5}, map{1.0:5.5, 3.0:30.5},
    -- double keys
    map{1.0:5, 3.0:30}, map{1.0:50, 3.0:300}, map{1.0:500, 3.0:3000}, map{1.0:5000, 3.0:30000},
    map{1.0:50000, 3.0:300000}, map{1.0:0.5, 3.0:3.5}, map{1.0:5.5, 3.0:30.5},
    -- date/datetime/string keys with numeric values
    map{'2024-01-01':50, '2024-01-03':300}, map{'2024-01-01 10:00:00':50, '2024-01-01 12:00:00':300},
    map{"a":50, "c":300},
    -- Non-numeric values
    map{1:'2024-01-03', 3:'2024-01-04'}, map{1:'2024-01-01 12:00:00', 3:'2024-01-01 13:00:00'},
    map{1:"c", 3:"d"}
);
-- result:
-- !result
select sum_map(m_ti_ti)[1], sum_map(m_ti_ti)[2], sum_map(m_ti_ti)[3] from t11_type_matrix;
-- result:
15	20	30
-- !result
select sum_map(m_ti_si)[1], sum_map(m_ti_si)[2], sum_map(m_ti_si)[3] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_ti_i)[1], sum_map(m_ti_i)[2], sum_map(m_ti_i)[3] from t11_type_matrix;
-- result:
1500	2000	3000
-- !result
select sum_map(m_ti_bi)[1], sum_map(m_ti_bi)[2], sum_map(m_ti_bi)[3] from t11_type_matrix;
-- result:
15000	20000	30000
-- !result
select sum_map(m_ti_li)[1], sum_map(m_ti_li)[2], sum_map(m_ti_li)[3] from t11_type_matrix;
-- result:
150000	200000	300000
-- !result
select sum_map(m_ti_f)[1], sum_map(m_ti_f)[2], sum_map(m_ti_f)[3] from t11_type_matrix;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_ti_d)[1], sum_map(m_ti_d)[2], sum_map(m_ti_d)[3] from t11_type_matrix;
-- result:
16.0	20.5	30.5
-- !result
select sum_map(m_si_ti)[1], sum_map(m_si_ti)[2], sum_map(m_si_ti)[3] from t11_type_matrix;
-- result:
15	20	30
-- !result
select sum_map(m_si_si)[1], sum_map(m_si_si)[2], sum_map(m_si_si)[3] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_si_i)[1], sum_map(m_si_i)[2], sum_map(m_si_i)[3] from t11_type_matrix;
-- result:
1500	2000	3000
-- !result
select sum_map(m_si_bi)[1], sum_map(m_si_bi)[2], sum_map(m_si_bi)[3] from t11_type_matrix;
-- result:
15000	20000	30000
-- !result
select sum_map(m_si_li)[1], sum_map(m_si_li)[2], sum_map(m_si_li)[3] from t11_type_matrix;
-- result:
150000	200000	300000
-- !result
select sum_map(m_si_f)[1], sum_map(m_si_f)[2], sum_map(m_si_f)[3] from t11_type_matrix;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_si_d)[1], sum_map(m_si_d)[2], sum_map(m_si_d)[3] from t11_type_matrix;
-- result:
16.0	20.5	30.5
-- !result
select sum_map(m_i_ti)[1], sum_map(m_i_ti)[2], sum_map(m_i_ti)[3] from t11_type_matrix;
-- result:
15	20	30
-- !result
select sum_map(m_i_si)[1], sum_map(m_i_si)[2], sum_map(m_i_si)[3] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_i_i)[1], sum_map(m_i_i)[2], sum_map(m_i_i)[3] from t11_type_matrix;
-- result:
1500	2000	3000
-- !result
select sum_map(m_i_bi)[1], sum_map(m_i_bi)[2], sum_map(m_i_bi)[3] from t11_type_matrix;
-- result:
15000	20000	30000
-- !result
select sum_map(m_i_li)[1], sum_map(m_i_li)[2], sum_map(m_i_li)[3] from t11_type_matrix;
-- result:
150000	200000	300000
-- !result
select sum_map(m_i_f)[1], sum_map(m_i_f)[2], sum_map(m_i_f)[3] from t11_type_matrix;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_i_d)[1], sum_map(m_i_d)[2], sum_map(m_i_d)[3] from t11_type_matrix;
-- result:
16.0	20.5	30.5
-- !result
select sum_map(m_bi_ti)[1], sum_map(m_bi_ti)[2], sum_map(m_bi_ti)[3] from t11_type_matrix;
-- result:
15	20	30
-- !result
select sum_map(m_bi_si)[1], sum_map(m_bi_si)[2], sum_map(m_bi_si)[3] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_bi_i)[1], sum_map(m_bi_i)[2], sum_map(m_bi_i)[3] from t11_type_matrix;
-- result:
1500	2000	3000
-- !result
select sum_map(m_bi_bi)[1], sum_map(m_bi_bi)[2], sum_map(m_bi_bi)[3] from t11_type_matrix;
-- result:
15000	20000	30000
-- !result
select sum_map(m_bi_li)[1], sum_map(m_bi_li)[2], sum_map(m_bi_li)[3] from t11_type_matrix;
-- result:
150000	200000	300000
-- !result
select sum_map(m_bi_f)[1], sum_map(m_bi_f)[2], sum_map(m_bi_f)[3] from t11_type_matrix;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_bi_d)[1], sum_map(m_bi_d)[2], sum_map(m_bi_d)[3] from t11_type_matrix;
-- result:
16.0	20.5	30.5
-- !result
select sum_map(m_li_ti)[1], sum_map(m_li_ti)[2], sum_map(m_li_ti)[3] from t11_type_matrix;
-- result:
15	20	30
-- !result
select sum_map(m_li_si)[1], sum_map(m_li_si)[2], sum_map(m_li_si)[3] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_li_i)[1], sum_map(m_li_i)[2], sum_map(m_li_i)[3] from t11_type_matrix;
-- result:
1500	2000	3000
-- !result
select sum_map(m_li_bi)[1], sum_map(m_li_bi)[2], sum_map(m_li_bi)[3] from t11_type_matrix;
-- result:
15000	20000	30000
-- !result
select sum_map(m_li_li)[1], sum_map(m_li_li)[2], sum_map(m_li_li)[3] from t11_type_matrix;
-- result:
150000	200000	300000
-- !result
select sum_map(m_li_f)[1], sum_map(m_li_f)[2], sum_map(m_li_f)[3] from t11_type_matrix;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_li_d)[1], sum_map(m_li_d)[2], sum_map(m_li_d)[3] from t11_type_matrix;
-- result:
16.0	20.5	30.5
-- !result
select sum_map(m_f_ti)[1.0], sum_map(m_f_ti)[2.0], sum_map(m_f_ti)[3.0] from t11_type_matrix;
-- result:
15	20	30
-- !result
select sum_map(m_f_si)[1.0], sum_map(m_f_si)[2.0], sum_map(m_f_si)[3.0] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_f_i)[1.0], sum_map(m_f_i)[2.0], sum_map(m_f_i)[3.0] from t11_type_matrix;
-- result:
1500	2000	3000
-- !result
select sum_map(m_f_bi)[1.0], sum_map(m_f_bi)[2.0], sum_map(m_f_bi)[3.0] from t11_type_matrix;
-- result:
15000	20000	30000
-- !result
select sum_map(m_f_li)[1.0], sum_map(m_f_li)[2.0], sum_map(m_f_li)[3.0] from t11_type_matrix;
-- result:
150000	200000	300000
-- !result
select sum_map(m_f_f)[1.0], sum_map(m_f_f)[2.0], sum_map(m_f_f)[3.0] from t11_type_matrix;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_f_d)[1.0], sum_map(m_f_d)[2.0], sum_map(m_f_d)[3.0] from t11_type_matrix;
-- result:
16.0	20.5	30.5
-- !result
select sum_map(m_d_ti)[1.0], sum_map(m_d_ti)[2.0], sum_map(m_d_ti)[3.0] from t11_type_matrix;
-- result:
15	20	30
-- !result
select sum_map(m_d_si)[1.0], sum_map(m_d_si)[2.0], sum_map(m_d_si)[3.0] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_d_i)[1.0], sum_map(m_d_i)[2.0], sum_map(m_d_i)[3.0] from t11_type_matrix;
-- result:
1500	2000	3000
-- !result
select sum_map(m_d_bi)[1.0], sum_map(m_d_bi)[2.0], sum_map(m_d_bi)[3.0] from t11_type_matrix;
-- result:
15000	20000	30000
-- !result
select sum_map(m_d_li)[1.0], sum_map(m_d_li)[2.0], sum_map(m_d_li)[3.0] from t11_type_matrix;
-- result:
150000	200000	300000
-- !result
select sum_map(m_d_f)[1.0], sum_map(m_d_f)[2.0], sum_map(m_d_f)[3.0] from t11_type_matrix;
-- result:
2.0	2.5	3.5
-- !result
select sum_map(m_d_d)[1.0], sum_map(m_d_d)[2.0], sum_map(m_d_d)[3.0] from t11_type_matrix;
-- result:
16.0	20.5	30.5
-- !result
select sum_map(m_date_i)['2024-01-01'], sum_map(m_date_i)['2024-01-02'], sum_map(m_date_i)['2024-01-03'] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_dt_i)['2024-01-01 10:00:00'], sum_map(m_dt_i)['2024-01-01 11:00:00'], sum_map(m_dt_i)['2024-01-01 12:00:00'] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_str_i)["a"], sum_map(m_str_i)["b"], sum_map(m_str_i)["c"] from t11_type_matrix;
-- result:
150	200	300
-- !result
select sum_map(m_i_date) from t11_type_matrix;
-- result:
[REGEX].*unsupported value type:DATE.*
-- !result
select sum_map(m_i_dt) from t11_type_matrix;
-- result:
[REGEX].*unsupported value type:DATETIME.*
-- !result
select sum_map(m_i_str) from t11_type_matrix;
-- result:
[REGEX].*unsupported value type:VARCHAR.*
-- !result