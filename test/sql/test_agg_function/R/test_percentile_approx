-- name: test_percentile_approx 
CREATE TABLE t1 (
    c1 int,
    c2 double
    )
DUPLICATE KEY(c1)
DISTRIBUTED BY HASH(c1)
BUCKETS 1
PROPERTIES ("replication_num" = "1");
-- result:
-- !result
insert into t1 select generate_series, generate_series from table(generate_series(1, 1000));
-- result:
-- !result
set pipeline_dop=1;
-- result:
-- !result
select percentile_approx(c2, 0.5) from t1;
-- result:
500.5
-- !result
with tt as (select @v1 as v1, c1, c2 from t1) select /*+ set_user_variable(@v1 = 0.5) */ percentile_approx(c2, v1) from tt;
-- result:
500.5
-- !result
with tt as (select @v1 as v1, @v2 as v2, c1, c2 from t1) select /*+ set_user_variable(@v1= 0.5, @v2 = 4096) */ percentile_approx(c2, v1, v2 + 1) from tt;
-- result:
500.5
-- !result