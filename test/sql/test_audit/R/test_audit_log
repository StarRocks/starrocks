-- name: test_audit_log
CREATE TABLE `t_audit_log` (
  `v1` int(11) NOT NULL,
  `v2` int(11) NOT NULL,
  `v3` int(11) NOT NULL
) ENGINE=OLAP
DUPLICATE KEY(`v1`)
DISTRIBUTED BY HASH(`v1`) BUCKETS 10
PROPERTIES (
 "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `t_audit_log` (v1, v2, v3) values
    (1, 1, 1),
    (1, 1, 2),
    (1, 1, 3);
-- result:
-- !result
SELECT COUNT(*) FROM t_audit_log;
-- result:
3
-- !result
shell: if [ $(cat ${root_path}/../output/fe/log/fe.audit.* | grep -F "${db[0]}" | grep -F 'SELECT COUNT(*) FROM t_audit_log' | grep -E '|CpuCostNs=([0-9]*)|' -o | awk -F '=' '{print $2}' | tail -n 1) -gt 0 ]; then echo "Find audit log"; else echo "Can't find audit log"; fi
-- result:
0
Find audit log
-- !result
INSERT INTO t_audit_log SELECT * FROM t_audit_log;
-- result:
-- !result
shell: if [ $(cat ${root_path}/../output/fe/log/fe.audit.* | grep -F "${db[0]}" | grep -F 't_audit_log' | grep -E '|CpuCostNs=([0-9]*)|' -o | awk -F '=' '{print $2}' | tail -n 1) -gt 0 ]; then echo "Find audit log"; else echo "Can't find audit log"; fi
-- result:
0
Find audit log
-- !result