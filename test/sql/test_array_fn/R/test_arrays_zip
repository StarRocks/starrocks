-- name: test_arrays_zip @mac
SELECT arrays_zip([1, 2], ['1b', '2b']) AS result;
-- result:
[{"col1":1,"col2":"1b"},{"col1":2,"col2":"2b"}]
-- !result
SELECT arrays_zip([1, 2], ['1b', null, '3b']) AS result;
-- result:
[{"col1":1,"col2":"1b"},{"col1":2,"col2":null},{"col1":null,"col2":"3b"}]
-- !result
SELECT arrays_zip([1, 2, 3], ['a', 'b', 'c'], [10, 20, 30]) AS result;
-- result:
[{"col1":1,"col2":"a","col3":10},{"col1":2,"col2":"b","col3":20},{"col1":3,"col2":"c","col3":30}]
-- !result
SELECT arrays_zip([], []) AS result;
-- result:
[]
-- !result
SELECT arrays_zip([1, 2, 3]) AS result;
-- result:
[{"col1":1},{"col1":2},{"col1":3}]
-- !result
SELECT arrays_zip(null, [1, 2]) AS result;
-- result:
None
-- !result
SELECT arrays_zip([1, null, 3], ['a', 'b', null]) AS result;
-- result:
[{"col1":1,"col2":"a"},{"col1":null,"col2":"b"},{"col1":3,"col2":null}]
-- !result
SELECT * FROM (SELECT 1 AS id) a WHERE a.id = 1 AND arrays_zip([1], ['a']) IS NOT NULL;
-- result:
1
-- !result
CREATE TABLE arrays_zip_test (
  pk bigint not null,
  int_array Array<BigInt>,
  str_array Array<String>,
  double_array Array<Double>,
  null_array Array<String>,
  mixed_null_array Array<BigInt>,
  empty_array Array<String>,
  single_element_array Array<BigInt>,
  large_array Array<String>,
  decimal_array Array<DECIMAL(10, 2)>
) ENGINE=OLAP
DUPLICATE KEY(`pk`)
DISTRIBUTED BY HASH(`pk`) BUCKETS 3
PROPERTIES (
  "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO arrays_zip_test VALUES
  (1, [1, 2, 3], ['a', 'b', 'c'], [1.1, 2.2, 3.3], NULL, [1, 2, 3], [], [100], ['x1', 'x2', 'x3'], [10.50, 20.75, 30.25]),
  (2, [10, 20], ['hello', 'world'], [10.5, 20.5], NULL, [10, null, 30], [], [200], ['y1', 'y2'], [100.00, 200.00]),
  (3, [100], ['single'], [99.9], NULL, [null, null], [], [300], ['single_element'], [999.99]),
  (4, [], [], [], NULL, [], [], [], [], []),
  (5, [1, 2, 3, 4, 5], ['a', 'b', 'c', 'd', 'e'], [1.1, 2.2, 3.3, 4.4, 5.5], NULL, [1, 2, 3, 4, 5], [], [400], ['a', 'b', 'c', 'd', 'e', 'f'], [1.11, 2.22, 3.33, 4.44, 5.55]),
  (6, [null, null, null], [null, null, null], [null, null, null], NULL, [null, null, null], [], [500], [null, null, null], [null, null, null]),
  (7, [1, null, 3, null, 5], ['x', null, 'z', null, 'w'], [1.1, null, 3.3, null, 5.5], NULL, [1, null, 3, null, 5], [], [600], ['p', null, 'r', null, 't'], [11.11, null, 33.33, null, 55.55]),
  (8, [999, 888, 777, 666, 555, 444, 333, 222, 111, 0], ['z', 'y', 'x', 'w', 'v', 'u', 't', 's', 'r', 'q'], [99.9, 88.8, 77.7, 66.6, 55.5, 44.4, 33.3, 22.2, 11.1, 0.0], NULL, [9, 8, 7, 6, 5, 4, 3, 2, 1, 0], [], [700], ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j'], [9.90, 8.80, 7.70, 6.60, 5.50, 4.40, 3.30, 2.20, 1.10, 0.00]),
  (9, [1], ['one'], [1.0], NULL, [1], [], [800], ['one'], [1.00]),
  (10, [2, 4, 6, 8, 10, 12], ['two', 'four', 'six', 'eight', 'ten', 'twelve'], [2.0, 4.0, 6.0, 8.0, 10.0, 12.0], NULL, [2, 4, 6, 8, 10, 12], [], [900], ['even1', 'even2', 'even3', 'even4', 'even5', 'even6'], [2.00, 4.00, 6.00, 8.00, 10.00, 12.00]),
  (11, [3, 6, 9, 12, 15], ['three', 'six', 'nine', 'twelve', 'fifteen'], [3.0, 6.0, 9.0, 12.0, 15.0], NULL, [3, 6, 9, 12, 15], [], [1000], ['odd1', 'odd2', 'odd3', 'odd4', 'odd5'], [3.00, 6.00, 9.00, 12.00, 15.00]),
  (12, [null], [null], [null], NULL, [null], [], [1100], [null], [null]),
  (13, [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200], ['a1', 'b1', 'c1', 'd1', 'e1', 'f1', 'g1', 'h1', 'i1', 'j1', 'k1', 'l1'], [100.1, 200.2, 300.3, 400.4, 500.5, 600.6, 700.7, 800.8, 900.9, 1000.1, 1100.2, 1200.3], NULL, [100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200], [], [1200], ['long1', 'long2', 'long3', 'long4', 'long5', 'long6', 'long7', 'long8', 'long9', 'long10', 'long11', 'long12'], [100.10, 200.20, 300.30, 400.40, 500.50, 600.60, 700.70, 800.80, 900.90, 1000.10, 1100.20, 1200.30]),
  (14, [-1, -2, -3], ['neg_a', 'neg_b', 'neg_c'], [-1.5, -2.5, -3.5], NULL, [-1, -2, -3], [], [1300], ['neg1', 'neg2', 'neg3'], [-1.50, -2.50, -3.50]),
  (15, [1, 2], ['short', 'array'], [1.0, 2.0], NULL, [1, 2], [], [1400], ['a', 'b'], [1.00, 2.00]),
  (16, [0, 0, 0], ['zero', 'zero', 'zero'], [0.0, 0.0, 0.0], NULL, [0, 0, 0], [], [1500], ['z1', 'z2', 'z3'], [0.00, 0.00, 0.00]),
  (17, [111, 222, 333, 444, 555], ['str_111', 'str_222', 'str_333', 'str_444', 'str_555'], [111.1, 222.2, 333.3, 444.4, 555.5], NULL, [111, 222, 333, 444, 555], [], [1600], ['s1', 's2', 's3', 's4', 's5'], [111.11, 222.22, 333.33, 444.44, 555.55]),
  (18, [1, 1, 1], ['dup', 'dup', 'dup'], [1.1, 1.1, 1.1], NULL, [1, 1, 1], [], [1700], ['d1', 'd2', 'd3'], [1.11, 1.11, 1.11]),
  (19, [7, 8, 9, 10, 11, 12, 13, 14, 15], ['seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen'], [7.7, 8.8, 9.9, 10.1, 11.1, 12.1, 13.1, 14.1, 15.1], NULL, [7, 8, 9, 10, 11, 12, 13, 14, 15], [], [1800], ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9'], [7.70, 8.80, 9.90, 10.10, 11.10, 12.10, 13.10, 14.10, 15.10]),
  (20, [42], ['answer'], [42.0], NULL, [42], [], [1900], ['fortytwo'], [42.00]);
-- result:
-- !result
SELECT pk, arrays_zip(int_array, str_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":1,"col2":"a"},{"col1":2,"col2":"b"},{"col1":3,"col2":"c"}]
2	[{"col1":10,"col2":"hello"},{"col1":20,"col2":"world"}]
3	[{"col1":100,"col2":"single"}]
4	[]
5	[{"col1":1,"col2":"a"},{"col1":2,"col2":"b"},{"col1":3,"col2":"c"},{"col1":4,"col2":"d"},{"col1":5,"col2":"e"}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":1,"col2":"x"},{"col1":null,"col2":null},{"col1":3,"col2":"z"},{"col1":null,"col2":null},{"col1":5,"col2":"w"}]
8	[{"col1":999,"col2":"z"},{"col1":888,"col2":"y"},{"col1":777,"col2":"x"},{"col1":666,"col2":"w"},{"col1":555,"col2":"v"},{"col1":444,"col2":"u"},{"col1":333,"col2":"t"},{"col1":222,"col2":"s"},{"col1":111,"col2":"r"},{"col1":0,"col2":"q"}]
9	[{"col1":1,"col2":"one"}]
10	[{"col1":2,"col2":"two"},{"col1":4,"col2":"four"},{"col1":6,"col2":"six"},{"col1":8,"col2":"eight"},{"col1":10,"col2":"ten"},{"col1":12,"col2":"twelve"}]
11	[{"col1":3,"col2":"three"},{"col1":6,"col2":"six"},{"col1":9,"col2":"nine"},{"col1":12,"col2":"twelve"},{"col1":15,"col2":"fifteen"}]
12	[{"col1":null,"col2":null}]
13	[{"col1":100,"col2":"a1"},{"col1":200,"col2":"b1"},{"col1":300,"col2":"c1"},{"col1":400,"col2":"d1"},{"col1":500,"col2":"e1"},{"col1":600,"col2":"f1"},{"col1":700,"col2":"g1"},{"col1":800,"col2":"h1"},{"col1":900,"col2":"i1"},{"col1":1000,"col2":"j1"},{"col1":1100,"col2":"k1"},{"col1":1200,"col2":"l1"}]
14	[{"col1":-1,"col2":"neg_a"},{"col1":-2,"col2":"neg_b"},{"col1":-3,"col2":"neg_c"}]
15	[{"col1":1,"col2":"short"},{"col1":2,"col2":"array"}]
16	[{"col1":0,"col2":"zero"},{"col1":0,"col2":"zero"},{"col1":0,"col2":"zero"}]
17	[{"col1":111,"col2":"str_111"},{"col1":222,"col2":"str_222"},{"col1":333,"col2":"str_333"},{"col1":444,"col2":"str_444"},{"col1":555,"col2":"str_555"}]
18	[{"col1":1,"col2":"dup"},{"col1":1,"col2":"dup"},{"col1":1,"col2":"dup"}]
19	[{"col1":7,"col2":"seven"},{"col1":8,"col2":"eight"},{"col1":9,"col2":"nine"},{"col1":10,"col2":"ten"},{"col1":11,"col2":"eleven"},{"col1":12,"col2":"twelve"},{"col1":13,"col2":"thirteen"},{"col1":14,"col2":"fourteen"},{"col1":15,"col2":"fifteen"}]
20	[{"col1":42,"col2":"answer"}]
-- !result
SELECT pk, arrays_zip(int_array, str_array, double_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":1,"col2":"a","col3":1.1},{"col1":2,"col2":"b","col3":2.2},{"col1":3,"col2":"c","col3":3.3}]
2	[{"col1":10,"col2":"hello","col3":10.5},{"col1":20,"col2":"world","col3":20.5}]
3	[{"col1":100,"col2":"single","col3":99.9}]
4	[]
5	[{"col1":1,"col2":"a","col3":1.1},{"col1":2,"col2":"b","col3":2.2},{"col1":3,"col2":"c","col3":3.3},{"col1":4,"col2":"d","col3":4.4},{"col1":5,"col2":"e","col3":5.5}]
6	[{"col1":null,"col2":null,"col3":null},{"col1":null,"col2":null,"col3":null},{"col1":null,"col2":null,"col3":null}]
7	[{"col1":1,"col2":"x","col3":1.1},{"col1":null,"col2":null,"col3":null},{"col1":3,"col2":"z","col3":3.3},{"col1":null,"col2":null,"col3":null},{"col1":5,"col2":"w","col3":5.5}]
8	[{"col1":999,"col2":"z","col3":99.9},{"col1":888,"col2":"y","col3":88.8},{"col1":777,"col2":"x","col3":77.7},{"col1":666,"col2":"w","col3":66.6},{"col1":555,"col2":"v","col3":55.5},{"col1":444,"col2":"u","col3":44.4},{"col1":333,"col2":"t","col3":33.3},{"col1":222,"col2":"s","col3":22.2},{"col1":111,"col2":"r","col3":11.1},{"col1":0,"col2":"q","col3":0}]
9	[{"col1":1,"col2":"one","col3":1}]
10	[{"col1":2,"col2":"two","col3":2},{"col1":4,"col2":"four","col3":4},{"col1":6,"col2":"six","col3":6},{"col1":8,"col2":"eight","col3":8},{"col1":10,"col2":"ten","col3":10},{"col1":12,"col2":"twelve","col3":12}]
11	[{"col1":3,"col2":"three","col3":3},{"col1":6,"col2":"six","col3":6},{"col1":9,"col2":"nine","col3":9},{"col1":12,"col2":"twelve","col3":12},{"col1":15,"col2":"fifteen","col3":15}]
12	[{"col1":null,"col2":null,"col3":null}]
13	[{"col1":100,"col2":"a1","col3":100.1},{"col1":200,"col2":"b1","col3":200.2},{"col1":300,"col2":"c1","col3":300.3},{"col1":400,"col2":"d1","col3":400.4},{"col1":500,"col2":"e1","col3":500.5},{"col1":600,"col2":"f1","col3":600.6},{"col1":700,"col2":"g1","col3":700.7},{"col1":800,"col2":"h1","col3":800.8},{"col1":900,"col2":"i1","col3":900.9},{"col1":1000,"col2":"j1","col3":1000.1},{"col1":1100,"col2":"k1","col3":1100.2},{"col1":1200,"col2":"l1","col3":1200.3}]
14	[{"col1":-1,"col2":"neg_a","col3":-1.5},{"col1":-2,"col2":"neg_b","col3":-2.5},{"col1":-3,"col2":"neg_c","col3":-3.5}]
15	[{"col1":1,"col2":"short","col3":1},{"col1":2,"col2":"array","col3":2}]
16	[{"col1":0,"col2":"zero","col3":0},{"col1":0,"col2":"zero","col3":0},{"col1":0,"col2":"zero","col3":0}]
17	[{"col1":111,"col2":"str_111","col3":111.1},{"col1":222,"col2":"str_222","col3":222.2},{"col1":333,"col2":"str_333","col3":333.3},{"col1":444,"col2":"str_444","col3":444.4},{"col1":555,"col2":"str_555","col3":555.5}]
18	[{"col1":1,"col2":"dup","col3":1.1},{"col1":1,"col2":"dup","col3":1.1},{"col1":1,"col2":"dup","col3":1.1}]
19	[{"col1":7,"col2":"seven","col3":7.7},{"col1":8,"col2":"eight","col3":8.8},{"col1":9,"col2":"nine","col3":9.9},{"col1":10,"col2":"ten","col3":10.1},{"col1":11,"col2":"eleven","col3":11.1},{"col1":12,"col2":"twelve","col3":12.1},{"col1":13,"col2":"thirteen","col3":13.1},{"col1":14,"col2":"fourteen","col3":14.1},{"col1":15,"col2":"fifteen","col3":15.1}]
20	[{"col1":42,"col2":"answer","col3":42}]
-- !result
SELECT pk, arrays_zip(null_array, int_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	None
2	None
3	None
4	None
5	None
6	None
7	None
8	None
9	None
10	None
11	None
12	None
13	None
14	None
15	None
16	None
17	None
18	None
19	None
20	None
-- !result
SELECT pk, arrays_zip(mixed_null_array, str_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":1,"col2":"a"},{"col1":2,"col2":"b"},{"col1":3,"col2":"c"}]
2	[{"col1":10,"col2":"hello"},{"col1":null,"col2":"world"},{"col1":30,"col2":null}]
3	[{"col1":null,"col2":"single"},{"col1":null,"col2":null}]
4	[]
5	[{"col1":1,"col2":"a"},{"col1":2,"col2":"b"},{"col1":3,"col2":"c"},{"col1":4,"col2":"d"},{"col1":5,"col2":"e"}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":1,"col2":"x"},{"col1":null,"col2":null},{"col1":3,"col2":"z"},{"col1":null,"col2":null},{"col1":5,"col2":"w"}]
8	[{"col1":9,"col2":"z"},{"col1":8,"col2":"y"},{"col1":7,"col2":"x"},{"col1":6,"col2":"w"},{"col1":5,"col2":"v"},{"col1":4,"col2":"u"},{"col1":3,"col2":"t"},{"col1":2,"col2":"s"},{"col1":1,"col2":"r"},{"col1":0,"col2":"q"}]
9	[{"col1":1,"col2":"one"}]
10	[{"col1":2,"col2":"two"},{"col1":4,"col2":"four"},{"col1":6,"col2":"six"},{"col1":8,"col2":"eight"},{"col1":10,"col2":"ten"},{"col1":12,"col2":"twelve"}]
11	[{"col1":3,"col2":"three"},{"col1":6,"col2":"six"},{"col1":9,"col2":"nine"},{"col1":12,"col2":"twelve"},{"col1":15,"col2":"fifteen"}]
12	[{"col1":null,"col2":null}]
13	[{"col1":100,"col2":"a1"},{"col1":200,"col2":"b1"},{"col1":300,"col2":"c1"},{"col1":400,"col2":"d1"},{"col1":500,"col2":"e1"},{"col1":600,"col2":"f1"},{"col1":700,"col2":"g1"},{"col1":800,"col2":"h1"},{"col1":900,"col2":"i1"},{"col1":1000,"col2":"j1"},{"col1":1100,"col2":"k1"},{"col1":1200,"col2":"l1"}]
14	[{"col1":-1,"col2":"neg_a"},{"col1":-2,"col2":"neg_b"},{"col1":-3,"col2":"neg_c"}]
15	[{"col1":1,"col2":"short"},{"col1":2,"col2":"array"}]
16	[{"col1":0,"col2":"zero"},{"col1":0,"col2":"zero"},{"col1":0,"col2":"zero"}]
17	[{"col1":111,"col2":"str_111"},{"col1":222,"col2":"str_222"},{"col1":333,"col2":"str_333"},{"col1":444,"col2":"str_444"},{"col1":555,"col2":"str_555"}]
18	[{"col1":1,"col2":"dup"},{"col1":1,"col2":"dup"},{"col1":1,"col2":"dup"}]
19	[{"col1":7,"col2":"seven"},{"col1":8,"col2":"eight"},{"col1":9,"col2":"nine"},{"col1":10,"col2":"ten"},{"col1":11,"col2":"eleven"},{"col1":12,"col2":"twelve"},{"col1":13,"col2":"thirteen"},{"col1":14,"col2":"fourteen"},{"col1":15,"col2":"fifteen"}]
20	[{"col1":42,"col2":"answer"}]
-- !result
SELECT pk, arrays_zip(empty_array, int_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":null,"col2":1},{"col1":null,"col2":2},{"col1":null,"col2":3}]
2	[{"col1":null,"col2":10},{"col1":null,"col2":20}]
3	[{"col1":null,"col2":100}]
4	[]
5	[{"col1":null,"col2":1},{"col1":null,"col2":2},{"col1":null,"col2":3},{"col1":null,"col2":4},{"col1":null,"col2":5}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":null,"col2":1},{"col1":null,"col2":null},{"col1":null,"col2":3},{"col1":null,"col2":null},{"col1":null,"col2":5}]
8	[{"col1":null,"col2":999},{"col1":null,"col2":888},{"col1":null,"col2":777},{"col1":null,"col2":666},{"col1":null,"col2":555},{"col1":null,"col2":444},{"col1":null,"col2":333},{"col1":null,"col2":222},{"col1":null,"col2":111},{"col1":null,"col2":0}]
9	[{"col1":null,"col2":1}]
10	[{"col1":null,"col2":2},{"col1":null,"col2":4},{"col1":null,"col2":6},{"col1":null,"col2":8},{"col1":null,"col2":10},{"col1":null,"col2":12}]
11	[{"col1":null,"col2":3},{"col1":null,"col2":6},{"col1":null,"col2":9},{"col1":null,"col2":12},{"col1":null,"col2":15}]
12	[{"col1":null,"col2":null}]
13	[{"col1":null,"col2":100},{"col1":null,"col2":200},{"col1":null,"col2":300},{"col1":null,"col2":400},{"col1":null,"col2":500},{"col1":null,"col2":600},{"col1":null,"col2":700},{"col1":null,"col2":800},{"col1":null,"col2":900},{"col1":null,"col2":1000},{"col1":null,"col2":1100},{"col1":null,"col2":1200}]
14	[{"col1":null,"col2":-1},{"col1":null,"col2":-2},{"col1":null,"col2":-3}]
15	[{"col1":null,"col2":1},{"col1":null,"col2":2}]
16	[{"col1":null,"col2":0},{"col1":null,"col2":0},{"col1":null,"col2":0}]
17	[{"col1":null,"col2":111},{"col1":null,"col2":222},{"col1":null,"col2":333},{"col1":null,"col2":444},{"col1":null,"col2":555}]
18	[{"col1":null,"col2":1},{"col1":null,"col2":1},{"col1":null,"col2":1}]
19	[{"col1":null,"col2":7},{"col1":null,"col2":8},{"col1":null,"col2":9},{"col1":null,"col2":10},{"col1":null,"col2":11},{"col1":null,"col2":12},{"col1":null,"col2":13},{"col1":null,"col2":14},{"col1":null,"col2":15}]
20	[{"col1":null,"col2":42}]
-- !result
SELECT pk, arrays_zip(single_element_array, str_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":100,"col2":"a"},{"col1":null,"col2":"b"},{"col1":null,"col2":"c"}]
2	[{"col1":200,"col2":"hello"},{"col1":null,"col2":"world"}]
3	[{"col1":300,"col2":"single"}]
4	[]
5	[{"col1":400,"col2":"a"},{"col1":null,"col2":"b"},{"col1":null,"col2":"c"},{"col1":null,"col2":"d"},{"col1":null,"col2":"e"}]
6	[{"col1":500,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":600,"col2":"x"},{"col1":null,"col2":null},{"col1":null,"col2":"z"},{"col1":null,"col2":null},{"col1":null,"col2":"w"}]
8	[{"col1":700,"col2":"z"},{"col1":null,"col2":"y"},{"col1":null,"col2":"x"},{"col1":null,"col2":"w"},{"col1":null,"col2":"v"},{"col1":null,"col2":"u"},{"col1":null,"col2":"t"},{"col1":null,"col2":"s"},{"col1":null,"col2":"r"},{"col1":null,"col2":"q"}]
9	[{"col1":800,"col2":"one"}]
10	[{"col1":900,"col2":"two"},{"col1":null,"col2":"four"},{"col1":null,"col2":"six"},{"col1":null,"col2":"eight"},{"col1":null,"col2":"ten"},{"col1":null,"col2":"twelve"}]
11	[{"col1":1000,"col2":"three"},{"col1":null,"col2":"six"},{"col1":null,"col2":"nine"},{"col1":null,"col2":"twelve"},{"col1":null,"col2":"fifteen"}]
12	[{"col1":1100,"col2":null}]
13	[{"col1":1200,"col2":"a1"},{"col1":null,"col2":"b1"},{"col1":null,"col2":"c1"},{"col1":null,"col2":"d1"},{"col1":null,"col2":"e1"},{"col1":null,"col2":"f1"},{"col1":null,"col2":"g1"},{"col1":null,"col2":"h1"},{"col1":null,"col2":"i1"},{"col1":null,"col2":"j1"},{"col1":null,"col2":"k1"},{"col1":null,"col2":"l1"}]
14	[{"col1":1300,"col2":"neg_a"},{"col1":null,"col2":"neg_b"},{"col1":null,"col2":"neg_c"}]
15	[{"col1":1400,"col2":"short"},{"col1":null,"col2":"array"}]
16	[{"col1":1500,"col2":"zero"},{"col1":null,"col2":"zero"},{"col1":null,"col2":"zero"}]
17	[{"col1":1600,"col2":"str_111"},{"col1":null,"col2":"str_222"},{"col1":null,"col2":"str_333"},{"col1":null,"col2":"str_444"},{"col1":null,"col2":"str_555"}]
18	[{"col1":1700,"col2":"dup"},{"col1":null,"col2":"dup"},{"col1":null,"col2":"dup"}]
19	[{"col1":1800,"col2":"seven"},{"col1":null,"col2":"eight"},{"col1":null,"col2":"nine"},{"col1":null,"col2":"ten"},{"col1":null,"col2":"eleven"},{"col1":null,"col2":"twelve"},{"col1":null,"col2":"thirteen"},{"col1":null,"col2":"fourteen"},{"col1":null,"col2":"fifteen"}]
20	[{"col1":1900,"col2":"answer"}]
-- !result
SELECT pk, arrays_zip(large_array, double_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":"x1","col2":1.1},{"col1":"x2","col2":2.2},{"col1":"x3","col2":3.3}]
2	[{"col1":"y1","col2":10.5},{"col1":"y2","col2":20.5}]
3	[{"col1":"single_element","col2":99.9}]
4	[]
5	[{"col1":"a","col2":1.1},{"col1":"b","col2":2.2},{"col1":"c","col2":3.3},{"col1":"d","col2":4.4},{"col1":"e","col2":5.5},{"col1":"f","col2":null}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":"p","col2":1.1},{"col1":null,"col2":null},{"col1":"r","col2":3.3},{"col1":null,"col2":null},{"col1":"t","col2":5.5}]
8	[{"col1":"a","col2":99.9},{"col1":"b","col2":88.8},{"col1":"c","col2":77.7},{"col1":"d","col2":66.6},{"col1":"e","col2":55.5},{"col1":"f","col2":44.4},{"col1":"g","col2":33.3},{"col1":"h","col2":22.2},{"col1":"i","col2":11.1},{"col1":"j","col2":0}]
9	[{"col1":"one","col2":1}]
10	[{"col1":"even1","col2":2},{"col1":"even2","col2":4},{"col1":"even3","col2":6},{"col1":"even4","col2":8},{"col1":"even5","col2":10},{"col1":"even6","col2":12}]
11	[{"col1":"odd1","col2":3},{"col1":"odd2","col2":6},{"col1":"odd3","col2":9},{"col1":"odd4","col2":12},{"col1":"odd5","col2":15}]
12	[{"col1":null,"col2":null}]
13	[{"col1":"long1","col2":100.1},{"col1":"long2","col2":200.2},{"col1":"long3","col2":300.3},{"col1":"long4","col2":400.4},{"col1":"long5","col2":500.5},{"col1":"long6","col2":600.6},{"col1":"long7","col2":700.7},{"col1":"long8","col2":800.8},{"col1":"long9","col2":900.9},{"col1":"long10","col2":1000.1},{"col1":"long11","col2":1100.2},{"col1":"long12","col2":1200.3}]
14	[{"col1":"neg1","col2":-1.5},{"col1":"neg2","col2":-2.5},{"col1":"neg3","col2":-3.5}]
15	[{"col1":"a","col2":1},{"col1":"b","col2":2}]
16	[{"col1":"z1","col2":0},{"col1":"z2","col2":0},{"col1":"z3","col2":0}]
17	[{"col1":"s1","col2":111.1},{"col1":"s2","col2":222.2},{"col1":"s3","col2":333.3},{"col1":"s4","col2":444.4},{"col1":"s5","col2":555.5}]
18	[{"col1":"d1","col2":1.1},{"col1":"d2","col2":1.1},{"col1":"d3","col2":1.1}]
19	[{"col1":"n1","col2":7.7},{"col1":"n2","col2":8.8},{"col1":"n3","col2":9.9},{"col1":"n4","col2":10.1},{"col1":"n5","col2":11.1},{"col1":"n6","col2":12.1},{"col1":"n7","col2":13.1},{"col1":"n8","col2":14.1},{"col1":"n9","col2":15.1}]
20	[{"col1":"fortytwo","col2":42}]
-- !result
SELECT pk, arrays_zip(int_array, str_array, double_array, decimal_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":1,"col2":"a","col3":1.1,"col4":10.50},{"col1":2,"col2":"b","col3":2.2,"col4":20.75},{"col1":3,"col2":"c","col3":3.3,"col4":30.25}]
2	[{"col1":10,"col2":"hello","col3":10.5,"col4":100.00},{"col1":20,"col2":"world","col3":20.5,"col4":200.00}]
3	[{"col1":100,"col2":"single","col3":99.9,"col4":999.99}]
4	[]
5	[{"col1":1,"col2":"a","col3":1.1,"col4":1.11},{"col1":2,"col2":"b","col3":2.2,"col4":2.22},{"col1":3,"col2":"c","col3":3.3,"col4":3.33},{"col1":4,"col2":"d","col3":4.4,"col4":4.44},{"col1":5,"col2":"e","col3":5.5,"col4":5.55}]
6	[{"col1":null,"col2":null,"col3":null,"col4":null},{"col1":null,"col2":null,"col3":null,"col4":null},{"col1":null,"col2":null,"col3":null,"col4":null}]
7	[{"col1":1,"col2":"x","col3":1.1,"col4":11.11},{"col1":null,"col2":null,"col3":null,"col4":null},{"col1":3,"col2":"z","col3":3.3,"col4":33.33},{"col1":null,"col2":null,"col3":null,"col4":null},{"col1":5,"col2":"w","col3":5.5,"col4":55.55}]
8	[{"col1":999,"col2":"z","col3":99.9,"col4":9.90},{"col1":888,"col2":"y","col3":88.8,"col4":8.80},{"col1":777,"col2":"x","col3":77.7,"col4":7.70},{"col1":666,"col2":"w","col3":66.6,"col4":6.60},{"col1":555,"col2":"v","col3":55.5,"col4":5.50},{"col1":444,"col2":"u","col3":44.4,"col4":4.40},{"col1":333,"col2":"t","col3":33.3,"col4":3.30},{"col1":222,"col2":"s","col3":22.2,"col4":2.20},{"col1":111,"col2":"r","col3":11.1,"col4":1.10},{"col1":0,"col2":"q","col3":0,"col4":0.00}]
9	[{"col1":1,"col2":"one","col3":1,"col4":1.00}]
10	[{"col1":2,"col2":"two","col3":2,"col4":2.00},{"col1":4,"col2":"four","col3":4,"col4":4.00},{"col1":6,"col2":"six","col3":6,"col4":6.00},{"col1":8,"col2":"eight","col3":8,"col4":8.00},{"col1":10,"col2":"ten","col3":10,"col4":10.00},{"col1":12,"col2":"twelve","col3":12,"col4":12.00}]
11	[{"col1":3,"col2":"three","col3":3,"col4":3.00},{"col1":6,"col2":"six","col3":6,"col4":6.00},{"col1":9,"col2":"nine","col3":9,"col4":9.00},{"col1":12,"col2":"twelve","col3":12,"col4":12.00},{"col1":15,"col2":"fifteen","col3":15,"col4":15.00}]
12	[{"col1":null,"col2":null,"col3":null,"col4":null}]
13	[{"col1":100,"col2":"a1","col3":100.1,"col4":100.10},{"col1":200,"col2":"b1","col3":200.2,"col4":200.20},{"col1":300,"col2":"c1","col3":300.3,"col4":300.30},{"col1":400,"col2":"d1","col3":400.4,"col4":400.40},{"col1":500,"col2":"e1","col3":500.5,"col4":500.50},{"col1":600,"col2":"f1","col3":600.6,"col4":600.60},{"col1":700,"col2":"g1","col3":700.7,"col4":700.70},{"col1":800,"col2":"h1","col3":800.8,"col4":800.80},{"col1":900,"col2":"i1","col3":900.9,"col4":900.90},{"col1":1000,"col2":"j1","col3":1000.1,"col4":1000.10},{"col1":1100,"col2":"k1","col3":1100.2,"col4":1100.20},{"col1":1200,"col2":"l1","col3":1200.3,"col4":1200.30}]
14	[{"col1":-1,"col2":"neg_a","col3":-1.5,"col4":-1.50},{"col1":-2,"col2":"neg_b","col3":-2.5,"col4":-2.50},{"col1":-3,"col2":"neg_c","col3":-3.5,"col4":-3.50}]
15	[{"col1":1,"col2":"short","col3":1,"col4":1.00},{"col1":2,"col2":"array","col3":2,"col4":2.00}]
16	[{"col1":0,"col2":"zero","col3":0,"col4":0.00},{"col1":0,"col2":"zero","col3":0,"col4":0.00},{"col1":0,"col2":"zero","col3":0,"col4":0.00}]
17	[{"col1":111,"col2":"str_111","col3":111.1,"col4":111.11},{"col1":222,"col2":"str_222","col3":222.2,"col4":222.22},{"col1":333,"col2":"str_333","col3":333.3,"col4":333.33},{"col1":444,"col2":"str_444","col3":444.4,"col4":444.44},{"col1":555,"col2":"str_555","col3":555.5,"col4":555.55}]
18	[{"col1":1,"col2":"dup","col3":1.1,"col4":1.11},{"col1":1,"col2":"dup","col3":1.1,"col4":1.11},{"col1":1,"col2":"dup","col3":1.1,"col4":1.11}]
19	[{"col1":7,"col2":"seven","col3":7.7,"col4":7.70},{"col1":8,"col2":"eight","col3":8.8,"col4":8.80},{"col1":9,"col2":"nine","col3":9.9,"col4":9.90},{"col1":10,"col2":"ten","col3":10.1,"col4":10.10},{"col1":11,"col2":"eleven","col3":11.1,"col4":11.10},{"col1":12,"col2":"twelve","col3":12.1,"col4":12.10},{"col1":13,"col2":"thirteen","col3":13.1,"col4":13.10},{"col1":14,"col2":"fourteen","col3":14.1,"col4":14.10},{"col1":15,"col2":"fifteen","col3":15.1,"col4":15.10}]
20	[{"col1":42,"col2":"answer","col3":42,"col4":42.00}]
-- !result
SELECT pk, arrays_zip(int_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":1},{"col1":2},{"col1":3}]
2	[{"col1":10},{"col1":20}]
3	[{"col1":100}]
4	[]
5	[{"col1":1},{"col1":2},{"col1":3},{"col1":4},{"col1":5}]
6	[{"col1":null},{"col1":null},{"col1":null}]
7	[{"col1":1},{"col1":null},{"col1":3},{"col1":null},{"col1":5}]
8	[{"col1":999},{"col1":888},{"col1":777},{"col1":666},{"col1":555},{"col1":444},{"col1":333},{"col1":222},{"col1":111},{"col1":0}]
9	[{"col1":1}]
10	[{"col1":2},{"col1":4},{"col1":6},{"col1":8},{"col1":10},{"col1":12}]
11	[{"col1":3},{"col1":6},{"col1":9},{"col1":12},{"col1":15}]
12	[{"col1":null}]
13	[{"col1":100},{"col1":200},{"col1":300},{"col1":400},{"col1":500},{"col1":600},{"col1":700},{"col1":800},{"col1":900},{"col1":1000},{"col1":1100},{"col1":1200}]
14	[{"col1":-1},{"col1":-2},{"col1":-3}]
15	[{"col1":1},{"col1":2}]
16	[{"col1":0},{"col1":0},{"col1":0}]
17	[{"col1":111},{"col1":222},{"col1":333},{"col1":444},{"col1":555}]
18	[{"col1":1},{"col1":1},{"col1":1}]
19	[{"col1":7},{"col1":8},{"col1":9},{"col1":10},{"col1":11},{"col1":12},{"col1":13},{"col1":14},{"col1":15}]
20	[{"col1":42}]
-- !result
SELECT pk FROM arrays_zip_test WHERE arrays_zip(int_array, str_array) IS NOT NULL ORDER BY pk;
-- result:
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
-- !result
SELECT pk FROM arrays_zip_test WHERE arrays_zip(null_array, str_array) IS NULL ORDER BY pk;
-- result:
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
-- !result
SELECT pk, arrays_zip(int_array, ['const1', 'const2', 'const3']) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":1,"col2":"const1"},{"col1":2,"col2":"const2"},{"col1":3,"col2":"const3"}]
2	[{"col1":10,"col2":"const1"},{"col1":20,"col2":"const2"},{"col1":null,"col2":"const3"}]
3	[{"col1":100,"col2":"const1"},{"col1":null,"col2":"const2"},{"col1":null,"col2":"const3"}]
4	[{"col1":null,"col2":"const1"},{"col1":null,"col2":"const2"},{"col1":null,"col2":"const3"}]
5	[{"col1":1,"col2":"const1"},{"col1":2,"col2":"const2"},{"col1":3,"col2":"const3"},{"col1":4,"col2":null},{"col1":5,"col2":null}]
6	[{"col1":null,"col2":"const1"},{"col1":null,"col2":"const2"},{"col1":null,"col2":"const3"}]
7	[{"col1":1,"col2":"const1"},{"col1":null,"col2":"const2"},{"col1":3,"col2":"const3"},{"col1":null,"col2":null},{"col1":5,"col2":null}]
8	[{"col1":999,"col2":"const1"},{"col1":888,"col2":"const2"},{"col1":777,"col2":"const3"},{"col1":666,"col2":null},{"col1":555,"col2":null},{"col1":444,"col2":null},{"col1":333,"col2":null},{"col1":222,"col2":null},{"col1":111,"col2":null},{"col1":0,"col2":null}]
9	[{"col1":1,"col2":"const1"},{"col1":null,"col2":"const2"},{"col1":null,"col2":"const3"}]
10	[{"col1":2,"col2":"const1"},{"col1":4,"col2":"const2"},{"col1":6,"col2":"const3"},{"col1":8,"col2":null},{"col1":10,"col2":null},{"col1":12,"col2":null}]
11	[{"col1":3,"col2":"const1"},{"col1":6,"col2":"const2"},{"col1":9,"col2":"const3"},{"col1":12,"col2":null},{"col1":15,"col2":null}]
12	[{"col1":null,"col2":"const1"},{"col1":null,"col2":"const2"},{"col1":null,"col2":"const3"}]
13	[{"col1":100,"col2":"const1"},{"col1":200,"col2":"const2"},{"col1":300,"col2":"const3"},{"col1":400,"col2":null},{"col1":500,"col2":null},{"col1":600,"col2":null},{"col1":700,"col2":null},{"col1":800,"col2":null},{"col1":900,"col2":null},{"col1":1000,"col2":null},{"col1":1100,"col2":null},{"col1":1200,"col2":null}]
14	[{"col1":-1,"col2":"const1"},{"col1":-2,"col2":"const2"},{"col1":-3,"col2":"const3"}]
15	[{"col1":1,"col2":"const1"},{"col1":2,"col2":"const2"},{"col1":null,"col2":"const3"}]
16	[{"col1":0,"col2":"const1"},{"col1":0,"col2":"const2"},{"col1":0,"col2":"const3"}]
17	[{"col1":111,"col2":"const1"},{"col1":222,"col2":"const2"},{"col1":333,"col2":"const3"},{"col1":444,"col2":null},{"col1":555,"col2":null}]
18	[{"col1":1,"col2":"const1"},{"col1":1,"col2":"const2"},{"col1":1,"col2":"const3"}]
19	[{"col1":7,"col2":"const1"},{"col1":8,"col2":"const2"},{"col1":9,"col2":"const3"},{"col1":10,"col2":null},{"col1":11,"col2":null},{"col1":12,"col2":null},{"col1":13,"col2":null},{"col1":14,"col2":null},{"col1":15,"col2":null}]
20	[{"col1":42,"col2":"const1"},{"col1":null,"col2":"const2"},{"col1":null,"col2":"const3"}]
-- !result
SELECT pk, arrays_zip(['const_a', 'const_b', 'const_c'], str_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":"const_a","col2":"a"},{"col1":"const_b","col2":"b"},{"col1":"const_c","col2":"c"}]
2	[{"col1":"const_a","col2":"hello"},{"col1":"const_b","col2":"world"},{"col1":"const_c","col2":null}]
3	[{"col1":"const_a","col2":"single"},{"col1":"const_b","col2":null},{"col1":"const_c","col2":null}]
4	[{"col1":"const_a","col2":null},{"col1":"const_b","col2":null},{"col1":"const_c","col2":null}]
5	[{"col1":"const_a","col2":"a"},{"col1":"const_b","col2":"b"},{"col1":"const_c","col2":"c"},{"col1":null,"col2":"d"},{"col1":null,"col2":"e"}]
6	[{"col1":"const_a","col2":null},{"col1":"const_b","col2":null},{"col1":"const_c","col2":null}]
7	[{"col1":"const_a","col2":"x"},{"col1":"const_b","col2":null},{"col1":"const_c","col2":"z"},{"col1":null,"col2":null},{"col1":null,"col2":"w"}]
8	[{"col1":"const_a","col2":"z"},{"col1":"const_b","col2":"y"},{"col1":"const_c","col2":"x"},{"col1":null,"col2":"w"},{"col1":null,"col2":"v"},{"col1":null,"col2":"u"},{"col1":null,"col2":"t"},{"col1":null,"col2":"s"},{"col1":null,"col2":"r"},{"col1":null,"col2":"q"}]
9	[{"col1":"const_a","col2":"one"},{"col1":"const_b","col2":null},{"col1":"const_c","col2":null}]
10	[{"col1":"const_a","col2":"two"},{"col1":"const_b","col2":"four"},{"col1":"const_c","col2":"six"},{"col1":null,"col2":"eight"},{"col1":null,"col2":"ten"},{"col1":null,"col2":"twelve"}]
11	[{"col1":"const_a","col2":"three"},{"col1":"const_b","col2":"six"},{"col1":"const_c","col2":"nine"},{"col1":null,"col2":"twelve"},{"col1":null,"col2":"fifteen"}]
12	[{"col1":"const_a","col2":null},{"col1":"const_b","col2":null},{"col1":"const_c","col2":null}]
13	[{"col1":"const_a","col2":"a1"},{"col1":"const_b","col2":"b1"},{"col1":"const_c","col2":"c1"},{"col1":null,"col2":"d1"},{"col1":null,"col2":"e1"},{"col1":null,"col2":"f1"},{"col1":null,"col2":"g1"},{"col1":null,"col2":"h1"},{"col1":null,"col2":"i1"},{"col1":null,"col2":"j1"},{"col1":null,"col2":"k1"},{"col1":null,"col2":"l1"}]
14	[{"col1":"const_a","col2":"neg_a"},{"col1":"const_b","col2":"neg_b"},{"col1":"const_c","col2":"neg_c"}]
15	[{"col1":"const_a","col2":"short"},{"col1":"const_b","col2":"array"},{"col1":"const_c","col2":null}]
16	[{"col1":"const_a","col2":"zero"},{"col1":"const_b","col2":"zero"},{"col1":"const_c","col2":"zero"}]
17	[{"col1":"const_a","col2":"str_111"},{"col1":"const_b","col2":"str_222"},{"col1":"const_c","col2":"str_333"},{"col1":null,"col2":"str_444"},{"col1":null,"col2":"str_555"}]
18	[{"col1":"const_a","col2":"dup"},{"col1":"const_b","col2":"dup"},{"col1":"const_c","col2":"dup"}]
19	[{"col1":"const_a","col2":"seven"},{"col1":"const_b","col2":"eight"},{"col1":"const_c","col2":"nine"},{"col1":null,"col2":"ten"},{"col1":null,"col2":"eleven"},{"col1":null,"col2":"twelve"},{"col1":null,"col2":"thirteen"},{"col1":null,"col2":"fourteen"},{"col1":null,"col2":"fifteen"}]
20	[{"col1":"const_a","col2":"answer"},{"col1":"const_b","col2":null},{"col1":"const_c","col2":null}]
-- !result
SELECT pk, arrays_zip(int_array, decimal_array) FROM arrays_zip_test ORDER BY pk;
-- result:
1	[{"col1":1,"col2":10.50},{"col1":2,"col2":20.75},{"col1":3,"col2":30.25}]
2	[{"col1":10,"col2":100.00},{"col1":20,"col2":200.00}]
3	[{"col1":100,"col2":999.99}]
4	[]
5	[{"col1":1,"col2":1.11},{"col1":2,"col2":2.22},{"col1":3,"col2":3.33},{"col1":4,"col2":4.44},{"col1":5,"col2":5.55}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":1,"col2":11.11},{"col1":null,"col2":null},{"col1":3,"col2":33.33},{"col1":null,"col2":null},{"col1":5,"col2":55.55}]
8	[{"col1":999,"col2":9.90},{"col1":888,"col2":8.80},{"col1":777,"col2":7.70},{"col1":666,"col2":6.60},{"col1":555,"col2":5.50},{"col1":444,"col2":4.40},{"col1":333,"col2":3.30},{"col1":222,"col2":2.20},{"col1":111,"col2":1.10},{"col1":0,"col2":0.00}]
9	[{"col1":1,"col2":1.00}]
10	[{"col1":2,"col2":2.00},{"col1":4,"col2":4.00},{"col1":6,"col2":6.00},{"col1":8,"col2":8.00},{"col1":10,"col2":10.00},{"col1":12,"col2":12.00}]
11	[{"col1":3,"col2":3.00},{"col1":6,"col2":6.00},{"col1":9,"col2":9.00},{"col1":12,"col2":12.00},{"col1":15,"col2":15.00}]
12	[{"col1":null,"col2":null}]
13	[{"col1":100,"col2":100.10},{"col1":200,"col2":200.20},{"col1":300,"col2":300.30},{"col1":400,"col2":400.40},{"col1":500,"col2":500.50},{"col1":600,"col2":600.60},{"col1":700,"col2":700.70},{"col1":800,"col2":800.80},{"col1":900,"col2":900.90},{"col1":1000,"col2":1000.10},{"col1":1100,"col2":1100.20},{"col1":1200,"col2":1200.30}]
14	[{"col1":-1,"col2":-1.50},{"col1":-2,"col2":-2.50},{"col1":-3,"col2":-3.50}]
15	[{"col1":1,"col2":1.00},{"col1":2,"col2":2.00}]
16	[{"col1":0,"col2":0.00},{"col1":0,"col2":0.00},{"col1":0,"col2":0.00}]
17	[{"col1":111,"col2":111.11},{"col1":222,"col2":222.22},{"col1":333,"col2":333.33},{"col1":444,"col2":444.44},{"col1":555,"col2":555.55}]
18	[{"col1":1,"col2":1.11},{"col1":1,"col2":1.11},{"col1":1,"col2":1.11}]
19	[{"col1":7,"col2":7.70},{"col1":8,"col2":8.80},{"col1":9,"col2":9.90},{"col1":10,"col2":10.10},{"col1":11,"col2":11.10},{"col1":12,"col2":12.10},{"col1":13,"col2":13.10},{"col1":14,"col2":14.10},{"col1":15,"col2":15.10}]
20	[{"col1":42,"col2":42.00}]
-- !result
SELECT pk, arrays_zip(int_array, str_array) AS zipped 
FROM arrays_zip_test 
WHERE pk > 5 AND pk <= 15
ORDER BY pk;
-- result:
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":1,"col2":"x"},{"col1":null,"col2":null},{"col1":3,"col2":"z"},{"col1":null,"col2":null},{"col1":5,"col2":"w"}]
8	[{"col1":999,"col2":"z"},{"col1":888,"col2":"y"},{"col1":777,"col2":"x"},{"col1":666,"col2":"w"},{"col1":555,"col2":"v"},{"col1":444,"col2":"u"},{"col1":333,"col2":"t"},{"col1":222,"col2":"s"},{"col1":111,"col2":"r"},{"col1":0,"col2":"q"}]
9	[{"col1":1,"col2":"one"}]
10	[{"col1":2,"col2":"two"},{"col1":4,"col2":"four"},{"col1":6,"col2":"six"},{"col1":8,"col2":"eight"},{"col1":10,"col2":"ten"},{"col1":12,"col2":"twelve"}]
11	[{"col1":3,"col2":"three"},{"col1":6,"col2":"six"},{"col1":9,"col2":"nine"},{"col1":12,"col2":"twelve"},{"col1":15,"col2":"fifteen"}]
12	[{"col1":null,"col2":null}]
13	[{"col1":100,"col2":"a1"},{"col1":200,"col2":"b1"},{"col1":300,"col2":"c1"},{"col1":400,"col2":"d1"},{"col1":500,"col2":"e1"},{"col1":600,"col2":"f1"},{"col1":700,"col2":"g1"},{"col1":800,"col2":"h1"},{"col1":900,"col2":"i1"},{"col1":1000,"col2":"j1"},{"col1":1100,"col2":"k1"},{"col1":1200,"col2":"l1"}]
14	[{"col1":-1,"col2":"neg_a"},{"col1":-2,"col2":"neg_b"},{"col1":-3,"col2":"neg_c"}]
15	[{"col1":1,"col2":"short"},{"col1":2,"col2":"array"}]
-- !result
SELECT pk, arrays_zip(str_array, double_array, decimal_array) 
FROM arrays_zip_test 
WHERE int_array IS NOT NULL
ORDER BY pk;
-- result:
1	[{"col1":"a","col2":1.1,"col3":10.50},{"col1":"b","col2":2.2,"col3":20.75},{"col1":"c","col2":3.3,"col3":30.25}]
2	[{"col1":"hello","col2":10.5,"col3":100.00},{"col1":"world","col2":20.5,"col3":200.00}]
3	[{"col1":"single","col2":99.9,"col3":999.99}]
4	[]
5	[{"col1":"a","col2":1.1,"col3":1.11},{"col1":"b","col2":2.2,"col3":2.22},{"col1":"c","col2":3.3,"col3":3.33},{"col1":"d","col2":4.4,"col3":4.44},{"col1":"e","col2":5.5,"col3":5.55}]
6	[{"col1":null,"col2":null,"col3":null},{"col1":null,"col2":null,"col3":null},{"col1":null,"col2":null,"col3":null}]
7	[{"col1":"x","col2":1.1,"col3":11.11},{"col1":null,"col2":null,"col3":null},{"col1":"z","col2":3.3,"col3":33.33},{"col1":null,"col2":null,"col3":null},{"col1":"w","col2":5.5,"col3":55.55}]
8	[{"col1":"z","col2":99.9,"col3":9.90},{"col1":"y","col2":88.8,"col3":8.80},{"col1":"x","col2":77.7,"col3":7.70},{"col1":"w","col2":66.6,"col3":6.60},{"col1":"v","col2":55.5,"col3":5.50},{"col1":"u","col2":44.4,"col3":4.40},{"col1":"t","col2":33.3,"col3":3.30},{"col1":"s","col2":22.2,"col3":2.20},{"col1":"r","col2":11.1,"col3":1.10},{"col1":"q","col2":0,"col3":0.00}]
9	[{"col1":"one","col2":1,"col3":1.00}]
10	[{"col1":"two","col2":2,"col3":2.00},{"col1":"four","col2":4,"col3":4.00},{"col1":"six","col2":6,"col3":6.00},{"col1":"eight","col2":8,"col3":8.00},{"col1":"ten","col2":10,"col3":10.00},{"col1":"twelve","col2":12,"col3":12.00}]
11	[{"col1":"three","col2":3,"col3":3.00},{"col1":"six","col2":6,"col3":6.00},{"col1":"nine","col2":9,"col3":9.00},{"col1":"twelve","col2":12,"col3":12.00},{"col1":"fifteen","col2":15,"col3":15.00}]
12	[{"col1":null,"col2":null,"col3":null}]
13	[{"col1":"a1","col2":100.1,"col3":100.10},{"col1":"b1","col2":200.2,"col3":200.20},{"col1":"c1","col2":300.3,"col3":300.30},{"col1":"d1","col2":400.4,"col3":400.40},{"col1":"e1","col2":500.5,"col3":500.50},{"col1":"f1","col2":600.6,"col3":600.60},{"col1":"g1","col2":700.7,"col3":700.70},{"col1":"h1","col2":800.8,"col3":800.80},{"col1":"i1","col2":900.9,"col3":900.90},{"col1":"j1","col2":1000.1,"col3":1000.10},{"col1":"k1","col2":1100.2,"col3":1100.20},{"col1":"l1","col2":1200.3,"col3":1200.30}]
14	[{"col1":"neg_a","col2":-1.5,"col3":-1.50},{"col1":"neg_b","col2":-2.5,"col3":-2.50},{"col1":"neg_c","col2":-3.5,"col3":-3.50}]
15	[{"col1":"short","col2":1,"col3":1.00},{"col1":"array","col2":2,"col3":2.00}]
16	[{"col1":"zero","col2":0,"col3":0.00},{"col1":"zero","col2":0,"col3":0.00},{"col1":"zero","col2":0,"col3":0.00}]
17	[{"col1":"str_111","col2":111.1,"col3":111.11},{"col1":"str_222","col2":222.2,"col3":222.22},{"col1":"str_333","col2":333.3,"col3":333.33},{"col1":"str_444","col2":444.4,"col3":444.44},{"col1":"str_555","col2":555.5,"col3":555.55}]
18	[{"col1":"dup","col2":1.1,"col3":1.11},{"col1":"dup","col2":1.1,"col3":1.11},{"col1":"dup","col2":1.1,"col3":1.11}]
19	[{"col1":"seven","col2":7.7,"col3":7.70},{"col1":"eight","col2":8.8,"col3":8.80},{"col1":"nine","col2":9.9,"col3":9.90},{"col1":"ten","col2":10.1,"col3":10.10},{"col1":"eleven","col2":11.1,"col3":11.10},{"col1":"twelve","col2":12.1,"col3":12.10},{"col1":"thirteen","col2":13.1,"col3":13.10},{"col1":"fourteen","col2":14.1,"col3":14.10},{"col1":"fifteen","col2":15.1,"col3":15.10}]
20	[{"col1":"answer","col2":42,"col3":42.00}]
-- !result
SELECT pk, int_array, str_array, arrays_zip(mixed_null_array, str_array, double_array) 
FROM arrays_zip_test 
WHERE pk IN (1, 6, 7, 12)
ORDER BY pk;
-- result:
1	[1,2,3]	["a","b","c"]	[{"col1":1,"col2":"a","col3":1.1},{"col1":2,"col2":"b","col3":2.2},{"col1":3,"col2":"c","col3":3.3}]
6	[null,null,null]	[null,null,null]	[{"col1":null,"col2":null,"col3":null},{"col1":null,"col2":null,"col3":null},{"col1":null,"col2":null,"col3":null}]
7	[1,null,3,null,5]	["x",null,"z",null,"w"]	[{"col1":1,"col2":"x","col3":1.1},{"col1":null,"col2":null,"col3":null},{"col1":3,"col2":"z","col3":3.3},{"col1":null,"col2":null,"col3":null},{"col1":5,"col2":"w","col3":5.5}]
12	[null]	[null]	[{"col1":null,"col2":null,"col3":null}]
-- !result
SELECT pk, 
  CASE 
    WHEN pk <= 5 THEN arrays_zip(int_array, str_array)
    WHEN pk <= 10 THEN arrays_zip(str_array, double_array)
    ELSE arrays_zip(double_array, decimal_array)
  END AS conditional_zip
FROM arrays_zip_test
ORDER BY pk;
-- result:
1	[{"col1":"1","col2":"a"},{"col1":"2","col2":"b"},{"col1":"3","col2":"c"}]
2	[{"col1":"10","col2":"hello"},{"col1":"20","col2":"world"}]
3	[{"col1":"100","col2":"single"}]
4	[]
5	[{"col1":"1","col2":"a"},{"col1":"2","col2":"b"},{"col1":"3","col2":"c"},{"col1":"4","col2":"d"},{"col1":"5","col2":"e"}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":"x","col2":"1.1"},{"col1":null,"col2":null},{"col1":"z","col2":"3.3"},{"col1":null,"col2":null},{"col1":"w","col2":"5.5"}]
8	[{"col1":"z","col2":"99.9"},{"col1":"y","col2":"88.8"},{"col1":"x","col2":"77.7"},{"col1":"w","col2":"66.6"},{"col1":"v","col2":"55.5"},{"col1":"u","col2":"44.4"},{"col1":"t","col2":"33.3"},{"col1":"s","col2":"22.2"},{"col1":"r","col2":"11.1"},{"col1":"q","col2":"0"}]
9	[{"col1":"one","col2":"1"}]
10	[{"col1":"two","col2":"2"},{"col1":"four","col2":"4"},{"col1":"six","col2":"6"},{"col1":"eight","col2":"8"},{"col1":"ten","col2":"10"},{"col1":"twelve","col2":"12"}]
11	[{"col1":"3","col2":"3.00"},{"col1":"6","col2":"6.00"},{"col1":"9","col2":"9.00"},{"col1":"12","col2":"12.00"},{"col1":"15","col2":"15.00"}]
12	[{"col1":null,"col2":null}]
13	[{"col1":"100.1","col2":"100.10"},{"col1":"200.2","col2":"200.20"},{"col1":"300.3","col2":"300.30"},{"col1":"400.4","col2":"400.40"},{"col1":"500.5","col2":"500.50"},{"col1":"600.6","col2":"600.60"},{"col1":"700.7","col2":"700.70"},{"col1":"800.8","col2":"800.80"},{"col1":"900.9","col2":"900.90"},{"col1":"1000.1","col2":"1000.10"},{"col1":"1100.2","col2":"1100.20"},{"col1":"1200.3","col2":"1200.30"}]
14	[{"col1":"-1.5","col2":"-1.50"},{"col1":"-2.5","col2":"-2.50"},{"col1":"-3.5","col2":"-3.50"}]
15	[{"col1":"1","col2":"1.00"},{"col1":"2","col2":"2.00"}]
16	[{"col1":"0","col2":"0.00"},{"col1":"0","col2":"0.00"},{"col1":"0","col2":"0.00"}]
17	[{"col1":"111.1","col2":"111.11"},{"col1":"222.2","col2":"222.22"},{"col1":"333.3","col2":"333.33"},{"col1":"444.4","col2":"444.44"},{"col1":"555.5","col2":"555.55"}]
18	[{"col1":"1.1","col2":"1.11"},{"col1":"1.1","col2":"1.11"},{"col1":"1.1","col2":"1.11"}]
19	[{"col1":"7.7","col2":"7.70"},{"col1":"8.8","col2":"8.80"},{"col1":"9.9","col2":"9.90"},{"col1":"10.1","col2":"10.10"},{"col1":"11.1","col2":"11.10"},{"col1":"12.1","col2":"12.10"},{"col1":"13.1","col2":"13.10"},{"col1":"14.1","col2":"14.10"},{"col1":"15.1","col2":"15.10"}]
20	[{"col1":"42","col2":"42.00"}]
-- !result
SELECT pk, arrays_zip(int_array, CASE WHEN pk > 10 THEN str_array ELSE empty_array END) 
FROM arrays_zip_test 
ORDER BY pk;
-- result:
1	[{"col1":1,"col2":null},{"col1":2,"col2":null},{"col1":3,"col2":null}]
2	[{"col1":10,"col2":null},{"col1":20,"col2":null}]
3	[{"col1":100,"col2":null}]
4	[]
5	[{"col1":1,"col2":null},{"col1":2,"col2":null},{"col1":3,"col2":null},{"col1":4,"col2":null},{"col1":5,"col2":null}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":1,"col2":null},{"col1":null,"col2":null},{"col1":3,"col2":null},{"col1":null,"col2":null},{"col1":5,"col2":null}]
8	[{"col1":999,"col2":null},{"col1":888,"col2":null},{"col1":777,"col2":null},{"col1":666,"col2":null},{"col1":555,"col2":null},{"col1":444,"col2":null},{"col1":333,"col2":null},{"col1":222,"col2":null},{"col1":111,"col2":null},{"col1":0,"col2":null}]
9	[{"col1":1,"col2":null}]
10	[{"col1":2,"col2":null},{"col1":4,"col2":null},{"col1":6,"col2":null},{"col1":8,"col2":null},{"col1":10,"col2":null},{"col1":12,"col2":null}]
11	[{"col1":3,"col2":"three"},{"col1":6,"col2":"six"},{"col1":9,"col2":"nine"},{"col1":12,"col2":"twelve"},{"col1":15,"col2":"fifteen"}]
12	[{"col1":null,"col2":null}]
13	[{"col1":100,"col2":"a1"},{"col1":200,"col2":"b1"},{"col1":300,"col2":"c1"},{"col1":400,"col2":"d1"},{"col1":500,"col2":"e1"},{"col1":600,"col2":"f1"},{"col1":700,"col2":"g1"},{"col1":800,"col2":"h1"},{"col1":900,"col2":"i1"},{"col1":1000,"col2":"j1"},{"col1":1100,"col2":"k1"},{"col1":1200,"col2":"l1"}]
14	[{"col1":-1,"col2":"neg_a"},{"col1":-2,"col2":"neg_b"},{"col1":-3,"col2":"neg_c"}]
15	[{"col1":1,"col2":"short"},{"col1":2,"col2":"array"}]
16	[{"col1":0,"col2":"zero"},{"col1":0,"col2":"zero"},{"col1":0,"col2":"zero"}]
17	[{"col1":111,"col2":"str_111"},{"col1":222,"col2":"str_222"},{"col1":333,"col2":"str_333"},{"col1":444,"col2":"str_444"},{"col1":555,"col2":"str_555"}]
18	[{"col1":1,"col2":"dup"},{"col1":1,"col2":"dup"},{"col1":1,"col2":"dup"}]
19	[{"col1":7,"col2":"seven"},{"col1":8,"col2":"eight"},{"col1":9,"col2":"nine"},{"col1":10,"col2":"ten"},{"col1":11,"col2":"eleven"},{"col1":12,"col2":"twelve"},{"col1":13,"col2":"thirteen"},{"col1":14,"col2":"fourteen"},{"col1":15,"col2":"fifteen"}]
20	[{"col1":42,"col2":"answer"}]
-- !result
SELECT pk, arrays_zip(CAST(int_array AS Array<String>), str_array) 
FROM arrays_zip_test 
ORDER BY pk;
-- result:
1	[{"col1":"1","col2":"a"},{"col1":"2","col2":"b"},{"col1":"3","col2":"c"}]
2	[{"col1":"10","col2":"hello"},{"col1":"20","col2":"world"}]
3	[{"col1":"100","col2":"single"}]
4	[]
5	[{"col1":"1","col2":"a"},{"col1":"2","col2":"b"},{"col1":"3","col2":"c"},{"col1":"4","col2":"d"},{"col1":"5","col2":"e"}]
6	[{"col1":null,"col2":null},{"col1":null,"col2":null},{"col1":null,"col2":null}]
7	[{"col1":"1","col2":"x"},{"col1":null,"col2":null},{"col1":"3","col2":"z"},{"col1":null,"col2":null},{"col1":"5","col2":"w"}]
8	[{"col1":"999","col2":"z"},{"col1":"888","col2":"y"},{"col1":"777","col2":"x"},{"col1":"666","col2":"w"},{"col1":"555","col2":"v"},{"col1":"444","col2":"u"},{"col1":"333","col2":"t"},{"col1":"222","col2":"s"},{"col1":"111","col2":"r"},{"col1":"0","col2":"q"}]
9	[{"col1":"1","col2":"one"}]
10	[{"col1":"2","col2":"two"},{"col1":"4","col2":"four"},{"col1":"6","col2":"six"},{"col1":"8","col2":"eight"},{"col1":"10","col2":"ten"},{"col1":"12","col2":"twelve"}]
11	[{"col1":"3","col2":"three"},{"col1":"6","col2":"six"},{"col1":"9","col2":"nine"},{"col1":"12","col2":"twelve"},{"col1":"15","col2":"fifteen"}]
12	[{"col1":null,"col2":null}]
13	[{"col1":"100","col2":"a1"},{"col1":"200","col2":"b1"},{"col1":"300","col2":"c1"},{"col1":"400","col2":"d1"},{"col1":"500","col2":"e1"},{"col1":"600","col2":"f1"},{"col1":"700","col2":"g1"},{"col1":"800","col2":"h1"},{"col1":"900","col2":"i1"},{"col1":"1000","col2":"j1"},{"col1":"1100","col2":"k1"},{"col1":"1200","col2":"l1"}]
14	[{"col1":"-1","col2":"neg_a"},{"col1":"-2","col2":"neg_b"},{"col1":"-3","col2":"neg_c"}]
15	[{"col1":"1","col2":"short"},{"col1":"2","col2":"array"}]
16	[{"col1":"0","col2":"zero"},{"col1":"0","col2":"zero"},{"col1":"0","col2":"zero"}]
17	[{"col1":"111","col2":"str_111"},{"col1":"222","col2":"str_222"},{"col1":"333","col2":"str_333"},{"col1":"444","col2":"str_444"},{"col1":"555","col2":"str_555"}]
18	[{"col1":"1","col2":"dup"},{"col1":"1","col2":"dup"},{"col1":"1","col2":"dup"}]
19	[{"col1":"7","col2":"seven"},{"col1":"8","col2":"eight"},{"col1":"9","col2":"nine"},{"col1":"10","col2":"ten"},{"col1":"11","col2":"eleven"},{"col1":"12","col2":"twelve"},{"col1":"13","col2":"thirteen"},{"col1":"14","col2":"fourteen"},{"col1":"15","col2":"fifteen"}]
20	[{"col1":"42","col2":"answer"}]
-- !result
SELECT pk, array_length(arrays_zip(int_array, str_array)) AS zip_length
FROM arrays_zip_test
ORDER BY pk;
-- result:
1	3
2	2
3	1
4	0
5	5
6	3
7	5
8	10
9	1
10	6
11	5
12	1
13	12
14	3
15	2
16	3
17	5
18	3
19	9
20	1
-- !result
SELECT DISTINCT arrays_zip([1, 2], ['a', 'b']) FROM arrays_zip_test LIMIT 5;
-- result:
[{"col1":1,"col2":"a"},{"col1":2,"col2":"b"}]
-- !result
SELECT COUNT(*) AS cnt, arrays_zip([1], ['test']) 
FROM arrays_zip_test 
GROUP BY arrays_zip([1], ['test']);
-- result:
20	[{"col1":1,"col2":"test"}]
-- !result