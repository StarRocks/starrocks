-- name: test_case_when
 CREATE TABLE `t0` (
  `region` varchar(128) NOT NULL COMMENT "",
  `order_date` date NOT NULL COMMENT "",
  `income` decimal(7, 0) NOT NULL COMMENT "",
  `ship_mode` int NOT NULL COMMENT "",
  `ship_code` int) ENGINE=OLAP
DUPLICATE KEY(`region`, `order_date`)
COMMENT "OLAP"
PARTITION BY RANGE(`order_date`)
(PARTITION p20220101 VALUES [("2022-01-01"), ("2022-01-02")),
PARTITION p20220102 VALUES [("2022-01-02"), ("2022-01-03")),
PARTITION p20220103 VALUES [("2022-01-03"), ("2022-01-05")))
DISTRIBUTED BY HASH(`region`, `order_date`) BUCKETS 10
PROPERTIES (
"replication_num" = "1",
"in_memory" = "false",
"enable_persistent_index" = "false",
"replicated_storage" = "false",
"compression" = "LZ4"
);
-- result:
-- !result
INSERT INTO `t0` (`region`, `order_date`, `income`, `ship_mode`, `ship_code`) VALUES
('USA', '2022-01-01', 12345, 50, 1),
('CHINA', '2022-01-02', 54321, 51, 4),
('JAPAN', '2022-01-03', 67890, 610, 6),
('UK', '2022-01-04', 98765, 75, 2),
('AUS', '2022-01-01', 23456, 25, 18),
('AFRICA', '2022-01-02', 87654, 125, 7),
('USA', '2022-01-03', 54321, 75, null),
('CHINA', '2022-01-04', 12345, 100, 3),
('JAPAN', '2022-01-01', 67890, 64, 10),
('UK', '2022-01-02', 54321, 25, 5),
('AUS', '2022-01-03', 98765, 150, 15),
('AFRICA', '2022-01-04', 23456, 75, null),
('USA', '2022-01-01', 87654, 125, 2),
('CHINA', '2022-01-02', 54321, 175, 12),
('JAPAN', '2022-01-03', 12345, 100, 3),
('UK', '2022-01-04', 67890, 50, 10),
('AUS', '2022-01-01', 54321, 25, 5),
('AFRICA', '2022-01-02', 98765, 150, 15),
('USA', '2022-01-03', 23456, 75, 18),
('CHINA', '2022-01-04', 87654, 125, 7),
('JAPAN', '2022-01-01', 54321, 175, 12),
('UK', '2022-01-02', 12345, 86, 3),
('AUS', '2022-01-03', 67890, 50, 10),
('AFRICA', '2022-01-04', 54321, 25, 95),
('USA', '2022-01-01', 98765, 150, 55),
('CHINA', '2022-01-02', 23456, 75, 88),
('JAPAN', '2022-01-03', 87654, 125, 67),
('UK', '2022-01-04', 54321, 82, 72),
('AUS', '2022-01-01', 12345, 90, 35),
('AFRICA', '2022-01-02', 67890, 50, 100),
('USA', '2022-01-03', 54321, 25, 5),
('CHINA', '2022-01-04', 98765, 150, 15),
('JAPAN', '2022-01-01', 23456, 75, null);
-- result:
-- !result

select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  = 'A';
-- result:
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  = 'B';
-- result:
CHINA	2022-01-02	23456	75	88
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  = 'C';
-- result:
UK	2022-01-04	54321	82	72
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  <> 'D';
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  <> 'E';
-- result:
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	23456	75	88
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	54321	82	72
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B');
-- result:
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	23456	75	88
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B', 'C');
-- result:
AFRICA	2022-01-04	54321	25	95
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	23456	75	88
UK	2022-01-04	54321	82	72
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('D','E');
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('E');
-- result:
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in (NULL);
-- result:
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('F');
-- result:
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E');
-- result:
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E','F');
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('A','B', 'C');
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('D','E');
-- result:
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	23456	75	88
UK	2022-01-04	54321	82	72
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('E');
-- result:
UK	2022-01-04	54321	82	72
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	23456	75	88
AFRICA	2022-01-04	54321	25	95
AFRICA	2022-01-02	67890	50	100
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in (NULL);
-- result:
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('A','B','C','D','E','F');
-- result:
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  is NULL;
-- result:
-- !result
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  is NOT NULL;
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) = 1;
-- result:
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) <> 1;
-- result:
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
-- !result
select * from t0 where
(case when region <> 'China' then 1 when region = 'Japan' then 2 else 3 end) <> 2;
-- result:
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where
(case when region = 'China' then 2 when region = 'Japan' then 2 else 3 end) <> 2;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
(case when region = 'China' then 2 when region = 'China' then 1 else 3 end) = 1;
-- result:
-- !result
select * from t0 where
(case when region = 'China' then 2 when region = 'China' then 1 else 3 end) <> 1;
-- result:
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where
(case when region is NULL then 2 when region = 'China' then 1 else 3 end) = 3;
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case when region = NULL then 2 when region = 'China' then 1 else 3 end) = 1;
-- result:
-- !result
select * from t0 where
(case when region = 'USA' then 5 when region = 'China' then 1 else 3 end) = 3;
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
-- !result
select * from t0 where
(case when region = 'USA' then 5 when region = 'UK' then 2
when region = 'China' then 1 end) = 3;
-- result:
-- !result
select * from t0 where
(case when region = 'USA' then 1 when region = 'UK' then 2
when region = 'China' then 2 end) = 2;
-- result:
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case when region = NULL then 2 when region = 'China' then 1 else 3 end) <> 1;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
(case when region = 'UK' then 2 when region = 'China' then 1 else 3 end) <> 3;
-- result:
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case when region = 'USA' then 5 when region = 'UK' then 2
when region = 'China' then 1 end) <> 3;
-- result:
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
(case when region = 'USA' then 1 when region = 'UK' then 2 when region = 'China' then 2 end) <> 2;
-- result:
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) in (1);
-- result:
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) not in (1);
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) in (3);
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) not in (3);
-- result:
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) is null;
-- result:
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) is not null;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 end) is null;
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 end) is not null;
-- result:
-- !result
select * from t0 where
(case when region = 'China' then NULL when region = 'Japan' then 2 end) is null;
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
-- !result
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then NULL end) is not null;
-- result:
-- !result
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' else 'd' end != 'c';
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' else 'd' end in ('a', 'b', 'c');
-- result:
UK	2022-01-04	98765	75	2
USA	2022-01-03	54321	75	None
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
-- !result
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' else 'd' end not in ('a', 'b', 'c');
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end != 'c';
-- result:
AFRICA	2022-01-04	23456	75	None
USA	2022-01-03	54321	75	None
USA	2022-01-01	12345	50	1
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end in ('a', 'b', 'c');
-- result:
AFRICA	2022-01-04	23456	75	None
UK	2022-01-04	98765	75	2
USA	2022-01-03	54321	75	None
JAPAN	2022-01-01	23456	75	None
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
-- !result
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end not in ('a', 'b', 'c');
-- result:
-- !result
select * from t0 where (case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end in ('a', 'b', 'c')) is null;
-- result:
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	98765	150	55
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where (case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end not in ('a', 'b', 'c')) is null;
-- result:
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
-- !result
select * from t0 where if(region='USA', 1, 0) = 1;
-- result:
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where if(region='USA', 1, 0) = 0;
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where if(region='USA', 1, 0) = 2;
-- result:
-- !result
select * from t0 where if(region='USA', 1, 0) <> 1;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where if(region='USA', 1, 0) <> 0;
-- result:
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where if(region='USA', 1, 0) <> 2;
-- result:
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where if(region='USA', 1, 0) in (1);
-- result:
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where if(region='USA', 1, 0) in (1,0);
-- result:
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where if(region='USA', 1, 0) in (2,3);
-- result:
-- !result
select * from t0 where if(region='USA', 1, 0) not in (0);
-- result:
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where if(region='USA', 1, 0) not in (0,1);
-- result:
-- !result
select * from t0 where if(region='USA', 1, 0) not in (2,3);
-- result:
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where if(region='USA', 1, 0) is NULL;
-- result:
-- !result
select * from t0 where if(region='USA', 1, 0) is NOT NULL;
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where if(ship_code is null, null, 0) is NULL;
-- result:
AFRICA	2022-01-04	23456	75	None
USA	2022-01-03	54321	75	None
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where if(ship_code is null or ship_code > 2, 2, 1) > 1;
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	98765	150	55
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where if(ship_code is null or ship_code > 2, 2, 1) != 2;
-- result:
UK	2022-01-04	98765	75	2
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
-- !result
select * from t0 where if(ship_code is null or ship_code > 2, 1, 0) is NOT NULL;
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
with tmp as (select ship_mode, if(ship_code > 4, 1, 0) as layer0, if (ship_code >= 1 and ship_code <= 4, 1, 0) as layer1,if(ship_code is null or ship_code < 1, 1, 0) as layer2 from t0) select * from tmp where layer2 = 1 and layer0 != 1 and layer1 !=1;
-- result:
75	0	0	1
75	0	0	1
75	0	0	1
-- !result
select * from t0 where nullif('China', region) = 'China';
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where nullif('China', region) <> 'China';
-- result:
-- !result
select * from t0 where nullif('China', region) is NULL;
-- result:
-- !result
select * from t0 where nullif('China', region) is NOT NULL;
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
-- !result
select * from t0 where nullif('China', region) = 'USA';
-- result:
-- !result
select * from t0 where nullif('China', region) <>  'USA';
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where nullif(1, ship_code) = 1;
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where nullif(1, ship_code) <> 1;
-- result:
-- !result
select * from t0 where nullif(1, ship_code) is NULL;
-- result:
USA	2022-01-01	12345	50	1
-- !result
select * from t0 where nullif(1, ship_code) is NOT NULL;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where nullif(1, ship_code) = 2;
-- result:
-- !result
select * from t0 where nullif(1, ship_code) <>  2;
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) = 1;
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (1,2);
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <> 1;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <> 2;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case region when 'China' then 2 when 'Japan' then 2 else 3 end) <> 2;
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where
(case region when 'China' then 2 when 'China' then 1 else 3 end) = 1;
-- result:
-- !result
select * from t0 where
(case region when 'China' then 2 when 'China' then 1 else 3 end) <> 1;
-- result:
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case region when NULL then 2 when 'China' then 1 else 3 end) = 3;
-- result:
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
-- !result
select * from t0 where
(case region when NULL then 2 when 'China' then 1 else 3 end) = 1;
-- result:
-- !result
select * from t0 where
(case region when 'USA' then 5 when 'China' then 1 else 3 end) = 3;
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case region when 'USA' then 5 when 'UK' then 2 when 'China' then 1 end) = 3;
-- result:
-- !result
select * from t0 where
(case region when 'USA' then 1 when 'UK' then 2 when 'China' then 2 end) = 2;
-- result:
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
-- !result
select * from t0 where
(case region when NULL then 2 when 'China' then 1 else 3 end) <> 1;
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
(case region when 'UK' then 2 when 'China' then 1 else 3 end) <> 3;
-- result:
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case region when 'USA' then 5 when 'UK' then 2 when 'China' then 1 end) <> 3;
-- result:
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where
(case region when 'USA' then 1 when 'UK' then 2 when 'China' then 2 end) <> 2;
-- result:
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
((case region when 'USA' then 1 when 'UK' then 2 when 'China' then 2 end) <> 2) IS NULL;
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (1);
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (1);
-- result:
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (3);
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (3);
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) is null;
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) is not null;
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 end) is null;
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 end) is not null;
-- result:
-- !result
select * from t0 where
(case region when 'China' then NULL when 'Japan' then 2 end) is null;
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then NULL end) is not null;
-- result:
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  = 'b';
-- result:
USA	2022-01-01	87654	125	2
UK	2022-01-04	98765	75	2
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  != 'b';
-- result:
CHINA	2022-01-04	12345	100	3
JAPAN	2022-01-03	12345	100	3
USA	2022-01-01	12345	50	1
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('a', 'b', 'c', 'd');
-- result:
UK	2022-01-04	98765	75	2
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
CHINA	2022-01-04	12345	100	3
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	12345	100	3
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('e', 'f');
-- result:
-- !result
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('a', 'b', 'c', 'd')) is null;
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	98765	150	55
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('e', 'f')) is not null;
-- result:
UK	2022-01-02	12345	86	3
JAPAN	2022-01-03	12345	100	3
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
CHINA	2022-01-04	12345	100	3
UK	2022-01-04	98765	75	2
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null  else 'e' end  = 'b';
-- result:
USA	2022-01-01	87654	125	2
UK	2022-01-04	98765	75	2
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end  != 'b';
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end in ('a', 'b', 'c', 'd');
-- result:
UK	2022-01-04	98765	75	2
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
-- !result
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end  in ('e', 'f');
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	98765	150	55
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end in ('a', 'b', 'c', 'd')) is null;
-- result:
CHINA	2022-01-04	12345	100	3
JAPAN	2022-01-03	12345	100	3
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end in ('a', 'b', 'c', 'd')) is not null;
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
-- !result
select * from t0 where case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' when 3 then 'c' end in ('b', 'c', 'd');
-- result:
JAPAN	2022-01-03	12345	100	3
UK	2022-01-02	12345	86	3
CHINA	2022-01-04	12345	100	3
-- !result
select * from t0 where case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' else 'e' end in ('a', 'b', 'c', 'd');
-- result:
-- !result
select * from t0 where (case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' else 'e' end in ('a', 'b', 'c', 'd')) is null;
-- result:
-- !result
select * from t0 where (case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' else 'e' end in ('a', 'b', 'c', 'd')) is not null;
-- result:
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'A';
-- result:
CHINA	2022-01-02	54321	175	12
JAPAN	2022-01-01	54321	175	12
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'B';
-- result:
UK	2022-01-04	54321	82	72
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'C';
-- result:
AFRICA	2022-01-04	23456	75	None
CHINA	2022-01-02	23456	75	88
JAPAN	2022-01-01	23456	75	None
UK	2022-01-04	98765	75	2
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'D';
-- result:
JAPAN	2022-01-01	67890	64	10
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'E';
-- result:
AUS	2022-01-03	67890	50	10
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
UK	2022-01-02	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
USA	2022-01-01	12345	50	1
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'A';
-- result:
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	67890	50	10
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
USA	2022-01-01	12345	50	1
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'B';
-- result:
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'C';
-- result:
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	25	5
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'D';
-- result:
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'E';
-- result:
AFRICA	2022-01-04	23456	75	None
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
UK	2022-01-04	98765	75	2
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B');
-- result:
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
UK	2022-01-04	54321	82	72
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	175	12
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B', 'C');
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	12345	86	3
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AUS	2022-01-03	98765	150	15
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
UK	2022-01-04	98765	75	2
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('D','E');
-- result:
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
AFRICA	2022-01-04	54321	25	95
CHINA	2022-01-02	54321	51	4
UK	2022-01-02	54321	25	5
AUS	2022-01-03	67890	50	10
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
USA	2022-01-01	12345	50	1
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('E');
-- result:
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
UK	2022-01-02	54321	25	5
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
USA	2022-01-01	12345	50	1
AUS	2022-01-03	67890	50	10
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in (NULL);
-- result:
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('F');
-- result:
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E');
-- result:
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E','F');
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B');
-- result:
AFRICA	2022-01-02	67890	50	100
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
AUS	2022-01-03	67890	50	10
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
USA	2022-01-01	12345	50	1
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B', 'C');
-- result:
UK	2022-01-04	67890	50	10
USA	2022-01-03	54321	25	5
AFRICA	2022-01-02	67890	50	100
JAPAN	2022-01-01	67890	64	10
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
USA	2022-01-01	12345	50	1
CHINA	2022-01-02	54321	51	4
UK	2022-01-02	54321	25	5
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-03	67890	50	10
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('D','E');
-- result:
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('E');
-- result:
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AUS	2022-01-01	12345	90	35
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	12345	86	3
AUS	2022-01-03	98765	150	15
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-04	23456	75	None
UK	2022-01-04	98765	75	2
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in (NULL);
-- result:
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B','C','D','E');
-- result:
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B','C','D','E','F');
-- result:
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  is NULL;
-- result:
-- !result
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  is NOT NULL;
-- result:
CHINA	2022-01-02	54321	51	4
CHINA	2022-01-02	54321	175	12
CHINA	2022-01-02	23456	75	88
UK	2022-01-02	54321	25	5
UK	2022-01-02	12345	86	3
JAPAN	2022-01-01	67890	64	10
JAPAN	2022-01-01	54321	175	12
JAPAN	2022-01-01	23456	75	None
JAPAN	2022-01-03	67890	610	6
JAPAN	2022-01-03	12345	100	3
JAPAN	2022-01-03	87654	125	67
AFRICA	2022-01-04	23456	75	None
AFRICA	2022-01-04	54321	25	95
AUS	2022-01-01	23456	25	18
AUS	2022-01-01	54321	25	5
AUS	2022-01-01	12345	90	35
USA	2022-01-01	12345	50	1
USA	2022-01-01	87654	125	2
USA	2022-01-01	98765	150	55
AUS	2022-01-03	98765	150	15
AUS	2022-01-03	67890	50	10
CHINA	2022-01-04	12345	100	3
CHINA	2022-01-04	87654	125	7
CHINA	2022-01-04	98765	150	15
AFRICA	2022-01-02	87654	125	7
AFRICA	2022-01-02	98765	150	15
AFRICA	2022-01-02	67890	50	100
UK	2022-01-04	98765	75	2
UK	2022-01-04	67890	50	10
UK	2022-01-04	54321	82	72
USA	2022-01-03	54321	75	None
USA	2022-01-03	23456	75	18
USA	2022-01-03	54321	25	5
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) = NULL;
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <> NULL;
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <=> NULL;
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (1,NULL);
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (1,NULL);
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (NULL,NULL);
-- result:
-- !result
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (NULL,NULL);
-- result:
-- !result
select * from t0 where
if (region = 'China', 1, 2) = NULL;
-- result:
-- !result
select * from t0 where
if (region = 'China', 1, 2) not in (NULL, 1);
-- result:
-- !result