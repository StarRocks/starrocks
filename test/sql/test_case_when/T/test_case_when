-- name: test_case_when
 CREATE TABLE `t0` (
  `region` varchar(128) NOT NULL COMMENT "",
  `order_date` date NOT NULL COMMENT "",
  `income` decimal(7, 0) NOT NULL COMMENT "",
  `ship_mode` int NOT NULL COMMENT "",
  `ship_code` int) ENGINE=OLAP
DUPLICATE KEY(`region`, `order_date`)
COMMENT "OLAP"
PARTITION BY RANGE(`order_date`)
(PARTITION p20220101 VALUES [("2022-01-01"), ("2022-01-02")),
PARTITION p20220102 VALUES [("2022-01-02"), ("2022-01-03")),
PARTITION p20220103 VALUES [("2022-01-03"), ("2022-01-05")))
DISTRIBUTED BY HASH(`region`, `order_date`) BUCKETS 10
PROPERTIES (
"replication_num" = "1",
"enable_persistent_index" = "true",
"replicated_storage" = "false",
"compression" = "LZ4"
);

INSERT INTO `t0` (`region`, `order_date`, `income`, `ship_mode`, `ship_code`) VALUES
('USA', '2022-01-01', 12345, 50, 1),
('CHINA', '2022-01-02', 54321, 51, 4),
('JAPAN', '2022-01-03', 67890, 610, 6),
('UK', '2022-01-04', 98765, 75, 2),
('AUS', '2022-01-01', 23456, 25, 18),
('AFRICA', '2022-01-02', 87654, 125, 7),
('USA', '2022-01-03', 54321, 75, null),
('CHINA', '2022-01-04', 12345, 100, 3),
('JAPAN', '2022-01-01', 67890, 64, 10),
('UK', '2022-01-02', 54321, 25, 5),
('AUS', '2022-01-03', 98765, 150, 15),
('AFRICA', '2022-01-04', 23456, 75, null),
('USA', '2022-01-01', 87654, 125, 2),
('CHINA', '2022-01-02', 54321, 175, 12),
('JAPAN', '2022-01-03', 12345, 100, 3),
('UK', '2022-01-04', 67890, 50, 10),
('AUS', '2022-01-01', 54321, 25, 5),
('AFRICA', '2022-01-02', 98765, 150, 15),
('USA', '2022-01-03', 23456, 75, 18),
('CHINA', '2022-01-04', 87654, 125, 7),
('JAPAN', '2022-01-01', 54321, 175, 12),
('UK', '2022-01-02', 12345, 86, 3),
('AUS', '2022-01-03', 67890, 50, 10),
('AFRICA', '2022-01-04', 54321, 25, 95),
('USA', '2022-01-01', 98765, 150, 55),
('CHINA', '2022-01-02', 23456, 75, 88),
('JAPAN', '2022-01-03', 87654, 125, 67),
('UK', '2022-01-04', 54321, 82, 72),
('AUS', '2022-01-01', 12345, 90, 35),
('AFRICA', '2022-01-02', 67890, 50, 100),
('USA', '2022-01-03', 54321, 25, 5),
('CHINA', '2022-01-04', 98765, 150, 15),
('JAPAN', '2022-01-01', 23456, 75, null);

[UC]set ENABLE_SIMPLIFY_CASE_WHEN = true;

select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  = 'A' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  = 'B' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  = 'C' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  <> 'D' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  <> 'E' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B', 'C') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('D','E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in (NULL) order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('F') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E','F') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('A','B', 'C') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('D','E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in (NULL) order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  not in ('A','B','C','D','E','F') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  is NULL order by 1,2,3,4,5;
select * from t0 where (case
   when ship_code >= 90 then 'A'
   when ship_code >= 80 then 'B'
   when ship_code >= 70 then 'C'
   when ship_code >= 60 then 'D'
   else 'E' end)  is NOT NULL order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) = 1 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) <> 1 order by 1,2,3,4,5;
select * from t0 where
(case when region <> 'China' then 1 when region = 'Japan' then 2 else 3 end) <> 2 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 2 when region = 'Japan' then 2 else 3 end) <> 2 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 2 when region = 'China' then 1 else 3 end) = 1 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 2 when region = 'China' then 1 else 3 end) <> 1 order by 1,2,3,4,5;
select * from t0 where
(case when region is NULL then 2 when region = 'China' then 1 else 3 end) = 3 order by 1,2,3,4,5;
select * from t0 where
(case when region = NULL then 2 when region = 'China' then 1 else 3 end) = 1 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'USA' then 5 when region = 'China' then 1 else 3 end) = 3 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'USA' then 5 when region = 'UK' then 2
when region = 'China' then 1 end) = 3 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'USA' then 1 when region = 'UK' then 2
when region = 'China' then 2 end) = 2 order by 1,2,3,4,5;
select * from t0 where
(case when region = NULL then 2 when region = 'China' then 1 else 3 end) <> 1 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'UK' then 2 when region = 'China' then 1 else 3 end) <> 3 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'USA' then 5 when region = 'UK' then 2
when region = 'China' then 1 end) <> 3 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'USA' then 1 when region = 'UK' then 2 when region = 'China' then 2 end) <> 2 order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) in (1) order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) not in (1) order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) in (3) order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) not in (3) order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) is null order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 else 3 end) is not null order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 end) is null order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then 2 end) is not null order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then NULL when region = 'Japan' then 2 end) is null order by 1,2,3,4,5;
select * from t0 where
(case when region = 'China' then 1 when region = 'Japan' then NULL end) is not null order by 1,2,3,4,5;
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' else 'd' end != 'c' order by 1,2,3,4,5;
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' else 'd' end in ('a', 'b', 'c') order by 1,2,3,4,5;
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' else 'd' end not in ('a', 'b', 'c') order by 1,2,3,4,5;
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end != 'c' order by 1,2,3,4,5;
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end in ('a', 'b', 'c') order by 1,2,3,4,5;
select * from t0 where case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end not in ('a', 'b', 'c') order by 1,2,3,4,5;
select * from t0 where (case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end in ('a', 'b', 'c')) is null order by 1,2,3,4,5;
select * from t0 where (case when ship_code is null then 'a' when ship_code = 1 then 'b' when ship_code = 2 then 'c' end not in ('a', 'b', 'c')) is null order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) = 1 order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) = 0 order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) = 2 order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) <> 1 order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) <> 0 order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) <> 2 order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) in (1) order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) in (1,0) order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) in (2,3) order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) not in (0) order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) not in (0,1) order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) not in (2,3) order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) is NULL order by 1,2,3,4,5;
select * from t0 where if(region='USA', 1, 0) is NOT NULL order by 1,2,3,4,5;
select * from t0 where if(ship_code is null, null, 0) is NULL order by 1,2,3,4,5;
select * from t0 where if(ship_code is null or ship_code > 2, 2, 1) > 1 order by 1,2,3,4,5;
select * from t0 where if(ship_code is null or ship_code > 2, 2, 1) != 2 order by 1,2,3,4,5;
select * from t0 where if(ship_code is null or ship_code > 2, 1, 0) is NOT NULL order by 1,2,3,4,5;
with tmp as (select ship_mode, if(ship_code > 4, 1, 0) as layer0, if (ship_code >= 1 and ship_code <= 4, 1, 0) as layer1,if(ship_code is null or ship_code < 1, 1, 0) as layer2 from t0) select * from tmp where layer2 = 1 and layer0 != 1 and layer1 !=1 order by 1,2,3,4,5;
select * from t0 where nullif('China', region) = 'China' order by 1,2,3,4,5;
select * from t0 where nullif('China', region) <> 'China' order by 1,2,3,4,5;
select * from t0 where nullif('China', region) is NULL order by 1,2,3,4,5;
select * from t0 where (nullif('China', region) is NULL) is NULL order by 1,2,3,4,5;
select * from t0 where (nullif('China', region) is NULL) is NOT NULL order by 1,2,3,4,5;
select * from t0 where nullif('China', region) is NOT NULL order by 1,2,3,4,5;
select * from t0 where (nullif('China', region) is NOT NULL) is NULL order by 1,2,3,4,5;
select * from t0 where (nullif('China', region) is NOT NULL) is NOT NULL order by 1,2,3,4,5;
select * from t0 where nullif('China', region) = 'USA' order by 1,2,3,4,5;
select * from t0 where nullif('China', region) <>  'USA' order by 1,2,3,4,5;
select * from t0 where nullif(1, ship_code) = 1 order by 1,2,3,4,5;
select * from t0 where nullif(1, ship_code) <> 1 order by 1,2,3,4,5;
select * from t0 where nullif(1, ship_code) is NULL order by 1,2,3,4,5;
select * from t0 where (nullif(1, ship_code) is NULL) is NULL order by 1,2,3,4,5;
select * from t0 where (nullif(1, ship_code) is NULL) is NOT NULL order by 1,2,3,4,5;
select * from t0 where nullif(1, ship_code) is NOT NULL order by 1,2,3,4,5;
select * from t0 where (nullif(1, ship_code) is NOT NULL) is NULL order by 1,2,3,4,5;
select * from t0 where (nullif(1, ship_code) is NOT NULL) is NOT NULL order by 1,2,3,4,5;
SELECT * from t0 WHERE NULLIF(1919971645 = -672243616 , ship_code <  CONV('', 1400516661, -2096754551)) IS NULL order by 1,2,3,4,5;
SELECT * from t0 WHERE NOT NULLIF(1919971645 = -672243616 , ship_code <  CONV('', 1400516661, -2096754551)) IS NULL;
SELECT * from t0 WHERE (NULLIF(1919971645 = -672243616 , ship_code <  CONV('', 1400516661, -2096754551)) IS NULL) IS NULL order by 1,2,3,4,5;

select * from t0 where nullif(1, ship_code) = 2 order by 1,2,3,4,5;
select * from t0 where nullif(1, ship_code) <>  2 order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) = 1 order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (1,2) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <> 1 order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <> 2 order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 2 when 'Japan' then 2 else 3 end) <> 2 order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 2 when 'China' then 1 else 3 end) = 1 order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 2 when 'China' then 1 else 3 end) <> 1 order by 1,2,3,4,5;
select * from t0 where
(case region when NULL then 2 when 'China' then 1 else 3 end) = 3 order by 1,2,3,4,5;
select * from t0 where
(case region when NULL then 2 when 'China' then 1 else 3 end) = 1 order by 1,2,3,4,5;
select * from t0 where
(case region when 'USA' then 5 when 'China' then 1 else 3 end) = 3 order by 1,2,3,4,5;
select * from t0 where
(case region when 'USA' then 5 when 'UK' then 2 when 'China' then 1 end) = 3 order by 1,2,3,4,5;
select * from t0 where
(case region when 'USA' then 1 when 'UK' then 2 when 'China' then 2 end) = 2 order by 1,2,3,4,5;
select * from t0 where
(case region when NULL then 2 when 'China' then 1 else 3 end) <> 1 order by 1,2,3,4,5;
select * from t0 where
(case region when 'UK' then 2 when 'China' then 1 else 3 end) <> 3 order by 1,2,3,4,5;
select * from t0 where
(case region when 'USA' then 5 when 'UK' then 2 when 'China' then 1 end) <> 3 order by 1,2,3,4,5;
select * from t0 where
(case region when 'USA' then 1 when 'UK' then 2 when 'China' then 2 end) <> 2 order by 1,2,3,4,5;
select * from t0 where
((case region when 'USA' then 1 when 'UK' then 2 when 'China' then 2 end) <> 2) IS NULL order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (1) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (1) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (3) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (3) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) is null order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) is not null order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 end) is null order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 end) is not null order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then NULL when 'Japan' then 2 end) is null order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then NULL end) is not null order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  = 'b' order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  != 'b' order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('a', 'b', 'c', 'd') order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('e', 'f') order by 1,2,3,4,5;
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('a', 'b', 'c', 'd')) is null order by 1,2,3,4,5;
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then 'c' end  in ('e', 'f')) is not null order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null  else 'e' end  = 'b' order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end  != 'b' order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end in ('a', 'b', 'c', 'd') order by 1,2,3,4,5;
select * from t0 where case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end  in ('e', 'f') order by 1,2,3,4,5;
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end in ('a', 'b', 'c', 'd')) is null order by 1,2,3,4,5;
select * from t0 where (case ship_code when 1 then 'a' when 2 then 'b' when 3 then null else 'e' end in ('a', 'b', 'c', 'd')) is not null order by 1,2,3,4,5;
select * from t0 where case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' when 3 then 'c' end in ('b', 'c', 'd') order by 1,2,3,4,5;
select * from t0 where case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' else 'e' end in ('a', 'b', 'c', 'd') order by 1,2,3,4,5;
select * from t0 where (case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' else 'e' end in ('a', 'b', 'c', 'd')) is null order by 1,2,3,4,5;
select * from t0 where (case ship_code when ship_mode + 1 then 'a' when ship_mode + 2 then 'b' else 'e' end in ('a', 'b', 'c', 'd')) is not null order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'A' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'B' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'C' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'D' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  = 'E' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'A' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'B' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'C' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'D' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  <> 'E' order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B', 'C') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('D','E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in (NULL) order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('F') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  in ('A','B','C','D','E','F') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B', 'C') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('D','E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in (NULL) order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B','C','D','E') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  not in ('A','B','C','D','E','F') order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  is NULL order by 1,2,3,4,5;
select * from t0 where (case
   when ship_mode >= 90 then 'A'
   when ship_mode >= 80 then 'B'
   when ship_mode >= 70 then 'C'
   when ship_mode >= 60 then 'D'
   else 'E' end)  is NOT NULL order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) = NULL order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <> NULL order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) <=> NULL order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (1,NULL) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (1,NULL) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) in (NULL,NULL) order by 1,2,3,4,5;
select * from t0 where
(case region when 'China' then 1 when 'Japan' then 2 else 3 end) not in (NULL,NULL) order by 1,2,3,4,5;
select * from t0 where
if (region = 'China', 1, 2) = NULL order by 1,2,3,4,5;
select * from t0 where
if (region = 'China', 1, 2) not in (NULL, 1) order by 1,2,3,4,5;
select * from t0 where (case when region = 'USA' then true when region like 'COM%' then false end) is null order by 1,2,3,4,5;
select * from t0 where (case when ship_code is null then true when not 3 then false end) is null order by 1,2,3,4,5;
select * from t0 where (case when ship_code is null then true when not null then false end) is null order by 1,2,3,4,5;
select * from t0 where (case when ship_code is null then true when null then false end) is null order by 1,2,3,4,5;
select * from t0 where (case when ship_code is null then true when 0 then false end) is null order by 1,2,3,4,5;
select * from t0 where (case region when 'USA' then 1 when 'UK' then 2 else 3 end in (2, 3, null)) is null order by 1,2,3,4,5;
select * from t0 where (case region when 'USA' then 1 when 'UK' then 2 else 3 end in (2, 3, null)) is not null order by 1,2,3,4,5;
select * from t0 where (case region when 'USA' then 1 when 'UK' then 2 end in (2, 3, null)) is null order by 1,2,3,4,5;
select * from t0 where (case region when 'USA' then 1 when 'UK' then 2 end in (2, 3, null)) is not null order by 1,2,3,4,5;
select * from t0 where (case when region = 'USA' then 1 when region = 'UK' then 2 else 3 end in (2, 3, null)) is null order by 1,2,3,4,5;
select * from t0 where (case when region = 'USA' then 1 when region = 'UK' then 2 else 3 end in (2, 3, null)) is not null order by 1,2,3,4,5;

CREATE TABLE `ads_opt_t_goods_odd_important_kd_di` (
  `region` varchar(128) NOT NULL COMMENT "",
  `handed_dept_name` int NOT NULL COMMENT "")
ENGINE=OLAP
DUPLICATE KEY(`region`)
COMMENT "OLAP"
PROPERTIES (
"replication_num" = "1",
"enable_persistent_index" = "true",
"replicated_storage" = "false",
"compression" = "LZ4"
);

SELECT *,
       CASE
         WHEN `handling_department_2` LIKE '%Ganzhou Transfer Yard%'
           THEN REPLACE(`handling_department_2`, 'Ganzhou Transfer Yard', 'Ganzhou Transfer Yard Loading/Unloading Team 1')
         WHEN `handling_department_2` LIKE '%Guangzhou Fanlong Distribution Station Loading/Unloading Team 1%'
           THEN REPLACE(`handling_department_2`, 'Guangzhou Fanlong Distribution Station Loading/Unloading Team 1', 'Guangzhou Fanlong Distribution Station Loading/Unloading Team')
         WHEN `handling_department_2` LIKE '%Jingzhou Transfer Yard Loading/Unloading Department%'
           THEN REPLACE(`handling_department_2`, 'Jingzhou Transfer Yard Loading/Unloading Department', 'Jingzhou Transfer Yard Loading/Unloading Team')
         WHEN `handling_department_2` LIKE '%Tangshan Loading/Unloading Team 1%'
           THEN REPLACE(`handling_department_2`, 'Tangshan Loading/Unloading Team 1', 'Tangshan Loading/Unloading Team')
         WHEN `handling_department_2` LIKE '%Zhexi Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Zhexi Hub Center', 'Hangzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Shanghai Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Shanghai Hub Center', 'Shanghai Transfer Yard')
         WHEN `handling_department_2` LIKE '%Shunde Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Shunde Hub Center', 'Shunde Transfer Yard')
         WHEN `handling_department_2` LIKE '%Sunan Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Sunan Hub Center', 'Suzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Tianjin Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Tianjin Hub Center', 'Tianjin Transfer Yard')
         WHEN `handling_department_2` LIKE '%Wuhan Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Wuhan Hub Center', 'Wuhan Transfer Yard')
         WHEN `handling_department_2` LIKE '%Northwest Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Northwest Hub Center', 'Xi\'an Transfer Yard')
         WHEN `handling_department_2` LIKE '%Zhengzhou Hub Center%'
           THEN REPLACE(`handling_department_2`, 'Zhengzhou Hub Center', 'Zhengzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Changzhou Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Changzhou Transfer Center', 'Changzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Chaoshan Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Chaoshan Transfer Center', 'Chaoshan Transfer Yard')
         WHEN `handling_department_2` LIKE '%Fangshan Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Fangshan Transfer Center', 'Fangshan Transfer Yard')
         WHEN `handling_department_2` LIKE '%Fuzhou Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Fuzhou Transfer Center', 'Fuzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Guiyang Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Guiyang Transfer Center', 'Guiyang Transfer Yard')
         WHEN `handling_department_2` LIKE '%Harbin Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Harbin Transfer Center', 'Harbin Transfer Yard')
         WHEN `handling_department_2` LIKE '%Huaian Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Huaian Transfer Center', 'Huaian Transfer Yard')
         WHEN `handling_department_2` LIKE '%Jinhua Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Jinhua Transfer Center', 'Jinhua Transfer Yard')
         WHEN `handling_department_2` LIKE '%Kunming Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Kunming Transfer Center', 'Kunming Transfer Yard')
         WHEN `handling_department_2` LIKE '%Lanzhou Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Lanzhou Transfer Center', 'Lanzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Luohe Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Luohe Transfer Center', 'Luohe Transfer Yard')
         WHEN `handling_department_2` LIKE '%Nanchang Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Nanchang Transfer Center', 'Nanchang Transfer Yard')
         WHEN `handling_department_2` LIKE '%Nanjing Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Nanjing Transfer Center', 'Nanjing Transfer Yard')
         WHEN `handling_department_2` LIKE '%Nanning Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Nanning Transfer Center', 'Nanning Transfer Yard')
         WHEN `handling_department_2` LIKE '%Nantong Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Nantong Transfer Center', 'Nantong Transfer Yard')
         WHEN `handling_department_2` LIKE '%Pudong Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Pudong Transfer Center', 'Pudong Transfer Yard')
         WHEN `handling_department_2` LIKE '%Quanzhou Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Quanzhou Transfer Center', 'Quanzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Xiamen Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Xiamen Transfer Center', 'Xiamen Transfer Yard')
         WHEN `handling_department_2` LIKE '%Shenyang Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Shenyang Transfer Center', 'Shenyang Transfer Yard')
         WHEN `handling_department_2` LIKE '%Taiyuan Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Taiyuan Transfer Center', 'Taiyuan Transfer Yard')
         WHEN `handling_department_2` LIKE '%Wenzhou Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Wenzhou Transfer Center', 'Wenzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Wuhu Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Wuhu Transfer Center', 'Wuhu Transfer Yard')
         WHEN `handling_department_2` LIKE '%Xuzhou Shaji Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Xuzhou Shaji Transfer Center', 'Xuzhou Shaji Transfer Yard')
         WHEN `handling_department_2` LIKE '%Xuzhou Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Xuzhou Transfer Center', 'Xuzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Yantai Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Yantai Transfer Center', 'Yantai Transfer Yard')
         WHEN `handling_department_2` LIKE '%Yangzhou Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Yangzhou Transfer Center', 'Yangzhou Transfer Yard')
         WHEN `handling_department_2` LIKE '%Changchun Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Changchun Transfer Center', 'Changchun Transfer Yard')
         WHEN `handling_department_2` LIKE '%Chongqing Baihe Transfer Center%'
           THEN REPLACE(`handling_department_2`, 'Chongqing Baihe Transfer Center', 'Chongqing Baihe Transfer Yard')
         ELSE `handling_department_2`
       END AS `handling_department_3`
FROM (
    SELECT *,
           CASE
             WHEN `handling_department` LIKE '%Ganzhou Transfer Yard%'
               THEN REPLACE(`handling_department`, 'Ganzhou Transfer Yard', 'Ganzhou Transfer Yard Loading/Unloading Team 1')
             WHEN `handling_department` LIKE '%Guangzhou Fanlong Distribution Station Loading/Unloading Team 1%'
               THEN REPLACE(`handling_department`, 'Guangzhou Fanlong Distribution Station Loading/Unloading Team 1', 'Guangzhou Fanlong Distribution Station Loading/Unloading Team')
             WHEN `handling_department` LIKE '%Jingzhou Transfer Yard Loading/Unloading Department%'
               THEN REPLACE(`handling_department`, 'Jingzhou Transfer Yard Loading/Unloading Department', 'Jingzhou Transfer Yard Loading/Unloading Team')
             WHEN `handling_department` LIKE '%Tangshan Loading/Unloading Team 1%'
               THEN REPLACE(`handling_department`, 'Tangshan Loading/Unloading Team 1', 'Tangshan Loading/Unloading Team')
             WHEN `handling_department` LIKE '%Zhexi Hub Center%'
               THEN REPLACE(`handling_department`, 'Zhexi Hub Center', 'Hangzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Shanghai Hub Center%'
               THEN REPLACE(`handling_department`, 'Shanghai Hub Center', 'Shanghai Transfer Yard')
             WHEN `handling_department` LIKE '%Shunde Hub Center%'
               THEN REPLACE(`handling_department`, 'Shunde Hub Center', 'Shunde Transfer Yard')
             WHEN `handling_department` LIKE '%Sunan Hub Center%'
               THEN REPLACE(`handling_department`, 'Sunan Hub Center', 'Suzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Tianjin Hub Center%'
               THEN REPLACE(`handling_department`, 'Tianjin Hub Center', 'Tianjin Transfer Yard')
             WHEN `handling_department` LIKE '%Wuhan Hub Center%'
               THEN REPLACE(`handling_department`, 'Wuhan Hub Center', 'Wuhan Transfer Yard')
             WHEN `handling_department` LIKE '%Northwest Hub Center%'
               THEN REPLACE(`handling_department`, 'Northwest Hub Center', 'Xi\'an Transfer Yard')
             WHEN `handling_department` LIKE '%Zhengzhou Hub Center%'
               THEN REPLACE(`handling_department`, 'Zhengzhou Hub Center', 'Zhengzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Changzhou Transfer Center%'
               THEN REPLACE(`handling_department`, 'Changzhou Transfer Center', 'Changzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Chaoshan Transfer Center%'
               THEN REPLACE(`handling_department`, 'Chaoshan Transfer Center', 'Chaoshan Transfer Yard')
             WHEN `handling_department` LIKE '%Fangshan Transfer Center%'
               THEN REPLACE(`handling_department`, 'Fangshan Transfer Center', 'Fangshan Transfer Yard')
             WHEN `handling_department` LIKE '%Fuzhou Transfer Center%'
               THEN REPLACE(`handling_department`, 'Fuzhou Transfer Center', 'Fuzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Guiyang Transfer Center%'
               THEN REPLACE(`handling_department`, 'Guiyang Transfer Center', 'Guiyang Transfer Yard')
             WHEN `handling_department` LIKE '%Harbin Transfer Center%'
               THEN REPLACE(`handling_department`, 'Harbin Transfer Center', 'Harbin Transfer Yard')
             WHEN `handling_department` LIKE '%Huaian Transfer Center%'
               THEN REPLACE(`handling_department`, 'Huaian Transfer Center', 'Huaian Transfer Yard')
             WHEN `handling_department` LIKE '%Jinhua Transfer Center%'
               THEN REPLACE(`handling_department`, 'Jinhua Transfer Center', 'Jinhua Transfer Yard')
             WHEN `handling_department` LIKE '%Kunming Transfer Center%'
               THEN REPLACE(`handling_department`, 'Kunming Transfer Center', 'Kunming Transfer Yard')
             WHEN `handling_department` LIKE '%Lanzhou Transfer Center%'
               THEN REPLACE(`handling_department`, 'Lanzhou Transfer Center', 'Lanzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Luohe Transfer Center%'
               THEN REPLACE(`handling_department`, 'Luohe Transfer Center', 'Luohe Transfer Yard')
             WHEN `handling_department` LIKE '%Nanchang Transfer Center%'
               THEN REPLACE(`handling_department`, 'Nanchang Transfer Center', 'Nanchang Transfer Yard')
             WHEN `handling_department` LIKE '%Nanjing Transfer Center%'
               THEN REPLACE(`handling_department`, 'Nanjing Transfer Center', 'Nanjing Transfer Yard')
             WHEN `handling_department` LIKE '%Nanning Transfer Center%'
               THEN REPLACE(`handling_department`, 'Nanning Transfer Center', 'Nanning Transfer Yard')
             WHEN `handling_department` LIKE '%Nantong Transfer Center%'
               THEN REPLACE(`handling_department`, 'Nantong Transfer Center', 'Nantong Transfer Yard')
             WHEN `handling_department` LIKE '%Pudong Transfer Center%'
               THEN REPLACE(`handling_department`, 'Pudong Transfer Center', 'Pudong Transfer Yard')
             WHEN `handling_department` LIKE '%Quanzhou Transfer Center%'
               THEN REPLACE(`handling_department`, 'Quanzhou Transfer Center', 'Quanzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Xiamen Transfer Center%'
               THEN REPLACE(`handling_department`, 'Xiamen Transfer Center', 'Xiamen Transfer Yard')
             WHEN `handling_department` LIKE '%Shenyang Transfer Center%'
               THEN REPLACE(`handling_department`, 'Shenyang Transfer Center', 'Shenyang Transfer Yard')
             WHEN `handling_department` LIKE '%Taiyuan Transfer Center%'
               THEN REPLACE(`handling_department`, 'Taiyuan Transfer Center', 'Taiyuan Transfer Yard')
             WHEN `handling_department` LIKE '%Wenzhou Transfer Center%'
               THEN REPLACE(`handling_department`, 'Wenzhou Transfer Center', 'Wenzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Wuhu Transfer Center%'
               THEN REPLACE(`handling_department`, 'Wuhu Transfer Center', 'Wuhu Transfer Yard')
             WHEN `handling_department` LIKE '%Xuzhou Shaji Transfer Center%'
               THEN REPLACE(`handling_department`, 'Xuzhou Shaji Transfer Center', 'Xuzhou Shaji Transfer Yard')
             WHEN `handling_department` LIKE '%Xuzhou Transfer Center%'
               THEN REPLACE(`handling_department`, 'Xuzhou Transfer Center', 'Xuzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Yantai Transfer Center%'
               THEN REPLACE(`handling_department`, 'Yantai Transfer Center', 'Yantai Transfer Yard')
             WHEN `handling_department` LIKE '%Yangzhou Transfer Center%'
               THEN REPLACE(`handling_department`, 'Yangzhou Transfer Center', 'Yangzhou Transfer Yard')
             WHEN `handling_department` LIKE '%Changchun Transfer Center%'
               THEN REPLACE(`handling_department`, 'Changchun Transfer Center', 'Changchun Transfer Yard')
             WHEN `handling_department` LIKE '%Chongqing Baihe Transfer Center%'
               THEN REPLACE(`handling_department`, 'Chongqing Baihe Transfer Center', 'Chongqing Baihe Transfer Yard')
             ELSE `handling_department`
           END AS `handling_department_2`
    FROM (
        SELECT CAST(`handling_department` AS STRING) AS `handling_department`
        FROM (
            SELECT handed_dept_name AS `handling_department`
            FROM ads_opt_t_goods_odd_important_kd_di
        ) dataset_table
    ) table_1
) table_2
