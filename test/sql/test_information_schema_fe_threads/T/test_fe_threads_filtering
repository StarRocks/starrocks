-- name: test_fe_threads_filtering @sequential
-- Test filtering and querying capabilities

-- Test 1: Filter by specific thread name pattern
select thread_id, thread_name, thread_state 
from information_schema.fe_threads 
where thread_name like '%main%' 
limit 5;

-- Test 2: Filter by thread state and daemon status
select count(*) >= 0 from information_schema.fe_threads 
where thread_state = 'RUNNABLE' and is_daemon = true;

-- Test 3: Filter by priority range
select count(*) >= 0 from information_schema.fe_threads 
where priority >= 5 and priority <= 10;

-- Test 4: Filter threads with CPU time available (not -1)
select count(*) >= 0 from information_schema.fe_threads 
where cpu_time_ms >= 0;

-- Test 5: Filter threads with user time available (not -1)
select count(*) >= 0 from information_schema.fe_threads 
where user_time_ms >= 0;

-- Test 6: Order by thread ID
select thread_id, thread_name 
from information_schema.fe_threads 
order by thread_id 
limit 10;

-- Test 7: Order by thread name
select thread_id, thread_name, thread_state 
from information_schema.fe_threads 
order by thread_name 
limit 10;

-- Test 8: Count threads by state
select thread_state, count(*) as count 
from information_schema.fe_threads 
group by thread_state 
order by count desc;

-- Test 9: Count threads by daemon status
select is_daemon, count(*) as count 
from information_schema.fe_threads 
group by is_daemon;

-- Test 10: Find threads with highest CPU time
select thread_id, thread_name, cpu_time_ms 
from information_schema.fe_threads 
where cpu_time_ms >= 0 
order by cpu_time_ms desc 
limit 5;
