-- name: test_arrow_flight_3
arrow: CREATE DATABASE arrow_flight_${uuid0};
-- result:
0
-- !result
arrow: USE arrow_flight_${uuid0};
-- result:
0
-- !result
arrow: CREATE TABLE arrow_flight_${uuid0}.__row_util_base ( k1 bigint NULL ) DISTRIBUTED BY HASH(`k1`) BUCKETS 64 PROPERTIES ( "replication_num" = "1" );
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.__row_util_base select generate_series from TABLE(generate_series(0, 10000 - 1));
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.__row_util_base select * from arrow_flight_${uuid0}.__row_util_base;
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.__row_util_base select * from arrow_flight_${uuid0}.__row_util_base;
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.__row_util_base select * from arrow_flight_${uuid0}.__row_util_base;
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.__row_util_base select * from arrow_flight_${uuid0}.__row_util_base;
-- result:
0
-- !result
arrow: CREATE TABLE arrow_flight_${uuid0}.__row_util ( idx bigint NULL ) DISTRIBUTED BY HASH(`idx`) BUCKETS 64 PROPERTIES ( "replication_num" = "1" );
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.__row_util select row_number() over() as idx from arrow_flight_${uuid0}.__row_util_base;
-- result:
0
-- !result
arrow: CREATE TABLE arrow_flight_${uuid0}.t1 ( k1 bigint NULL, c_boolean boolean NULL, c_tinyint tinyint NULL, c_smallint smallint NULL, c_int int NULL, c_bigint bigint NULL, c_largeint largeint NULL, c_float float NULL, c_double double NULL, c_decimalv2 DECIMAL NULL, c_decimal32 DECIMAL(9, 1) NULL, c_decimal64 DECIMAL(18, 1) NULL, c_decimal128 DECIMAL(38, 1) NULL, c_date date NULL, c_datetime datetime NULL, c_varchar string NULL, c_char char(64) NULL, c_json JSON NULL, c_array_int ARRAY<INT> NULL, c_map MAP<INT, STRING> NULL, c_struct STRUCT<k1 INT, k2 STRING> NULL ) DISTRIBUTED BY HASH(`k1`) BUCKETS 64 PROPERTIES ( "replication_num" = "1" );
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.t1 SELECT idx, idx % 2 = 0, cast(idx % 128 as tinyint), cast(idx % 32768 as smallint), cast(idx as int), cast(idx as bigint), cast(idx * 1000000000000 as largeint), cast(idx as float), cast(idx as double), cast(idx + 0.1 as DECIMAL), cast(idx + 0.1 as DECIMAL(9, 1)), cast(idx + 0.1 as DECIMAL(18, 1)), cast(idx + 0.1 as DECIMAL(38, 1)), date_add('2020-01-01', interval idx day), date_add('2020-01-01 00:00:00', interval idx hour), cast(concat('varchar_', idx) as string), cast(concat('char_', idx) as char(64)), json_object('k1', idx, 'k2', concat('str_', idx)), [idx, idx + 1, idx + 2], map{0: concat('str_', idx), 1: concat('str_', idx + 1)}, struct(idx, concat('str_', idx)) FROM arrow_flight_${uuid0}.__row_util;
-- result:
0
-- !result
arrow: insert into arrow_flight_${uuid0}.t1(k1) select idx + 1600000 from arrow_flight_${uuid0}.__row_util where idx <= 10000;
-- result:
0
-- !result
arrow: select * from arrow_flight_${uuid0}.t1 order by k1 limit 10;
-- result:
1	False	1	1	1	1	1000000000000	1.0	1.0	1	1.1	1.1	1.1	2020-01-02	2020-01-01 01:00:00	varchar_1	char_1	{"k1": 1, "k2": "str_1"}	[1, 2, 3]	[(0, 'str_1'), (1, 'str_2')]	{'k1': 1, 'k2': 'str_1'}
2	True	2	2	2	2	2000000000000	2.0	2.0	2	2.1	2.1	2.1	2020-01-03	2020-01-01 02:00:00	varchar_2	char_2	{"k1": 2, "k2": "str_2"}	[2, 3, 4]	[(0, 'str_2'), (1, 'str_3')]	{'k1': 2, 'k2': 'str_2'}
3	False	3	3	3	3	3000000000000	3.0	3.0	3	3.1	3.1	3.1	2020-01-04	2020-01-01 03:00:00	varchar_3	char_3	{"k1": 3, "k2": "str_3"}	[3, 4, 5]	[(0, 'str_3'), (1, 'str_4')]	{'k1': 3, 'k2': 'str_3'}
4	True	4	4	4	4	4000000000000	4.0	4.0	4	4.1	4.1	4.1	2020-01-05	2020-01-01 04:00:00	varchar_4	char_4	{"k1": 4, "k2": "str_4"}	[4, 5, 6]	[(0, 'str_4'), (1, 'str_5')]	{'k1': 4, 'k2': 'str_4'}
5	False	5	5	5	5	5000000000000	5.0	5.0	5	5.1	5.1	5.1	2020-01-06	2020-01-01 05:00:00	varchar_5	char_5	{"k1": 5, "k2": "str_5"}	[5, 6, 7]	[(0, 'str_5'), (1, 'str_6')]	{'k1': 5, 'k2': 'str_5'}
6	True	6	6	6	6	6000000000000	6.0	6.0	6	6.1	6.1	6.1	2020-01-07	2020-01-01 06:00:00	varchar_6	char_6	{"k1": 6, "k2": "str_6"}	[6, 7, 8]	[(0, 'str_6'), (1, 'str_7')]	{'k1': 6, 'k2': 'str_6'}
7	False	7	7	7	7	7000000000000	7.0	7.0	7	7.1	7.1	7.1	2020-01-08	2020-01-01 07:00:00	varchar_7	char_7	{"k1": 7, "k2": "str_7"}	[7, 8, 9]	[(0, 'str_7'), (1, 'str_8')]	{'k1': 7, 'k2': 'str_7'}
8	True	8	8	8	8	8000000000000	8.0	8.0	8	8.1	8.1	8.1	2020-01-09	2020-01-01 08:00:00	varchar_8	char_8	{"k1": 8, "k2": "str_8"}	[8, 9, 10]	[(0, 'str_8'), (1, 'str_9')]	{'k1': 8, 'k2': 'str_8'}
9	False	9	9	9	9	9000000000000	9.0	9.0	9	9.1	9.1	9.1	2020-01-10	2020-01-01 09:00:00	varchar_9	char_9	{"k1": 9, "k2": "str_9"}	[9, 10, 11]	[(0, 'str_9'), (1, 'str_10')]	{'k1': 9, 'k2': 'str_9'}
10	True	10	10	10	10	10000000000000	10.0	10.0	10	10.1	10.1	10.1	2020-01-11	2020-01-01 10:00:00	varchar_10	char_10	{"k1": 10, "k2": "str_10"}	[10, 11, 12]	[(0, 'str_10'), (1, 'str_11')]	{'k1': 10, 'k2': 'str_10'}
-- !result
arrow: select * from arrow_flight_${uuid0}.t1 where false;
-- result:
-- !result
arrow: select * from arrow_flight_${uuid0}.t1 where k1 < 0;
-- result:
-- !result
arrow: select distinct k1, c_boolean, c_tinyint, c_smallint, c_int, c_bigint, c_largeint, c_float, c_double, c_decimalv2, c_decimal32, c_decimal64, c_decimal128, c_date, c_datetime, c_varchar, c_char from arrow_flight_${uuid0}.t1 order by k1 limit 10;
-- result:
1	False	1	1	1	1	1000000000000	1.0	1.0	1	1.1	1.1	1.1	2020-01-02	2020-01-01 01:00:00	varchar_1	char_1
2	True	2	2	2	2	2000000000000	2.0	2.0	2	2.1	2.1	2.1	2020-01-03	2020-01-01 02:00:00	varchar_2	char_2
3	False	3	3	3	3	3000000000000	3.0	3.0	3	3.1	3.1	3.1	2020-01-04	2020-01-01 03:00:00	varchar_3	char_3
4	True	4	4	4	4	4000000000000	4.0	4.0	4	4.1	4.1	4.1	2020-01-05	2020-01-01 04:00:00	varchar_4	char_4
5	False	5	5	5	5	5000000000000	5.0	5.0	5	5.1	5.1	5.1	2020-01-06	2020-01-01 05:00:00	varchar_5	char_5
6	True	6	6	6	6	6000000000000	6.0	6.0	6	6.1	6.1	6.1	2020-01-07	2020-01-01 06:00:00	varchar_6	char_6
7	False	7	7	7	7	7000000000000	7.0	7.0	7	7.1	7.1	7.1	2020-01-08	2020-01-01 07:00:00	varchar_7	char_7
8	True	8	8	8	8	8000000000000	8.0	8.0	8	8.1	8.1	8.1	2020-01-09	2020-01-01 08:00:00	varchar_8	char_8
9	False	9	9	9	9	9000000000000	9.0	9.0	9	9.1	9.1	9.1	2020-01-10	2020-01-01 09:00:00	varchar_9	char_9
10	True	10	10	10	10	10000000000000	10.0	10.0	10	10.1	10.1	10.1	2020-01-11	2020-01-01 10:00:00	varchar_10	char_10
-- !result
arrow: select distinct k1, c_boolean, c_tinyint, c_smallint, c_int, c_bigint, c_largeint, c_float, c_double, c_decimalv2, c_decimal32, c_decimal64, c_decimal128, c_date, c_datetime, c_varchar, c_char from arrow_flight_${uuid0}.t1 order by k1 DESC limit 10;
-- result:
1610000	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609999	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609998	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609997	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609996	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609995	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609994	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609993	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609992	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
1609991	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None	None
-- !result
arrow: select distinct k1, c_boolean, c_tinyint, c_smallint, c_int, c_bigint, c_largeint, c_float, c_double, c_decimalv2, c_decimal32, c_decimal64, c_decimal128, c_date, c_datetime, c_varchar, c_char from arrow_flight_${uuid0}.t1 where false order by k1 limit 10;
-- result:
-- !result
arrow: select distinct k1, c_boolean, c_tinyint, c_smallint, c_int, c_bigint, c_largeint, c_float, c_double, c_decimalv2, c_decimal32, c_decimal64, c_decimal128, c_date, c_datetime, c_varchar, c_char from arrow_flight_${uuid0}.t1 where k1 < 0 order by k1 limit 10;
-- result:
-- !result
arrow: select 1;
-- result:
1
-- !result
arrow: drop database arrow_flight_${uuid0} force;
-- result:
0
-- !result