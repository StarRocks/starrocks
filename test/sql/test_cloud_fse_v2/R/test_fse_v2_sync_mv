-- name: test_fse_v2_sync_mv @cloud
create database test_sync_mv_${uuid0};
-- result:
-- !result
use test_sync_mv_${uuid0};
-- result:
-- !result
CREATE TABLE `t` (
    k1 int,
    v0 int,
    v1 int
)
DUPLICATE KEY(`k1`)
DISTRIBUTED BY HASH(`k1`) BUCKETS 3
PROPERTIES('replication_num' = '1');
-- result:
-- !result
INSERT INTO t VALUES (1, 1, 1);
-- result:
-- !result
ALTER TABLE t ADD COLUMN v2 int;
-- result:
-- !result
ALTER TABLE t DROP COLUMN v0;
-- result:
-- !result
ALTER TABLE t ADD COLUMN v0 string;
-- result:
-- !result
SELECT * FROM t ORDER BY k1;
-- result:
1	1	None	None
-- !result
CREATE MATERIALIZED VIEW mv AS
SELECT k1, v0, v1 FROM t;
-- result:
-- !result
function: wait_materialized_view_finish()
-- result:
None
-- !result
SELECT * FROM mv [_SYNC_MV_] ORDER BY k1;
-- result:
1	None	1
-- !result
INSERT INTO t (k1, v1, v0) VALUES (2, 2, 'test');
-- result:
-- !result
SELECT * FROM t ORDER BY k1;
-- result:
1	1	None	None
2	2	None	test
-- !result
SELECT * FROM mv [_SYNC_MV_] ORDER BY k1;
-- result:
1	None	1
2	test	2
-- !result
SELECT k1, v0, v1 FROM t ORDER BY k1;
-- result:
1	None	1
2	test	2
-- !result