-- name: test_array_join
CREATE TABLE `student_score` (
  `id` bigint(20) NULL COMMENT "",
  `scores` array<int(11)> NULL COMMENT ""
) ENGINE=OLAP
DUPLICATE KEY(`id`)
DISTRIBUTED BY HASH(`id`)
PROPERTIES (
"replication_num" = "1"
);
-- result:
-- !result

INSERT INTO student_score VALUES
(1, [80,85,87]),
(2, [77, null, 89]),
(3, null),
(4, []),
(5, [90,92]);
-- result:
-- !result

select id , c1 from student_score array join scores as c1 order by id,c1
-- result:
1	80
1	85
1	87
2   None
2	77
2	89
5	90
5	92
-- !result

select id , c1 from student_score left array join scores as c1 order by id,c1
-- result:
1	80
1	85
1	87
2   None
2	77
2	89
3   None
4   None
5	90
5	92
-- !result

select id ,c1 ,c2 from student_score array join scores as c1, scores as c2 order by id,c1
-- result:
1	80	80
1	85	85
1	87	87
2   None	None
2	77	77
2	89	89
5	90	90
5	92	92
-- !result

select id ,c1 ,c2 from student_score left array join scores as c1, scores as c2 order by id,c1
-- result:
1	80	80
1	85	85
1	87	87
2   None	None
2	77	77
2	89	89
3   None	None
4   None	None
5	90	90
5	92	92
-- !result

select id, c1, c2 from student_score array join scores as c1, [1,2] as c2
-- result:
E: (1064, 'Sizes of ARRAY-JOIN-ed arrays do not match.')
-- !result