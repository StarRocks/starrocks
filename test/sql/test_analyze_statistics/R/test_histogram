-- name: test_histogram
create database analyze_test_${uuid0};
-- result:
-- !result
use analyze_test_${uuid0};
-- result:
-- !result
CREATE TABLE `t1` (
    `k1`  date,
    `k2`  int,
    `k3`  int
)
PROPERTIES ('replication_num' = '1');
-- result:
-- !result
CREATE TABLE `t2` LIKE `t1`;
-- result:
-- !result
CREATE TABLE `t3` LIKE `t1`;
-- result:
-- !result
INSERT INTO t1
WITH series AS (
    SELECT g1 FROM TABLE(generate_series(1, 300)) AS t(g1)
)
SELECT date_add('2020-01-01', s1.g1) as k1 , s1.g1, s2.g1
FROM series s1, series s2
WHERE s1.g1 <= s2.g1
ORDER BY s1.g1;
-- result:
-- !result
INSERT INTO t2
WITH series AS (
    SELECT g1 FROM TABLE(generate_series(1, 300)) AS t(g1)
)
SELECT date_add('2020-01-01', 300-s1.g1) as k1 , s1.g1, s2.g1
FROM series s1, series s2
WHERE s1.g1 <= s2.g1
ORDER BY s1.g1;
-- result:
-- !result
INSERT INTO t3
WITH 
series AS (
    SELECT g1 FROM TABLE(generate_series(1, 300)) AS t(g1)
)
SELECT date_add('2020-01-01', s1.g1), s1.g1, s2.g1
FROM series s1, series s2;
-- result:
-- !result
SELECT k1, count(*)
FROM t1
GROUP BY k1
ORDER BY k1;
-- result:
2020-01-02	300
2020-01-03	299
2020-01-04	298
2020-01-05	297
2020-01-06	296
2020-01-07	295
2020-01-08	294
2020-01-09	293
2020-01-10	292
2020-01-11	291
2020-01-12	290
2020-01-13	289
2020-01-14	288
2020-01-15	287
2020-01-16	286
2020-01-17	285
2020-01-18	284
2020-01-19	283
2020-01-20	282
2020-01-21	281
2020-01-22	280
2020-01-23	279
2020-01-24	278
2020-01-25	277
2020-01-26	276
2020-01-27	275
2020-01-28	274
2020-01-29	273
2020-01-30	272
2020-01-31	271
2020-02-01	270
2020-02-02	269
2020-02-03	268
2020-02-04	267
2020-02-05	266
2020-02-06	265
2020-02-07	264
2020-02-08	263
2020-02-09	262
2020-02-10	261
2020-02-11	260
2020-02-12	259
2020-02-13	258
2020-02-14	257
2020-02-15	256
2020-02-16	255
2020-02-17	254
2020-02-18	253
2020-02-19	252
2020-02-20	251
2020-02-21	250
2020-02-22	249
2020-02-23	248
2020-02-24	247
2020-02-25	246
2020-02-26	245
2020-02-27	244
2020-02-28	243
2020-02-29	242
2020-03-01	241
2020-03-02	240
2020-03-03	239
2020-03-04	238
2020-03-05	237
2020-03-06	236
2020-03-07	235
2020-03-08	234
2020-03-09	233
2020-03-10	232
2020-03-11	231
2020-03-12	230
2020-03-13	229
2020-03-14	228
2020-03-15	227
2020-03-16	226
2020-03-17	225
2020-03-18	224
2020-03-19	223
2020-03-20	222
2020-03-21	221
2020-03-22	220
2020-03-23	219
2020-03-24	218
2020-03-25	217
2020-03-26	216
2020-03-27	215
2020-03-28	214
2020-03-29	213
2020-03-30	212
2020-03-31	211
2020-04-01	210
2020-04-02	209
2020-04-03	208
2020-04-04	207
2020-04-05	206
2020-04-06	205
2020-04-07	204
2020-04-08	203
2020-04-09	202
2020-04-10	201
2020-04-11	200
2020-04-12	199
2020-04-13	198
2020-04-14	197
2020-04-15	196
2020-04-16	195
2020-04-17	194
2020-04-18	193
2020-04-19	192
2020-04-20	191
2020-04-21	190
2020-04-22	189
2020-04-23	188
2020-04-24	187
2020-04-25	186
2020-04-26	185
2020-04-27	184
2020-04-28	183
2020-04-29	182
2020-04-30	181
2020-05-01	180
2020-05-02	179
2020-05-03	178
2020-05-04	177
2020-05-05	176
2020-05-06	175
2020-05-07	174
2020-05-08	173
2020-05-09	172
2020-05-10	171
2020-05-11	170
2020-05-12	169
2020-05-13	168
2020-05-14	167
2020-05-15	166
2020-05-16	165
2020-05-17	164
2020-05-18	163
2020-05-19	162
2020-05-20	161
2020-05-21	160
2020-05-22	159
2020-05-23	158
2020-05-24	157
2020-05-25	156
2020-05-26	155
2020-05-27	154
2020-05-28	153
2020-05-29	152
2020-05-30	151
2020-05-31	150
2020-06-01	149
2020-06-02	148
2020-06-03	147
2020-06-04	146
2020-06-05	145
2020-06-06	144
2020-06-07	143
2020-06-08	142
2020-06-09	141
2020-06-10	140
2020-06-11	139
2020-06-12	138
2020-06-13	137
2020-06-14	136
2020-06-15	135
2020-06-16	134
2020-06-17	133
2020-06-18	132
2020-06-19	131
2020-06-20	130
2020-06-21	129
2020-06-22	128
2020-06-23	127
2020-06-24	126
2020-06-25	125
2020-06-26	124
2020-06-27	123
2020-06-28	122
2020-06-29	121
2020-06-30	120
2020-07-01	119
2020-07-02	118
2020-07-03	117
2020-07-04	116
2020-07-05	115
2020-07-06	114
2020-07-07	113
2020-07-08	112
2020-07-09	111
2020-07-10	110
2020-07-11	109
2020-07-12	108
2020-07-13	107
2020-07-14	106
2020-07-15	105
2020-07-16	104
2020-07-17	103
2020-07-18	102
2020-07-19	101
2020-07-20	100
2020-07-21	99
2020-07-22	98
2020-07-23	97
2020-07-24	96
2020-07-25	95
2020-07-26	94
2020-07-27	93
2020-07-28	92
2020-07-29	91
2020-07-30	90
2020-07-31	89
2020-08-01	88
2020-08-02	87
2020-08-03	86
2020-08-04	85
2020-08-05	84
2020-08-06	83
2020-08-07	82
2020-08-08	81
2020-08-09	80
2020-08-10	79
2020-08-11	78
2020-08-12	77
2020-08-13	76
2020-08-14	75
2020-08-15	74
2020-08-16	73
2020-08-17	72
2020-08-18	71
2020-08-19	70
2020-08-20	69
2020-08-21	68
2020-08-22	67
2020-08-23	66
2020-08-24	65
2020-08-25	64
2020-08-26	63
2020-08-27	62
2020-08-28	61
2020-08-29	60
2020-08-30	59
2020-08-31	58
2020-09-01	57
2020-09-02	56
2020-09-03	55
2020-09-04	54
2020-09-05	53
2020-09-06	52
2020-09-07	51
2020-09-08	50
2020-09-09	49
2020-09-10	48
2020-09-11	47
2020-09-12	46
2020-09-13	45
2020-09-14	44
2020-09-15	43
2020-09-16	42
2020-09-17	41
2020-09-18	40
2020-09-19	39
2020-09-20	38
2020-09-21	37
2020-09-22	36
2020-09-23	35
2020-09-24	34
2020-09-25	33
2020-09-26	32
2020-09-27	31
2020-09-28	30
2020-09-29	29
2020-09-30	28
2020-10-01	27
2020-10-02	26
2020-10-03	25
2020-10-04	24
2020-10-05	23
2020-10-06	22
2020-10-07	21
2020-10-08	20
2020-10-09	19
2020-10-10	18
2020-10-11	17
2020-10-12	16
2020-10-13	15
2020-10-14	14
2020-10-15	13
2020-10-16	12
2020-10-17	11
2020-10-18	10
2020-10-19	9
2020-10-20	8
2020-10-21	7
2020-10-22	6
2020-10-23	5
2020-10-24	4
2020-10-25	3
2020-10-26	2
2020-10-27	1
-- !result
SELECT k2, count(*)
FROM t1
GROUP BY k2
ORDER BY k2;
-- result:
1	300
2	299
3	298
4	297
5	296
6	295
7	294
8	293
9	292
10	291
11	290
12	289
13	288
14	287
15	286
16	285
17	284
18	283
19	282
20	281
21	280
22	279
23	278
24	277
25	276
26	275
27	274
28	273
29	272
30	271
31	270
32	269
33	268
34	267
35	266
36	265
37	264
38	263
39	262
40	261
41	260
42	259
43	258
44	257
45	256
46	255
47	254
48	253
49	252
50	251
51	250
52	249
53	248
54	247
55	246
56	245
57	244
58	243
59	242
60	241
61	240
62	239
63	238
64	237
65	236
66	235
67	234
68	233
69	232
70	231
71	230
72	229
73	228
74	227
75	226
76	225
77	224
78	223
79	222
80	221
81	220
82	219
83	218
84	217
85	216
86	215
87	214
88	213
89	212
90	211
91	210
92	209
93	208
94	207
95	206
96	205
97	204
98	203
99	202
100	201
101	200
102	199
103	198
104	197
105	196
106	195
107	194
108	193
109	192
110	191
111	190
112	189
113	188
114	187
115	186
116	185
117	184
118	183
119	182
120	181
121	180
122	179
123	178
124	177
125	176
126	175
127	174
128	173
129	172
130	171
131	170
132	169
133	168
134	167
135	166
136	165
137	164
138	163
139	162
140	161
141	160
142	159
143	158
144	157
145	156
146	155
147	154
148	153
149	152
150	151
151	150
152	149
153	148
154	147
155	146
156	145
157	144
158	143
159	142
160	141
161	140
162	139
163	138
164	137
165	136
166	135
167	134
168	133
169	132
170	131
171	130
172	129
173	128
174	127
175	126
176	125
177	124
178	123
179	122
180	121
181	120
182	119
183	118
184	117
185	116
186	115
187	114
188	113
189	112
190	111
191	110
192	109
193	108
194	107
195	106
196	105
197	104
198	103
199	102
200	101
201	100
202	99
203	98
204	97
205	96
206	95
207	94
208	93
209	92
210	91
211	90
212	89
213	88
214	87
215	86
216	85
217	84
218	83
219	82
220	81
221	80
222	79
223	78
224	77
225	76
226	75
227	74
228	73
229	72
230	71
231	70
232	69
233	68
234	67
235	66
236	65
237	64
238	63
239	62
240	61
241	60
242	59
243	58
244	57
245	56
246	55
247	54
248	53
249	52
250	51
251	50
252	49
253	48
254	47
255	46
256	45
257	44
258	43
259	42
260	41
261	40
262	39
263	38
264	37
265	36
266	35
267	34
268	33
269	32
270	31
271	30
272	29
273	28
274	27
275	26
276	25
277	24
278	23
279	22
280	21
281	20
282	19
283	18
284	17
285	16
286	15
287	14
288	13
289	12
290	11
291	10
292	9
293	8
294	7
295	6
296	5
297	4
298	3
299	2
300	1
-- !result
SELECT k1, count(*)
FROM t2
GROUP BY k1
ORDER BY k1;
-- result:
2020-01-01	1
2020-01-02	2
2020-01-03	3
2020-01-04	4
2020-01-05	5
2020-01-06	6
2020-01-07	7
2020-01-08	8
2020-01-09	9
2020-01-10	10
2020-01-11	11
2020-01-12	12
2020-01-13	13
2020-01-14	14
2020-01-15	15
2020-01-16	16
2020-01-17	17
2020-01-18	18
2020-01-19	19
2020-01-20	20
2020-01-21	21
2020-01-22	22
2020-01-23	23
2020-01-24	24
2020-01-25	25
2020-01-26	26
2020-01-27	27
2020-01-28	28
2020-01-29	29
2020-01-30	30
2020-01-31	31
2020-02-01	32
2020-02-02	33
2020-02-03	34
2020-02-04	35
2020-02-05	36
2020-02-06	37
2020-02-07	38
2020-02-08	39
2020-02-09	40
2020-02-10	41
2020-02-11	42
2020-02-12	43
2020-02-13	44
2020-02-14	45
2020-02-15	46
2020-02-16	47
2020-02-17	48
2020-02-18	49
2020-02-19	50
2020-02-20	51
2020-02-21	52
2020-02-22	53
2020-02-23	54
2020-02-24	55
2020-02-25	56
2020-02-26	57
2020-02-27	58
2020-02-28	59
2020-02-29	60
2020-03-01	61
2020-03-02	62
2020-03-03	63
2020-03-04	64
2020-03-05	65
2020-03-06	66
2020-03-07	67
2020-03-08	68
2020-03-09	69
2020-03-10	70
2020-03-11	71
2020-03-12	72
2020-03-13	73
2020-03-14	74
2020-03-15	75
2020-03-16	76
2020-03-17	77
2020-03-18	78
2020-03-19	79
2020-03-20	80
2020-03-21	81
2020-03-22	82
2020-03-23	83
2020-03-24	84
2020-03-25	85
2020-03-26	86
2020-03-27	87
2020-03-28	88
2020-03-29	89
2020-03-30	90
2020-03-31	91
2020-04-01	92
2020-04-02	93
2020-04-03	94
2020-04-04	95
2020-04-05	96
2020-04-06	97
2020-04-07	98
2020-04-08	99
2020-04-09	100
2020-04-10	101
2020-04-11	102
2020-04-12	103
2020-04-13	104
2020-04-14	105
2020-04-15	106
2020-04-16	107
2020-04-17	108
2020-04-18	109
2020-04-19	110
2020-04-20	111
2020-04-21	112
2020-04-22	113
2020-04-23	114
2020-04-24	115
2020-04-25	116
2020-04-26	117
2020-04-27	118
2020-04-28	119
2020-04-29	120
2020-04-30	121
2020-05-01	122
2020-05-02	123
2020-05-03	124
2020-05-04	125
2020-05-05	126
2020-05-06	127
2020-05-07	128
2020-05-08	129
2020-05-09	130
2020-05-10	131
2020-05-11	132
2020-05-12	133
2020-05-13	134
2020-05-14	135
2020-05-15	136
2020-05-16	137
2020-05-17	138
2020-05-18	139
2020-05-19	140
2020-05-20	141
2020-05-21	142
2020-05-22	143
2020-05-23	144
2020-05-24	145
2020-05-25	146
2020-05-26	147
2020-05-27	148
2020-05-28	149
2020-05-29	150
2020-05-30	151
2020-05-31	152
2020-06-01	153
2020-06-02	154
2020-06-03	155
2020-06-04	156
2020-06-05	157
2020-06-06	158
2020-06-07	159
2020-06-08	160
2020-06-09	161
2020-06-10	162
2020-06-11	163
2020-06-12	164
2020-06-13	165
2020-06-14	166
2020-06-15	167
2020-06-16	168
2020-06-17	169
2020-06-18	170
2020-06-19	171
2020-06-20	172
2020-06-21	173
2020-06-22	174
2020-06-23	175
2020-06-24	176
2020-06-25	177
2020-06-26	178
2020-06-27	179
2020-06-28	180
2020-06-29	181
2020-06-30	182
2020-07-01	183
2020-07-02	184
2020-07-03	185
2020-07-04	186
2020-07-05	187
2020-07-06	188
2020-07-07	189
2020-07-08	190
2020-07-09	191
2020-07-10	192
2020-07-11	193
2020-07-12	194
2020-07-13	195
2020-07-14	196
2020-07-15	197
2020-07-16	198
2020-07-17	199
2020-07-18	200
2020-07-19	201
2020-07-20	202
2020-07-21	203
2020-07-22	204
2020-07-23	205
2020-07-24	206
2020-07-25	207
2020-07-26	208
2020-07-27	209
2020-07-28	210
2020-07-29	211
2020-07-30	212
2020-07-31	213
2020-08-01	214
2020-08-02	215
2020-08-03	216
2020-08-04	217
2020-08-05	218
2020-08-06	219
2020-08-07	220
2020-08-08	221
2020-08-09	222
2020-08-10	223
2020-08-11	224
2020-08-12	225
2020-08-13	226
2020-08-14	227
2020-08-15	228
2020-08-16	229
2020-08-17	230
2020-08-18	231
2020-08-19	232
2020-08-20	233
2020-08-21	234
2020-08-22	235
2020-08-23	236
2020-08-24	237
2020-08-25	238
2020-08-26	239
2020-08-27	240
2020-08-28	241
2020-08-29	242
2020-08-30	243
2020-08-31	244
2020-09-01	245
2020-09-02	246
2020-09-03	247
2020-09-04	248
2020-09-05	249
2020-09-06	250
2020-09-07	251
2020-09-08	252
2020-09-09	253
2020-09-10	254
2020-09-11	255
2020-09-12	256
2020-09-13	257
2020-09-14	258
2020-09-15	259
2020-09-16	260
2020-09-17	261
2020-09-18	262
2020-09-19	263
2020-09-20	264
2020-09-21	265
2020-09-22	266
2020-09-23	267
2020-09-24	268
2020-09-25	269
2020-09-26	270
2020-09-27	271
2020-09-28	272
2020-09-29	273
2020-09-30	274
2020-10-01	275
2020-10-02	276
2020-10-03	277
2020-10-04	278
2020-10-05	279
2020-10-06	280
2020-10-07	281
2020-10-08	282
2020-10-09	283
2020-10-10	284
2020-10-11	285
2020-10-12	286
2020-10-13	287
2020-10-14	288
2020-10-15	289
2020-10-16	290
2020-10-17	291
2020-10-18	292
2020-10-19	293
2020-10-20	294
2020-10-21	295
2020-10-22	296
2020-10-23	297
2020-10-24	298
2020-10-25	299
2020-10-26	300
-- !result
SELECT k1, count(*)
FROM t3
GROUP BY k1
ORDER BY k1;
-- result:
2020-01-02	300
2020-01-03	300
2020-01-04	300
2020-01-05	300
2020-01-06	300
2020-01-07	300
2020-01-08	300
2020-01-09	300
2020-01-10	300
2020-01-11	300
2020-01-12	300
2020-01-13	300
2020-01-14	300
2020-01-15	300
2020-01-16	300
2020-01-17	300
2020-01-18	300
2020-01-19	300
2020-01-20	300
2020-01-21	300
2020-01-22	300
2020-01-23	300
2020-01-24	300
2020-01-25	300
2020-01-26	300
2020-01-27	300
2020-01-28	300
2020-01-29	300
2020-01-30	300
2020-01-31	300
2020-02-01	300
2020-02-02	300
2020-02-03	300
2020-02-04	300
2020-02-05	300
2020-02-06	300
2020-02-07	300
2020-02-08	300
2020-02-09	300
2020-02-10	300
2020-02-11	300
2020-02-12	300
2020-02-13	300
2020-02-14	300
2020-02-15	300
2020-02-16	300
2020-02-17	300
2020-02-18	300
2020-02-19	300
2020-02-20	300
2020-02-21	300
2020-02-22	300
2020-02-23	300
2020-02-24	300
2020-02-25	300
2020-02-26	300
2020-02-27	300
2020-02-28	300
2020-02-29	300
2020-03-01	300
2020-03-02	300
2020-03-03	300
2020-03-04	300
2020-03-05	300
2020-03-06	300
2020-03-07	300
2020-03-08	300
2020-03-09	300
2020-03-10	300
2020-03-11	300
2020-03-12	300
2020-03-13	300
2020-03-14	300
2020-03-15	300
2020-03-16	300
2020-03-17	300
2020-03-18	300
2020-03-19	300
2020-03-20	300
2020-03-21	300
2020-03-22	300
2020-03-23	300
2020-03-24	300
2020-03-25	300
2020-03-26	300
2020-03-27	300
2020-03-28	300
2020-03-29	300
2020-03-30	300
2020-03-31	300
2020-04-01	300
2020-04-02	300
2020-04-03	300
2020-04-04	300
2020-04-05	300
2020-04-06	300
2020-04-07	300
2020-04-08	300
2020-04-09	300
2020-04-10	300
2020-04-11	300
2020-04-12	300
2020-04-13	300
2020-04-14	300
2020-04-15	300
2020-04-16	300
2020-04-17	300
2020-04-18	300
2020-04-19	300
2020-04-20	300
2020-04-21	300
2020-04-22	300
2020-04-23	300
2020-04-24	300
2020-04-25	300
2020-04-26	300
2020-04-27	300
2020-04-28	300
2020-04-29	300
2020-04-30	300
2020-05-01	300
2020-05-02	300
2020-05-03	300
2020-05-04	300
2020-05-05	300
2020-05-06	300
2020-05-07	300
2020-05-08	300
2020-05-09	300
2020-05-10	300
2020-05-11	300
2020-05-12	300
2020-05-13	300
2020-05-14	300
2020-05-15	300
2020-05-16	300
2020-05-17	300
2020-05-18	300
2020-05-19	300
2020-05-20	300
2020-05-21	300
2020-05-22	300
2020-05-23	300
2020-05-24	300
2020-05-25	300
2020-05-26	300
2020-05-27	300
2020-05-28	300
2020-05-29	300
2020-05-30	300
2020-05-31	300
2020-06-01	300
2020-06-02	300
2020-06-03	300
2020-06-04	300
2020-06-05	300
2020-06-06	300
2020-06-07	300
2020-06-08	300
2020-06-09	300
2020-06-10	300
2020-06-11	300
2020-06-12	300
2020-06-13	300
2020-06-14	300
2020-06-15	300
2020-06-16	300
2020-06-17	300
2020-06-18	300
2020-06-19	300
2020-06-20	300
2020-06-21	300
2020-06-22	300
2020-06-23	300
2020-06-24	300
2020-06-25	300
2020-06-26	300
2020-06-27	300
2020-06-28	300
2020-06-29	300
2020-06-30	300
2020-07-01	300
2020-07-02	300
2020-07-03	300
2020-07-04	300
2020-07-05	300
2020-07-06	300
2020-07-07	300
2020-07-08	300
2020-07-09	300
2020-07-10	300
2020-07-11	300
2020-07-12	300
2020-07-13	300
2020-07-14	300
2020-07-15	300
2020-07-16	300
2020-07-17	300
2020-07-18	300
2020-07-19	300
2020-07-20	300
2020-07-21	300
2020-07-22	300
2020-07-23	300
2020-07-24	300
2020-07-25	300
2020-07-26	300
2020-07-27	300
2020-07-28	300
2020-07-29	300
2020-07-30	300
2020-07-31	300
2020-08-01	300
2020-08-02	300
2020-08-03	300
2020-08-04	300
2020-08-05	300
2020-08-06	300
2020-08-07	300
2020-08-08	300
2020-08-09	300
2020-08-10	300
2020-08-11	300
2020-08-12	300
2020-08-13	300
2020-08-14	300
2020-08-15	300
2020-08-16	300
2020-08-17	300
2020-08-18	300
2020-08-19	300
2020-08-20	300
2020-08-21	300
2020-08-22	300
2020-08-23	300
2020-08-24	300
2020-08-25	300
2020-08-26	300
2020-08-27	300
2020-08-28	300
2020-08-29	300
2020-08-30	300
2020-08-31	300
2020-09-01	300
2020-09-02	300
2020-09-03	300
2020-09-04	300
2020-09-05	300
2020-09-06	300
2020-09-07	300
2020-09-08	300
2020-09-09	300
2020-09-10	300
2020-09-11	300
2020-09-12	300
2020-09-13	300
2020-09-14	300
2020-09-15	300
2020-09-16	300
2020-09-17	300
2020-09-18	300
2020-09-19	300
2020-09-20	300
2020-09-21	300
2020-09-22	300
2020-09-23	300
2020-09-24	300
2020-09-25	300
2020-09-26	300
2020-09-27	300
2020-09-28	300
2020-09-29	300
2020-09-30	300
2020-10-01	300
2020-10-02	300
2020-10-03	300
2020-10-04	300
2020-10-05	300
2020-10-06	300
2020-10-07	300
2020-10-08	300
2020-10-09	300
2020-10-10	300
2020-10-11	300
2020-10-12	300
2020-10-13	300
2020-10-14	300
2020-10-15	300
2020-10-16	300
2020-10-17	300
2020-10-18	300
2020-10-19	300
2020-10-20	300
2020-10-21	300
2020-10-22	300
2020-10-23	300
2020-10-24	300
2020-10-25	300
2020-10-26	300
2020-10-27	300
-- !result
[UC] ANALYZE FULL TABLE t1;
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t1	analyze	status	OK
-- !result
[UC] ANALYZE FULL TABLE t2;
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t2	analyze	status	OK
-- !result
[UC] ANALYZE FULL TABLE t3;
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t3	analyze	status	OK
-- !result
SELECT min,max,row_count,hll_cardinality(ndv) FROM _statistics_.column_statistics WHERE table_name = 'analyze_test_${uuid0}.t1' and column_name = 'k1';
-- result:
2020-01-02	2020-10-27	45150	298
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 WHERE k1="2020-01-02"', 'cardinality: 152')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 WHERE k1="2020-01-10"', 'cardinality: 152')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 WHERE k1="2020-01-30"', 'cardinality: 152')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t2 WHERE k1="2020-01-02"', 'cardinality: 152')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t2 WHERE k1="2020-01-10"', 'cardinality: 152')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t2 WHERE k1="2020-01-30"', 'cardinality: 152')
-- result:
None
-- !result
[UC] ANALYZE TABLE t1 UPDATE HISTOGRAM ON k1,k2,k3 PROPERTIES('histogram_sample_ratio' = '1.0');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t1	histogram	status	OK
-- !result
[UC] ANALYZE TABLE t2 UPDATE HISTOGRAM ON k1,k2,k3 PROPERTIES('histogram_sample_ratio' = '1.0');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t2	histogram	status	OK
-- !result
[UC] ANALYZE TABLE t3 UPDATE HISTOGRAM ON k1,k2,k3 PROPERTIES('histogram_sample_ratio' = '1.0');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t3	histogram	status	OK
-- !result
set enable_stats_to_optimize_skew_join = false;
-- result:
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 WHERE k2=120', 'cardinality: 181')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 WHERE k1="2020-05-11"', 'cardinality: 32')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 WHERE k1="2020-06-11"', 'cardinality: 139')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 WHERE k1="2020-07-11"', 'cardinality: 109')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t2 WHERE k1="2020-05-11"', 'cardinality: 49')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t2 WHERE k1="2020-06-11"', 'cardinality: 163')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t2 WHERE k1="2020-07-11"', 'cardinality: 193')
-- result:
None
-- !result
SELECT COUNT(*) FROM t1 JOIN t2 USING (k1);
-- result:
4589949
-- !result
SELECT COUNT(*) FROM t1 JOIN t2 USING (k1) WHERE t1.k1 BETWEEN "2020-01-21" AND "2020-01-30";
-- result:
70425
-- !result
SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-05-01" AND "2020-05-10";
-- result:
526500
-- !result
SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-06-01" AND "2020-06-10";
-- result:
433500
-- !result
SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-07-01" AND "2020-07-10";
-- result:
343500
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1;
-- result:
1376984700
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30";
-- result:
21127500
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10";
-- result:
66577500
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-06-01" AND "2020-06-10";
-- result:
68251500
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-07-01" AND "2020-07-10";
-- result:
64381500
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3;
-- result:
1376984700
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30" AND n1.k3 BETWEEN 50 AND 100;
-- result:
3901500
-- !result
SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10" AND n1.k3 BETWEEN 200 AND 250;
-- result:
19354500
-- !result
set cbo_enable_histogram_join_estimation = false;
-- result:
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1)', 'cardinality: 45150', 'cardinality: 6840680')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1) WHERE t1.k1 BETWEEN "2020-01-21" AND "2020-01-30" ', 'cardinality: 176', 'cardinality: 2765', 'cardinality: 1633')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-05-01" AND "2020-05-10" ', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 17668')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-06-01" AND "2020-06-10" ', 'cardinality: 3085', 'cardinality: 1230', 'cardinality: 12733')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-07-01" AND "2020-07-10" ', 'cardinality: 2925', 'cardinality: 975', 'cardinality: 9570')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 6840680', 'cardinality: 2065977039')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30"', 'cardinality: 176', 'cardinality: 2765', 'cardinality: 2236', 'cardinality: 1633', 'cardinality: 12253')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10"', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 1134', 'cardinality: 6678', 'cardinality: 67232')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-06-01" AND "2020-06-10"', 'cardinality: 3085', 'cardinality: 1230', 'cardinality: 1335', 'cardinality: 5510', 'cardinality: 57044')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-07-01" AND "2020-07-10"', 'cardinality: 2925', 'cardinality: 975', 'cardinality: 1683', 'cardinality: 5506', 'cardinality: 54048')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 6840680', 'cardinality: 2045385906')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30" AND n1.k3 BETWEEN 50 AND 100', 'cardinality: 176', 'cardinality: 225', 'cardinality: 15000', 'cardinality: 176', 'cardinality: 8771')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10" AND n1.k3 BETWEEN 200 AND 250', 'cardinality: 1134', 'cardinality: 446', 'cardinality: 1697', 'cardinality: 1697', 'cardinality: 15025')
-- result:
None
-- !result
set cbo_enable_histogram_join_estimation = true;
-- result:
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1)', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 3645821')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1) WHERE t1.k1 BETWEEN "2020-01-21" AND "2020-01-30" ', 'cardinality: 176', 'cardinality: 2765', 'cardinality: 10239')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-05-01" AND "2020-05-10" ', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 165302')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-06-01" AND "2020-06-10" ', 'cardinality: 3085', 'cardinality: 1230', 'cardinality: 93773')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-07-01" AND "2020-07-10" ', 'cardinality: 2925', 'cardinality: 975', 'cardinality: 75849')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 3645821', 'cardinality: 798048960')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30"', 'cardinality: 176', 'cardinality: 2765', 'cardinality: 2236', 'cardinality: 10239', 'cardinality: 2741799')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10"', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 1134', 'cardinality: 716918', 'cardinality: 716918')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-06-01" AND "2020-06-10"', 'cardinality: 3085', 'cardinality: 1230', 'cardinality: 1335', 'cardinality: 47457', 'cardinality: 7386159')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-07-01" AND "2020-07-10"', 'cardinality: 2925', 'cardinality: 975', 'cardinality: 1683', 'cardinality: 25034', 'cardinality: 668664')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 3645821', 'cardinality: 1064520058')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30" AND n1.k3 BETWEEN 50 AND 100', 'cardinality: 225', 'cardinality: 176', 'cardinality: 15000', 'cardinality: 835', 'cardinality: 264915')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10" AND n1.k3 BETWEEN 200 AND 250', 'cardinality: 15025', 'cardinality: 1134', 'cardinality: 446', 'cardinality: 6628', 'cardinality: 1707096')
-- result:
None
-- !result
[UC] ANALYZE TABLE t1 UPDATE HISTOGRAM ON k1,k2,k3 PROPERTIES('histogram_sample_ratio' = '1.0', "histogram_mcv_size" = '400');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t1	histogram	status	OK
-- !result
[UC] ANALYZE TABLE t2 UPDATE HISTOGRAM ON k1,k2,k3 PROPERTIES('histogram_sample_ratio' = '1.0', "histogram_mcv_size" = '400');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t2	histogram	status	OK
-- !result
[UC] ANALYZE TABLE t3 UPDATE HISTOGRAM ON k1,k2,k3 PROPERTIES('histogram_sample_ratio' = '1.0', "histogram_mcv_size" = '400');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t3	histogram	status	OK
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1)', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 4589949')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1) WHERE t1.k1 BETWEEN "2020-01-21" AND "2020-01-30" ', 'cardinality: 255', 'cardinality: 2765', 'cardinality: 70425')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-05-01" AND "2020-05-10" ', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 526500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-06-01" AND "2020-06-10" ', 'cardinality: 3000', 'cardinality: 1445', 'cardinality: 433500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-07-01" AND "2020-07-10" ', 'cardinality: 3000', 'cardinality: 1145', 'cardinality: 343500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 4589949', 'cardinality: 1376984700')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30"', 'cardinality: 255', 'cardinality: 2765', 'cardinality: 3000', 'cardinality: 70425', 'cardinality: 21127500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10"', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 1265', 'cardinality: 221925', 'cardinality: 66577500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-06-01" AND "2020-06-10"', 'cardinality: 3000', 'cardinality: 1445', 'cardinality: 1575', 'cardinality: 227505', 'cardinality: 68251500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-07-01" AND "2020-07-10"', 'cardinality: 3000', 'cardinality: 1875', 'cardinality: 1145', 'cardinality: 214605', 'cardinality: 64381500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 4589949', 'cardinality: 1376984700')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30" AND n1.k3 BETWEEN 50 AND 100', 'cardinality: 15300', 'cardinality: 234', 'cardinality: 255', 'cardinality: 5966', 'cardinality: 1789871')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10" AND n1.k3 BETWEEN 200 AND 250', 'cardinality: 1265', 'cardinality: 446', 'cardinality: 15300', 'cardinality: 56403', 'cardinality: 16920860')
-- result:
None
-- !result
[UC] ANALYZE TABLE t1 UPDATE HISTOGRAM ON k1,k2,k3 WITH 256 BUCKETS PROPERTIES('histogram_sample_ratio' = '1.0', "histogram_mcv_size" = '100');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t1	histogram	status	OK
-- !result
[UC] ANALYZE TABLE t2 UPDATE HISTOGRAM ON k1,k2,k3 WITH 256 BUCKETS PROPERTIES('histogram_sample_ratio' = '1.0', "histogram_mcv_size" = '100');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t2	histogram	status	OK
-- !result
[UC] ANALYZE TABLE t3 UPDATE HISTOGRAM ON k1,k2,k3 WITH 256 BUCKETS PROPERTIES('histogram_sample_ratio' = '1.0', "histogram_mcv_size" = '100');
-- result:
analyze_test_7900a47b61a0481fbd4f2b74af0fd9ef.t3	histogram	status	OK
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1)', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 4562636')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t2 USING (k1) WHERE t1.k1 BETWEEN "2020-01-21" AND "2020-01-30" ', 'cardinality: 209', 'cardinality: 2765', 'cardinality: 24300')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-05-01" AND "2020-05-10" ', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 526500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-06-01" AND "2020-06-10" ', 'cardinality: 3000', 'cardinality: 1445', 'cardinality: 433500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM t1 JOIN t3 USING (k1) WHERE t1.k1 BETWEEN "2020-07-01" AND "2020-07-10" ', 'cardinality: 3000', 'cardinality: 1145', 'cardinality: 343500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 4562636', 'cardinality: 1368790800')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30"', 'cardinality: 209', 'cardinality: 2765', 'cardinality: 3000', 'cardinality: 24300', 'cardinality: 7290000')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10"', 'cardinality: 3000', 'cardinality: 1755', 'cardinality: 1265', 'cardinality: 221925', 'cardinality: 66577500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-06-01" AND "2020-06-10"', 'cardinality: 3000', 'cardinality: 1445', 'cardinality: 1575', 'cardinality: 227505', 'cardinality: 68251500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k1 = n3.k1 WHERE n1.k1 BETWEEN "2020-07-01" AND "2020-07-10"', 'cardinality: 3000', 'cardinality: 1875', 'cardinality: 1145', 'cardinality: 214605', 'cardinality: 64381500')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3', 'cardinality: 45150', 'cardinality: 45150', 'cardinality: 90000', 'cardinality: 4562636', 'cardinality: 1368912066')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-01-21" AND "2020-01-30" AND n1.k3 BETWEEN 50 AND 100', 'cardinality: 15300', 'cardinality: 234', 'cardinality: 209', 'cardinality: 2059', 'cardinality: 617591')
-- result:
None
-- !result
function: assert_explain_verbose_contains('SELECT COUNT(*) FROM (t1 n1 JOIN t2 n2 ON n1.k1 = n2.k1) JOIN t3 n3 ON n1.k3 = n3.k3 WHERE n1.k1 BETWEEN "2020-05-01" AND "2020-05-10" AND n1.k3 BETWEEN 200 AND 250', 'cardinality: 1265', 'cardinality: 446', 'cardinality: 15300', 'cardinality: 56403', 'cardinality: 16920860')
-- result:
None
-- !result