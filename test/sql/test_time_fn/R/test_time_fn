-- name: test_week_iso
select week_iso("2023-01-01");
-- result:
52
-- !result
select week_iso("2023-01-02");
-- result:
1
-- !result
select week_iso("2023-01-03");
-- result:
1
-- !result
select week_iso("");
-- result:
NULL
-- !result
select week_iso(NULL);
-- result:
NULL
-- !result

<<<<<<< HEAD
=======
-- name: test_day_of_week_iso
select dayofweek_iso("2023-01-01");
-- result:
7
-- !result
select dayofweek_iso("2023-01-02");
-- result:
1
-- !result
select dayofweek_iso("2023-01-03");
-- result:
2
-- !result
select dayofweek_iso("");
-- result:
None
-- !result
select dayofweek_iso(NULL);
-- result:
None
-- !result

-- name: test_makedate
CREATE TABLE IF NOT EXISTS `makedate_test` (
  `id` int,
  `col_year` int,
  `col_day` int
)
DISTRIBUTED BY HASH(`id`)
PROPERTIES(
  "replication_num" = "1"
);
-- result:
-- !result
INSERT INTO `makedate_test`(id, col_year, col_day)
VALUES (1, NUll, NUll),
       (2, 1, NUll),
       (3, NULL, 1),
       (4, 0, 1),
       (5, 2023, 0),
       (6, 2023, 32),
       (7, 2023, 365),
       (8, 2023, 366),
       (9, 9999, 1),
       (10, 9999, 365),
       (11, 9999, 366),
       (12, 10000, 1),
       (13, 1, -1);
-- result:
-- !result
select makedate(NUll,NUll);
-- result:
None
-- !result
select makedate(1,NUll);
-- result:
None
-- !result
select makedate(NUll,1);
-- result:
None
-- !result
select makedate(0,1);
-- result:
0000-01-01
-- !result
select makedate(2023, 0);
-- result:
None
-- !result
select makedate(2023, 32);
-- result:
2023-02-01
-- !result
select makedate(2023, 365);
-- result:
2023-12-31
-- !result
select makedate(2023, 366);
-- result:
None
-- !result
select makedate(9999, 1);
-- result:
9999-01-01
-- !result
select makedate(9999, 365);
-- result:
9999-12-31
-- !result
select makedate(9999, 366);
-- result:
None
-- !result
select makedate(10000, 1);
-- result:
None
-- !result
select makedate(1, -1);
-- result:
None
-- !result
select makedate(col_year, col_day) from makedate_test order by id;
-- result:
None
None
None
0000-01-01
None
2023-02-01
2023-12-31
None
9999-01-01
9999-12-31
None
None
None
-- !result
>>>>>>> 4495fecd3 ([Feature] support dayofweek_iso function (#26240))

