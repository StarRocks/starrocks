-- name: test_spm_manual_create @sequential
create table t1 (
    k1 int,
    k2 int,
    k3 string
)
duplicate key(k1)
distributed by hash(k1) buckets 1
properties("replication_num" = "1");
-- result:
-- !result
insert into t1 
select s1, s1 % 1000, repeat('a', 128) FROM TABLE(generate_series(1, 100)) s(s1);
-- result:
-- !result
create table t2 like t1;
-- result:
-- !result
insert into t2 select * from t1;
-- result:
-- !result
truncate table _statistics_.spm_baselines;
-- result:
-- !result
create baseline using select * from t1 where k1 = 1 and k2 = 2;
-- result:
-- !result
show baseline on select * from t1 where k1 = 1 and k2 = 2;
-- result:
[REGEX].*k1 = _spm_const_var.*k2 = _spm_const_var.*
-- !result
create baseline on select * from t1 where k1 = 1 and k2 = 2 using select * from t1 where k1 = 1 and k2 = 2;
-- result:
-- !result
show baseline on select * from t1 where k1 = 1 and k2 = 2;
-- result:
[REGEX].*k1 = _spm_const_var.*k2 = _spm_const_var.*
-- !result
create baseline on select * from t1 where k1 = _spm_const_var(100, 1) and k2 = _spm_const_var(101, 2) using select * from t1 where k1 = _spm_const_var(100, 3) and k2 = _spm_const_var(101, 4);
-- result:
[REGEX].*found expression.*
-- !result
show baseline on select * from t1 where k1 = 1 and k2 = 2;
-- result:
[REGEX].*k1 = _spm_const_var.*k2 = _spm_const_var
-- !result
create baseline using select * from t1 where k1 = _spm_const_range(300, 1, 10);
-- result:
-- !result
show baseline on select * from t1 where k1 = 5;
-- result:
[REGEX].*k1 = _spm_const_range.*
-- !result
create baseline using select * from t1 where k1 = _spm_const_enum(400, 1, 5, 100);
-- result:
-- !result
show baseline on select * from t1 where k1 = 100;
-- result:
[REGEX].*k1 = _spm_const_enum.*
-- !result
