-- name: test_spm_plan_rewrite_enable_disable @sequential
create table t1 (
    k1 int,
    k2 int,
    k3 string
)
duplicate key(k1)
distributed by hash(k1) buckets 1
properties("replication_num" = "1");
-- result:
-- !result
insert into t1 
select s1, s1 % 1000, repeat('a', 5) FROM TABLE(generate_series(1, 3)) s(s1);
-- result:
-- !result
set enable_spm_rewrite=true;
-- result:
-- !result
truncate table _statistics_.spm_baselines; 
create global baseline on select * from t1 where k1 = 1 using select /*+ SET_VAR(parallel_fragment_exec_instance_num=2) */ * from t1 where k1 = 1;
-- result:
-- !result
explain select * from t1 where k1 = 1;
-- result:
[REGEX].*Using baseline plan.*
-- !result
select * from t1 where k1 = 1;
-- result:
1	1	aaaaa
-- !result
set enable_spm_rewrite=false;
-- result:
-- !result
explain select * from t1 where k1 = 1;
-- result:
[REGEX]^ *PLAN FRAGMENT.*
-- !result
select * from t1 where k1 = 1;
-- result:
1	1	aaaaa
-- !result
