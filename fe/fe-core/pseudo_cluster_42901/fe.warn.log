2025-05-17 00:21:15.541+08:00 WARN (fe|75) [StateChangeExecutor.notifyNewFETypeTransfer():62] notify new FE type transfer: LEADER
 2025-05-17 00:21:15.740+08:00 WARN (TableKeeper|81) [TableKeeper.run():63] database not exists: _statistics_
 2025-05-17 00:21:15.741+08:00 WARN (TableKeeper|81) [TableKeeper.run():63] database not exists: _statistics_
 2025-05-17 00:21:15.762+08:00 WARN (Routine load task scheduler|58) [RoutineLoadTaskScheduler.process():117] no available be slot to scheduler tasks, wait for 10 seconds to scheduler again, you can set max_routine_load_task_num_per_be bigger in fe.conf, current value is 16
 2025-05-17 00:21:15.781+08:00 WARN (PipeScheduler|65) [PipeScheduler.process():67] Successfully recover all pipes
 2025-05-17 00:21:15.796+08:00 WARN (Thread-45|71) [TemporaryTableCleaner.runAfterCatalogReady():88] listSessions return error from 127.0.0.1:9020, skip clean temporary tables
 org.apache.thrift.TException: java.net.ConnectException: Connection refused (Connection refused)
	at com.starrocks.rpc.ThriftRPCRequestExecutor.call(ThriftRPCRequestExecutor.java:60)
	at com.starrocks.rpc.ThriftRPCRequestExecutor.call(ThriftRPCRequestExecutor.java:33)
	at com.starrocks.server.TemporaryTableCleaner.runAfterCatalogReady(TemporaryTableCleaner.java:70)
	at com.starrocks.common.util.FrontendDaemon.runOneCycle(FrontendDaemon.java:72)
	at com.starrocks.common.util.Daemon.run(Daemon.java:98)
2025-05-17 00:21:15.812+08:00 WARN (ProcProfileCollector|70) [ProcProfileCollector.lambda$collectProfile$3():123] collect profile failed, reason: Cannot run program "/root/starrocks/bin/async-profiler/bin/asprof": error=2, No such file or directory
 2025-05-17 00:21:19.391+08:00 WARN (Connect-Scheduler-Check-Timer-0|76) [ConnectScheduler$TimeoutChecker.run():121] Timeout checker exception, Internal error : null
 java.lang.NullPointerException
	at com.starrocks.sql.ast.StatementBase.getTimeout(StatementBase.java:175)
	at com.starrocks.qe.StmtExecutor.getExecTimeout(StmtExecutor.java:489)
	at com.starrocks.qe.ConnectContext.getExecTimeout(ConnectContext.java:981)
	at com.starrocks.qe.ConnectContext.checkTimeout(ConnectContext.java:1019)
	at com.starrocks.qe.ConnectScheduler$TimeoutChecker.run(ConnectScheduler.java:108)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.runAndReset(FutureTask.java:305)
	at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:305)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2025-05-17 00:21:21.698+08:00 WARN (PBackendService-10002|109) [PseudoOlapTableSink$NodeChannel.open():89] open tablet writer failed: node:10001 Too many versions. tablet_id: 10006, version_count: 4, limit: 4
 2025-05-17 00:21:21.698+08:00 WARN (PBackendService-10002|109) [PseudoOlapTableSink$NodeChannel.open():89] open tablet writer failed: node:10002 Too many versions. tablet_id: 10006, version_count: 4, limit: 4
 2025-05-17 00:21:21.700+08:00 WARN (PBackendService-10002|109) [PseudoBackend.execPlanFragmentWithReport():1253] error execPlanFragmentWithReport
 java.lang.Exception: open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
	at com.starrocks.pseudocluster.PseudoBackend.runSink(PseudoBackend.java:1378)
	at com.starrocks.pseudocluster.PseudoBackend.execPlanFragmentWithReport(PseudoBackend.java:1246)
	at com.starrocks.pseudocluster.PseudoBackend$PseudoPBackendService.lambda$execPlanFragmentAsync$2(PseudoBackend.java:939)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2025-05-17 00:21:21.704+08:00 WARN (PBackendService-10002|109) [DefaultCoordinator.lambda$updateFragmentExecStatus$9():1077] exec state report failed status=errorCode INTERNAL_ERROR open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |, query_id=cdf9d1d5-3271-11f0-81e1-02420aff0002, instance_id=cdf9d1d5-3271-11f0-81e1-02420aff0003, backend_id=10002
 2025-05-17 00:21:21.705+08:00 WARN (PBackendService-10002|109) [DefaultCoordinator.updateStatus():858] one instance report fail throw updateStatus(), need cancel. job id: 10023, query id: cdf9d1d5-3271-11f0-81e1-02420aff0002, instance id: cdf9d1d5-3271-11f0-81e1-02420aff0003
 2025-05-17 00:21:21.705+08:00 WARN (starrocks-mysql-nio-pool-1|121) [StmtExecutor.handleDMLStmt():2450] insert failed: open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
 2025-05-17 00:21:21.707+08:00 WARN (starrocks-mysql-nio-pool-1|121) [StmtExecutor.handleDMLStmt():2632] failed to handle stmt [insert into test.test values (1,"1", 1), (2,"2", 2), (3,"3", 3)] label: insert_cdf9d1d5-3271-11f0-81e1-02420aff0002
 com.starrocks.common.DdlException: open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
	at com.starrocks.common.ErrorReport.reportDdlException(ErrorReport.java:90)
	at com.starrocks.qe.StmtExecutor.handleDMLStmt(StmtExecutor.java:2451)
	at com.starrocks.qe.StmtExecutor.handleDMLStmtWithProfile(StmtExecutor.java:2210)
	at com.starrocks.qe.StmtExecutor.execute(StmtExecutor.java:745)
	at com.starrocks.qe.ConnectProcessor.handleQuery(ConnectProcessor.java:372)
	at com.starrocks.qe.ConnectProcessor.dispatch(ConnectProcessor.java:572)
	at com.starrocks.qe.ConnectProcessor.processOnce(ConnectProcessor.java:910)
	at com.starrocks.mysql.nio.ReadListener.lambda$handleEvent$0(ReadListener.java:69)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
2025-05-17 00:21:21.710+08:00 WARN (starrocks-mysql-nio-pool-1|121) [StmtExecutor.handleDMLStmtWithProfile():2212] DML statement(insert into test.test values (1,"1", 1), (2,"2", 2), (3,"3", 3)) process failed.
 com.starrocks.common.UserException: open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
	at com.starrocks.qe.StmtExecutor.handleDMLStmt(StmtExecutor.java:2680)
	at com.starrocks.qe.StmtExecutor.handleDMLStmtWithProfile(StmtExecutor.java:2210)
	at com.starrocks.qe.StmtExecutor.execute(StmtExecutor.java:745)
	at com.starrocks.qe.ConnectProcessor.handleQuery(ConnectProcessor.java:372)
	at com.starrocks.qe.ConnectProcessor.dispatch(ConnectProcessor.java:572)
	at com.starrocks.qe.ConnectProcessor.processOnce(ConnectProcessor.java:910)
	at com.starrocks.mysql.nio.ReadListener.lambda$handleEvent$0(ReadListener.java:69)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.starrocks.common.DdlException: open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
	at com.starrocks.common.ErrorReport.reportDdlException(ErrorReport.java:90)
	at com.starrocks.qe.StmtExecutor.handleDMLStmt(StmtExecutor.java:2451)
	... 9 more
2025-05-17 00:21:21.712+08:00 WARN (main|1) [Slf4JLogger.warn():99] Error: 5025-HY000: open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
 2025-05-17 00:21:21.713+08:00 ERROR (main|1) [PseudoCluster.runSingleSql():333] (conn=1) open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
 java.sql.SQLException: (conn=1) open sink failed, backend:10002 txn:6 index:10004 has intolerable failure: Too many versions. tablet_id: 10006, version_count: 4, limit: 4 [10001, 10002] numReplica:3 |
	at org.mariadb.jdbc.export.ExceptionFactory.createException(ExceptionFactory.java:306)
	at org.mariadb.jdbc.export.ExceptionFactory.create(ExceptionFactory.java:378)
	at org.mariadb.jdbc.message.ClientMessage.readPacket(ClientMessage.java:172)
	at org.mariadb.jdbc.client.impl.StandardClient.readPacket(StandardClient.java:913)
	at org.mariadb.jdbc.client.impl.StandardClient.readResults(StandardClient.java:852)
	at org.mariadb.jdbc.client.impl.StandardClient.readResponse(StandardClient.java:771)
	at org.mariadb.jdbc.client.impl.StandardClient.execute(StandardClient.java:695)
	at org.mariadb.jdbc.Statement.executeInternal(Statement.java:1035)
	at org.mariadb.jdbc.Statement.execute(Statement.java:1165)
	at org.mariadb.jdbc.Statement.execute(Statement.java:493)
	at org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:193)
	at org.apache.commons.dbcp2.DelegatingStatement.execute(DelegatingStatement.java:193)
	at com.starrocks.pseudocluster.PseudoCluster.runSingleSql(PseudoCluster.java:318)
	at com.starrocks.pseudocluster.PseudoCluster.runSql(PseudoCluster.java:346)
	at com.starrocks.pseudocluster.PseudoCluster.runSql(PseudoCluster.java:354)
	at com.starrocks.transaction.TooManyVersionWriteFailTest.testTooManyVersionFail(TooManyVersionWriteFailTest.java:56)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at mockit.integration.junit4.JUnit4TestRunnerDecorator.executeTestMethod(JUnit4TestRunnerDecorator.java:157)
	at mockit.integration.junit4.JUnit4TestRunnerDecorator.invokeExplosively(JUnit4TestRunnerDecorator.java:71)
	at mockit.integration.junit4.FakeFrameworkMethod.invokeExplosively(FakeFrameworkMethod.java:29)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:115)
	at org.junit.vintage.engine.execution.RunnerExecutor.execute(RunnerExecutor.java:42)
	at org.junit.vintage.engine.VintageTestEngine.executeAllChildren(VintageTestEngine.java:80)
	at org.junit.vintage.engine.VintageTestEngine.execute(VintageTestEngine.java:72)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)
	at org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)
	at org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:120)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
