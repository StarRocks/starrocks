{
  "statement": "SELECT CAST(t1.dayno AS DATE) AS dayno, t1.shop_code, t1.sku_code, 0 AS register_cnt, 0 AS sale_quantity, 0 AS retail_price, -1 AS source_type, reserve_qty\n    FROM dm_crm_abd.dwd_reserve_order_base_data_rt t1 JOIN (\n        SELECT substr(MAX(etl_time), 1, 10) AS etl_time\n        FROM dm_crm_abd.rpt_crm_reach_goal_cust_all_d\n        WHERE dayno > date_sub(CURRENT_DATE(), 3)\n      ) t2 ON CAST(t1.dayno AS DATE) >= t2.etl_time\n    WHERE 1 = 1 AND CAST(t1.dayno AS DATE) > date_sub(CURRENT_DATE(), 2) ;\n",
  "table_meta": {
    "dm_crm_abd.dwd_reserve_order_base_data_rt": "CREATE TABLE `dwd_reserve_order_base_data_rt` (\n  `dayno` bigint(20) NULL,\n  `id` varchar(100) NULL,\n  `reserve_order_id` varchar(100) NULL,\n  `reserve_order_status` varchar(100) NULL,\n  `shop_id` varchar(100) NULL,\n  `shop_code` varchar(100) NULL,\n  `shop_operate_status` varchar(50) NULL,\n  `shop_operate_status_desc` varchar(255) NULL,\n  `sku_id` varchar(100) NULL,\n  `sku_code` varchar(100) NULL,\n  `staff_id` varchar(100) NULL,\n  `staff_code` varchar(100) NULL,\n  `staff_status` varchar(50) NULL,\n  `staff_status_desc` varchar(100) NULL,\n  `reserve_type` int(11) NULL,\n  `pay_finish_time` varchar(50) NULL,\n  `finish_time` varchar(50) NULL,\n  `close_time` varchar(50) NULL,\n  `is_deposit` int(11) NULL,\n  `reserve_qty` int(11) NULL,\n  `out_qty` int(11) NULL,\n  `old_shop_id` varchar(100) NULL,\n  `old_sku_id` varchar(100) NULL,\n  `old_staff_id` varchar(100) NULL,\n  `update_time` varchar(50) NULL,\n  `source` varchar(50) NULL,\n  `source_desc` varchar(100) NULL,\n  `verify_imei_sn` varchar(300) NULL,\n  `verify_time` varchar(50) NULL,\n  `is_verificated` int(11) NULL,\n  `is_registed` int(11) NULL,\n  `register_time` varchar(50) NULL,\n  `register_depot_code` varchar(50) NULL,\n  `register_depot_name` varchar(100) NULL,\n  `is_many_imei` int(11) NULL,\n  `origin_reserve_order_id` varchar(100) NULL,\n  `created_time` varchar(30) NULL,\n  `paid_amount` varchar(20) NULL,\n  `is_sku_change` int(11) NULL,\n  `is_staff_change` int(11) NULL,\n  `is_transfer_order` int(11) NULL,\n  `pick_staff_name` varchar(100) NULL,\n  `pick_staff_id` varchar(100) NULL,\n  `pick_staff_code` varchar(100) NULL,\n  `reserve_staff_name` varchar(100) NULL,\n  `reserve_staff_id` varchar(100) NULL,\n  `reserve_staff_code` varchar(100) NULL,\n  `reserve_sku_code` varchar(100) NULL,\n  `pick_sku_code` varchar(100) NULL,\n  `verify_person_code` varchar(100) NULL,\n  `verify_person_name` varchar(100) NULL,\n  `verify_depot_code` varchar(100) NULL,\n  `verify_depot_name` varchar(100) NULL,\n  `report_qty_person_id` varchar(100) NULL,\n  `account_id` varchar(100) NULL,\n  `login_id` varchar(100) NULL\n) ENGINE=OLAP \nUNIQUE KEY(`dayno`, `id`)\nCOMMENT \"预定实时数据\"\nPARTITION BY RANGE(`dayno`)\n(PARTITION p20251205 VALUES [(\"20251205\"), (\"20251206\")),\nPARTITION p20251206 VALUES [(\"20251206\"), (\"20251207\")),\nPARTITION p20251207 VALUES [(\"20251207\"), (\"20251208\")),\nPARTITION p20251208 VALUES [(\"20251208\"), (\"20251209\")),\nPARTITION p20251209 VALUES [(\"20251209\"), (\"20251210\")),\nPARTITION p20251210 VALUES [(\"20251210\"), (\"20251211\")),\nPARTITION p20251211 VALUES [(\"20251211\"), (\"20251212\")),\nPARTITION p20251212 VALUES [(\"20251212\"), (\"20251213\")),\nPARTITION p20251213 VALUES [(\"20251213\"), (\"20251214\")),\nPARTITION p20251214 VALUES [(\"20251214\"), (\"20251215\")))\nDISTRIBUTED BY HASH(`id`) BUCKETS 5 \nPROPERTIES (\n\"compression\" = \"LZ4\",\n\"dynamic_partition.buckets\" = \"5\",\n\"dynamic_partition.enable\" = \"true\",\n\"dynamic_partition.end\" = \"2\",\n\"dynamic_partition.history_partition_num\" = \"0\",\n\"dynamic_partition.prefix\" = \"p\",\n\"dynamic_partition.start\" = \"-7\",\n\"dynamic_partition.time_unit\" = \"DAY\",\n\"dynamic_partition.time_zone\" = \"Asia/Shanghai\",\n\"fast_schema_evolution\" = \"false\",\n\"replicated_storage\" = \"true\",\n\"replication_num\" = \"3\"\n);",
    "dm_crm_abd.rpt_crm_reach_goal_cust_all_d": "CREATE TABLE `rpt_crm_reach_goal_cust_all_d` (\n  `dayno` date NULL,\n  `target_id` varchar(255) NULL,\n  `push_target_child_id` varchar(255) NULL,\n  `target_delivery_level` int(11) NULL,\n  `sales_org_code` varchar(255) NULL,\n  `sub_target_id` varchar(255) NULL,\n  `assess_type` int(11) NULL,\n  `y` varchar(255) NULL,\n  `m` varchar(255) NULL,\n  `start_date` varchar(255) NULL,\n  `end_date` varchar(255) NULL,\n  `target_name` varchar(255) NULL,\n  `decompose` varchar(255) NULL,\n  `target_organization` varchar(255) NULL,\n  `target_organization_name` varchar(255) NULL,\n  `target_organization_level` varchar(255) NULL,\n  `child_target_name` varchar(255) NULL,\n  `dimension` int(11) NULL,\n  `product` int(11) NULL,\n  `product_type` int(11) NULL,\n  `product_code` array<varchar(255)> NULL,\n  `product_name` array<varchar(255)> NULL,\n  `statistics_rule` int(11) NULL,\n  `target_status` int(11) NULL,\n  `sales_org_code_l5` varchar(255) NULL,\n  `sales_org_name_l5` varchar(255) NULL,\n  `staff_code_l5` varchar(255) NULL,\n  `staff_name_l5` varchar(255) NULL,\n  `sales_org_code_l6` varchar(255) NULL,\n  `sales_org_name_l6` varchar(255) NULL,\n  `staff_code_l6` varchar(255) NULL,\n  `staff_name_l6` varchar(255) NULL,\n  `cust_group_code` varchar(255) NULL,\n  `cust_group_name` varchar(255) NULL,\n  `cust_code` varchar(255) NULL,\n  `cust_name` varchar(255) NULL,\n  `target_current` int(11) NULL,\n  `cumulative_completion` int(11) NULL,\n  `etl_time` varchar(255) NULL,\n  `target_id_head` varchar(255) NULL,\n  `target_id_path` varchar(1000) NULL,\n  `target_type` int(11) NULL,\n  `sales_org_code_l4` varchar(255) NULL,\n  `sales_org_name_l4` varchar(255) NULL,\n  `staff_code_l4` varchar(255) NULL,\n  `staff_name_l4` varchar(255) NULL,\n  `head_customer_group_level` varchar(50) NULL,\n  `area_customer_group_level` varchar(50) NULL,\n  `sales_org_code_l7` varchar(255) NULL,\n  `sales_org_name_l7` varchar(255) NULL,\n  `staff_code_l7` varchar(255) NULL,\n  `staff_name_l7` varchar(255) NULL,\n  `sales_org_code_l8` varchar(255) NULL,\n  `sales_org_name_l8` varchar(255) NULL,\n  `staff_code_l8` varchar(255) NULL,\n  `staff_name_l8` varchar(255) NULL,\n  `sales_org_code_l9` varchar(255) NULL,\n  `sales_org_name_l9` varchar(255) NULL,\n  `staff_code_l9` varchar(255) NULL,\n  `staff_name_l9` varchar(255) NULL,\n  `number` int(11) NULL\n) ENGINE=OLAP \nDUPLICATE KEY(`dayno`, `target_id`, `push_target_child_id`, `target_delivery_level`)\nCOMMENT \"目标达成客户表\"\nPARTITION BY RANGE(`dayno`)\n(PARTITION p20251202 VALUES [(\"2025-12-02\"), (\"2025-12-03\")),\nPARTITION p20251203 VALUES [(\"2025-12-03\"), (\"2025-12-04\")),\nPARTITION p20251204 VALUES [(\"2025-12-04\"), (\"2025-12-05\")),\nPARTITION p20251205 VALUES [(\"2025-12-05\"), (\"2025-12-06\")),\nPARTITION p20251206 VALUES [(\"2025-12-06\"), (\"2025-12-07\")),\nPARTITION p20251207 VALUES [(\"2025-12-07\"), (\"2025-12-08\")),\nPARTITION p20251208 VALUES [(\"2025-12-08\"), (\"2025-12-09\")),\nPARTITION p20251209 VALUES [(\"2025-12-09\"), (\"2025-12-10\")),\nPARTITION p20251210 VALUES [(\"2025-12-10\"), (\"2025-12-11\")),\nPARTITION p20251211 VALUES [(\"2025-12-11\"), (\"2025-12-12\")),\nPARTITION p20251212 VALUES [(\"2025-12-12\"), (\"2025-12-13\")),\nPARTITION p20251213 VALUES [(\"2025-12-13\"), (\"2025-12-14\")),\nPARTITION p20251214 VALUES [(\"2025-12-14\"), (\"2025-12-15\")))\nDISTRIBUTED BY HASH(`sub_target_id`) BUCKETS 1 \nPROPERTIES (\n\"compression\" = \"LZ4\",\n\"dynamic_partition.buckets\" = \"1\",\n\"dynamic_partition.enable\" = \"true\",\n\"dynamic_partition.end\" = \"2\",\n\"dynamic_partition.history_partition_num\" = \"0\",\n\"dynamic_partition.prefix\" = \"p\",\n\"dynamic_partition.start\" = \"-10\",\n\"dynamic_partition.time_unit\" = \"DAY\",\n\"dynamic_partition.time_zone\" = \"Asia/Chongqing\",\n\"fast_schema_evolution\" = \"false\",\n\"replicated_storage\" = \"true\",\n\"replication_num\" = \"3\"\n);"
  },
  "table_row_count": {
    "dm_crm_abd.dwd_reserve_order_base_data_rt": {
      "p20251208": 801,
      "p20251209": 600,
      "p20251206": 1358,
      "p20251207": 1051,
      "p20251211": 682,
      "p20251212": 175,
      "p20251210": 611,
      "p20251205": 2244
    },
    "dm_crm_abd.rpt_crm_reach_goal_cust_all_d": {
      "p20251211": 605636,
      "p20251212": 605636,
      "p20251210": 605636
    }
  },
  "column_statistics": {
    "dm_crm_abd.dwd_reserve_order_base_data_rt": {
      "dayno": "[2.0251205E7, 2.0251212E7, 0.0, 8.0, 8.0] ESTIMATE",
      "shop_code": "[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "reserve_qty": "[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "sku_code": "[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN"
    },
    "dm_crm_abd.rpt_crm_reach_goal_cust_all_d": {
      "dayno": "[1.7646048E9, 1.7654688E9, 0.0, 4.0, 11.0] ESTIMATE",
      "etl_time": "[-Infinity, Infinity, 0.0, 23.0, 10.0] ESTIMATE"
    }
  },
  "session_variables": "{\"partial_update_mode\":\"auto\",\"cbo_cte_reuse\":true,\"character_set_connection\":\"utf8\",\"cbo_use_correlated_join_estimate\":true,\"enable_insert_strict\":true,\"enable_connector_adaptive_io_tasks\":true,\"tx_isolation\":\"REPEATABLE-READ\",\"enable_hive_metadata_cache_with_insert\":false,\"hive_temp_staging_dir\":\"/tmp/starrocks\",\"cbo_cte_reuse_rate_v2\":1.15,\"spill_rand_ratio\":0.1,\"enable_datacache_io_adaptor\":false,\"character_set_results\":\"utf8\",\"materialized_view_union_rewrite_mode\":0,\"enable_count_star_optimization\":true,\"enable_iceberg_column_statistics\":true,\"thrift_plan_protocol\":\"binary\",\"enable_plan_serialize_concurrently\":true,\"materialized_view_max_relation_mapping_size\":10,\"enable_rewrite_partition_column_minmax\":true,\"global_runtime_filter_build_min_size\":131072,\"enable_iceberg_identity_column_optimize\":true,\"enable_view_based_mv_rewrite\":false,\"query_excluding_mv_names\":\"\",\"enable_rewrite_simple_agg_to_meta_scan\":false,\"enable_ukfk_opt\":false,\"enable_adaptive_sink_dop\":true,\"enable_ukfk_join_reorder\":false,\"consistent_hash_virtual_number\":32,\"warehouse\":\"default_warehouse\",\"enable_profile\":false,\"load_mem_limit\":0,\"spill_storage_volume\":\"\",\"cbo_eq_base_type\":\"varchar\",\"enable_materialized_view_for_insert\":false,\"large_decimal_underlying_type\":\"panic\",\"sql_safe_updates\":0,\"runtime_filter_early_return_selectivity\":0.05,\"enable_local_shuffle_agg\":true,\"disable_function_fold_constants\":false,\"enable_query_queue\":true,\"enable_cbo_view_based_mv_rewrite\":false,\"select_ratio_threshold\":0.15,\"enable_connector_sink_global_shuffle\":true,\"query_delivery_timeout\":300,\"collation_database\":\"utf8_general_ci\",\"spill_mem_table_size\":104857600,\"enable_gin_filter\":true,\"follower_query_forward_mode\":\"\",\"orc_use_column_names\":false,\"spill_enable_compaction\":true,\"cbo_use_lock_db\":false,\"new_planner_agg_stage\":0,\"enable_strict_order_by\":true,\"hash_join_interpolate_passthrough\":false,\"cbo_enable_intersect_add_distinct\":true,\"use_compute_nodes\":-1,\"enable_metadata_profile\":false,\"collation_connection\":\"utf8_general_ci\",\"enable_rewrite_bitmap_union_to_bitamp_agg\":false,\"enable_force_rule_based_mv_rewrite\":false,\"enable_array_distinct_after_agg_opt\":true,\"resource_group\":\"\",\"group_execution_max_groups\":128,\"scan_hive_partition_num_limit\":0,\"always_collect_low_card_dict\":false,\"enable_materialized_view_plan_cache\":true,\"spill_operator_max_bytes\":1048576000,\"enable_materialized_view_agg_pushdown_rewrite\":false,\"cbo_max_reorder_node_use_dp\":10,\"cbo_prepare_metadata_thread_pool_size\":16,\"enable_result_sink_accumulate\":true,\"enable_hive_column_stats\":true,\"enable_async_profile\":true,\"enable_groupby_use_output_alias\":false,\"global_runtime_filter_wait_timeout\":20,\"forward_to_leader\":false,\"enable_prune_column_after_index_filter\":true,\"count_distinct_column_buckets\":1024,\"cross_join_cost_penalty\":1000000,\"query_cache_agg_cardinality_limit\":5000000,\"connector_sink_spill_mem_limit_threshold\":0.5,\"cboPushDownAggregateMode_v1\":-1,\"window_partition_mode\":1,\"enable_tablet_internal_parallel_v2\":true,\"enable_predicate_expr_reuse\":true,\"interpolate_passthrough\":true,\"enable_incremental_mv\":false,\"cbo_push_down_topn_limit\":0,\"SQL_AUTO_IS_NULL\":false,\"event_scheduler\":\"OFF\",\"parallel_merge_late_materialization_mode\":\"auto\",\"max_pipeline_dop\":64,\"broadcast_right_table_scale_factor\":10,\"materialized_view_rewrite_mode\":\"DEFAULT\",\"enable_read_iceberg_puffin_ndv\":true,\"enable_write_hive_external_table\":false,\"enable_simplify_case_when\":true,\"enable_aggregation_pipeline_share_limit\":true,\"runtime_join_filter_push_down_limit\":1024000,\"trace_log_mode\":\"command\",\"enable_scan_datacache\":false,\"enable_scan_predicate_expr_reuse\":false,\"big_query_log_cpu_second_threshold\":10,\"div_precision_increment\":4,\"runtime_adaptive_dop_max_block_rows_per_driver_seq\":16384,\"log_rejected_record_num\":0,\"phased_scheduler_max_concurrency\":2,\"populate_datacache_mode\":\"auto\",\"enable_short_circuit\":false,\"cbo_push_down_distinct_below_window\":true,\"sql_mode_v2\":32,\"prefer_cte_rewrite\":false,\"optimizer_materialized_view_timelimit\":1000,\"hdfs_backend_selector_scan_range_shuffle\":false,\"pipeline_profile_level\":1,\"parallel_fragment_exec_instance_num\":1,\"max_scan_key_num\":-1,\"net_read_timeout\":60,\"streaming_preaggregation_mode\":\"auto\",\"hive_partition_stats_sample_size\":3000,\"enable_mv_planner\":false,\"enable_collect_table_level_scan_stats\":true,\"enable_fine_grained_range_predicate\":false,\"enable_populate_datacache\":true,\"enable_connector_sink_writer_scaling\":true,\"query_debug_options\":\"\",\"profile_timeout\":2,\"cbo_push_down_aggregate\":\"global\",\"spill_encode_level\":7,\"enable_query_dump\":false,\"max_spill_read_buffer_bytes_per_driver\":16777216,\"global_runtime_filter_build_max_size\":67108864,\"cbo_push_down_groupingset_reshuffle\":true,\"enable_rewrite_sum_by_associative_rule\":true,\"query_cache_hot_partition_num\":3,\"enable_prune_complex_types\":true,\"enable_delta_lake_column_statistics\":false,\"metadata_collect_query_timeout\":60,\"query_cache_type\":0,\"max_parallel_scan_instance_num\":-1,\"enable_dynamic_prune_scan_range\":true,\"query_cache_entry_max_rows\":409600,\"enable_paimon_column_statistics\":false,\"connector_io_tasks_per_scan_operator\":16,\"disable_spill_to_local_disk\":false,\"enable_materialized_view_union_rewrite\":true,\"sql_quote_show_create\":true,\"enable_constant_execute_in_fe\":true,\"scan_or_to_union_threshold\":50000000,\"enable_materialized_view_rewrite_partition_compensate\":true,\"enable_exchange_pass_through\":true,\"enable_cbo_based_mv_rewrite\":true,\"runtime_profile_report_interval\":10,\"query_cache_entry_max_bytes\":4194304,\"enable_partition_column_value_only_optimization\":true,\"scan_olap_partition_num_limit\":0,\"connector_max_split_size\":67108864,\"array_low_cardinality_optimize\":true,\"interleaving_group_size\":10,\"enable_exchange_perf\":false,\"enable_prepare_stmt\":true,\"workgroup_id\":0,\"enable_pipeline_level_multi_partitioned_rf\":false,\"enable_rewrite_groupingsets_to_union_all\":false,\"spill_enable_direct_io\":false,\"cbo_push_down_groupingset\":true,\"custom_query_id\":\"\",\"transmission_compression_type\":\"NO_COMPRESSION\",\"interactive_timeout\":3600,\"use_page_cache\":true,\"big_query_log_scan_bytes_threshold\":10737418240,\"collation_server\":\"utf8_general_ci\",\"cbo_decimal_cast_string_strict\":true,\"enable_hyperscan_vec\":true,\"count_distinct_implementation\":\"default\",\"enable_datacache_async_populate_mode\":false,\"cbo_enable_predicate_subfield_path\":true,\"tablet_internal_parallel_mode\":\"auto\",\"enable_pipeline\":true,\"spill_mode\":\"auto\",\"allow_hive_without_partition_filter\":true,\"cbo_prune_json_subfield_depth\":20,\"enable_lambda_pushdown\":true,\"enable_query_debug_trace\":false,\"like_predicate_consolidate_min\":2,\"cbo_materialized_view_rewrite_related_mvs_limit\":64,\"enable_lake_tablet_internal_parallel\":false,\"enable_show_all_variables\":false,\"hdfs_backend_selector_force_rebalance\":false,\"full_sort_max_buffered_bytes\":16777216,\"catalog\":\"default_catalog\",\"wait_timeout\":28800,\"max_buckets_per_be_to_use_balancer_assignment\":6,\"enable_query_tablet_affinity\":false,\"transmission_encode_level\":7,\"query_including_mv_names\":\"\",\"transaction_isolation\":\"REPEATABLE-READ\",\"enable_global_runtime_filter\":true,\"enable_load_profile\":false,\"enable_rewrite_simple_agg_to_hdfs_scan\":false,\"enable_plan_validation\":true,\"load_transmission_compression_type\":\"NO_COMPRESSION\",\"global_runtime_filter_rpc_http_min_size\":67108864,\"cbo_materialized_view_rewrite_rule_output_limit\":3,\"cbo_enable_low_cardinality_optimize\":true,\"scan_use_query_mem_ratio\":0.3,\"datacache_evict_probability\":100,\"enable_analyze_phase_prune_columns\":false,\"connector_huge_file_size\":536870912,\"new_planner_optimize_timeout\":5000,\"enable_outer_join_reorder\":true,\"force_schedule_local\":false,\"hudi_mor_force_jni_reader\":false,\"enable_agg_spill_preaggregation\":true,\"cbo_enable_greedy_join_reorder\":true,\"range_pruner_max_predicate\":100,\"enable_rbo_table_prune\":false,\"spillable_operator_mask\":-1,\"enable_wait_dependent_event\":false,\"rpc_http_min_size\":2147482624,\"low_cardinality_optimize_v2\":true,\"enable_file_metacache\":false,\"cbo_debug_alive_backend_number\":0,\"global_runtime_filter_probe_min_size\":102400,\"topn_filter_back_pressure_mode\":0,\"scan_or_to_union_limit\":1,\"enable_cbo_table_prune\":false,\"enable_parallel_merge\":true,\"cbo_materialized_view_rewrite_candidate_limit\":12,\"skew_join_use_mcv_count\":5,\"skip_page_cache\":false,\"cbo_derive_join_is_null_predicate\":true,\"nested_mv_rewrite_max_level\":3,\"enable_materialized_view_text_match_rewrite\":true,\"big_query_profile_threshold\":\"0s\",\"net_write_timeout\":60,\"cbo_prune_shuffle_column_rate\":0.1,\"spill_revocable_max_bytes\":0,\"hash_join_push_down_right_table\":true,\"connector_sink_target_max_file_size\":1073741824,\"max_ukfk_join_reorder_scale_ratio\":100,\"pipeline_sink_dop\":0,\"broadcast_row_limit\":15000000,\"enable_prune_iceberg_manifest\":true,\"exec_mem_limit\":2147483648,\"enable_sort_aggregate\":false,\"query_cache_force_populate\":false,\"computation_fragment_scheduling_policy\":\"COMPUTE_NODES_ONLY\",\"runtime_filter_on_exchange_node\":false,\"disable_join_reorder\":false,\"enable_evaluate_schema_scan_rule\":true,\"global_runtime_filter_rpc_timeout\":400,\"connector_scan_use_query_mem_ratio\":0.3,\"net_buffer_length\":16384,\"cbo_prune_subfield\":true,\"full_sort_max_buffered_rows\":1024000,\"query_timeout\":300,\"connector_io_tasks_slow_io_latency_ms\":50,\"cbo_max_reorder_node\":50,\"enable_distinct_column_bucketization\":false,\"enable_big_query_log\":true,\"enable_spill_buffer_read\":true,\"group_execution_min_scan_rows\":5000000,\"runtime_filter_scan_wait_time\":20,\"enable_count_distinct_rewrite_by_hll_bitmap\":true,\"enable_sync_materialized_view_rewrite\":true,\"prefer_compute_node\":false,\"enable_strict_type\":false,\"enable_table_prune_on_update\":false,\"group_concat_max_len\":1024,\"enable_stats_to_optimize_skew_join\":false,\"parse_tokens_limit\":3500000,\"chunk_size\":4096,\"global_runtime_filter_probe_min_selectivity\":0.5,\"query_mem_limit\":0,\"enable_filter_unused_columns_in_scan_stage\":true,\"enable_materialized_view_single_table_view_delta_rewrite\":false,\"cbo_prune_json_subfield\":false,\"enable_spill_to_remote_storage\":false,\"enable_materialized_view_transparent_union_rewrite\":true,\"enable_prune_complex_types_in_unnest\":true,\"auto_increment_increment\":1,\"sql_dialect\":\"StarRocks\",\"enable_per_bucket_optimize\":true,\"enable_eliminate_agg\":true,\"enable_group_execution\":true,\"big_query_log_scan_rows_threshold\":1000000000,\"character_set_client\":\"utf8\",\"autocommit\":true,\"enable_column_expr_predicate\":true,\"enable_partition_bucket_optimize\":false,\"skip_local_disk_cache\":false,\"max_ukfk_join_reorder_fk_rows\":100000000,\"enable_subfield_no_copy\":true,\"jit_level\":1,\"enable_runtime_adaptive_dop\":false,\"cbo_cte_max_limit\":10,\"connector_sink_compression_codec\":\"uncompressed\",\"storage_engine\":\"olap\",\"enable_rewrite_unnest_bitmap_to_array\":true,\"spill_operator_min_bytes\":10485760,\"cbo_enable_dp_join_reorder\":true,\"tx_visible_wait_timeout\":10,\"materialized_view_join_same_table_permutation_limit\":5,\"enable_materialized_view_view_delta_rewrite\":true,\"cbo_max_reorder_node_use_exhaustive\":4,\"enable_sql_digest\":false,\"spill_mem_table_num\":2,\"enable_spill\":false,\"enable_materialized_view_rewrite_greedy_mode\":false,\"pipeline_dop\":0,\"single_node_exec_plan\":false,\"full_sort_late_materialization_v2\":false,\"join_implementation_mode_v2\":\"auto\",\"enable_connector_split_io_tasks\":true,\"sql_select_limit\":9223372036854775807,\"enable_materialized_view_rewrite\":true,\"materialized_view_subuqery_text_match_max_count\":4,\"statistic_collect_parallel\":1,\"hdfs_backend_selector_hash_algorithm\":\"consistent\",\"enable_expr_prune_partition\":true,\"plan_mode\":\"auto\",\"enable_topn_runtime_filter\":true,\"disable_colocate_join\":false,\"enable_insert_partial_update\":true,\"max_pushdown_conditions_per_column\":-1,\"back_pressure_back_rounds\":3,\"default_table_compression\":\"lz4_frame\",\"runtime_adaptive_dop_max_output_amplification_factor\":0,\"skew_join_rand_range\":1000,\"choose_execute_instances_mode\":\"LOCALITY\",\"back_pressure_throttle_time_upper_bound\":300,\"skew_join_data_skew_threshold\":0.2,\"innodb_read_only\":true,\"spill_mem_limit_threshold\":0.8,\"cbo_reorder_threshold_use_exhaustive\":6,\"disable_generated_column_rewrite\":false,\"enable_predicate_reorder\":false,\"enable_connector_sink_spill\":true,\"enable_query_cache\":false,\"enable_phased_scheduler\":false,\"group_execution_group_scale\":64,\"transaction_read_only\":false,\"max_allowed_packet\":33554432,\"enable_partition_level_cardinality_estimation\":true,\"enable_materialized_view_multi_stages_rewrite\":true,\"enable_parallel_prepare_metadata\":false,\"enable_cloud_native_persistent_index_by_default\":false,\"time_zone\":\"Asia/Shanghai\",\"enable_multicolumn_global_runtime_filter\":false,\"character_set_server\":\"utf8\",\"cbo_use_nth_exec_plan\":0,\"io_tasks_per_scan_operator\":4,\"parallel_exchange_instance_num\":-1,\"enable_shared_scan\":false,\"join_late_materialization\":false,\"audit_execute_stmt\":false,\"cbo_derive_range_join_predicate\":false,\"allow_default_partition\":false,\"cbo_use_histogram_evaluate_list_partition\":false,\"paimon_force_jni_reader\":false,\"enable_pipeline_level_shuffle\":true}",
  "be_number": 3,
  "be_core_stat": {
    "numOfHardwareCoresPerBe": "{\"10007\":104,\"10008\":104,\"10009\":104}",
    "cachedAvgNumOfHardwareCores": 104
  },
  "exception": [
    "com.starrocks.sql.common.StarRocksPlannerException: Invalid plan:\nPhysicalHashAggregate {type=LOCAL, groupBy=[], partitionBy=[] ,aggregations={118: max=max(95: etl_time)}}\n\n->  PhysicalOlapScanOperator {table=9844461, selectedPartitionId=[47587445, 48540841, 48540846], selectedIndexId=9844462, outputColumns=[125: etl_time], projection=[125: etl_time], predicate=null, prunedPartitionPredicates=[57: dayno >= 2025-12-10], limit=-1}Input dependency cols check failed. The required cols {95} cannot obtain from input cols {125}.\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.checkInputCols(InputDependenciesChecker.java:204)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.checkOptExprWithOneChild(InputDependenciesChecker.java:138)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.visit(InputDependenciesChecker.java:68)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.checkOptExprWithOneChild(InputDependenciesChecker.java:118)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.visit(InputDependenciesChecker.java:68)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.checkOptExprWithOneChild(InputDependenciesChecker.java:118)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.visit(InputDependenciesChecker.java:68)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.checkOptExprWithOneChild(InputDependenciesChecker.java:118)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.visit(InputDependenciesChecker.java:68)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.checkJoinOpt(InputDependenciesChecker.java:143)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker$Visitor.visit(InputDependenciesChecker.java:70)\n\tat com.starrocks.sql.optimizer.validate.InputDependenciesChecker.validate(InputDependenciesChecker.java:57)\n\tat com.starrocks.sql.optimizer.validate.PlanValidator.validatePlan(PlanValidator.java:55)\n\tat com.starrocks.sql.optimizer.Optimizer.optimizeByCost(Optimizer.java:303)\n\tat com.starrocks.sql.optimizer.Optimizer.optimize(Optimizer.java:196)\n\tat com.starrocks.sql.StatementPlanner.createQueryPlanWithReTry(StatementPlanner.java:354)\n\tat com.starrocks.sql.StatementPlanner.plan(StatementPlanner.java:140)\n\tat com.starrocks.sql.StatementPlanner.plan(StatementPlanner.java:95)\n\tat com.starrocks.qe.StmtExecutor.execute(StmtExecutor.java:575)\n\tat com.starrocks.sql.optimizer.dump.QueryDumper.dumpQuery(QueryDumper.java:80)\n\tat com.starrocks.http.rest.QueryDumpAction.executeWithoutPassword(QueryDumpAction.java:78)\n\tat com.starrocks.http.rest.RestBaseAction.execute(RestBaseAction.java:142)\n\tat com.starrocks.http.rest.RestBaseAction.handleRequest(RestBaseAction.java:88)\n\tat com.starrocks.http.HttpServerHandler.channelRead(HttpServerHandler.java:107)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:107)\n\tat io.netty.handler.codec.MessageToMessageCodec.channelRead(MessageToMessageCodec.java:120)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:107)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868)\n\tat io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:796)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:732)\n\tat io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:658)\n\tat io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998)\n\tat io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\n"
  ],
  "version": "3.3.20",
  "commit_version": "bc0523a"
}