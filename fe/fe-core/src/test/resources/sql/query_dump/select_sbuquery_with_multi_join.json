{
  "statement":"select \n          BITMAP_AND(\n            (\n              select \n                BITMAP_AND(\n                  (\n                    select \n                      BITMAP_AND(\n                        (\n                          select \n                            bmp \n                          from \n                            (\n                              select \n                                '1' as bmp_order, \n                                bitmap_union(\n                                  to_bitmap(v1)\n                                ) as bmp, \n                                '0' as agg_type \n                              from \n                                t2 \n                              where \n                                v3 = 20220308 \n                                and (v7 = '正常')\n                            ) as t1\n                        ), \n                        (\n                          select \n                            bmp \n                          from \n                            (\n                              select \n                                '2' as bmp_order, \n                                bitmap_union(\n                                  to_bitmap(v1)\n                                ) as bmp, \n                                '2' as agg_type \n                              from \n                                t3 \n                              where \n                                v3 = 20220308 \n                                and (v5 = 'FIND N')\n                            ) as t2\n                        )\n                      )\n                  ), \n                  (\n                    select \n                      bmp \n                    from \n                      (\n                        select \n                          '3' as bmp_order, \n                          bitmap_union(\n                            to_bitmap(v1)\n                          ) as bmp, \n                          '2' as agg_type \n                        from \n                          t3 \n                        where \n                          v3 = 20220308 \n                          and (\n                            v2 BETWEEN 1 \n                            and 7\n                          )\n                      ) as t3\n                  )\n                )\n            ), \n            (\n              select \n                bmp \n              from \n                (\n                  select \n                    '4' as bmp_order, \n                    bitmap_union(\n                      to_bitmap(v1)\n                    ) as bmp, \n                    '2' as agg_type \n                  from \n                    t3 \n                  where \n                    v3 = 20220308 \n                    and (v4 = '线下')\n                ) as t4\n            )\n          )",
  "table_meta":{
    "test.t1":"CREATE TABLE `t1` (\n  `statis_id` varchar(50) NULL ,\n  `v3` int(11) NULL ,\n  `union_id` varchar(200) NULL ,\n  `v1` bigint(20) NULL,\n  `v6` varchar(500) NULL ,\n  `status` varchar(50) NULL ,\n `etl_time` bigint(20) NULL \n) ENGINE\u003dOLAP \nDUPLICATE KEY(`statis_id`)\n\nPARTITION BY RANGE(`v3`)\n(PARTITION p20220303 VALUES [(\"20220303\"), (\"20220304\")),\nPARTITION p20220304 VALUES [(\"20220304\"), (\"20220305\")),\nPARTITION p20220305 VALUES [(\"20220305\"), (\"20220306\")),\nPARTITION p20220306 VALUES [(\"20220306\"), (\"20220307\")),\nPARTITION p20220307 VALUES [(\"20220307\"), (\"20220308\")),\nPARTITION p20220308 VALUES [(\"20220308\"), (\"20220309\")),\nPARTITION p20220309 VALUES [(\"20220309\"), (\"20220310\")),\nPARTITION p20220310 VALUES [(\"20220310\"), (\"20220311\")),\nPARTITION p20220311 VALUES [(\"20220311\"), (\"20220312\")),\nPARTITION p20220312 VALUES [(\"20220312\"), (\"20220313\")),\nPARTITION p20220313 VALUES [(\"20220313\"), (\"20220314\")))\nDISTRIBUTED BY HASH(`statis_id`) BUCKETS 6 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"dynamic_partition.enable\" \u003d \"false\",\n\"dynamic_partition.time_unit\" \u003d \"DAY\",\n\"dynamic_partition.time_zone\" \u003d \"Asia/Shanghai\",\n\"dynamic_partition.start\" \u003d \"-7\",\n\"dynamic_partition.end\" \u003d \"3\",\n\"dynamic_partition.prefix\" \u003d \"p\",\n\"dynamic_partition.buckets\" \u003d \"12\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\"\n);",
    "test.t2":"CREATE TABLE `t2` (\n  `one_id` varchar(200) NULL ,\n  `v3` int(11) NULL ,\n  `id_type` varchar(100) NULL ,\n  `imei` varchar(100) NULL ,\n  `ssoid` varchar(100) NULL ,\n  `country_code` varchar(100) NULL ,\n  `phone` varchar(100) NULL ,\n  `union_id` varchar(100) NULL ,\n  `v1` bigint(20) NULL ,\n  `is_card_no` varchar(100) NULL ,\n  `v6` varchar(100) NULL ,\n  `v7` varchar(100) NULL ,\n  `etl_time` varchar(100) NULL \n) ENGINE\u003dOLAP \nDUPLICATE KEY(`one_id`)\n\nPARTITION BY RANGE(`v3`)\n(PARTITION p20220303 VALUES [(\"20220303\"), (\"20220304\")),\nPARTITION p20220304 VALUES [(\"20220304\"), (\"20220305\")),\nPARTITION p20220305 VALUES [(\"20220305\"), (\"20220306\")),\nPARTITION p20220306 VALUES [(\"20220306\"), (\"20220307\")),\nPARTITION p20220307 VALUES [(\"20220307\"), (\"20220308\")),\nPARTITION p20220308 VALUES [(\"20220308\"), (\"20220309\")),\nPARTITION p20220309 VALUES [(\"20220309\"), (\"20220310\")),\nPARTITION p20220310 VALUES [(\"20220310\"), (\"20220311\")),\nPARTITION p20220311 VALUES [(\"20220311\"), (\"20220312\")),\nPARTITION p20220312 VALUES [(\"20220312\"), (\"20220313\")),\nPARTITION p20220313 VALUES [(\"20220313\"), (\"20220314\")))\nDISTRIBUTED BY HASH(`one_id`) BUCKETS 12 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"dynamic_partition.enable\" \u003d \"false\",\n\"dynamic_partition.time_unit\" \u003d \"DAY\",\n\"dynamic_partition.time_zone\" \u003d \"Asia/Shanghai\",\n\"dynamic_partition.start\" \u003d \"-7\",\n\"dynamic_partition.end\" \u003d \"3\",\n\"dynamic_partition.prefix\" \u003d \"p\",\n\"dynamic_partition.buckets\" \u003d \"12\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\"\n);",
    "test.t3":"CREATE TABLE `t3` (\n  `one_id` bigint(20) NULL ,\n `v3` int(11) NULL ,\n `v1` bigint(20) NULL,\n `v5` varchar(20) NULL ,\n `v2` int(11) NULL ,\n `v4` varchar(10) NULL \n ) ENGINE\u003dOLAP \nDUPLICATE KEY(`one_id`)\n\nPARTITION BY RANGE(`v3`)\n(PARTITION p20220303 VALUES [(\"20220303\"), (\"20220304\")),\nPARTITION p20220304 VALUES [(\"20220304\"), (\"20220305\")),\nPARTITION p20220305 VALUES [(\"20220305\"), (\"20220306\")),\nPARTITION p20220306 VALUES [(\"20220306\"), (\"20220307\")),\nPARTITION p20220307 VALUES [(\"20220307\"), (\"20220308\")),\nPARTITION p20220308 VALUES [(\"20220308\"), (\"20220309\")),\nPARTITION p20220309 VALUES [(\"20220309\"), (\"20220310\")),\nPARTITION p20220310 VALUES [(\"20220310\"), (\"20220311\")),\nPARTITION p20220311 VALUES [(\"20220311\"), (\"20220312\")),\nPARTITION p20220312 VALUES [(\"20220312\"), (\"20220313\")),\nPARTITION p20220313 VALUES [(\"20220313\"), (\"20220314\")))\nDISTRIBUTED BY HASH(`one_id`) BUCKETS 32 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"dynamic_partition.enable\" \u003d \"false\",\n\"dynamic_partition.time_unit\" \u003d \"DAY\",\n\"dynamic_partition.time_zone\" \u003d \"Asia/Shanghai\",\n\"dynamic_partition.start\" \u003d \"-7\",\n\"dynamic_partition.end\" \u003d \"3\",\n\"dynamic_partition.prefix\" \u003d \"p\",\n\"dynamic_partition.buckets\" \u003d \"10\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\"\n);"
  },
  "table_row_count":{
    "test.t3":{
      "p20220308":1419040581
    },
    "test.t1":{
      "p20220308":19345470
    },
    "test.t2":{
      "p20220308":692501912
    }
  },
  "session_variables":"{\"chunk_size\":4096,\"runtime_join_filter_push_down_limit\":1024000,\"codegen_level\":0,\"cbo_cte_reuse\":false,\"character_set_connection\":\"utf8\",\"cbo_use_correlated_join_estimate\":true,\"enable_insert_strict\":true,\"enable_filter_unused_columns_in_scan_stage\":false,\"div_precision_increment\":4,\"tx_isolation\":\"REPEATABLE-READ\",\"wait_timeout\":28800,\"auto_increment_increment\":1,\"foreign_key_checks\":true,\"character_set_client\":\"utf8\",\"autocommit\":true,\"enable_column_expr_predicate\":false,\"character_set_results\":\"utf8\",\"parallel_fragment_exec_instance_num\":1,\"max_scan_key_num\":-1,\"enable_global_runtime_filter\":true,\"forward_to_master\":false,\"net_read_timeout\":60,\"streaming_preaggregation_mode\":\"auto\",\"storage_engine\":\"olap\",\"cbo_enable_dp_join_reorder\":true,\"cbo_enable_low_cardinality_optimize\":true,\"tx_visible_wait_timeout\":10,\"cbo_max_reorder_node_use_exhaustive\":4,\"new_planner_optimize_timeout\":3000,\"force_schedule_local\":false,\"pipeline_dop\":0,\"enable_query_dump\":false,\"cbo_enable_greedy_join_reorder\":true,\"prefer_join_method\":\"broadcast\",\"single_node_exec_plan\":false,\"load_mem_limit\":0,\"sql_select_limit\":9223372036854775807,\"profiling\":false,\"sql_safe_updates\":0,\"enable_pipeline_engine\":false,\"query_cache_type\":0,\"disable_colocate_join\":false,\"max_pushdown_conditions_per_column\":-1,\"enable_vectorized_engine\":true,\"net_write_timeout\":60,\"collation_database\":\"utf8_general_ci\",\"hash_join_push_down_right_table\":true,\"enable_exchange_pass_through\":true,\"new_planner_agg_stage\":0,\"pipeline_profile_mode\":\"brief\",\"collation_connection\":\"utf8_general_ci\",\"resource_group\":\"normal\",\"broadcast_row_limit\":15000000,\"exec_mem_limit\":2147483648,\"cbo_max_reorder_node_use_dp\":10,\"disable_join_reorder\":false,\"enable_profile\":false,\"enable_groupby_use_output_alias\":false,\"net_buffer_length\":16384,\"transmission_compression_type\":\"LZ4\",\"enable_vectorized_insert\":true,\"interactive_timeout\":3600,\"enable_spilling\":false,\"batch_size\":0,\"cbo_enable_replicated_join\":true,\"pipeline_max_input_bytes_per_operator\":100000000,\"max_allowed_packet\":1048576,\"query_timeout\":300,\"enable_cbo\":true,\"collation_server\":\"utf8_general_ci\",\"time_zone\":\"Asia/Shanghai\",\"max_execution_time\":3000000,\"character_set_server\":\"utf8\",\"cbo_use_nth_exec_plan\":0,\"rewrite_count_distinct_to_bitmap_hll\":true,\"parallel_exchange_instance_num\":-1,\"sql_mode\":0,\"SQL_AUTO_IS_NULL\":false,\"event_scheduler\":\"OFF\",\"disable_streaming_preaggregations\":false}",
  "column_statistics":{
    "test.t3":{
      "v1":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v2":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v3":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v4":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v5":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN"
    },
    "test.t1":{
      "v1":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v3":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v6":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN"
    },
    "test.t2":{
      "v1":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v7":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "v3":"[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN"
    }
  },
  "be_number":5,
  "exception":[

  ]
}