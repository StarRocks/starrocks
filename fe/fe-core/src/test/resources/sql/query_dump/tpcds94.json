{
  "statement":"select  \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between \u00271999-2-01\u0027 and \n           date_add(cast(\u00271999-2-01\u0027 as date), 60)\nand ws1.ws_ship_date_sk \u003d d_date_sk\nand ws1.ws_ship_addr_sk \u003d ca_address_sk\nand ca_state \u003d \u0027IL\u0027\nand ws1.ws_web_site_sk \u003d web_site_sk\nand web_company_name \u003d \u0027pri\u0027\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number \u003d ws2.ws_order_number\n              and ws1.ws_warehouse_sk \u003c\u003e ws2.ws_warehouse_sk)\nand not exists(select *\n               from web_returns wr1\n               where ws1.ws_order_number \u003d wr1.wr_order_number)\norder by count(distinct ws_order_number)\nlimit 100;\n",
  "table_meta":{
    "tpcds_1t_performance.customer_address":"CREATE TABLE `customer_address` (\n  `ca_address_sk` int(11) NOT NULL COMMENT \"\",\n  `ca_address_id` char(16) NOT NULL COMMENT \"\",\n  `ca_street_number` char(10) NULL COMMENT \"\",\n  `ca_street_name` varchar(60) NULL COMMENT \"\",\n  `ca_street_type` char(15) NULL COMMENT \"\",\n  `ca_suite_number` char(10) NULL COMMENT \"\",\n  `ca_city` varchar(60) NULL COMMENT \"\",\n  `ca_county` varchar(30) NULL COMMENT \"\",\n  `ca_state` char(2) NULL COMMENT \"\",\n  `ca_zip` char(10) NULL COMMENT \"\",\n  `ca_country` varchar(20) NULL COMMENT \"\",\n  `ca_gmt_offset` decimal64(5, 2) NULL COMMENT \"\",\n  `ca_location_type` char(20) NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`ca_address_sk`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`ca_address_sk`) BUCKETS 8 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\",\n\"enable_persistent_index\" \u003d \"false\"\n);",
    "tpcds_1t_performance.date_dim":"CREATE TABLE `date_dim` (\n  `d_date_sk` int(11) NOT NULL COMMENT \"\",\n  `d_date_id` char(16) NOT NULL COMMENT \"\",\n  `d_date` date NOT NULL COMMENT \"\",\n  `d_month_seq` int(11) NOT NULL COMMENT \"\",\n  `d_week_seq` int(11) NOT NULL COMMENT \"\",\n  `d_quarter_seq` int(11) NOT NULL COMMENT \"\",\n  `d_year` int(11) NOT NULL COMMENT \"\",\n  `d_dow` int(11) NOT NULL COMMENT \"\",\n  `d_moy` int(11) NOT NULL COMMENT \"\",\n  `d_dom` int(11) NOT NULL COMMENT \"\",\n  `d_qoy` int(11) NOT NULL COMMENT \"\",\n  `d_fy_year` int(11) NOT NULL COMMENT \"\",\n  `d_fy_quarter_seq` int(11) NOT NULL COMMENT \"\",\n  `d_fy_week_seq` int(11) NOT NULL COMMENT \"\",\n  `d_day_name` char(9) NOT NULL COMMENT \"\",\n  `d_quarter_name` char(6) NOT NULL COMMENT \"\",\n  `d_holiday` char(1) NOT NULL COMMENT \"\",\n  `d_weekend` char(1) NOT NULL COMMENT \"\",\n  `d_following_holiday` char(1) NOT NULL COMMENT \"\",\n  `d_first_dom` int(11) NOT NULL COMMENT \"\",\n  `d_last_dom` int(11) NOT NULL COMMENT \"\",\n  `d_same_day_ly` int(11) NOT NULL COMMENT \"\",\n  `d_same_day_lq` int(11) NOT NULL COMMENT \"\",\n  `d_current_day` char(1) NOT NULL COMMENT \"\",\n  `d_current_week` char(1) NOT NULL COMMENT \"\",\n  `d_current_month` char(1) NOT NULL COMMENT \"\",\n  `d_current_quarter` char(1) NOT NULL COMMENT \"\",\n  `d_current_year` char(1) NOT NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`d_date_sk`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`d_date_sk`) BUCKETS 1 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\",\n\"enable_persistent_index\" \u003d \"false\"\n);",
    "tpcds_1t_performance.web_returns":"CREATE TABLE `web_returns` (\n  `wr_item_sk` int(11) NOT NULL COMMENT \"\",\n  `wr_order_number` int(11) NOT NULL COMMENT \"\",\n  `wr_returned_date_sk` int(11) NULL COMMENT \"\",\n  `wr_returned_time_sk` int(11) NULL COMMENT \"\",\n  `wr_refunded_customer_sk` int(11) NULL COMMENT \"\",\n  `wr_refunded_cdemo_sk` int(11) NULL COMMENT \"\",\n  `wr_refunded_hdemo_sk` int(11) NULL COMMENT \"\",\n  `wr_refunded_addr_sk` int(11) NULL COMMENT \"\",\n  `wr_returning_customer_sk` int(11) NULL COMMENT \"\",\n  `wr_returning_cdemo_sk` int(11) NULL COMMENT \"\",\n  `wr_returning_hdemo_sk` int(11) NULL COMMENT \"\",\n  `wr_returning_addr_sk` int(11) NULL COMMENT \"\",\n  `wr_web_page_sk` int(11) NULL COMMENT \"\",\n  `wr_reason_sk` int(11) NULL COMMENT \"\",\n  `wr_return_quantity` int(11) NULL COMMENT \"\",\n  `wr_return_amt` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_return_tax` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_return_amt_inc_tax` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_fee` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_return_ship_cost` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_refunded_cash` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_reversed_charge` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_account_credit` decimal64(7, 2) NULL COMMENT \"\",\n  `wr_net_loss` decimal64(7, 2) NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`wr_item_sk`, `wr_order_number`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`wr_item_sk`, `wr_order_number`) BUCKETS 16 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\",\n\"enable_persistent_index\" \u003d \"false\"\n);",
    "tpcds_1t_performance.web_sales":"CREATE TABLE `web_sales` (\n  `ws_item_sk` int(11) NOT NULL COMMENT \"\",\n  `ws_order_number` int(11) NOT NULL COMMENT \"\",\n  `ws_sold_date_sk` int(11) NULL COMMENT \"\",\n  `ws_sold_time_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_date_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_customer_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_cdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_hdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_addr_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_customer_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_cdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_hdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_addr_sk` int(11) NULL COMMENT \"\",\n  `ws_web_page_sk` int(11) NULL COMMENT \"\",\n  `ws_web_site_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_mode_sk` int(11) NULL COMMENT \"\",\n  `ws_warehouse_sk` int(11) NULL COMMENT \"\",\n  `ws_promo_sk` int(11) NULL COMMENT \"\",\n  `ws_quantity` int(11) NULL COMMENT \"\",\n  `ws_wholesale_cost` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_list_price` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_sales_price` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_ext_discount_amt` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_ext_sales_price` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_ext_wholesale_cost` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_ext_list_price` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_ext_tax` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_coupon_amt` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_ext_ship_cost` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_net_paid` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_net_paid_inc_tax` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_net_paid_inc_ship` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_net_paid_inc_ship_tax` decimal64(7, 2) NULL COMMENT \"\",\n  `ws_net_profit` decimal64(7, 2) NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`ws_item_sk`, `ws_order_number`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`ws_item_sk`, `ws_order_number`) BUCKETS 256 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\",\n\"enable_persistent_index\" \u003d \"false\"\n);",
    "tpcds_1t_performance.web_site":"CREATE TABLE `web_site` (\n  `web_site_sk` int(11) NOT NULL COMMENT \"\",\n  `web_site_id` char(16) NOT NULL COMMENT \"\",\n  `web_rec_start_date` date NULL COMMENT \"\",\n  `web_rec_end_date` date NULL COMMENT \"\",\n  `web_name` varchar(50) NULL COMMENT \"\",\n  `web_open_date_sk` int(11) NULL COMMENT \"\",\n  `web_close_date_sk` int(11) NULL COMMENT \"\",\n  `web_class` varchar(50) NULL COMMENT \"\",\n  `web_manager` varchar(40) NULL COMMENT \"\",\n  `web_mkt_id` int(11) NULL COMMENT \"\",\n  `web_mkt_class` varchar(50) NULL COMMENT \"\",\n  `web_mkt_desc` varchar(100) NULL COMMENT \"\",\n  `web_market_manager` varchar(40) NULL COMMENT \"\",\n  `web_company_id` int(11) NULL COMMENT \"\",\n  `web_company_name` char(50) NULL COMMENT \"\",\n  `web_street_number` char(10) NULL COMMENT \"\",\n  `web_street_name` varchar(60) NULL COMMENT \"\",\n  `web_street_type` char(15) NULL COMMENT \"\",\n  `web_suite_number` char(10) NULL COMMENT \"\",\n  `web_city` varchar(60) NULL COMMENT \"\",\n  `web_county` varchar(30) NULL COMMENT \"\",\n  `web_state` char(2) NULL COMMENT \"\",\n  `web_zip` char(10) NULL COMMENT \"\",\n  `web_country` varchar(20) NULL COMMENT \"\",\n  `web_gmt_offset` decimal64(5, 2) NULL COMMENT \"\",\n  `web_tax_percentage` decimal64(5, 2) NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`web_site_sk`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`web_site_sk`) BUCKETS 1 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\",\n\"enable_persistent_index\" \u003d \"false\"\n);"
  },
  "table_row_count":{
    "tpcds_1t_performance.web_returns":{
      "web_returns":71997522
    },
    "tpcds_1t_performance.web_site":{
      "web_site":54
    },
    "tpcds_1t_performance.customer_address":{
      "customer_address":6000000
    },
    "tpcds_1t_performance.date_dim":{
      "date_dim":73049
    },
    "tpcds_1t_performance.web_sales":{
      "web_sales":720000376
    }
  },
  "session_variables":"{\"enable_resource_group\":false,\"codegen_level\":0,\"cbo_cte_reuse\":false,\"character_set_connection\":\"utf8\",\"cbo_use_correlated_join_estimate\":true,\"enable_insert_strict\":true,\"join_implementation_mode\":\"hash\",\"tx_isolation\":\"REPEATABLE-READ\",\"wait_timeout\":28800,\"cbo_cte_reuse_rate\":1.2,\"foreign_key_checks\":true,\"character_set_results\":\"utf8\",\"enable_global_runtime_filter\":true,\"forward_to_master\":false,\"cbo_enable_low_cardinality_optimize\":true,\"new_planner_optimize_timeout\":3000,\"force_schedule_local\":false,\"cbo_enable_greedy_join_reorder\":true,\"prefer_join_method\":\"broadcast\",\"load_mem_limit\":0,\"profiling\":false,\"sql_safe_updates\":0,\"global_runtime_filter_probe_min_size\":102400,\"enable_exchange_pass_through_expire\":false,\"enable_vectorized_engine\":true,\"query_delivery_timeout\":300,\"net_write_timeout\":60,\"collation_database\":\"utf8_general_ci\",\"hash_join_push_down_right_table\":true,\"new_planner_agg_stage\":0,\"collation_connection\":\"utf8_general_ci\",\"resource_group\":\"\",\"broadcast_row_limit\":15000000,\"exec_mem_limit\":21474836480,\"cbo_max_reorder_node_use_dp\":10,\"disable_join_reorder\":false,\"enable_profile\":false,\"enable_hive_column_stats\":true,\"enable_groupby_use_output_alias\":false,\"net_buffer_length\":16384,\"query_timeout\":180,\"cbo_max_reorder_node\":50,\"max_execution_time\":3000000,\"runtime_filter_scan_wait_time\":20,\"SQL_AUTO_IS_NULL\":false,\"event_scheduler\":\"OFF\",\"disable_streaming_preaggregations\":false,\"chunk_size\":4096,\"disable_bucket_join\":false,\"runtime_join_filter_push_down_limit\":20480000,\"global_runtime_filter_probe_min_selectivity\":0.5,\"query_mem_limit\":0,\"enable_tablet_internal_parallel\":false,\"enable_filter_unused_columns_in_scan_stage\":false,\"div_precision_increment\":4,\"auto_increment_increment\":1,\"sql_mode_v2\":8589934626,\"character_set_client\":\"utf8\",\"autocommit\":true,\"enable_column_expr_predicate\":true,\"pipeline_profile_level\":1,\"parallel_fragment_exec_instance_num\":1,\"max_scan_key_num\":-1,\"net_read_timeout\":60,\"streaming_preaggregation_mode\":\"auto\",\"storage_engine\":\"olap\",\"enable_optimizer_trace_log\":false,\"cbo_enable_dp_join_reorder\":true,\"tx_visible_wait_timeout\":10,\"cbo_max_reorder_node_use_exhaustive\":4,\"enable_sql_digest\":false,\"pipeline_dop\":0,\"enable_query_dump\":false,\"single_node_exec_plan\":false,\"global_runtime_filter_build_max_size\":67108864,\"sql_select_limit\":9223372036854775807,\"statistic_collect_parallel\":1,\"query_cache_type\":0,\"disable_colocate_join\":false,\"max_pushdown_conditions_per_column\":-1,\"enable_predicate_reorder\":false,\"workgroup_id\":0,\"transmission_compression_type\":\"LZ4\",\"enable_vectorized_insert\":true,\"interactive_timeout\":3600,\"enable_spilling\":false,\"batch_size\":0,\"cbo_enable_replicated_join\":true,\"max_allowed_packet\":1048576,\"enable_cbo\":true,\"collation_server\":\"utf8_general_ci\",\"time_zone\":\"Asia/Shanghai\",\"character_set_server\":\"utf8\",\"enable_pipeline\":true,\"cbo_use_nth_exec_plan\":0,\"rewrite_count_distinct_to_bitmap_hll\":true,\"parallel_exchange_instance_num\":-1,\"enable_shared_scan\":false,\"allow_default_partition\":false}",
  "column_statistics":{
    "tpcds_1t_performance.web_returns":{
      "wr_order_number":"[1.0, 6.0E7, 0.0, 4.0, 4.2753388E7] ESTIMATE"
    },
    "tpcds_1t_performance.web_site":{
      "web_site_sk":"[1.0, 54.0, 0.0, 4.0, 54.0] ESTIMATE",
      "web_company_name":"[-Infinity, Infinity, 0.037037037037037035, 3.759259259259259, 6.0] ESTIMATE"
    },
    "tpcds_1t_performance.customer_address":{
      "ca_state":"[-Infinity, Infinity, 0.029989333333333333, 1.9400213333333334, 51.0] ESTIMATE",
      "ca_address_sk":"[1.0, 6000000.0, 0.0, 4.0, 6028862.0] ESTIMATE"
    },
    "tpcds_1t_performance.date_dim":{
      "d_date":"[-2.208931543E9, 4.102416E9, 0.0, 4.0, 72542.0] ESTIMATE",
      "d_date_sk":"[2415022.0, 2488070.0, 0.0, 4.0, 72542.0] ESTIMATE"
    },
    "tpcds_1t_performance.web_sales":{
      "ws_warehouse_sk":"[1.0, 20.0, 2.5014570270168857E-4, 4.0, 20.0] ESTIMATE",
      "ws_order_number":"[1.0, 6.0E7, 0.0, 4.0, 6.0907464E7] ESTIMATE",
      "ws_ship_date_sk":"[2450817.0, 2452762.0, 2.50015147214312E-4, 4.0, 1960.0] ESTIMATE",
      "ws_web_site_sk":"[1.0, 54.0, 2.49902647273062E-4, 4.0, 54.0] ESTIMATE",
      "ws_net_profit":"[-10000.0, 19840.0, 0.0, 8.0, 2025399.0] ESTIMATE",
      "ws_ship_addr_sk":"[1.0, 6000000.0, 2.4978875844364835E-4, 4.0, 6028496.0] ESTIMATE",
      "ws_ext_ship_cost":"[0.0, 14950.0, 2.501165360502534E-4, 8.0, 568470.0] ESTIMATE"
    }
  },
  "be_number":4,
  "exception":[

  ],
  "version":"UNKNOWN",
  "commit_version":"2dab334aa"
}