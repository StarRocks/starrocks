{"statement":"SELECT * FROM partitions2_keys311 AS table1 RIGHT JOIN partitions2_keys311 AS table2 ON table2.`undef_signed_not_null` <=> table2.`undef_signed_not_null` AND table1.`col_bigint_undef_signed_not_null` = table1.`col_int_undef_signed_not_null` WHERE table2.`undef_signed_not_null` = table2.`undef_signed_not_null` AND table2.`undef_signed_not_null` != 'j' ORDER BY 1, 2, 3 ASC limit 10000;\n","table_meta":{"test_starrocks.partitions2_keys311":"CREATE TABLE `partitions2_keys311` (\n  `undef_signed_not_null` varchar(10) NOT NULL COMMENT \"\",\n  `pk` int(11) NULL COMMENT \"\",\n  `col_int_undef_signed_not_null` int(11) NOT NULL COMMENT \"\",\n  `col_bigint_undef_signed_not_null` bigint(20) NOT NULL COMMENT \"\",\n  `col_date_undef_signed_not_null` date NOT NULL COMMENT \"\",\n  `col_date_undef_signed_not_null2` date NOT NULL COMMENT \"\"\n) ENGINE=OLAP \nDUPLICATE KEY(`undef_signed_not_null`, `pk`)\nPARTITION BY LIST(`undef_signed_not_null`)(\n  PARTITION p1 VALUES IN ('n', 'o', 'p', 'q', 'r', 's', 't', 'u'),\n  PARTITION p2 VALUES IN ('v', 'w', 'x', 'y', 'z'),\n  PARTITION p0 VALUES IN ('a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm')\n)\nDISTRIBUTED BY HASH(`pk`) BUCKETS 10 \nPROPERTIES (\n\"replication_num\" = \"1\",\n\"in_memory\" = \"false\",\n\"enable_persistent_index\" = \"false\",\n\"replicated_storage\" = \"true\",\n\"compression\" = \"LZ4\"\n);"},"table_row_count":{"test_starrocks.partitions2_keys311":{"p0":48,"p1":25,"p2":27}},"column_statistics":{"test_starrocks.partitions2_keys311":{"col_date_undef_signed_not_null":"[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE","col_date_undef_signed_not_null2":"[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE","undef_signed_not_null":"[-Infinity, Infinity, 0.0, 1.0, 25.0] ESTIMATE","col_int_undef_signed_not_null":"[-12.0, 9.0, 0.0, 4.0, 12.0] ESTIMATE","col_bigint_undef_signed_not_null":"[-12.0, 9.0, 0.0, 8.0, 12.0] ESTIMATE","pk":"[0.0, 99.0, 0.0, 4.0, 100.0] ESTIMATE"}},"explain_info":"PLAN FRAGMENT 0(F03)\n  Output Exprs:1 | 2: pk | 3: col_int_undef_signed_not_null | 4: col_bigint_undef_signed_not_null | 5: col_date_undef_signed_not_null | 6: col_date_undef_signed_not_null2 | 7 | 8: pk | 9: col_int_undef_signed_not_null | 10: col_bigint_undef_signed_not_null | 11: col_date_undef_signed_not_null | 12: col_date_undef_signed_not_null2\n  Input Partition: UNPARTITIONED\n  RESULT SINK\n\n  6:Decode\n  |  <dict id 13> : <string id 7>\n  |  <dict id 14> : <string id 1>\n  |  cardinality: 416\n  |  column statistics: \n  |  * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 8.333333333333332] ESTIMATE\n  |  * pk-->[0.0, 99.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 8.333333333333332] ESTIMATE\n  |  * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 25.0] ESTIMATE\n  |  * pk-->[0.0, 99.0, 0.0, 4.0, 49.92] ESTIMATE\n  |  * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 12.0] ESTIMATE\n  |  * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 12.0] ESTIMATE\n  |  * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n  |  * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n  |  \n  5:MERGING-EXCHANGE\n     distribution type: GATHER\n     limit: 10000\n     cardinality: 416\n     column statistics: \n     * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 8.333333333333332] ESTIMATE\n     * pk-->[0.0, 99.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n     * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n     * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 8.333333333333332] ESTIMATE\n     * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n     * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n     * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 25.0] ESTIMATE\n     * pk-->[0.0, 99.0, 0.0, 4.0, 49.92] ESTIMATE\n     * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 12.0] ESTIMATE\n     * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 12.0] ESTIMATE\n     * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n     * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n\nPLAN FRAGMENT 1(F00)\n\n  Input Partition: RANDOM\n  OutPut Partition: UNPARTITIONED\n  OutPut Exchange Id: 05\n\n  4:TOP-N\n  |  order by: [14, INT, true] ASC, [2, INT, true] ASC, [3, INT, true] ASC\n  |  offset: 0\n  |  hasNullableGenerateChild: true\n  |  limit: 10000\n  |  cardinality: 416\n  |  column statistics: \n  |  * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 8.333333333333332] ESTIMATE\n  |  * pk-->[0.0, 99.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 8.333333333333332] ESTIMATE\n  |  * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 25.0] ESTIMATE\n  |  * pk-->[0.0, 99.0, 0.0, 4.0, 49.92] ESTIMATE\n  |  * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 12.0] ESTIMATE\n  |  * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 12.0] ESTIMATE\n  |  * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n  |  * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n  |  \n  3:NESTLOOP JOIN\n  |  join op: LEFT OUTER JOIN\n  |  can local shuffle: false\n  |  cardinality: 416\n  |  column statistics: \n  |  * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 8.333333333333332] ESTIMATE\n  |  * pk-->[0.0, 99.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 8.333333333333332] ESTIMATE\n  |  * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n  |  * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 25.0] ESTIMATE\n  |  * pk-->[0.0, 99.0, 0.0, 4.0, 49.92] ESTIMATE\n  |  * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 12.0] ESTIMATE\n  |  * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 12.0] ESTIMATE\n  |  * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n  |  * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n  |  \n  |----2:EXCHANGE\n  |       distribution type: BROADCAST\n  |       cardinality: 8\n  |    \n  0:OlapScanNode\n     table: partitions2_keys311, rollup: partitions2_keys311\n     preAggregation: on\n     Predicates: DictExpr(13: undef_signed_not_null,[<place-holder> != 'j'])\n     dict_col=undef_signed_not_null\n     partitionsRatio=2/3, tabletsRatio=20/20\n     tabletList=12236,12238,12240,12242,12244,12246,12248,12250,12252,12254 ...\n     actualRows=52, avgRowSize=25.0\n     cardinality: 50\n     column statistics: \n     * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 25.0] ESTIMATE\n     * pk-->[0.0, 99.0, 0.0, 4.0, 49.92] ESTIMATE\n     * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 12.0] ESTIMATE\n     * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 12.0] ESTIMATE\n     * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n     * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 12.0] ESTIMATE\n\nPLAN FRAGMENT 2(F01)\n\n  Input Partition: RANDOM\n  OutPut Partition: UNPARTITIONED\n  OutPut Exchange Id: 02\n\n  1:OlapScanNode\n     table: partitions2_keys311, rollup: partitions2_keys311\n     preAggregation: on\n     Predicates: [4: col_bigint_undef_signed_not_null, BIGINT, true] = cast([3: col_int_undef_signed_not_null, INT, true] as BIGINT)\n     dict_col=undef_signed_not_null\n     partitionsRatio=3/3, tabletsRatio=30/30\n     tabletList=12256,12258,12260,12262,12264,12266,12268,12270,12272,12274 ...\n     actualRows=100, avgRowSize=25.0\n     cardinality: 8\n     column statistics: \n     * undef_signed_not_null-->[-Infinity, Infinity, 0.0, 1.0, 8.333333333333332] ESTIMATE\n     * pk-->[0.0, 99.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n     * col_int_undef_signed_not_null-->[-12.0, 9.0, 0.0, 4.0, 8.333333333333332] ESTIMATE\n     * col_bigint_undef_signed_not_null-->[-12.0, 9.0, 0.0, 8.0, 8.333333333333332] ESTIMATE\n     * col_date_undef_signed_not_null-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n     * col_date_undef_signed_not_null2-->[1.7020512E9, 1.7030016E9, 0.0, 4.0, 8.333333333333332] ESTIMATE\n","session_variables":"{\"partial_update_mode\":\"auto\",\"cbo_cte_reuse\":true,\"character_set_connection\":\"utf8\",\"cbo_use_correlated_join_estimate\":true,\"enable_insert_strict\":true,\"enable_connector_adaptive_io_tasks\":false,\"tx_isolation\":\"REPEATABLE-READ\",\"enable_hive_metadata_cache_with_insert\":false,\"hive_temp_staging_dir\":\"/tmp/starrocks\",\"cbo_cte_reuse_rate_v2\":1.15,\"character_set_results\":\"utf8\",\"enable_count_star_optimization\":true,\"enable_iceberg_column_statistics\":false,\"thrift_plan_protocol\":\"binary\",\"enable_plan_serialize_concurrently\":true,\"global_runtime_filter_build_min_size\":131072,\"enable_iceberg_identity_column_optimize\":true,\"query_excluding_mv_names\":\"\",\"enable_rewrite_simple_agg_to_meta_scan\":false,\"enable_adaptive_sink_dop\":true,\"consistent_hash_virtual_number\":32,\"enable_profile\":false,\"load_mem_limit\":0,\"cbo_eq_base_type\":\"varchar\",\"large_decimal_underlying_type\":\"panic\",\"sql_safe_updates\":0,\"runtime_filter_early_return_selectivity\":0.05,\"enable_local_shuffle_agg\":true,\"disable_function_fold_constants\":false,\"select_ratio_threshold\":0.15,\"query_delivery_timeout\":300,\"collation_database\":\"utf8_general_ci\",\"spill_mem_table_size\":104857600,\"follower_query_forward_mode\":\"\",\"cbo_use_lock_db\":false,\"new_planner_agg_stage\":0,\"hash_join_interpolate_passthrough\":false,\"use_compute_nodes\":-1,\"collation_connection\":\"utf8_general_ci\",\"resource_group\":\"\",\"enable_materialized_view_plan_cache\":true,\"spill_operator_max_bytes\":1048576000,\"cbo_max_reorder_node_use_dp\":10,\"enable_hive_column_stats\":true,\"enable_async_profile\":true,\"enable_groupby_use_output_alias\":false,\"global_runtime_filter_wait_timeout\":20,\"forward_to_leader\":false,\"count_distinct_column_buckets\":1024,\"cross_join_cost_penalty\":1000000,\"query_cache_agg_cardinality_limit\":5000000,\"cboPushDownAggregateMode_v1\":-1,\"window_partition_mode\":1,\"enable_tablet_internal_parallel_v2\":true,\"interpolate_passthrough\":true,\"enable_incremental_mv\":false,\"cbo_push_down_topn_limit\":1000,\"SQL_AUTO_IS_NULL\":false,\"event_scheduler\":\"OFF\",\"max_pipeline_dop\":64,\"broadcast_right_table_scale_factor\":10,\"materialized_view_rewrite_mode\":\"DEFAULT\",\"enable_read_iceberg_puffin_ndv\":true,\"enable_write_hive_external_table\":false,\"enable_simplify_case_when\":true,\"runtime_join_filter_push_down_limit\":1024000,\"trace_log_mode\":\"command\",\"enable_scan_datacache\":false,\"big_query_log_cpu_second_threshold\":480,\"div_precision_increment\":4,\"runtime_adaptive_dop_max_block_rows_per_driver_seq\":16384,\"log_rejected_record_num\":0,\"enable_short_circuit\":false,\"cbo_push_down_distinct_below_window\":true,\"sql_mode_v2\":34,\"prefer_cte_rewrite\":false,\"hdfs_backend_selector_scan_range_shuffle\":false,\"pipeline_profile_level\":1,\"parallel_fragment_exec_instance_num\":1,\"max_scan_key_num\":-1,\"net_read_timeout\":60,\"streaming_preaggregation_mode\":\"auto\",\"hive_partition_stats_sample_size\":3000,\"enable_mv_planner\":false,\"enable_collect_table_level_scan_stats\":true,\"enable_populate_datacache\":true,\"query_debug_options\":\"\",\"profile_timeout\":2,\"cbo_push_down_aggregate\":\"global\",\"spill_encode_level\":7,\"enable_query_dump\":false,\"global_runtime_filter_build_max_size\":67108864,\"enable_rewrite_sum_by_associative_rule\":true,\"query_cache_hot_partition_num\":3,\"enable_prune_complex_types\":true,\"query_cache_type\":0,\"max_parallel_scan_instance_num\":-1,\"query_cache_entry_max_rows\":409600,\"connector_io_tasks_per_scan_operator\":16,\"enable_materialized_view_union_rewrite\":true,\"sql_quote_show_create\":true,\"scan_or_to_union_threshold\":50000000,\"enable_exchange_pass_through\":true,\"runtime_profile_report_interval\":10,\"query_cache_entry_max_bytes\":4194304,\"enable_partition_column_value_only_optimization\":true,\"interleaving_group_size\":10,\"enable_exchange_perf\":false,\"workgroup_id\":0,\"enable_rewrite_groupingsets_to_union_all\":false,\"transmission_compression_type\":\"NO_COMPRESSION\",\"interactive_timeout\":3600,\"use_page_cache\":true,\"big_query_log_scan_bytes_threshold\":10737418240,\"collation_server\":\"utf8_general_ci\",\"cbo_decimal_cast_string_strict\":true,\"cbo_enable_predicate_subfield_path\":true,\"tablet_internal_parallel_mode\":\"auto\",\"enable_pipeline\":true,\"spill_mode\":\"auto\",\"enable_query_debug_trace\":false,\"enable_show_all_variables\":false,\"full_sort_max_buffered_bytes\":16777216,\"wait_timeout\":28800,\"max_buckets_per_be_to_use_balancer_assignment\":6,\"enable_query_tablet_affinity\":false,\"transmission_encode_level\":7,\"query_including_mv_names\":\"\",\"transaction_isolation\":\"REPEATABLE-READ\",\"enable_global_runtime_filter\":true,\"enable_load_profile\":false,\"enable_plan_validation\":true,\"load_transmission_compression_type\":\"NO_COMPRESSION\",\"global_runtime_filter_rpc_http_min_size\":67108864,\"cbo_enable_low_cardinality_optimize\":true,\"scan_use_query_mem_ratio\":0.3,\"new_planner_optimize_timeout\":3000,\"enable_outer_join_reorder\":true,\"force_schedule_local\":false,\"hudi_mor_force_jni_reader\":false,\"cbo_enable_greedy_join_reorder\":true,\"range_pruner_max_predicate\":100,\"enable_rbo_table_prune\":false,\"spillable_operator_mask\":-1,\"rpc_http_min_size\":2147482624,\"enable_file_metacache\":false,\"cbo_debug_alive_backend_number\":0,\"global_runtime_filter_probe_min_size\":102400,\"scan_or_to_union_limit\":4,\"enable_cbo_table_prune\":false,\"enable_parallel_merge\":true,\"nested_mv_rewrite_max_level\":3,\"net_write_timeout\":60,\"cbo_prune_shuffle_column_rate\":0.1,\"spill_revocable_max_bytes\":0,\"hash_join_push_down_right_table\":true,\"pipeline_sink_dop\":0,\"broadcast_row_limit\":15000000,\"enable_prune_iceberg_manifest\":true,\"exec_mem_limit\":2147483648,\"enable_sort_aggregate\":false,\"query_cache_force_populate\":false,\"runtime_filter_on_exchange_node\":false,\"disable_join_reorder\":false,\"enable_rule_based_materialized_view_rewrite\":true,\"global_runtime_filter_rpc_timeout\":400,\"connector_scan_use_query_mem_ratio\":0.3,\"net_buffer_length\":16384,\"cbo_prune_subfield\":true,\"full_sort_max_buffered_rows\":1024000,\"query_timeout\":300,\"connector_io_tasks_slow_io_latency_ms\":50,\"cbo_max_reorder_node\":50,\"enable_distinct_column_bucketization\":false,\"enable_big_query_log\":true,\"analyze_mv\":\"sample\",\"runtime_filter_scan_wait_time\":20,\"enable_sync_materialized_view_rewrite\":true,\"prefer_compute_node\":true,\"enable_strict_type\":false,\"group_concat_max_len\":1024,\"parse_tokens_limit\":3500000,\"chunk_size\":4096,\"global_runtime_filter_probe_min_selectivity\":0.5,\"query_mem_limit\":0,\"big_query_profile_second_threshold\":0,\"enable_filter_unused_columns_in_scan_stage\":true,\"enable_materialized_view_single_table_view_delta_rewrite\":false,\"enable_prune_complex_types_in_unnest\":true,\"auto_increment_increment\":1,\"sql_dialect\":\"StarRocks\",\"enable_per_bucket_optimize\":true,\"big_query_log_scan_rows_threshold\":1000000000,\"character_set_client\":\"utf8\",\"autocommit\":true,\"enable_column_expr_predicate\":true,\"enable_runtime_adaptive_dop\":false,\"cbo_cte_max_limit\":10,\"storage_engine\":\"olap\",\"spill_operator_min_bytes\":52428800,\"cbo_enable_dp_join_reorder\":true,\"tx_visible_wait_timeout\":10,\"enable_materialized_view_view_delta_rewrite\":true,\"cbo_max_reorder_node_use_exhaustive\":4,\"enable_sql_digest\":false,\"spill_mem_table_num\":2,\"enable_spill\":false,\"enable_materialized_view_rewrite_greedy_mode\":false,\"pipeline_dop\":0,\"single_node_exec_plan\":false,\"full_sort_late_materialization_v2\":true,\"join_implementation_mode_v2\":\"auto\",\"sql_select_limit\":9223372036854775807,\"enable_materialized_view_rewrite\":true,\"statistic_collect_parallel\":1,\"hdfs_backend_selector_hash_algorithm\":\"consistent\",\"enable_expr_prune_partition\":true,\"enable_topn_runtime_filter\":true,\"disable_colocate_join\":false,\"max_pushdown_conditions_per_column\":-1,\"default_table_compression\":\"lz4_frame\",\"runtime_adaptive_dop_max_output_amplification_factor\":0,\"innodb_read_only\":true,\"spill_mem_limit_threshold\":0.8,\"cbo_reorder_threshold_use_exhaustive\":6,\"enable_predicate_reorder\":false,\"enable_query_cache\":false,\"max_allowed_packet\":33554432,\"time_zone\":\"Asia/Shanghai\",\"enable_multicolumn_global_runtime_filter\":false,\"character_set_server\":\"utf8\",\"cbo_use_nth_exec_plan\":0,\"io_tasks_per_scan_operator\":4,\"parallel_exchange_instance_num\":-1,\"enable_shared_scan\":false,\"audit_execute_stmt\":false,\"cbo_derive_range_join_predicate\":false,\"allow_default_partition\":false,\"enable_pipeline_level_shuffle\":true}","be_number":3,"be_core_stat":{"numOfHardwareCoresPerBe":"{\"10004\":4,\"10005\":4,\"10166\":4}","cachedAvgNumOfHardwareCores":4},"exception":[],"version":"3.2.2","commit_version":"269e832"}