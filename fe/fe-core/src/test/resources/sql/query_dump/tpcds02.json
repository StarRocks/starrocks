{
  "statement":"with wscs as\n (select sold_date_sk\n        ,sales_price\n  from (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales \n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales) t),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name\u003d\u0027Sunday\u0027) then sales_price else null end) sun_sales,\n        sum(case when (d_day_name\u003d\u0027Monday\u0027) then sales_price else null end) mon_sales,\n        sum(case when (d_day_name\u003d\u0027Tuesday\u0027) then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name\u003d\u0027Wednesday\u0027) then sales_price else null end) wed_sales,\n        sum(case when (d_day_name\u003d\u0027Thursday\u0027) then sales_price else null end) thu_sales,\n        sum(case when (d_day_name\u003d\u0027Friday\u0027) then sales_price else null end) fri_sales,\n        sum(case when (d_day_name\u003d\u0027Saturday\u0027) then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk \u003d sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq \u003d wswscs.d_week_seq and\n        d_year \u003d 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq \u003d wswscs.d_week_seq and\n        d_year \u003d 2001+1) z\n where d_week_seq1\u003dd_week_seq2-53\n order by d_week_seq1;\n",
  "table_meta":{
    "tpcds.web_sales":"CREATE TABLE `web_sales` (\n  `ws_item_sk` int(11) NOT NULL COMMENT \"\",\n  `ws_order_number` int(11) NOT NULL COMMENT \"\",\n  `ws_sold_date_sk` int(11) NULL COMMENT \"\",\n  `ws_sold_time_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_date_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_customer_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_cdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_hdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_bill_addr_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_customer_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_cdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_hdemo_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_addr_sk` int(11) NULL COMMENT \"\",\n  `ws_web_page_sk` int(11) NULL COMMENT \"\",\n  `ws_web_site_sk` int(11) NULL COMMENT \"\",\n  `ws_ship_mode_sk` int(11) NULL COMMENT \"\",\n  `ws_warehouse_sk` int(11) NULL COMMENT \"\",\n  `ws_promo_sk` int(11) NULL COMMENT \"\",\n  `ws_quantity` int(11) NULL COMMENT \"\",\n  `ws_wholesale_cost` decimal(7, 2) NULL COMMENT \"\",\n  `ws_list_price` decimal(7, 2) NULL COMMENT \"\",\n  `ws_sales_price` decimal(7, 2) NULL COMMENT \"\",\n  `ws_ext_discount_amt` decimal(7, 2) NULL COMMENT \"\",\n  `ws_ext_sales_price` decimal(7, 2) NULL COMMENT \"\",\n  `ws_ext_wholesale_cost` decimal(7, 2) NULL COMMENT \"\",\n  `ws_ext_list_price` decimal(7, 2) NULL COMMENT \"\",\n  `ws_ext_tax` decimal(7, 2) NULL COMMENT \"\",\n  `ws_coupon_amt` decimal(7, 2) NULL COMMENT \"\",\n  `ws_ext_ship_cost` decimal(7, 2) NULL COMMENT \"\",\n  `ws_net_paid` decimal(7, 2) NULL COMMENT \"\",\n  `ws_net_paid_inc_tax` decimal(7, 2) NULL COMMENT \"\",\n  `ws_net_paid_inc_ship` decimal(7, 2) NULL COMMENT \"\",\n  `ws_net_paid_inc_ship_tax` decimal(7, 2) NULL COMMENT \"\",\n  `ws_net_profit` decimal(7, 2) NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`ws_item_sk`, `ws_order_number`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`ws_item_sk`, `ws_order_number`) BUCKETS 192 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\"\n);",
    "tpcds.catalog_sales":"CREATE TABLE `catalog_sales` (\n  `cs_item_sk` int(11) NOT NULL COMMENT \"\",\n  `cs_order_number` int(11) NOT NULL COMMENT \"\",\n  `cs_sold_date_sk` int(11) NULL COMMENT \"\",\n  `cs_sold_time_sk` int(11) NULL COMMENT \"\",\n  `cs_ship_date_sk` int(11) NULL COMMENT \"\",\n  `cs_bill_customer_sk` int(11) NULL COMMENT \"\",\n  `cs_bill_cdemo_sk` int(11) NULL COMMENT \"\",\n  `cs_bill_hdemo_sk` int(11) NULL COMMENT \"\",\n  `cs_bill_addr_sk` int(11) NULL COMMENT \"\",\n  `cs_ship_customer_sk` int(11) NULL COMMENT \"\",\n  `cs_ship_cdemo_sk` int(11) NULL COMMENT \"\",\n  `cs_ship_hdemo_sk` int(11) NULL COMMENT \"\",\n  `cs_ship_addr_sk` int(11) NULL COMMENT \"\",\n  `cs_call_center_sk` int(11) NULL COMMENT \"\",\n  `cs_catalog_page_sk` int(11) NULL COMMENT \"\",\n  `cs_ship_mode_sk` int(11) NULL COMMENT \"\",\n  `cs_warehouse_sk` int(11) NULL COMMENT \"\",\n  `cs_promo_sk` int(11) NULL COMMENT \"\",\n  `cs_quantity` int(11) NULL COMMENT \"\",\n  `cs_wholesale_cost` decimal(7, 2) NULL COMMENT \"\",\n  `cs_list_price` decimal(7, 2) NULL COMMENT \"\",\n  `cs_sales_price` decimal(7, 2) NULL COMMENT \"\",\n  `cs_ext_discount_amt` decimal(7, 2) NULL COMMENT \"\",\n  `cs_ext_sales_price` decimal(7, 2) NULL COMMENT \"\",\n  `cs_ext_wholesale_cost` decimal(7, 2) NULL COMMENT \"\",\n  `cs_ext_list_price` decimal(7, 2) NULL COMMENT \"\",\n  `cs_ext_tax` decimal(7, 2) NULL COMMENT \"\",\n  `cs_coupon_amt` decimal(7, 2) NULL COMMENT \"\",\n  `cs_ext_ship_cost` decimal(7, 2) NULL COMMENT \"\",\n  `cs_net_paid` decimal(7, 2) NULL COMMENT \"\",\n  `cs_net_paid_inc_tax` decimal(7, 2) NULL COMMENT \"\",\n  `cs_net_paid_inc_ship` decimal(7, 2) NULL COMMENT \"\",\n  `cs_net_paid_inc_ship_tax` decimal(7, 2) NULL COMMENT \"\",\n  `cs_net_profit` decimal(7, 2) NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`cs_item_sk`, `cs_order_number`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`cs_item_sk`, `cs_order_number`) BUCKETS 192 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\"\n);",
    "tpcds.date_dim":"CREATE TABLE `date_dim` (\n  `d_date_sk` int(11) NOT NULL COMMENT \"\",\n  `d_date_id` char(16) NOT NULL COMMENT \"\",\n  `d_date` date NULL COMMENT \"\",\n  `d_month_seq` int(11) NULL COMMENT \"\",\n  `d_week_seq` int(11) NULL COMMENT \"\",\n  `d_quarter_seq` int(11) NULL COMMENT \"\",\n  `d_year` int(11) NULL COMMENT \"\",\n  `d_dow` int(11) NULL COMMENT \"\",\n  `d_moy` int(11) NULL COMMENT \"\",\n  `d_dom` int(11) NULL COMMENT \"\",\n  `d_qoy` int(11) NULL COMMENT \"\",\n  `d_fy_year` int(11) NULL COMMENT \"\",\n  `d_fy_quarter_seq` int(11) NULL COMMENT \"\",\n  `d_fy_week_seq` int(11) NULL COMMENT \"\",\n  `d_day_name` char(9) NULL COMMENT \"\",\n  `d_quarter_name` char(6) NULL COMMENT \"\",\n  `d_holiday` char(1) NULL COMMENT \"\",\n  `d_weekend` char(1) NULL COMMENT \"\",\n  `d_following_holiday` char(1) NULL COMMENT \"\",\n  `d_first_dom` int(11) NULL COMMENT \"\",\n  `d_last_dom` int(11) NULL COMMENT \"\",\n  `d_same_day_ly` int(11) NULL COMMENT \"\",\n  `d_same_day_lq` int(11) NULL COMMENT \"\",\n  `d_current_day` char(1) NULL COMMENT \"\",\n  `d_current_week` char(1) NULL COMMENT \"\",\n  `d_current_month` char(1) NULL COMMENT \"\",\n  `d_current_quarter` char(1) NULL COMMENT \"\",\n  `d_current_year` char(1) NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`d_date_sk`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`d_date_sk`) BUCKETS 5 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\"\n);"
  },
  "table_row_count":{
    "tpcds.catalog_sales":{
      "catalog_sales":143997065
    },
    "tpcds.web_sales":{
      "web_sales":72001237
    },
    "tpcds.date_dim":{
      "date_dim":73049
    }
  },
  "session_variables":"{\"runtime_join_filter_push_down_limit\":1024000,\"codegen_level\":0,\"cbo_cte_reuse\":false,\"character_set_connection\":\"utf8\",\"enable_insert_strict\":false,\"div_precision_increment\":4,\"tx_isolation\":\"REPEATABLE-READ\",\"wait_timeout\":28800,\"auto_increment_increment\":1,\"foreign_key_checks\":true,\"character_set_client\":\"utf8\",\"autocommit\":true,\"character_set_results\":\"utf8\",\"parallel_fragment_exec_instance_num\":4,\"max_scan_key_num\":-1,\"forward_to_master\":false,\"net_read_timeout\":60,\"streaming_preaggregation_mode\":\"auto\",\"storage_engine\":\"olap\",\"tx_visible_wait_timeout\":10,\"new_planner_optimize_timeout\":3000000,\"force_schedule_local\":false,\"prefer_join_method\":\"broadcast\",\"load_mem_limit\":0,\"sql_select_limit\":9223372036854775807,\"profiling\":false,\"sql_safe_updates\":0,\"enable_new_planner_mock_tpch_statistic\":false,\"query_cache_type\":0,\"use_v2_rollup\":false,\"disable_colocate_join\":false,\"max_pushdown_conditions_per_column\":-1,\"new_planner_tpch_scale\":1,\"enable_vectorized_engine\":true,\"net_write_timeout\":60,\"collation_database\":\"utf8_general_ci\",\"hash_join_push_down_right_table\":true,\"new_planner_agg_stage\":0,\"collation_connection\":\"utf8_general_ci\",\"resource_group\":\"normal\",\"enable_new_planner_push_down_join_to_agg\":false,\"broadcast_row_limit\":15000000,\"exec_mem_limit\":21474836480,\"disable_join_reorder\":false,\"enable_profile\":true,\"enable_groupby_use_output_alias\":false,\"enable_vectorized_insert\":true,\"net_buffer_length\":16384,\"transmission_compression_type\":\"LZ4\",\"interactive_timeout\":3600,\"enable_spilling\":false,\"batch_size\":1024,\"max_allowed_packet\":1048576,\"query_timeout\":180,\"test_materialized_view\":false,\"enable_cbo\":true,\"collation_server\":\"utf8_general_ci\",\"new_planner_max_transform_reorder_joins\":3,\"time_zone\":\"CST\",\"max_execution_time\":3000000,\"character_set_server\":\"utf8\",\"rewrite_count_distinct_to_bitmap_hll\":true,\"parallel_exchange_instance_num\":-1,\"sql_mode\":34,\"SQL_AUTO_IS_NULL\":false,\"event_scheduler\":\"OFF\",\"disable_streaming_preaggregations\":false}",
  "column_statistics":{
    "tpcds.catalog_sales":{
      "cs_sold_date_sk":"[-Infinity, Infinity, 0.0, 1.0, 1.0]",
      "cs_ext_sales_price":"[-Infinity, Infinity, 0.0, 1.0, 1.0]"
    },
    "tpcds.web_sales":{
      "ws_ext_sales_price":"[-Infinity, Infinity, 0.0, 1.0, 1.0]",
      "ws_sold_date_sk":"[-Infinity, Infinity, 0.0, 1.0, 1.0]"
    },
    "tpcds.date_dim":{
      "d_day_name":"[-Infinity, Infinity, 0.0, 1.0, 1.0]",
      "d_date_sk":"[-Infinity, Infinity, 0.0, 1.0, 1.0]",
      "d_week_seq":"[-Infinity, Infinity, 0.0, 1.0, 1.0]",
      "d_year":"[-Infinity, Infinity, 0.0, 1.0, 1.0]"
    }
  },
  "be_number":3,
  "exception":[

  ]
}