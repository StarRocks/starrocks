{
  "statement": "SELECT '2023-03-26' D_DATE,\n\t\t c_user,\n\t\t concat(C_NODEVALUE, '-', C_BROKERNAME) AS C_NAME,\n\t\t c_dept,\n\t\t c_par,\n\t\t '人',\n\t\t '1',\n\t\t '规',\n\t\t '1',\n\t\t 'KPI1' C_KPICODE,\n\t\t\tround(sum(if(c_par='01', F_ASSET_zb, F_ASSET))/100000000, 5) F_CURRENTDAta\nFROM t1\nWHERE c_par IN (\n\t'02',\n\t'01'\n)\nAND D_DATE='2023-03-26'\nGROUP BY C_BROKERNAME,\nc_dept,\nc_par,\nc_user,\nC_NODEVALUE\nunion all\nSELECT '2023-03-26' D_DATE,\n\t\t c_mr AS C_CODE,\n\t\t CASE\n\t\t\t\t WHEN c_mr = '01' THEN '部'\n\t\t\t\t ELSE '户部'\n\t\t END C_NAME,\n\t\t c_mr c_dept,\n\t\t c_mr c_par,\n\t\t '门' AS C_ROLE,\n\t\t '3' AS F_ROLERANK,\n\t\t '入' AS C_KPITYPE,\n\t\t '2' AS F_KPIRANK,\n\t\t 'KPI2' C_KPICODE,\n\t\t\tifnull(ROUND(SUM(fee_zb)/100000000, 5), 0) AS F_CURRENTDAta\nFROM t2\nWHERE c_mr IN ('02',\n\t\t\t\t\t\t\t'03')\nAND D_DATE>concat(year(str_to_date('2023-03-26', '%Y-%m-%d'))-1, '1231')\nAND d_date<='2023-03-26'\nGROUP BY c_mr;",
  "table_meta": {
    "sdx.t1": "CREATE TABLE `t1` (\n  `d_date` date ,\n  `c_user` varchar(50) ,\n  `c_dept` varchar(50) ,\n  `c_par` varchar(50) ,\n  `vst` varchar(3) ,\n  `vc_busness_sec_type` varchar(5) ,\n  `c_nodevalue` varchar(50) ,\n  `c_brokername` varchar(50) ,\n  `is_neworold` varchar(3) ,\n  `f_asset` decimal128(20, 5) ,\n  `f_asset_zb` decimal128(20, 5) ,\n  `f_managerfee` decimal128(20, 5) ,\n  `fee_zb` decimal128(20, 5) ,\n  `f_icapital` decimal128(20, 5) ,\n  `f_ocapital` decimal128(20, 5) ,\n  `net_cap` decimal128(20, 5) ,\n  `vc_custno_c` int(11) ,\n  `c_fundacco_c` int(11) ,\n  `c_new` int(11) ,\n  `cpc` int(11) \n) ENGINE=OLAP \nDUPLICATE KEY(`d_date`, `c_user`, `c_dept`, `c_par`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`d_date`, `c_user`, `c_dept`, `c_par`) BUCKETS 16 \nPROPERTIES (\n\"replication_num\" = \"1\",\n\"in_memory\" = \"false\",\n\"storage_format\" = \"DEFAULT\",\n\"enable_persistent_index\" = \"false\",\n\"compression\" = \"LZ4\"\n);",
    "sdx.t2": "CREATE TABLE `t2` (\n  `d_date` date ,\n  `c_mr` varchar(40) ,\n  `vst` varchar(3) ,\n  `vc_busness_sec_type` varchar(5) ,\n  `f_asset` decimal128(20, 5) ,\n  `f_asset_zb` decimal128(20, 5) ,\n  `f_managerfee` decimal128(20, 5) ,\n  `fee_zb` decimal128(20, 5) ,\n  `f_icapital` decimal128(20, 5) ,\n  `f_ocapital` decimal128(20, 5) ,\n  `net_cap` decimal128(20, 5) ,\n  `vc_custno_c` int(11) ,\n  `c_fundacco_c` int(11) ,\n  `c_new` int(11) ,\n  `cpc` int(11)\n) ENGINE=OLAP \nDUPLICATE KEY(`d_date`, `c_mr`)\nCOMMENT \"OLAP\"\nDISTRIBUTED BY HASH(`d_date`, `c_mr`) BUCKETS 16 \nPROPERTIES (\n\"replication_num\" = \"1\",\n\"in_memory\" = \"false\",\n\"storage_format\" = \"DEFAULT\",\n\"enable_persistent_index\" = \"false\",\n\"compression\" = \"LZ4\"\n);"
  },
  "table_row_count": {
    "sdx.t2": {
      "t2": 19920
    },
    "sdx.t1": {
      "t1": 614877
    }
  },
  "session_variables": "{\"enable_show_all_variables\":false,\"cbo_cte_reuse\":true,\"full_sort_max_buffered_bytes\":16777216,\"character_set_connection\":\"utf8\",\"cbo_use_correlated_join_estimate\":true,\"enable_insert_strict\":true,\"tx_isolation\":\"REPEATABLE-READ\",\"wait_timeout\":28800,\"cbo_cte_reuse_rate\":1.2,\"enable_query_tablet_affinity\":false,\"transmission_encode_level\":7,\"character_set_results\":\"utf8\",\"transaction_isolation\":\"REPEATABLE-READ\",\"enable_global_runtime_filter\":true,\"load_transmission_compression_type\":\"NO_COMPRESSION\",\"cbo_enable_low_cardinality_optimize\":true,\"enable_resource_group_v2\":true,\"new_planner_optimize_timeout\":3000,\"enable_realtime_mv\":false,\"enable_adaptive_sink_dop\":false,\"force_schedule_local\":false,\"hudi_mor_force_jni_reader\":false,\"full_sort_late_materialization\":false,\"enable_profile\":false,\"cbo_enable_greedy_join_reorder\":true,\"load_mem_limit\":0,\"sql_safe_updates\":0,\"runtime_filter_early_return_selectivity\":0.05,\"enable_local_shuffle_agg\":true,\"rpc_http_min_size\":2147482624,\"cbo_debug_alive_backend_number\":0,\"global_runtime_filter_probe_min_size\":102400,\"nested_mv_rewrite_max_level\":3,\"query_delivery_timeout\":300,\"net_write_timeout\":60,\"cbo_prune_shuffle_column_rate\":0.1,\"collation_database\":\"utf8_general_ci\",\"hash_join_push_down_right_table\":true,\"new_planner_agg_stage\":0,\"use_compute_nodes\":-1,\"collation_connection\":\"utf8_general_ci\",\"resource_group\":\"\",\"broadcast_row_limit\":15000000,\"enable_populate_block_cache\":true,\"profile_limit_fold\":true,\"exec_mem_limit\":2147483648,\"enable_sort_aggregate\":false,\"cbo_max_reorder_node_use_dp\":10,\"query_cache_force_populate\":false,\"runtime_filter_on_exchange_node\":false,\"disable_join_reorder\":false,\"enable_rule_based_materialized_view_rewrite\":true,\"enable_hive_column_stats\":true,\"enable_groupby_use_output_alias\":false,\"net_buffer_length\":16384,\"forward_to_leader\":false,\"count_distinct_column_buckets\":1024,\"full_sort_max_buffered_rows\":1024000,\"query_cache_agg_cardinality_limit\":5000000,\"query_timeout\":3600,\"enable_pipeline_query_statistic\":true,\"cbo_max_reorder_node\":50,\"cboPushDownAggregateMode_v1\":-1,\"window_partition_mode\":1,\"enable_deliver_batch_fragments\":true,\"enable_tablet_internal_parallel_v2\":false,\"enable_distinct_column_bucketization\":false,\"interpolate_passthrough\":true,\"runtime_filter_scan_wait_time\":20,\"SQL_AUTO_IS_NULL\":false,\"event_scheduler\":\"OFF\",\"prefer_compute_node\":false,\"enable_strict_type\":false,\"broadcast_right_table_scale_factor\":10,\"group_concat_max_len\":65535,\"disable_streaming_preaggregations\":false,\"parse_tokens_limit\":3500000,\"chunk_size\":4096,\"runtime_join_filter_push_down_limit\":1024000,\"global_runtime_filter_probe_min_selectivity\":0.5,\"query_mem_limit\":0,\"enable_filter_unused_columns_in_scan_stage\":true,\"enable_scan_block_cache\":false,\"enable_materialized_view_single_table_view_delta_rewrite\":false,\"div_precision_increment\":4,\"auto_increment_increment\":1,\"sql_mode_v2\":32,\"character_set_client\":\"utf8\",\"autocommit\":true,\"hdfs_backend_selector_scan_range_shuffle\":false,\"enable_column_expr_predicate\":true,\"pipeline_profile_level\":1,\"parallel_fragment_exec_instance_num\":48,\"max_scan_key_num\":-1,\"cbo_cte_max_limit\":10,\"net_read_timeout\":60,\"streaming_preaggregation_mode\":\"auto\",\"storage_engine\":\"olap\",\"hive_partition_stats_sample_size\":5000,\"enable_optimizer_trace_log\":false,\"enable_mv_planner\":false,\"cbo_enable_dp_join_reorder\":true,\"tx_visible_wait_timeout\":10,\"enable_materialized_view_view_delta_rewrite\":true,\"cbo_max_reorder_node_use_exhaustive\":4,\"enable_sql_digest\":false,\"profile_timeout\":2,\"cbo_push_down_aggregate\":\"global\",\"pipeline_dop\":4,\"enable_query_dump\":false,\"single_node_exec_plan\":false,\"join_implementation_mode_v2\":\"auto\",\"global_runtime_filter_build_max_size\":67108864,\"sql_select_limit\":9223372036854775807,\"enable_materialized_view_rewrite\":true,\"statistic_collect_parallel\":1,\"query_cache_hot_partition_num\":3,\"enable_prune_complex_types\":true,\"query_cache_type\":0,\"disable_colocate_join\":false,\"max_parallel_scan_instance_num\":-1,\"query_cache_entry_max_rows\":409600,\"max_pushdown_conditions_per_column\":-1,\"enable_materialized_view_union_rewrite\":true,\"sql_quote_show_create\":true,\"enable_exchange_pass_through\":true,\"query_cache_entry_max_bytes\":4194304,\"innodb_read_only\":true,\"enable_exchange_perf\":false,\"enable_predicate_reorder\":false,\"workgroup_id\":0,\"enable_query_cache\":false,\"enable_rewrite_groupingsets_to_union_all\":false,\"transmission_compression_type\":\"LZ4\",\"interactive_timeout\":3600,\"max_allowed_packet\":1048576,\"collation_server\":\"utf8_general_ci\",\"time_zone\":\"Asia/Shanghai\",\"enable_multicolumn_global_runtime_filter\":false,\"character_set_server\":\"utf8\",\"tablet_internal_parallel_mode\":\"auto\",\"enable_pipeline\":true,\"cbo_use_nth_exec_plan\":0,\"parallel_exchange_instance_num\":-1,\"enable_shared_scan\":true,\"enable_query_debug_trace\":false,\"allow_default_partition\":false}",
  "column_statistics": {
    "sdx.t2": {
      "d_date": "[1.546272E9, 1.6848576E9, 0.0, 4.0, 1618.0] ESTIMATE",
      "f_managerfee": "[-4643511.28262, 4.259007983193E7, 0.0, 16.0, 18952.0] ESTIMATE",
      "c_mr": "[-Infinity, Infinity, 0.08057228915662651, 13.826104417670683, 6.0] ESTIMATE"
    },
    "sdx.t1": {
      "cpc": "[-Infinity, Infinity, 0.002810318161193214, 15.820295766470368, 5.0] ESTIMATE",
      "c_nodevalue": "[-Infinity, Infinity, 0.002810318161193214, 3.1243809737557267, 12.0] ESTIMATE",
      "f_asset": "[0.0, 1.0754762936295361E11, 0.0, 16.0, 296985.0] ESTIMATE",
      "c_user": "[-Infinity, Infinity, 0.002810318161193214, 7.2697238634718815, 41.0] ESTIMATE",
      "d_date": "[1.546272E9, 1.6848576E9, 0.0, 4.0, 1618.0] ESTIMATE",
      "c_brokername": "[-Infinity, Infinity, 0.002810318161193214, 2.60808421846971, 41.0] ESTIMATE",
      "f_asset_zb": "[0.0, 8.215384940714224E10, 0.0, 16.0, 319302.0] ESTIMATE",
      "c_dept": "[-Infinity, Infinity, 0.002810318161193214, 19.68247307998185, 13.0] ESTIMATE"
    }
  },
  "be_number": 3,
  "be_core_stat": {
    "numOfHardwareCoresPerBe": "{\"10003\":96,\"10004\":96,\"10005\":96}",
    "cachedAvgNumOfHardwareCores": -1
  },
  "exception": [],
  "version": "2.5.6",
  "commit_version": "a193ae0"
}