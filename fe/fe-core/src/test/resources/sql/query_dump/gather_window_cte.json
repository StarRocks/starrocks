{
  "statement": "WITH with_t_0 as (\n  SELECT c_1_0 FROM v0\n)\nSELECT\n  subt0.c_0_0,\n  ROW_NUMBER() OVER (PARTITION BY subt0.c_0_0, subt0.c_0_1),\n  LAST_VALUE(subt0.c_0_2) OVER (ORDER BY subt0.c_0_0)\nFROM t0 subt0, with_t_0\nUNION ALL\nSELECT\n  subt0.c_0_0,\n  ROW_NUMBER() OVER (PARTITION BY subt0.c_0_0, subt0.c_0_1),\n  LAST_VALUE(subt0.c_0_2) OVER (ORDER BY subt0.c_0_0)\nFROM t0 subt0, with_t_0\n",
  "table_meta": {
    "w2.t0": "CREATE TABLE `t0` (\n  `c_0_0` date NOT NULL COMMENT \"\",\n  `c_0_1` double NOT NULL COMMENT \"\",\n  `c_0_2` decimal128(27, 19) NULL COMMENT \"\",\n  `c_0_3` ARRAY\u003cvarchar(65533)\u003e NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nDUPLICATE KEY(`c_0_0`)\nCOMMENT \"OLAP\"\nPARTITION BY RANGE(`c_0_0`)\n(PARTITION p20100101 VALUES [(\u00272010-01-01\u0027), (\u00272010-06-25\u0027)),\nPARTITION p20100625 VALUES [(\u00272010-06-25\u0027), (\u00272010-12-17\u0027)),\nPARTITION p20101217 VALUES [(\u00272010-12-17\u0027), (\u00272011-06-10\u0027)),\nPARTITION p20110610 VALUES [(\u00272011-06-10\u0027), (\u00272011-12-02\u0027)),\nPARTITION p20111202 VALUES [(\u00272011-12-02\u0027), (\u00272012-05-25\u0027)),\nPARTITION p20120525 VALUES [(\u00272012-05-25\u0027), (\u00272012-11-16\u0027)),\nPARTITION p20121116 VALUES [(\u00272012-11-16\u0027), (\u00272013-05-10\u0027)),\nPARTITION p20130510 VALUES [(\u00272013-05-10\u0027), (\u00272013-11-01\u0027)),\nPARTITION p20131101 VALUES [(\u00272013-11-01\u0027), (\u00272014-04-25\u0027)),\nPARTITION p20140425 VALUES [(\u00272014-04-25\u0027), (\u00272014-10-17\u0027)),\nPARTITION p20141017 VALUES [(\u00272014-10-17\u0027), (\u00272015-04-10\u0027)),\nPARTITION p20150410 VALUES [(\u00272015-04-10\u0027), (\u00272015-10-02\u0027)),\nPARTITION p20151002 VALUES [(\u00272015-10-02\u0027), (\u00272016-03-25\u0027)),\nPARTITION p20160325 VALUES [(\u00272016-03-25\u0027), (\u00272016-09-16\u0027)),\nPARTITION p20160916 VALUES [(\u00272016-09-16\u0027), (\u00272017-03-10\u0027)),\nPARTITION p20170310 VALUES [(\u00272017-03-10\u0027), (\u00272017-09-01\u0027)),\nPARTITION p20170901 VALUES [(\u00272017-09-01\u0027), (\u00272018-02-23\u0027)),\nPARTITION p20180223 VALUES [(\u00272018-02-23\u0027), (\u00272018-08-17\u0027)),\nPARTITION p20180817 VALUES [(\u00272018-08-17\u0027), (\u00272019-02-08\u0027)),\nPARTITION p20190208 VALUES [(\u00272019-02-08\u0027), (\u00272019-08-02\u0027)),\nPARTITION p20190802 VALUES [(\u00272019-08-02\u0027), (\u00272020-01-24\u0027)),\nPARTITION p20200124 VALUES [(\u00272020-01-24\u0027), (\u00272020-07-17\u0027)),\nPARTITION p20200717 VALUES [(\u00272020-07-17\u0027), (\u00272021-01-08\u0027)),\nPARTITION p20210108 VALUES [(\u00272021-01-08\u0027), (\u00272021-07-02\u0027)),\nPARTITION p20210702 VALUES [(\u00272021-07-02\u0027), (\u00272021-12-24\u0027)),\nPARTITION p20211224 VALUES [(\u00272021-12-24\u0027), (\u00272022-06-17\u0027)),\nPARTITION p20220617 VALUES [(\u00272022-06-17\u0027), (\u00272022-12-09\u0027)),\nPARTITION p20221209 VALUES [(\u00272022-12-09\u0027), (\u00272023-06-02\u0027)))\nDISTRIBUTED BY HASH(`c_0_0`) BUCKETS 3 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\",\n\"enable_persistent_index\" \u003d \"true\",\n\"compression\" \u003d \"LZ4\"\n);",
    "w2.t1": "CREATE TABLE `t1` (\n  `c_1_0` date NULL COMMENT \"\"\n) ENGINE\u003dOLAP \nUNIQUE KEY(`c_1_0`)\nCOMMENT \"OLAP\"\nPARTITION BY RANGE(`c_1_0`)\n(PARTITION p20100101 VALUES [(\u00272010-01-01\u0027), (\u00272010-05-12\u0027)),\nPARTITION p20100512 VALUES [(\u00272010-05-12\u0027), (\u00272010-09-20\u0027)),\nPARTITION p20100920 VALUES [(\u00272010-09-20\u0027), (\u00272011-01-29\u0027)),\nPARTITION p20110129 VALUES [(\u00272011-01-29\u0027), (\u00272011-06-09\u0027)),\nPARTITION p20110609 VALUES [(\u00272011-06-09\u0027), (\u00272011-10-18\u0027)),\nPARTITION p20111018 VALUES [(\u00272011-10-18\u0027), (\u00272012-02-26\u0027)),\nPARTITION p20120226 VALUES [(\u00272012-02-26\u0027), (\u00272012-07-06\u0027)),\nPARTITION p20120706 VALUES [(\u00272012-07-06\u0027), (\u00272012-11-14\u0027)),\nPARTITION p20121114 VALUES [(\u00272012-11-14\u0027), (\u00272013-03-25\u0027)),\nPARTITION p20130325 VALUES [(\u00272013-03-25\u0027), (\u00272013-08-03\u0027)),\nPARTITION p20130803 VALUES [(\u00272013-08-03\u0027), (\u00272013-12-12\u0027)),\nPARTITION p20131212 VALUES [(\u00272013-12-12\u0027), (\u00272014-04-22\u0027)),\nPARTITION p20140422 VALUES [(\u00272014-04-22\u0027), (\u00272014-08-31\u0027)),\nPARTITION p20140831 VALUES [(\u00272014-08-31\u0027), (\u00272015-01-09\u0027)),\nPARTITION p20150109 VALUES [(\u00272015-01-09\u0027), (\u00272015-05-20\u0027)),\nPARTITION p20150520 VALUES [(\u00272015-05-20\u0027), (\u00272015-09-28\u0027)),\nPARTITION p20150928 VALUES [(\u00272015-09-28\u0027), (\u00272016-02-06\u0027)),\nPARTITION p20160206 VALUES [(\u00272016-02-06\u0027), (\u00272016-06-16\u0027)),\nPARTITION p20160616 VALUES [(\u00272016-06-16\u0027), (\u00272016-10-25\u0027)),\nPARTITION p20161025 VALUES [(\u00272016-10-25\u0027), (\u00272017-03-05\u0027)),\nPARTITION p20170305 VALUES [(\u00272017-03-05\u0027), (\u00272017-07-14\u0027)),\nPARTITION p20170714 VALUES [(\u00272017-07-14\u0027), (\u00272017-11-22\u0027)),\nPARTITION p20171122 VALUES [(\u00272017-11-22\u0027), (\u00272018-04-02\u0027)),\nPARTITION p20180402 VALUES [(\u00272018-04-02\u0027), (\u00272018-08-11\u0027)),\nPARTITION p20180811 VALUES [(\u00272018-08-11\u0027), (\u00272018-12-20\u0027)),\nPARTITION p20181220 VALUES [(\u00272018-12-20\u0027), (\u00272019-04-30\u0027)),\nPARTITION p20190430 VALUES [(\u00272019-04-30\u0027), (\u00272019-09-08\u0027)),\nPARTITION p20190908 VALUES [(\u00272019-09-08\u0027), (\u00272020-01-17\u0027)),\nPARTITION p20200117 VALUES [(\u00272020-01-17\u0027), (\u00272020-05-27\u0027)),\nPARTITION p20200527 VALUES [(\u00272020-05-27\u0027), (\u00272020-10-05\u0027)),\nPARTITION p20201005 VALUES [(\u00272020-10-05\u0027), (\u00272021-02-13\u0027)),\nPARTITION p20210213 VALUES [(\u00272021-02-13\u0027), (\u00272021-06-24\u0027)),\nPARTITION p20210624 VALUES [(\u00272021-06-24\u0027), (\u00272021-11-02\u0027)),\nPARTITION p20211102 VALUES [(\u00272021-11-02\u0027), (\u00272022-03-13\u0027)),\nPARTITION p20220313 VALUES [(\u00272022-03-13\u0027), (\u00272022-07-22\u0027)),\nPARTITION p20220722 VALUES [(\u00272022-07-22\u0027), (\u00272022-11-30\u0027)),\nPARTITION p20221130 VALUES [(\u00272022-11-30\u0027), (\u00272023-04-10\u0027)))\nDISTRIBUTED BY HASH(`c_1_0`) BUCKETS 3 \nPROPERTIES (\n\"replication_num\" \u003d \"1\",\n\"in_memory\" \u003d \"false\",\n\"storage_format\" \u003d \"DEFAULT\",\n\"enable_persistent_index\" \u003d \"true\",\n\"compression\" \u003d \"LZ4\"\n);"
  },
  "table_row_count": {
    "w2.t0": {
      "p20100101": 13
    }
  },
  "view_meta": {
    "w2.v0": "SELECT DISTINCT `t1_24`.`c_1_0`\nFROM `w2`.`t1` AS `t1_24`\nWHERE NOT FALSE"
  },
  "session_variables": "{\"enable_show_all_variables\":true,\"cbo_cte_reuse\":true,\"character_set_connection\":\"utf8\",\"cbo_use_correlated_join_estimate\":true,\"enable_insert_strict\":true,\"tx_isolation\":\"REPEATABLE-READ\",\"wait_timeout\":28800,\"cbo_cte_reuse_rate_v2\":1.15,\"transmission_encode_level\":7,\"character_set_results\":\"utf8\",\"transaction_isolation\":\"REPEATABLE-READ\",\"enable_global_runtime_filter\":true,\"load_transmission_compression_type\":\"NO_COMPRESSION\",\"cbo_enable_low_cardinality_optimize\":true,\"enable_resource_group_v2\":true,\"new_planner_optimize_timeout\":100000000,\"enable_realtime_mv\":false,\"force_schedule_local\":false,\"enable_profile\":false,\"cbo_enable_greedy_join_reorder\":true,\"load_mem_limit\":0,\"sql_safe_updates\":0,\"enable_local_shuffle_agg\":true,\"cbo_debug_alive_backend_number\":0,\"global_runtime_filter_probe_min_size\":102400,\"nested_mv_rewrite_max_level\":3,\"query_delivery_timeout\":300,\"net_write_timeout\":60,\"cbo_prune_shuffle_column_rate\":0.1,\"collation_database\":\"utf8_general_ci\",\"hash_join_push_down_right_table\":true,\"new_planner_agg_stage\":0,\"use_compute_nodes\":-1,\"collation_connection\":\"utf8_general_ci\",\"pipeline_sink_dop\":0,\"resource_group\":\"\",\"broadcast_row_limit\":15000000,\"enable_populate_block_cache\":true,\"profile_limit_fold\":true,\"exec_mem_limit\":2147483648,\"enable_sort_aggregate\":false,\"cbo_max_reorder_node_use_dp\":10,\"query_cache_force_populate\":false,\"runtime_filter_on_exchange_node\":false,\"disable_join_reorder\":false,\"enable_rule_based_materialized_view_rewrite\":true,\"enable_hive_column_stats\":true,\"enable_groupby_use_output_alias\":false,\"net_buffer_length\":16384,\"forward_to_leader\":false,\"query_timeout\":300,\"enable_pipeline_query_statistic\":true,\"cbo_max_reorder_node\":50,\"cboPushDownAggregateMode_v1\":-1,\"enable_deliver_batch_fragments\":true,\"enable_tablet_internal_parallel_v2\":true,\"enable_big_query_log\":true,\"interpolate_passthrough\":true,\"runtime_filter_scan_wait_time\":20,\"SQL_AUTO_IS_NULL\":false,\"event_scheduler\":\"OFF\",\"prefer_compute_node\":false,\"broadcast_right_table_scale_factor\":10,\"disable_streaming_preaggregations\":false,\"parse_tokens_limit\":3500000,\"chunk_size\":4096,\"runtime_join_filter_push_down_limit\":1024000,\"global_runtime_filter_probe_min_selectivity\":0.5,\"query_mem_limit\":0,\"enable_filter_unused_columns_in_scan_stage\":false,\"big_query_log_cpu_second_threshold\":480,\"enable_scan_block_cache\":false,\"div_precision_increment\":4,\"auto_increment_increment\":1,\"sql_mode_v2\":32,\"big_query_log_scan_rows_threshold\":1000000000,\"character_set_client\":\"utf8\",\"autocommit\":true,\"enable_column_expr_predicate\":false,\"pipeline_profile_level\":1,\"parallel_fragment_exec_instance_num\":1,\"max_scan_key_num\":-1,\"cbo_cte_max_limit\":10,\"net_read_timeout\":60,\"streaming_preaggregation_mode\":\"auto\",\"storage_engine\":\"olap\",\"hive_partition_stats_sample_size\":3000,\"enable_optimizer_trace_log\":false,\"enable_mv_planner\":false,\"cbo_enable_dp_join_reorder\":true,\"tx_visible_wait_timeout\":10,\"cbo_max_reorder_node_use_exhaustive\":4,\"enable_sql_digest\":false,\"profile_timeout\":2,\"pipeline_dop\":1,\"enable_query_dump\":false,\"single_node_exec_plan\":false,\"join_implementation_mode_v2\":\"auto\",\"global_runtime_filter_build_max_size\":67108864,\"sql_select_limit\":9223372036854775807,\"enable_materialized_view_rewrite\":true,\"statistic_collect_parallel\":1,\"query_cache_type\":0,\"disable_colocate_join\":false,\"query_cache_entry_max_rows\":409600,\"max_pushdown_conditions_per_column\":-1,\"enable_materialized_view_union_rewrite\":true,\"enable_exchange_pass_through\":true,\"query_cache_entry_max_bytes\":4194304,\"enable_cost_based_materialized_view_rewrite\":true,\"innodb_read_only\":true,\"enable_exchange_perf\":false,\"enable_predicate_reorder\":false,\"workgroup_id\":0,\"enable_query_cache\":false,\"enable_rewrite_groupingsets_to_union_all\":false,\"transmission_compression_type\":\"LZ4\",\"interactive_timeout\":3600,\"max_allowed_packet\":1048576,\"big_query_log_scan_bytes_threshold\":10737418240,\"collation_server\":\"utf8_general_ci\",\"time_zone\":\"Asia/Shanghai\",\"enable_multicolumn_global_runtime_filter\":false,\"character_set_server\":\"utf8\",\"tablet_internal_parallel_mode\":\"auto\",\"enable_pipeline\":true,\"cbo_use_nth_exec_plan\":0,\"parallel_exchange_instance_num\":-1,\"enable_shared_scan\":false,\"enable_query_debug_trace\":false,\"allow_default_partition\":false}",
  "column_statistics": {
    "w2.t1": {
      "c_1_0": "[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN"
    },
    "w2.t0": {
      "c_0_2": "[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "c_0_1": "[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN",
      "c_0_0": "[-Infinity, Infinity, 0.0, 1.0, 1.0] UNKNOWN"
    }
  },
  "be_number": 1,
  "be_core_stat": {
    "numOfHardwareCoresPerBe": "{\"3609624\":104}",
    "cachedAvgNumOfHardwareCores": -1
  },
  "exception": [],
  "version": "UNKNOWN",
  "commit_version": ""
}