---
displayed_sidebar: docs
---

# array_top_n

对给定数组的元素按自然降序排序，并返回数组中的前n个元素。如果n大于输入数组的长度，则返回数组的长度将与输入相同，而不是n。

## 语法

```sql
array_top_n(array, count)
```

## 参数

- `array`：要从中提取前n个元素的数组。该数组可以包含StarRocks支持的任何可比较数据类型的元素。

- `count`：要返回的前n个元素的数量。必须是非负整数。

## 返回值

返回一个包含输入数组中前n个元素的数组，按降序排序。返回值的数据类型与输入数组相同，都是ARRAY类型。

## 使用说明

- 元素根据其自然顺序按降序排序。
- 如果`count`为0或负数，则返回空数组。
- 如果`count`大于数组大小，则返回整个数组，按降序排序。
- 如果输入的`array`或`count`为NULL，则结果为NULL。
- 数组中的NULL元素被视为比任何非NULL值小，如果包含在结果中，将出现在末尾。

## 示例

示例1：从整数数组中获取前3个元素。

```sql
mysql> SELECT array_top_n([1, 100, 2, 5, 3], 3);
+-----------------------------------+
| array_top_n([1,100,2,5,3], 3)    |
+-----------------------------------+
| [100,5,3]                         |
+-----------------------------------+
```

示例2：从包含两个整数的数组中获取前5个元素（`count`大于数组长度）。

```sql
mysql> SELECT array_top_n([1, 100], 5);
+--------------------------+
| array_top_n([1,100], 5)  |
+--------------------------+
| [100,1]                  |
+--------------------------+
```

示例3：从字符串数组中获取前3个元素。

```sql
mysql> SELECT array_top_n(['a', 'zzz', 'zz', 'b', 'g', 'f'], 3);
+----------------------------------------------------+
| array_top_n(['a','zzz','zz','b','g','f'], 3)      |
+----------------------------------------------------+
| ['zzz','zz','g']                                   |
+----------------------------------------------------+
```

示例4：当`count`为0时调用函数。

```sql
mysql> SELECT array_top_n([1, 2, 3], 0);
+--------------------------+
| array_top_n([1,2,3], 0)  |
+--------------------------+
| []                       |
+--------------------------+
```

示例5：从包含NULL元素的整数数组中获取前3个元素。

```sql
mysql> SELECT array_top_n([1, NULL, 3, 2], 3);
+---------------------------------+
| array_top_n([1,null,3,2], 3)   |
+---------------------------------+
| [3,2,1]                         |
+---------------------------------+
```

示例6：使用表数据调用函数。

```sql
mysql> CREATE TABLE IF NOT EXISTS test (id INT, arr ARRAY<INT>) PROPERTIES ("replication_num"="1");
mysql> INSERT INTO test VALUES (1, [5, 2, 8, 1, 9]), (2, [10, 3, 7]);
mysql> SELECT id, array_top_n(arr, 2) FROM test;
+------+----------------------+
| id   | array_top_n(arr, 2)  |
+------+----------------------+
|    1 | [9,8]                |
|    2 | [10,7]               |
+------+----------------------+
```