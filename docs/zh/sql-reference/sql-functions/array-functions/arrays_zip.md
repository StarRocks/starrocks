---
displayed_sidebar: docs
---

# arrays_zip

将给定的数组按元素位置合并成单个行数组。第 N 个参数的 M 元素将成为 M-th 输出元素的 N-th 字段。如果参数具有不均匀的长度，缺失的值将用 NULL 填充。

## 语法

```sql
arrays_zip(array1, array2[, ...])
```

## 参数

- `array1`, `array2`, ...: 要合并的多个数组。每个数组可以包含 StarRocks 支持的任意类型的元素。

## 返回值

返回一个包含元素的数组，每个元素是一个行（结构体），包含来自所有输入数组的对应元素。如果输入数组长度不同，较短的数组将用 NULL 值填充。

## 使用说明

- 如果输入数组长度不同，结果数组长度是输入数组中的最大长度。
- 较短的数组中的缺失值用 NULL 填充。
- 如果任何输入数组为 NULL，则结果为 NULL。
- 如果所有输入数组都为空，则结果是一个空数组。

## 示例

示例 1：等长数组的基本 zip 操作

```sql
mysql> SELECT arrays_zip([1, 2], ['a', 'b']) AS result;
+---------------------------------------------------+
| result                                            |
+---------------------------------------------------+
| [{"col1":1,"col2":"a"},{"col1":2,"col2":"b"}] |
+---------------------------------------------------+
```

示例 2：不同长度数组的 zip

```sql
mysql> SELECT arrays_zip([1, 2], ['a', null, 'c']) AS result;
+----------------------------------------------------------+
| result                                                   |
+----------------------------------------------------------+
| [{"col1":1,"col2":"a"},{"col1":2,"col2":null},{"col1":null,"col2":"c"}] |
+----------------------------------------------------------+
```

示例 3：三个数组的 zip

```sql
mysql> SELECT arrays_zip([1, 2, 3], ['a', 'b', 'c'], [10, 20, 30]) AS result;
+------------------------------------------------------------------------------------------+
| result                                                                                   |
+------------------------------------------------------------------------------------------+
| [{"col1":1,"col2":"a","col3":10},{"col1":2,"col2":"b","col3":20},{"col1":3,"col2":"c","col3":30}] |
+------------------------------------------------------------------------------------------+
```

示例 4：空数组的 zip

```sql
mysql> SELECT arrays_zip([], []) AS result;
+--------+
| result |
+--------+
| []     |
+--------+
```

示例 5：单个数组

```sql
mysql> SELECT arrays_zip([1, 2, 3]) AS result;
+----------------------------------+
| result                           |
+----------------------------------+
| [{"col1":1},{"col1":2},{"col1":3}] |
+----------------------------------+
```

示例 6：NULL 值处理

```sql
mysql> SELECT arrays_zip(null, [1, 2]) AS result;
+--------+
| result |
+--------+
| NULL   |
+--------+
```

示例 7：包含 NULL 值的混合类型

```sql
mysql> SELECT arrays_zip([1, null, 3], ['a', 'b', null]) AS result;
+----------------------------------------------------------+
| result                                                   |
+----------------------------------------------------------+
| [{"col1":1,"col2":"a"},{"col1":null,"col2":"b"},{"col1":3,"col2":null}] |
+----------------------------------------------------------+
```

示例 8：与表数据一起使用

```sql
mysql> CREATE TABLE IF NOT EXISTS test (id INT, arr1 ARRAY<INT>, arr2 ARRAY<VARCHAR>) PROPERTIES ("replication_num"="1");
mysql> INSERT INTO test VALUES (1, [1, 2], ['a', 'b']), (2, [3, 4, 5], ['x', 'y']);
mysql> SELECT id, arrays_zip(arr1, arr2) AS result FROM test;
+------+-------------------------------------------------------+
| id   | result                                                |
+------+-------------------------------------------------------+
|    1 | [{"col1":1,"col2":"a"},{"col1":2,"col2":"b"}]        |
|    2 | [{"col1":3,"col2":"x"},{"col1":4,"col2":"y"},{"col1":5,"col2":null}] |
+------+-------------------------------------------------------+
```