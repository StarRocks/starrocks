---
displayed_sidebar: docs
---

# time_slice

指定された時間の粒度に基づいて、指定された時間を時間間隔の始まりまたは終わりに変換します。

この関数は v2.3 からサポートされています。

v2.5 では、指定された時間を時間間隔の終わりに変換することがサポートされています。

## Syntax

```Haskell
DATETIME time_slice(DATETIME dt, INTERVAL N type[, boundary])
```

## Parameters

- `dt`: 変換する時間、DATETIME 型。
- `INTERVAL N type`: 時間の粒度。例えば、`interval 5 second`。
  - `N` は時間間隔の長さで、INT 値でなければなりません。
  - `type` は単位で、YEAR、QUARTER、MONTH、WEEK、DAY、HOUR、MINUTE、SECOND、MILLISECOND (3.1.7 以降)、MICROSECOND (3.1.7 以降) のいずれかです。
- `boundary`: オプションです。時間間隔の始まり (`FLOOR`) または終わり (`CEIL`) を返すかどうかを指定するために使用します。有効な値は FLOOR、CEIL です。このパラメータが指定されていない場合、デフォルトは `FLOOR` です。このパラメータは v2.5 からサポートされています。

## Return value

DATETIME 型の値を返します。

## Usage notes

時間間隔は西暦 `0001-01-01 00:00:00` から始まります。

## Examples

以下の例は `test_all_type_select` テーブルに基づいて提供されています。

```Plaintext
select * from test_all_type_select order by id_int;
+------------+---------------------+--------+
| id_date    | id_datetime         | id_int |
+------------+---------------------+--------+
| 2052-12-26 | 1691-12-23 04:01:09 |      0 |
| 2168-08-05 | 2169-12-18 15:44:31 |      1 |
| 1737-02-06 | 1840-11-23 13:09:50 |      2 |
| 2245-10-01 | 1751-03-21 00:19:04 |      3 |
| 1889-10-27 | 1861-09-12 13:28:18 |      4 |
+------------+---------------------+--------+
5 rows in set (0.06 sec)
```

例 1: 指定された DATETIME 値を `boundary` パラメータを指定せずに 5 秒の時間間隔の始まりに変換します。

```Plaintext
select time_slice(id_datetime, interval 5 second)
from test_all_type_select
order by id_int;
+---------------------------------------------------+
| time_slice(id_datetime, INTERVAL 5 second, floor) |
+---------------------------------------------------+
| 1691-12-23 04:01:05                               |
| 2169-12-18 15:44:30                               |
| 1840-11-23 13:09:50                               |
| 1751-03-21 00:19:00                               |
| 1861-09-12 13:28:15                               |
+---------------------------------------------------+
5 rows in set (0.16 sec)
```

例 2: 指定された DATETIME 値を `boundary` を `FLOOR` に設定して 5 日間の時間間隔の始まりに変換します。

```Plaintext
select time_slice(id_datetime, interval 5 day, FLOOR)
from test_all_type_select
order by id_int;
+------------------------------------------------+
| time_slice(id_datetime, INTERVAL 5 day, floor) |
+------------------------------------------------+
| 1691-12-22 00:00:00                            |
| 2169-12-16 00:00:00                            |
| 1840-11-21 00:00:00                            |
| 1751-03-18 00:00:00                            |
| 1861-09-12 00:00:00                            |
+------------------------------------------------+
5 rows in set (0.15 sec)
```

例 3: 指定された DATETIME 値を 5 日間の時間間隔の終わりに変換します。

```Plaintext
select time_slice(id_datetime, interval 5 day, CEIL)
from test_all_type_select
order by id_int;
+-----------------------------------------------+
| time_slice(id_datetime, INTERVAL 5 day, ceil) |
+-----------------------------------------------+
| 1691-12-27 00:00:00                           |
| 2169-12-21 00:00:00                           |
| 1840-11-26 00:00:00                           |
| 1751-03-23 00:00:00                           |
| 1861-09-17 00:00:00                           |
+-----------------------------------------------+
```

例 4: 指定された DATETIME 値を 1 ミリ秒の時間間隔の終わりに変換します。

```Plaintext
select id_datetime, time_slice(id_datetime, interval 1 millisecond, CEIL)
from test_all_type_select
order by id_int;
+---------------------+-------------------------------------------------------+
| id_datetime         | time_slice(id_datetime, INTERVAL 1 millisecond, ceil) |
+---------------------+-------------------------------------------------------+
| 1691-12-23 04:01:09 | 1691-12-23 04:01:09.001000                            |
| 2169-12-18 15:44:31 | 2169-12-18 15:44:31.001000                            |
| 1840-11-23 13:09:50 | 1840-11-23 13:09:50.001000                            |
| 1751-03-21 00:19:04 | 1751-03-21 00:19:04.001000                            |
| 1861-09-12 13:28:18 | 1861-09-12 13:28:18.001000                            |
+---------------------+-------------------------------------------------------+
```

例 5: 指定された DATETIME 値を 1 マイクロ秒の時間間隔の終わりに変換します。

```Plaintext
select id_datetime, time_slice(id_datetime, interval 1 microsecond, CEIL)
from test_all_type_select
order by id_int;
+---------------------+-------------------------------------------------------+
| id_datetime         | time_slice(id_datetime, INTERVAL 1 microsecond, ceil) |
+---------------------+-------------------------------------------------------+
| 1691-12-23 04:01:09 | 1691-12-23 04:01:09.000001                            |
| 2169-12-18 15:44:31 | 2169-12-18 15:44:31.000001                            |
| 1840-11-23 13:09:50 | 1840-11-23 13:09:50.000001                            |
| 1751-03-21 00:19:04 | 1751-03-21 00:19:04.000001                            |
| 1861-09-12 13:28:18 | 1861-09-12 13:28:18.000001                            |
+---------------------+-------------------------------------------------------+
```