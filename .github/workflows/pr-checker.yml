name: PR CHECKER

on:
  pull_request:
    branches:
      - main
      - 'branch-[0-9].[0-9]'

    types:
      - opened
      - reopened
      - edited
      - synchronize

permissions:
  checks: write
  actions: write
  contents: write
  deployments: write
  discussions: write
  issues: write
  packages: write
  pages: write
  pull-requests: write
  repository-projects: write
  security-events: write
  statuses: write

jobs:

  behavior-check:
    runs-on: ubuntu-latest
    if: >
      !startsWith(github.event.pull_request.title, '[Doc]') && github.base_ref == 'main'
    steps:
      - name: info
        run: |
          cat $GITHUB_EVENT_PATH

      - name: Format Check1
        id: check1
        if: >
          !contains(github.event.pull_request.body, '[ ] Yes, this PR will result in a change in behavior') && contains(github.event.pull_request.body, '[ ] Yes, this PR will result in a change in behavior')!contains(github.event.pull_request.body, '[x] Yes, this PR will result in a change in behavior')
        run: |
          echo "::error::Please check the format of your pr body about the behavior change checkbox!"
          exit 1

      - name: Format Check2
        id: check2
        if: >
          (!contains(github.event.pull_request.body, '[ ] No, this PR will not result in a change in behavior') &&
           !contains(github.event.pull_request.body, '[x] No, this PR will not result in a change in behavior'))
        run: |
          echo "::error::Please check the format of your pr body about the behavior change checkbox!"
          exit 1

      - name: Format Check3
        id: check3
        if: >
          (contains(github.event.pull_request.body, '[x] Yes, this PR will result in a change in behavior') &&
           contains(github.event.pull_request.body, '[x] No, this PR will not result in a change in behavior'))
        run: |
          echo "::error::Please check the format of your pr body about the behavior change checkbox!"
          exit 1

      - name: Format Check4
        id: check4
        if: >
          contains(github.event.pull_request.body, '[ ] Yes, this PR will result in a change in behavior')
        run: |
          echo "::error::Please check the format of your pr body about the behavior change checkbox!"
          exit 1

      - name: Format Check5
        id: check5
        if: >
          always() && !contains(github.event.pull_request.body, '[x] Yes, this PR will result in a change in behavior')
        run: |
          echo "::error::Please check the format of your pr body about the behavior change checkbox!"
          exit 1
      

